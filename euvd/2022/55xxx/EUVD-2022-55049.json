{
  "id": "EUVD-2022-55049",
  "enisaUuid": "23463334-bb86-33ab-a087-f1b3a8aed582",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbfq: fix use-after-free in bfq_dispatch_request\n\nKASAN reports a use-after-free report when doing normal scsi-mq test\n\n[69832.239032] ==================================================================\n[69832.241810] BUG: KASAN: use-after-free in bfq_dispatch_request+0x1045/0x44b0\n[69832.243267] Read of size 8 at addr ffff88802622ba88 by task kworker/3:1H/155\n[69832.244656]\n[69832.245007] CPU: 3 PID: 155 Comm: kworker/3:1H Not tainted 5.10.0-10295-g576c6382529e #8\n[69832.246626] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n[69832.249069] Workqueue: kblockd blk_mq_run_work_fn\n[69832.250022] Call Trace:\n[69832.250541]  dump_stack+0x9b/0xce\n[69832.251232]  ? bfq_dispatch_request+0x1045/0x44b0\n[69832.252243]  print_address_description.constprop.6+0x3e/0x60\n[69832.253381]  ? __cpuidle_text_end+0x5/0x5\n[69832.254211]  ? vprintk_func+0x6b/0x120\n[69832.254994]  ? bfq_dispatch_request+0x1045/0x44b0\n[69832.255952]  ? bfq_dispatch_request+0x1045/0x44b0\n[69832.256914]  kasan_report.cold.9+0x22/0x3a\n[69832.257753]  ? bfq_dispatch_request+0x1045/0x44b0\n[69832.258755]  check_memory_region+0x1c1/0x1e0\n[69832.260248]  bfq_dispatch_request+0x1045/0x44b0\n[69832.261181]  ? bfq_bfqq_expire+0x2440/0x2440\n[69832.262032]  ? blk_mq_delay_run_hw_queues+0xf9/0x170\n[69832.263022]  __blk_mq_do_dispatch_sched+0x52f/0x830\n[69832.264011]  ? blk_mq_sched_request_inserted+0x100/0x100\n[69832.265101]  __blk_mq_sched_dispatch_requests+0x398/0x4f0\n[69832.266206]  ? blk_mq_do_dispatch_ctx+0x570/0x570\n[69832.267147]  ? __switch_to+0x5f4/0xee0\n[69832.267898]  blk_mq_sched_dispatch_requests+0xdf/0x140\n[69832.268946]  __blk_mq_run_hw_queue+0xc0/0x270\n[69832.269840]  blk_mq_run_work_fn+0x51/0x60\n[69832.278170]  process_one_work+0x6d4/0xfe0\n[69832.278984]  worker_thread+0x91/0xc80\n[69832.279726]  ? __kthread_parkme+0xb0/0x110\n[69832.280554]  ? process_one_work+0xfe0/0xfe0\n[69832.281414]  kthread+0x32d/0x3f0\n[69832.282082]  ? kthread_park+0x170/0x170\n[69832.282849]  ret_from_fork+0x1f/0x30\n[69832.283573]\n[69832.283886] Allocated by task 7725:\n[69832.284599]  kasan_save_stack+0x19/0x40\n[69832.285385]  __kasan_kmalloc.constprop.2+0xc1/0xd0\n[69832.286350]  kmem_cache_alloc_node+0x13f/0x460\n[69832.287237]  bfq_get_queue+0x3d4/0x1140\n[69832.287993]  bfq_get_bfqq_handle_split+0x103/0x510\n[69832.289015]  bfq_init_rq+0x337/0x2d50\n[69832.289749]  bfq_insert_requests+0x304/0x4e10\n[69832.290634]  blk_mq_sched_insert_requests+0x13e/0x390\n[69832.291629]  blk_mq_flush_plug_list+0x4b4/0x760\n[69832.292538]  blk_flush_plug_list+0x2c5/0x480\n[69832.293392]  io_schedule_prepare+0xb2/0xd0\n[69832.294209]  io_schedule_timeout+0x13/0x80\n[69832.295014]  wait_for_common_io.constprop.1+0x13c/0x270\n[69832.296137]  submit_bio_wait+0x103/0x1a0\n[69832.296932]  blkdev_issue_discard+0xe6/0x160\n[69832.297794]  blk_ioctl_discard+0x219/0x290\n[69832.298614]  blkdev_common_ioctl+0x50a/0x1750\n[69832.304715]  blkdev_ioctl+0x470/0x600\n[69832.305474]  block_ioctl+0xde/0x120\n[69832.306232]  vfs_ioctl+0x6c/0xc0\n[69832.306877]  __se_sys_ioctl+0x90/0xa0\n[69832.307629]  do_syscall_64+0x2d/0x40\n[69832.308362]  entry_SYSCALL_64_after_hwframe+0x44/0xa9\n[69832.309382]\n[69832.309701] Freed by task 155:\n[69832.310328]  kasan_save_stack+0x19/0x40\n[69832.311121]  kasan_set_track+0x1c/0x30\n[69832.311868]  kasan_set_free_info+0x1b/0x30\n[69832.312699]  __kasan_slab_free+0x111/0x160\n[69832.313524]  kmem_cache_free+0x94/0x460\n[69832.314367]  bfq_put_queue+0x582/0x940\n[69832.315112]  __bfq_bfqd_reset_in_service+0x166/0x1d0\n[69832.317275]  bfq_bfqq_expire+0xb27/0x2440\n[69832.318084]  bfq_dispatch_request+0x697/0x44b0\n[69832.318991]  __blk_mq_do_dispatch_sched+0x52f/0x830\n[69832.319984]  __blk_mq_sched_dispatch_requests+0x398/0x4f0\n[69832.321087]  blk_mq_sched_dispatch_requests+0xdf/0x140\n[69832.322225]  __blk_mq_run_hw_queue+0xc0/0x270\n[69832.323114]  blk_mq_run_work_fn+0x51/0x6\n---truncated---",
  "datePublished": "Feb 26, 2025, 1:55:30 AM",
  "dateUpdated": "Mar 26, 2025, 5:44:56 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://git.kernel.org/stable/c/74e610b5ee0d95e751280567100509eb11517efa",
    "https://git.kernel.org/stable/c/5117c9ff4c2ebae0f5c2c262d42a25a8fbc086e6",
    "https://git.kernel.org/stable/c/df6e00b1a53c57dca82c63b5ecbcad5452231bc7",
    "https://git.kernel.org/stable/c/080665e2c3cbfc68359b9a348a3546ed9b908e7a",
    "https://git.kernel.org/stable/c/5687958bf18f84384d809f521210d0f5deed03b0",
    "https://git.kernel.org/stable/c/40b4ba0030e0b02cbacd424ebb9f4c8b0976c786",
    "https://git.kernel.org/stable/c/ab552fcb17cc9e4afe0e4ac4df95fc7b30e8490a",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49176"
  ],
  "aliases": [
    "CVE-2022-49176"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0cfac64c-95f6-3af2-82dd-ab36acde1c48",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "0f96b5b4-1947-3277-9ed0-d245e2094044",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.2"
    },
    {
      "id": "1036934c-b096-3df1-9e5e-389543e38563",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <080665e2c3cbfc68359b9a348a3546ed9b908e7a"
    },
    {
      "id": "260c1265-5376-3d0f-bfd1-656c2530ed6d",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <40b4ba0030e0b02cbacd424ebb9f4c8b0976c786"
    },
    {
      "id": "2d900176-d036-3b5c-828b-63f36c5a434f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.33"
    },
    {
      "id": "46aae37e-94af-356e-b45e-413a8313926c",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <080665e2c3cbfc68359b9a348a3546ed9b908e7a"
    },
    {
      "id": "46df9185-3747-3a83-8bf2-5cfa00616a65",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.238"
    },
    {
      "id": "54c186cf-f316-3c9b-9c0d-fd28b3d7183a",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <ab552fcb17cc9e4afe0e4ac4df95fc7b30e8490a"
    },
    {
      "id": "59f231bd-d714-3eeb-9d04-2f62eeff7e8d",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5117c9ff4c2ebae0f5c2c262d42a25a8fbc086e6"
    },
    {
      "id": "64a7891b-a036-372d-a8a4-8049dfb45475",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <df6e00b1a53c57dca82c63b5ecbcad5452231bc7"
    },
    {
      "id": "73176585-3721-3c56-aba0-53a14b58b553",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <40b4ba0030e0b02cbacd424ebb9f4c8b0976c786"
    },
    {
      "id": "96e45c98-22f6-3300-b3ce-d91f69e141e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.12"
    },
    {
      "id": "aa967ffd-cdda-3920-b6e8-b06345d71c3d",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <74e610b5ee0d95e751280567100509eb11517efa"
    },
    {
      "id": "ac029236-f535-3b03-9f92-c5e6a4f219d6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ab552fcb17cc9e4afe0e4ac4df95fc7b30e8490a"
    },
    {
      "id": "b03833fd-5529-33f5-8140-1fecf1a663d0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5687958bf18f84384d809f521210d0f5deed03b0"
    },
    {
      "id": "b818f4df-a31d-358e-af32-812a20eb1694",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <df6e00b1a53c57dca82c63b5ecbcad5452231bc7"
    },
    {
      "id": "b8ef422d-58f6-327f-868a-2a48c1e52fb1",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <5687958bf18f84384d809f521210d0f5deed03b0"
    },
    {
      "id": "bd7f892b-a8d2-38eb-a608-596f946fdbd1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.19"
    },
    {
      "id": "e2c8476e-a0ba-37e2-89e0-6e2396f29c39",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.189"
    },
    {
      "id": "ed3122ed-65ac-3215-abe6-65cb1091e668",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.110"
    },
    {
      "id": "f28b7458-4e1d-3403-8408-206ac2619dd6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <74e610b5ee0d95e751280567100509eb11517efa"
    },
    {
      "id": "f2ec3cfd-79d5-3bbc-afa1-633b425d3851",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <5117c9ff4c2ebae0f5c2c262d42a25a8fbc086e6"
    },
    {
      "id": "f435f13b-13fb-3118-8d0f-8510a40b8007",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "fe808a66-a7d7-3e4d-8ff3-e8e14c375352",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}