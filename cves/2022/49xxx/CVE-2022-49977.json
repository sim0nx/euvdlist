{
  "id": "EUVD-2022-55257",
  "enisaUuid": "8c0dafbc-7dcc-3270-b8c5-717c5bd66ede",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nftrace: Fix NULL pointer dereference in is_ftrace_trampoline when ftrace is dead\n\nftrace_startup does not remove ops from ftrace_ops_list when\nftrace_startup_enable fails:\n\nregister_ftrace_function\n  ftrace_startup\n    __register_ftrace_function\n      ...\n      add_ftrace_ops(&ftrace_ops_list, ops)\n      ...\n    ...\n    ftrace_startup_enable // if ftrace failed to modify, ftrace_disabled is set to 1\n    ...\n  return 0 // ops is in the ftrace_ops_list.\n\nWhen ftrace_disabled = 1, unregister_ftrace_function simply returns without doing anything:\nunregister_ftrace_function\n  ftrace_shutdown\n    if (unlikely(ftrace_disabled))\n            return -ENODEV;  // return here, __unregister_ftrace_function is not executed,\n                             // as a result, ops is still in the ftrace_ops_list\n    __unregister_ftrace_function\n    ...\n\nIf ops is dynamically allocated, it will be free later, in this case,\nis_ftrace_trampoline accesses NULL pointer:\n\nis_ftrace_trampoline\n  ftrace_ops_trampoline\n    do_for_each_ftrace_op(op, ftrace_ops_list) // OOPS! op may be NULL!\n\nSyzkaller reports as follows:\n[ 1203.506103] BUG: kernel NULL pointer dereference, address: 000000000000010b\n[ 1203.508039] #PF: supervisor read access in kernel mode\n[ 1203.508798] #PF: error_code(0x0000) - not-present page\n[ 1203.509558] PGD 800000011660b067 P4D 800000011660b067 PUD 130fb8067 PMD 0\n[ 1203.510560] Oops: 0000 [#1] SMP KASAN PTI\n[ 1203.511189] CPU: 6 PID: 29532 Comm: syz-executor.2 Tainted: G    B   W         5.10.0 #8\n[ 1203.512324] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n[ 1203.513895] RIP: 0010:is_ftrace_trampoline+0x26/0xb0\n[ 1203.514644] Code: ff eb d3 90 41 55 41 54 49 89 fc 55 53 e8 f2 00 fd ff 48 8b 1d 3b 35 5d 03 e8 e6 00 fd ff 48 8d bb 90 00 00 00 e8 2a 81 26 00 <48> 8b ab 90 00 00 00 48 85 ed 74 1d e8 c9 00 fd ff 48 8d bb 98 00\n[ 1203.518838] RSP: 0018:ffffc900012cf960 EFLAGS: 00010246\n[ 1203.520092] RAX: 0000000000000000 RBX: 000000000000007b RCX: ffffffff8a331866\n[ 1203.521469] RDX: 0000000000000000 RSI: 0000000000000008 RDI: 000000000000010b\n[ 1203.522583] RBP: 0000000000000000 R08: 0000000000000000 R09: ffffffff8df18b07\n[ 1203.523550] R10: fffffbfff1be3160 R11: 0000000000000001 R12: 0000000000478399\n[ 1203.524596] R13: 0000000000000000 R14: ffff888145088000 R15: 0000000000000008\n[ 1203.525634] FS:  00007f429f5f4700(0000) GS:ffff8881daf00000(0000) knlGS:0000000000000000\n[ 1203.526801] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[ 1203.527626] CR2: 000000000000010b CR3: 0000000170e1e001 CR4: 00000000003706e0\n[ 1203.528611] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n[ 1203.529605] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n\nTherefore, when ftrace_startup_enable fails, we need to rollback registration\nprocess and remove ops from ftrace_ops_list.",
  "datePublished": "Jun 18, 2025, 11:00:39 AM",
  "dateUpdated": "Jun 18, 2025, 11:00:39 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/8569b4ada1e0b9bfaa125bd0c0967918b6560fa2",
    "https://git.kernel.org/stable/c/4c34a2a6c9927c239dd2e295a03d49b37b618d2c",
    "https://git.kernel.org/stable/c/ddffe882d74ef43a3494f0ab0c24baf076c45f96",
    "https://git.kernel.org/stable/c/934e49f7d696afdae9f979abe3f308408184e17b",
    "https://git.kernel.org/stable/c/dbd8c8fc60480e3faa3ae7e27ebe03371ecd1b77",
    "https://git.kernel.org/stable/c/e4ae97295984ff1b9b340ed18ae1b066f36b7835",
    "https://git.kernel.org/stable/c/d81bd6671f45fde4c3ac7fd7733c6e3082ae9d8e",
    "https://git.kernel.org/stable/c/c3b0f72e805f0801f05fa2aa52011c4bfc694c44"
  ],
  "aliases": [
    "CVE-2022-49977"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "00f3cc72-564b-36f9-b45b-6db52bff7c50",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c3b0f72e805f0801f05fa2aa52011c4bfc694c44"
    },
    {
      "id": "17bfa3e4-0903-32a0-a845-989ea0a7f026",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <934e49f7d696afdae9f979abe3f308408184e17b"
    },
    {
      "id": "2969a14f-b2f1-346f-8719-827c0323774a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "2e316a53-bfed-3eb7-bfbf-4014bc91e4a6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <dbd8c8fc60480e3faa3ae7e27ebe03371ecd1b77"
    },
    {
      "id": "397d943b-c03c-3442-8d93-b29f9e628695",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.257"
    },
    {
      "id": "42e1f06e-f9c8-3d5f-ae81-25343a69e4e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.212"
    },
    {
      "id": "554a43e2-9671-324f-b672-468ea7568692",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.65"
    },
    {
      "id": "572e9b7e-8bc1-34e0-bf69-ae940785f44e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.141"
    },
    {
      "id": "8f4eb79d-165e-348e-b4ef-a67660d1b5d3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d81bd6671f45fde4c3ac7fd7733c6e3082ae9d8e"
    },
    {
      "id": "b0713ac6-c14e-3c4a-b609-3314f85c361f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e4ae97295984ff1b9b340ed18ae1b066f36b7835"
    },
    {
      "id": "cba24072-debc-3d5a-957e-3a7d20b3f7d5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.292"
    },
    {
      "id": "d188035e-7cfe-3e5e-9b70-7d5be2ae2284",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.7"
    },
    {
      "id": "dd6118e0-0bf4-3c91-b061-b2d710c9055d",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8569b4ada1e0b9bfaa125bd0c0967918b6560fa2"
    },
    {
      "id": "eec3d63d-2d52-312c-9744-9ee96af0a65a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ddffe882d74ef43a3494f0ab0c24baf076c45f96"
    },
    {
      "id": "f9258c9e-635b-3790-b176-c8d2a11fc9fd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.327"
    },
    {
      "id": "fb5b4270-2303-35b2-b842-7843bbce8bb2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4c34a2a6c9927c239dd2e295a03d49b37b618d2c"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "1abc0e1e-8162-3562-a104-6515ac2fc258",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49977"
}