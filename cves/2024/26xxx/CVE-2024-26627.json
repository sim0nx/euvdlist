{
  "id": "EUVD-2024-23889",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: core: Move scsi_host_busy() out of host lock for waking up EH handler\n\nInside scsi_eh_wakeup(), scsi_host_busy() is called & checked with host\nlock every time for deciding if error handler kthread needs to be waken up.\n\nThis can be too heavy in case of recovery, such as:\n\n - N hardware queues\n\n - queue depth is M for each hardware queue\n\n - each scsi_host_busy() iterates over (N * M) tag/requests\n\nIf recovery is triggered in case that all requests are in-flight, each\nscsi_eh_wakeup() is strictly serialized, when scsi_eh_wakeup() is called\nfor the last in-flight request, scsi_host_busy() has been run for (N * M -\n1) times, and request has been iterated for (N*M - 1) * (N * M) times.\n\nIf both N and M are big enough, hard lockup can be triggered on acquiring\nhost lock, and it is observed on mpi3mr(128 hw queues, queue depth 8169).\n\nFix the issue by calling scsi_host_busy() outside the host lock. We don't\nneed the host lock for getting busy count because host the lock never\ncovers that.\n\n[mkp: Drop unnecessary 'busy' variables pointed out by Bart]",
  "datePublished": "Mar 6, 2024, 6:45:34 AM",
  "dateUpdated": "Apr 16, 2025, 3:55:34 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/f5944853f7a961fedc1227dc8f60393f8936d37c",
    "https://git.kernel.org/stable/c/d37c1c81419fdef66ebd0747cf76fb8b7d979059",
    "https://git.kernel.org/stable/c/db6338f45971b4285ea368432a84033690eaf53c",
    "https://git.kernel.org/stable/c/65ead8468c21c2676d4d06f50b46beffdea69df1",
    "https://git.kernel.org/stable/c/07e3ca0f17f579491b5f54e9ed05173d6c1d6fcb",
    "https://git.kernel.org/stable/c/4373534a9850627a2695317944898eb1283a2db0"
  ],
  "aliases": [
    "CVE-2024-26627",
    "GSD-2024-26627"
  ],
  "assigner": "Linux",
  "epss": 0.01,
  "enisaIdProduct": [
    {
      "id": "006634cb-b70f-35fc-ba40-1b85395f1243",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <f5944853f7a961fedc1227dc8f60393f8936d37c"
    },
    {
      "id": "0d61e97b-f5f9-31d3-a528-6c052c396954",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <d37c1c81419fdef66ebd0747cf76fb8b7d979059"
    },
    {
      "id": "1eea4376-cfe7-3890-91b2-e2034c5f5d7c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <db6338f45971b4285ea368432a84033690eaf53c"
    },
    {
      "id": "218ecc35-b1f5-3ede-9b66-6a9c71a5dee9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.8"
    },
    {
      "id": "248842f9-022f-351b-986e-59eeb031c592",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <07e3ca0f17f579491b5f54e9ed05173d6c1d6fcb"
    },
    {
      "id": "32a0b6ce-378c-3c2e-b38c-54909e49500a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.7.4"
    },
    {
      "id": "392e1dc3-fce9-39a5-af3b-8762704546e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.5"
    },
    {
      "id": "45638ff4-dce0-39d2-b8a3-ee39d2b2f4c6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.16"
    },
    {
      "id": "48a6a26a-dbb4-3ee4-b155-eb63fb79c42c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.149"
    },
    {
      "id": "62076926-353d-344f-ae06-08f92358fc75",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <4373534a9850627a2695317944898eb1283a2db0"
    },
    {
      "id": "89929751-50c4-30d2-8ca9-1408b4afbb68",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.77"
    },
    {
      "id": "a184899d-ce08-3ca5-8005-6dfe2fb47070",
      "product": {
        "name": "Linux"
      },
      "product_version": "6eb045e092efefafc6687409a6fa6d1dabf0fb69 <65ead8468c21c2676d4d06f50b46beffdea69df1"
    },
    {
      "id": "aa1de1b4-9cb3-3142-bf54-26dc8803e144",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "c8584757-6753-3e9b-926f-24e7f2594583",
      "product": {
        "name": "Linux"
      }
    },
    {
      "id": "e493ca76-04fb-3115-9e0f-247f0408069d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.210"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "c8584757-6753-3e9b-926f-24e7f2594583",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2024-26627"
}
