{
  "id": "EUVD-2022-54779",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrxrpc: Fix listen() setting the bar too high for the prealloc rings\n\nAF_RXRPC's listen() handler lets you set the backlog up to 32 (if you bump\nup the sysctl), but whilst the preallocation circular buffers have 32 slots\nin them, one of them has to be a dead slot because we're using CIRC_CNT().\n\nThis means that listen(rxrpc_sock, 32) will cause an oops when the socket\nis closed because rxrpc_service_prealloc_one() allocated one too many calls\nand rxrpc_discard_prealloc() won't then be able to get rid of them because\nit'll think the ring is empty.  rxrpc_release_calls_on_socket() then tries\nto abort them, but oopses because call->peer isn't yet set.\n\nFix this by setting the maximum backlog to RXRPC_BACKLOG_MAX - 1 to match\nthe ring capacity.\n\n BUG: kernel NULL pointer dereference, address: 0000000000000086\n ...\n RIP: 0010:rxrpc_send_abort_packet+0x73/0x240 [rxrpc]\n Call Trace:\n  <TASK>\n  ? __wake_up_common_lock+0x7a/0x90\n  ? rxrpc_notify_socket+0x8e/0x140 [rxrpc]\n  ? rxrpc_abort_call+0x4c/0x60 [rxrpc]\n  rxrpc_release_calls_on_socket+0x107/0x1a0 [rxrpc]\n  rxrpc_release+0xc9/0x1c0 [rxrpc]\n  __sock_release+0x37/0xa0\n  sock_close+0x11/0x20\n  __fput+0x89/0x240\n  task_work_run+0x59/0x90\n  do_exit+0x319/0xaa0",
  "datePublished": "Mar 17, 2025, 6:31:49 PM",
  "dateUpdated": "Mar 17, 2025, 6:31:49 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/61fb38cfbb1d54d3dafd0c25752f684b3cd00b32",
    "https://git.kernel.org/stable/c/616f76498d5ddf26b997caf64a95cda3c8a55533",
    "https://git.kernel.org/stable/c/4a3a78b7918bdd723d8c7c9786522ca969bffcc4",
    "https://git.kernel.org/stable/c/91b34bf0409f43bb60453bab23c5beadd726d022",
    "https://git.kernel.org/stable/c/5b4826657d36c218e9f08e8d3223b0edce3de88f",
    "https://git.kernel.org/stable/c/b3a9b227d5e7467b8518160ff034ea22bb9de573",
    "https://git.kernel.org/stable/c/369de57492c4f1a42563c5a3bd365822ca3bfc79",
    "https://git.kernel.org/stable/c/e198f1930050e3115c80b67d9249f80f98a27c67",
    "https://git.kernel.org/stable/c/88e22159750b0d55793302eeed8ee603f5c1a95c",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49450"
  ],
  "aliases": [
    "CVE-2022-49450"
  ],
  "assigner": "Linux",
  "epss": 0.06,
  "enisaIdProduct": [
    {
      "id": "0163b912-432d-3325-aab8-9346807c7736",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "0bc946d8-4580-32b4-b450-73497dbb5ed5",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <5b4826657d36c218e9f08e8d3223b0edce3de88f"
    },
    {
      "id": "0cf9e5eb-6f03-3300-bd98-d055e41b1b4c",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <e198f1930050e3115c80b67d9249f80f98a27c67"
    },
    {
      "id": "1908404b-0f88-3275-8b6d-68ea8359e45a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.318"
    },
    {
      "id": "2b5626c9-124f-35ef-a751-074efd1e5561",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.283"
    },
    {
      "id": "31c1c01a-0199-36e6-b6d3-415094b732ca",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <91b34bf0409f43bb60453bab23c5beadd726d022"
    },
    {
      "id": "5280d331-c9ed-3869-b786-45c3e98e3e72",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <61fb38cfbb1d54d3dafd0c25752f684b3cd00b32"
    },
    {
      "id": "5725cd77-532e-378c-9113-606dfef47d3b",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <369de57492c4f1a42563c5a3bd365822ca3bfc79"
    },
    {
      "id": "69303c71-310c-3296-8372-18cc8d82c362",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <616f76498d5ddf26b997caf64a95cda3c8a55533"
    },
    {
      "id": "6e2927cd-5d2c-35e1-93fe-b220c831e0ad",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.9"
    },
    {
      "id": "79bcc257-6c13-3954-80c7-bd1c71bbb0e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "7fb8846e-bb9f-348f-ac2f-8b2c1fc6f0f0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.46"
    },
    {
      "id": "91072ba2-64fb-337c-b95d-ece05d6f9a73",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.3"
    },
    {
      "id": "9a10c128-3642-3eb4-9db8-8d49892e1337",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <88e22159750b0d55793302eeed8ee603f5c1a95c"
    },
    {
      "id": "a0726e99-293e-35c6-91c2-b615f4f8275f",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <b3a9b227d5e7467b8518160ff034ea22bb9de573"
    },
    {
      "id": "d1b1412e-33e9-3160-8bf4-ba0e4724b409",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.14"
    },
    {
      "id": "d9fac1fd-dc5b-3222-b467-6e94f8a73ae1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.121"
    },
    {
      "id": "de30bf74-fa92-303e-afdc-352882b6408c",
      "product": {
        "name": "Linux"
      },
      "product_version": "00e907127e6f86d0f9b122d9b4347a8aa09a8b61 <4a3a78b7918bdd723d8c7c9786522ca969bffcc4"
    },
    {
      "id": "f3b91107-52d0-3925-a374-f0cfc1074803",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.247"
    },
    {
      "id": "faf71b84-b62b-3d33-b414-2869a95fc44a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.198"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "4c9d9044-2e34-30fe-89d3-40d0b66f9fd0",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49450"
}
