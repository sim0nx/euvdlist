{
  "id": "EUVD-2025-32302",
  "enisaUuid": "e2472cf6-c9d7-38b1-9cb4-875b37615889",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing/histograms: Add histograms to hist_vars if they have referenced variables\n\nHist triggers can have referenced variables without having direct\nvariables fields. This can be the case if referenced variables are added\nfor trigger actions. In this case the newly added references will not\nhave field variables. Not taking such referenced variables into\nconsideration can result in a bug where it would be possible to remove\nhist trigger with variables being refenced. This will result in a bug\nthat is easily reproducable like so\n\n$ cd /sys/kernel/tracing\n$ echo 'synthetic_sys_enter char[] comm; long id' >> synthetic_events\n$ echo 'hist:keys=common_pid.execname,id.syscall:vals=hitcount:comm=common_pid.execname' >> events/raw_syscalls/sys_enter/trigger\n$ echo 'hist:keys=common_pid.execname,id.syscall:onmatch(raw_syscalls.sys_enter).synthetic_sys_enter($comm, id)' >> events/raw_syscalls/sys_enter/trigger\n$ echo '!hist:keys=common_pid.execname,id.syscall:vals=hitcount:comm=common_pid.execname' >> events/raw_syscalls/sys_enter/trigger\n\n[  100.263533] ==================================================================\n[  100.264634] BUG: KASAN: slab-use-after-free in resolve_var_refs+0xc7/0x180\n[  100.265520] Read of size 8 at addr ffff88810375d0f0 by task bash/439\n[  100.266320]\n[  100.266533] CPU: 2 PID: 439 Comm: bash Not tainted 6.5.0-rc1 #4\n[  100.267277] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.0-20220807_005459-localhost 04/01/2014\n[  100.268561] Call Trace:\n[  100.268902]  <TASK>\n[  100.269189]  dump_stack_lvl+0x4c/0x70\n[  100.269680]  print_report+0xc5/0x600\n[  100.270165]  ? resolve_var_refs+0xc7/0x180\n[  100.270697]  ? kasan_complete_mode_report_info+0x80/0x1f0\n[  100.271389]  ? resolve_var_refs+0xc7/0x180\n[  100.271913]  kasan_report+0xbd/0x100\n[  100.272380]  ? resolve_var_refs+0xc7/0x180\n[  100.272920]  __asan_load8+0x71/0xa0\n[  100.273377]  resolve_var_refs+0xc7/0x180\n[  100.273888]  event_hist_trigger+0x749/0x860\n[  100.274505]  ? kasan_save_stack+0x2a/0x50\n[  100.275024]  ? kasan_set_track+0x29/0x40\n[  100.275536]  ? __pfx_event_hist_trigger+0x10/0x10\n[  100.276138]  ? ksys_write+0xd1/0x170\n[  100.276607]  ? do_syscall_64+0x3c/0x90\n[  100.277099]  ? entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n[  100.277771]  ? destroy_hist_data+0x446/0x470\n[  100.278324]  ? event_hist_trigger_parse+0xa6c/0x3860\n[  100.278962]  ? __pfx_event_hist_trigger_parse+0x10/0x10\n[  100.279627]  ? __kasan_check_write+0x18/0x20\n[  100.280177]  ? mutex_unlock+0x85/0xd0\n[  100.280660]  ? __pfx_mutex_unlock+0x10/0x10\n[  100.281200]  ? kfree+0x7b/0x120\n[  100.281619]  ? ____kasan_slab_free+0x15d/0x1d0\n[  100.282197]  ? event_trigger_write+0xac/0x100\n[  100.282764]  ? __kasan_slab_free+0x16/0x20\n[  100.283293]  ? __kmem_cache_free+0x153/0x2f0\n[  100.283844]  ? sched_mm_cid_remote_clear+0xb1/0x250\n[  100.284550]  ? __pfx_sched_mm_cid_remote_clear+0x10/0x10\n[  100.285221]  ? event_trigger_write+0xbc/0x100\n[  100.285781]  ? __kasan_check_read+0x15/0x20\n[  100.286321]  ? __bitmap_weight+0x66/0xa0\n[  100.286833]  ? _find_next_bit+0x46/0xe0\n[  100.287334]  ? task_mm_cid_work+0x37f/0x450\n[  100.287872]  event_triggers_call+0x84/0x150\n[  100.288408]  trace_event_buffer_commit+0x339/0x430\n[  100.289073]  ? ring_buffer_event_data+0x3f/0x60\n[  100.292189]  trace_event_raw_event_sys_enter+0x8b/0xe0\n[  100.295434]  syscall_trace_enter.constprop.0+0x18f/0x1b0\n[  100.298653]  syscall_enter_from_user_mode+0x32/0x40\n[  100.301808]  do_syscall_64+0x1a/0x90\n[  100.304748]  entry_SYSCALL_64_after_hwframe+0x6e/0xd8\n[  100.307775] RIP: 0033:0x7f686c75c1cb\n[  100.310617] Code: 73 01 c3 48 8b 0d 65 3c 10 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa b8 21 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 35 3c 10 00 f7 d8 64 89 01 48\n[  100.317847] RSP: 002b:00007ffc60137a38 EFLAGS: 00000246 ORIG_RAX: 0000000000000021\n[  100.321200] RA\n---truncated---",
  "datePublished": "Oct 4, 2025, 3:17:04 PM",
  "dateUpdated": "Oct 4, 2025, 3:17:04 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53560",
    "https://git.kernel.org/stable/c/1576f0df7b4d1f82db588d6654b89d796fa06929",
    "https://git.kernel.org/stable/c/4815359056083c555f97a5ee3af86519be5166de",
    "https://git.kernel.org/stable/c/4a540f63618e525e433b37d2b5522cda08e321d7",
    "https://git.kernel.org/stable/c/4ffad1528e81c91769d9da1f8436080861c8ec67",
    "https://git.kernel.org/stable/c/5fd32eb6fa0ac795aa5a64bc004ab68d7b44196a",
    "https://git.kernel.org/stable/c/6018b585e8c6fa7d85d4b38d9ce49a5b67be7078",
    "https://git.kernel.org/stable/c/97f54b330c797ed27fba8791baeaa38ace886cbd"
  ],
  "aliases": [
    "CVE-2023-53560",
    "GHSA-g32r-xv9q-pp8r"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "03225fd9-0ecc-3f14-ba7b-89f01d9b416a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.251"
    },
    {
      "id": "1fff39ee-da4b-3f13-84d2-f80439ccc7e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.188"
    },
    {
      "id": "25bd0903-fbb6-398d-84e8-bfd620fd91fc",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <97f54b330c797ed27fba8791baeaa38ace886cbd"
    },
    {
      "id": "2fc7586a-7e84-34c8-8ec3-3726ac54ca5e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.40"
    },
    {
      "id": "3af2c5d0-2527-3048-ae1e-064eddc428a4",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <4ffad1528e81c91769d9da1f8436080861c8ec67"
    },
    {
      "id": "6d4fe353-748b-37c1-a734-b9eefc4d53b7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.121"
    },
    {
      "id": "7016dc13-6fb2-3400-903d-493d275de45a",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <4815359056083c555f97a5ee3af86519be5166de"
    },
    {
      "id": "91a3d5f3-ad77-3f5d-aee3-6c4b5fde87b5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.291"
    },
    {
      "id": "9fb1d8a8-1eab-3c95-859e-c02c55f4c9f0",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <6018b585e8c6fa7d85d4b38d9ce49a5b67be7078"
    },
    {
      "id": "a5028a4d-ca00-3515-990d-45a81339d74f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.5"
    },
    {
      "id": "aacc20a4-3716-3750-ac72-9f78ed1ba6af",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "ae18c1cc-30e8-385b-beb0-bab9edcd5e19",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <1576f0df7b4d1f82db588d6654b89d796fa06929"
    },
    {
      "id": "c6226553-4c20-3510-a13d-7fe952aa6614",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.17"
    },
    {
      "id": "eb114344-49f9-3555-8fb4-8e6cd6aa1fda",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <4a540f63618e525e433b37d2b5522cda08e321d7"
    },
    {
      "id": "efcaaf46-8a56-346c-9446-ffb1b1050de2",
      "product": {
        "name": "Linux"
      },
      "product_version": "067fe038e70f6e64960d26a79c4df5f1413d0f13 <5fd32eb6fa0ac795aa5a64bc004ab68d7b44196a"
    },
    {
      "id": "f5ce2ba8-1aff-375b-a397-7d7463e02e1f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.4.5"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "291ec21d-4ccc-3dd6-b9b7-299f82cfb7ee",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}