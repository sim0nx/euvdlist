{
  "id": "EUVD-2025-31944",
  "enisaUuid": "879a7150-15b3-37e2-851c-5a7f87ce0a7c",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, cpumap: Handle skb as well when clean up ptr_ring\n\nThe following warning was reported when running xdp_redirect_cpu with\nboth skb-mode and stress-mode enabled:\n\n  ------------[ cut here ]------------\n  Incorrect XDP memory type (-2128176192) usage\n  WARNING: CPU: 7 PID: 1442 at net/core/xdp.c:405\n  Modules linked in:\n  CPU: 7 PID: 1442 Comm: kworker/7:0 Tainted: G  6.5.0-rc2+ #1\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)\n  Workqueue: events __cpu_map_entry_free\n  RIP: 0010:__xdp_return+0x1e4/0x4a0\n  ......\n  Call Trace:\n   <TASK>\n   ? show_regs+0x65/0x70\n   ? __warn+0xa5/0x240\n   ? __xdp_return+0x1e4/0x4a0\n   ......\n   xdp_return_frame+0x4d/0x150\n   __cpu_map_entry_free+0xf9/0x230\n   process_one_work+0x6b0/0xb80\n   worker_thread+0x96/0x720\n   kthread+0x1a5/0x1f0\n   ret_from_fork+0x3a/0x70\n   ret_from_fork_asm+0x1b/0x30\n   </TASK>\n\nThe reason for the warning is twofold. One is due to the kthread\ncpu_map_kthread_run() is stopped prematurely. Another one is\n__cpu_map_ring_cleanup() doesn't handle skb mode and treats skbs in\nptr_ring as XDP frames.\n\nPrematurely-stopped kthread will be fixed by the preceding patch and\nptr_ring will be empty when __cpu_map_ring_cleanup() is called. But\nas the comments in __cpu_map_ring_cleanup() said, handling and freeing\nskbs in ptr_ring as well to \"catch any broken behaviour gracefully\".",
  "datePublished": "Oct 7, 2025, 3:21:20 PM",
  "dateUpdated": "Oct 7, 2025, 3:21:20 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53660",
    "https://git.kernel.org/stable/c/7c62b75cd1a792e14b037fa4f61f9b18914e7de1",
    "https://git.kernel.org/stable/c/937345720d18f1ad006ba3d5dcb3fa121037b8a2",
    "https://git.kernel.org/stable/c/b58d34068fd9f96bfc7d389988dfaf9a92a8fe00",
    "https://git.kernel.org/stable/c/cbd000451885801e9bbfd9cf7a7946806a85cb5e"
  ],
  "aliases": [
    "CVE-2023-53660",
    "GHSA-v6pf-gqpp-85ff"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1160b6fb-4d63-345b-af32-162189e603c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "11941f8a85362f612df61f4aaab0e41b64d2111d <937345720d18f1ad006ba3d5dcb3fa121037b8a2"
    },
    {
      "id": "3ae9df41-1a68-3624-b895-15ebcaec34d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.126"
    },
    {
      "id": "6a5733da-2c32-3260-a1af-2aa40885a982",
      "product": {
        "name": "Linux"
      },
      "product_version": "11941f8a85362f612df61f4aaab0e41b64d2111d <b58d34068fd9f96bfc7d389988dfaf9a92a8fe00"
    },
    {
      "id": "898e5316-31ac-335f-98ff-cb4a7f1f05c2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.5"
    },
    {
      "id": "b00ae520-5e95-3b87-829b-9a14dda9f6ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.15"
    },
    {
      "id": "b1bb7d45-9fbe-3c4e-9839-2fef0e2d4fbf",
      "product": {
        "name": "Linux"
      },
      "product_version": "11941f8a85362f612df61f4aaab0e41b64d2111d <cbd000451885801e9bbfd9cf7a7946806a85cb5e"
    },
    {
      "id": "c2ff2381-4821-3f33-afa3-3421fc4c3534",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.4.10"
    },
    {
      "id": "dd18fcc9-c9ad-3036-8671-3057ecb7b7d0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "eb045b34-7fff-358d-8c57-d9ef1a09ae80",
      "product": {
        "name": "Linux"
      },
      "product_version": "11941f8a85362f612df61f4aaab0e41b64d2111d <7c62b75cd1a792e14b037fa4f61f9b18914e7de1"
    },
    {
      "id": "fc5d9b2b-8189-3fab-b8df-e5582bb23469",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.45"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "40496a1a-7ea1-33a6-bba8-496bb6bd0f49",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2023-53660"
}