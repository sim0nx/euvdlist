{
  "id": "EUVD-2025-201630",
  "enisaUuid": "99d2837e-1841-3194-9e20-21c2efbecf11",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: f_fs: Fix epfile null pointer access after ep enable.\n\nA race condition occurs when ffs_func_eps_enable() runs concurrently\nwith ffs_data_reset(). The ffs_data_clear() called in ffs_data_reset()\nsets ffs->epfiles to NULL before resetting ffs->eps_count to 0, leading\nto a NULL pointer dereference when accessing epfile->ep in\nffs_func_eps_enable() after successful usb_ep_enable().\n\nThe ffs->epfiles pointer is set to NULL in both ffs_data_clear() and\nffs_data_close() functions, and its modification is protected by the\nspinlock ffs->eps_lock. And the whole ffs_func_eps_enable() function\nis also protected by ffs->eps_lock.\n\nThus, add NULL pointer handling for ffs->epfiles in the\nffs_func_eps_enable() function to fix issues",
  "datePublished": "Dec 8, 2025, 12:46:41 AM",
  "dateUpdated": "Jan 2, 2026, 3:33:33 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/b00d2572c16e8e59e979960d3383c2ae9cebd195",
    "https://git.kernel.org/stable/c/1c0dbd240be3f87cac321b14e17979b7e9cb6a8f",
    "https://git.kernel.org/stable/c/9ec40fba7357df2d36f4c2e2f3b9b1a4fba0a272",
    "https://git.kernel.org/stable/c/c53e90563bc148e4e0ad09fe130ba2246d426ea6",
    "https://git.kernel.org/stable/c/fc1141a530dfc91f0ee19b7f422a2d24829584bc",
    "https://git.kernel.org/stable/c/d62b808d5c68a931ad0849a00a5e3be3dd7e0019",
    "https://git.kernel.org/stable/c/30880e9df27332403dd638a82c27921134b3630b",
    "https://git.kernel.org/stable/c/cfd6f1a7b42f62523c96d9703ef32b0dbc495ba4",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-40315"
  ],
  "aliases": [
    "CVE-2025-40315"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "047eb03a-fab2-3d35-973a-01f093506a2c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17.8"
    },
    {
      "id": "09b2a60a-3b4e-31dc-9ec1-481b73882c21",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.117"
    },
    {
      "id": "0d247296-001e-3d77-a471-3f676c66cde6",
      "product": {
        "name": "Linux"
      },
      "product_version": "72a8aee863af099d4434314c4536d6c9a61dcf3c <9ec40fba7357df2d36f4c2e2f3b9b1a4fba0a272"
    },
    {
      "id": "0e6fb41f-dafe-3146-9315-41fd7fb64a7f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c53e90563bc148e4e0ad09fe130ba2246d426ea6"
    },
    {
      "id": "12a2b149-eef0-3693-b780-03dfebd86318",
      "product": {
        "name": "Linux"
      },
      "product_version": "c9fc422c9a43e3d58d246334a71f3390401781dc <b00d2572c16e8e59e979960d3383c2ae9cebd195"
    },
    {
      "id": "3b3e7303-0305-330f-8179-9f0e511d1d72",
      "product": {
        "name": "Linux"
      },
      "product_version": "ebe2b1add1055b903e2acd86b290a85297edc0b3 <c53e90563bc148e4e0ad09fe130ba2246d426ea6"
    },
    {
      "id": "3c22ddb3-acf1-35ed-9553-ea31489e2e14",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "407ba68f-adf1-3cd9-b1eb-0a6f1693e16d",
      "product": {
        "name": "Linux"
      },
      "product_version": "cfe5f6fd335d882bcc829a1c8a7d462a455c626e"
    },
    {
      "id": "4884da87-c13d-3044-b73c-8bddcc5218dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "ebe2b1add1055b903e2acd86b290a85297edc0b3 <cfd6f1a7b42f62523c96d9703ef32b0dbc495ba4"
    },
    {
      "id": "4953b953-963d-3603-8e05-6197f7041c13",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18"
    },
    {
      "id": "6e1a549b-3962-3b81-82ba-f5da2627eba8",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    },
    {
      "id": "7e69ea21-6856-3958-ad39-da5368554390",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fc1141a530dfc91f0ee19b7f422a2d24829584bc"
    },
    {
      "id": "7f420ee1-8294-3d63-902d-1a3ce0135ded",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.58"
    },
    {
      "id": "8caf83c4-e1ec-39b8-8aa4-bb9a3b535381",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9ec40fba7357df2d36f4c2e2f3b9b1a4fba0a272"
    },
    {
      "id": "92f59c61-0dba-361b-95e3-6c0c090f5dec",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1c0dbd240be3f87cac321b14e17979b7e9cb6a8f"
    },
    {
      "id": "9427dc11-da3b-3baa-8842-6ffe7f55a113",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.197"
    },
    {
      "id": "9cf99ab6-034f-316c-a60c-dc8d2ce3cf92",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d62b808d5c68a931ad0849a00a5e3be3dd7e0019"
    },
    {
      "id": "a6ea3531-b82e-355d-aeef-e44ddbd59f09",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.247"
    },
    {
      "id": "c0bb73ef-b658-3286-b511-36346056d806",
      "product": {
        "name": "Linux"
      },
      "product_version": "3e078b18753669615301d946297bafd69294ad2c"
    },
    {
      "id": "c112aaa3-6431-3d4a-808e-1570140699d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b00d2572c16e8e59e979960d3383c2ae9cebd195"
    },
    {
      "id": "d32eafc9-acce-31ae-8a16-c81be8d4693e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.302"
    },
    {
      "id": "d3bf43fd-af2b-33ce-ac83-7fa881b3ad42",
      "product": {
        "name": "Linux"
      },
      "product_version": "ebe2b1add1055b903e2acd86b290a85297edc0b3 <30880e9df27332403dd638a82c27921134b3630b"
    },
    {
      "id": "da67d558-7663-3896-96ab-d94f99c76ac6",
      "product": {
        "name": "Linux"
      },
      "product_version": "ebe2b1add1055b903e2acd86b290a85297edc0b3 <d62b808d5c68a931ad0849a00a5e3be3dd7e0019"
    },
    {
      "id": "de8eb904-cec9-35d0-a222-62e59ea7699f",
      "product": {
        "name": "Linux"
      },
      "product_version": "32048f4be071f9a6966744243f1786f45bb22dc2"
    },
    {
      "id": "e2ffab22-60dd-3097-87f3-1eed8be7c94c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <30880e9df27332403dd638a82c27921134b3630b"
    },
    {
      "id": "e53b707f-4f31-3adc-bcda-29ce56d24172",
      "product": {
        "name": "Linux"
      },
      "product_version": "ebe2b1add1055b903e2acd86b290a85297edc0b3 <fc1141a530dfc91f0ee19b7f422a2d24829584bc"
    },
    {
      "id": "f4b7fdb9-de54-32a5-97b5-20fe472f9515",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cfd6f1a7b42f62523c96d9703ef32b0dbc495ba4"
    },
    {
      "id": "f86755c1-e95e-3064-a678-d7c69a4c7d2b",
      "product": {
        "name": "Linux"
      },
      "product_version": "0042178a69eb77a979e36a50dcce9794a3140ef8 <1c0dbd240be3f87cac321b14e17979b7e9cb6a8f"
    },
    {
      "id": "fd4f9cae-02a3-38a2-ab58-fde943959def",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.159"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "9617ed1b-8d7e-3499-84c2-e5c2af26614f",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-40315"
}