{
  "id": "EUVD-2022-54667",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nperf/x86/intel/lbr: Fix unchecked MSR access error on HSW\n\nThe fuzzer triggers the below trace.\n\n[ 7763.384369] unchecked MSR access error: WRMSR to 0x689\n(tried to write 0x1fffffff8101349e) at rIP: 0xffffffff810704a4\n(native_write_msr+0x4/0x20)\n[ 7763.397420] Call Trace:\n[ 7763.399881]  <TASK>\n[ 7763.401994]  intel_pmu_lbr_restore+0x9a/0x1f0\n[ 7763.406363]  intel_pmu_lbr_sched_task+0x91/0x1c0\n[ 7763.410992]  __perf_event_task_sched_in+0x1cd/0x240\n\nOn a machine with the LBR format LBR_FORMAT_EIP_FLAGS2, when the TSX is\ndisabled, a TSX quirk is required to access LBR from registers.\nThe lbr_from_signext_quirk_needed() is introduced to determine whether\nthe TSX quirk should be applied. However, the\nlbr_from_signext_quirk_needed() is invoked before the\nintel_pmu_lbr_init(), which parses the LBR format information. Without\nthe correct LBR format information, the TSX quirk never be applied.\n\nMove the lbr_from_signext_quirk_needed() into the intel_pmu_lbr_init().\nChecking x86_pmu.lbr_has_tsx in the lbr_from_signext_quirk_needed() is\nnot required anymore.\n\nBoth LBR_FORMAT_EIP_FLAGS2 and LBR_FORMAT_INFO have LBR_TSX flag, but\nonly the LBR_FORMAT_EIP_FLAGS2 requirs the quirk. Update the comments\naccordingly.",
  "datePublished": "Feb 26, 2025, 2:23:11 AM",
  "dateUpdated": "Feb 26, 2025, 2:23:11 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/625bcd0685a1612225df83468c83412fc0edb3d7",
    "https://git.kernel.org/stable/c/b0380e13502adf7dd8be4c47d622c3522aae6c63"
  ],
  "aliases": [
    "CVE-2022-49565"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "48c6b941-5efa-3316-8505-3072871a83bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ac7fd8159a842b3aa51f0b46a351fa3eeb8fbf3 <625bcd0685a1612225df83468c83412fc0edb3d7"
    },
    {
      "id": "60911f7b-fe92-32a1-b246-d05b2f3ffa92",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "b97f36fe-7d63-3b1f-af38-1455a77e7f45",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ac7fd8159a842b3aa51f0b46a351fa3eeb8fbf3 <b0380e13502adf7dd8be4c47d622c3522aae6c63"
    },
    {
      "id": "c2484792-227d-3725-a2e3-1dbf08d67166",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.15"
    },
    {
      "id": "ce380faf-02f2-389f-a89e-d1704dd5ce80",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "e057c4d4-bf5a-3189-994a-cbbd9118b443",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "e9deea12-c5c9-34a2-bf5a-0ec220edfd96",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49565"
}
