{
  "id": "EUVD-2025-35074",
  "enisaUuid": "22ac27b0-2aef-3a3c-853f-8e7538967824",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/hugetlb: fix folio is still mapped when deleted\n\nMigration may be raced with fallocating hole.  remove_inode_single_folio\nwill unmap the folio if the folio is still mapped.  However, it's called\nwithout folio lock.  If the folio is migrated and the mapped pte has been\nconverted to migration entry, folio_mapped() returns false, and won't\nunmap it.  Due to extra refcount held by remove_inode_single_folio,\nmigration fails, restores migration entry to normal pte, and the folio is\nmapped again.  As a result, we triggered BUG in filemap_unaccount_folio.\n\nThe log is as follows:\n BUG: Bad page cache in process hugetlb  pfn:156c00\n page: refcount:515 mapcount:0 mapping:0000000099fef6e1 index:0x0 pfn:0x156c00\n head: order:9 mapcount:1 entire_mapcount:1 nr_pages_mapped:0 pincount:0\n aops:hugetlbfs_aops ino:dcc dentry name(?):\"my_hugepage_file\"\n flags: 0x17ffffc00000c1(locked|waiters|head|node=0|zone=2|lastcpupid=0x1fffff)\n page_type: f4(hugetlb)\n page dumped because: still mapped when deleted\n CPU: 1 UID: 0 PID: 395 Comm: hugetlb Not tainted 6.17.0-rc5-00044-g7aac71907bde-dirty #484 NONE\n Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 0.0.0 02/06/2015\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0x4f/0x70\n  filemap_unaccount_folio+0xc4/0x1c0\n  __filemap_remove_folio+0x38/0x1c0\n  filemap_remove_folio+0x41/0xd0\n  remove_inode_hugepages+0x142/0x250\n  hugetlbfs_fallocate+0x471/0x5a0\n  vfs_fallocate+0x149/0x380\n\nHold folio lock before checking if the folio is mapped to avold race with\nmigration.",
  "datePublished": "Oct 20, 2025, 6:30:33 PM",
  "dateUpdated": "Oct 20, 2025, 6:30:33 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/bc1c9ce8aeff45318332035dbef9713fb9e982d7",
    "https://git.kernel.org/stable/c/91f548e920fbf8be3f285bfa3fa045ae017e836d",
    "https://git.kernel.org/stable/c/3e851448078f5b01f6264915df3cfef75e323a12",
    "https://git.kernel.org/stable/c/c1dc0524ab2cc3982d4e0d2bfac71a0cd4d65c39",
    "https://git.kernel.org/stable/c/c9c2a51f91aea70e89b496cac360cd795a2b3c26",
    "https://git.kernel.org/stable/c/910d7749346c4b0acdc6e4adfdc4a9984281a206",
    "https://git.kernel.org/stable/c/21ee79ce938127f88fe07e409c1817f477dbe7ea",
    "https://git.kernel.org/stable/c/7b7387650dcf2881fd8bb55bcf3c8bd6c9542dd7",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-40006"
  ],
  "aliases": [
    "CVE-2025-40006"
  ],
  "assigner": "Linux",
  "epss": 0.0,
  "enisaIdProduct": [
    {
      "id": "002febc6-042b-3f0a-99b2-4ba004695208",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.50"
    },
    {
      "id": "13773268-9829-3a45-913a-e0bb3e27e3b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <bc1c9ce8aeff45318332035dbef9713fb9e982d7"
    },
    {
      "id": "2bd5f568-ed37-3290-add2-81d2ccc5ec53",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <91f548e920fbf8be3f285bfa3fa045ae017e836d"
    },
    {
      "id": "4722b9cd-9454-3df9-88c8-d002bddd1e08",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <21ee79ce938127f88fe07e409c1817f477dbe7ea"
    },
    {
      "id": "4763041a-a10d-3c0f-a469-e126cb232d30",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <910d7749346c4b0acdc6e4adfdc4a9984281a206"
    },
    {
      "id": "4a35a94b-d136-3e6c-b2ea-1b00bcb385ca",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <3e851448078f5b01f6264915df3cfef75e323a12"
    },
    {
      "id": "4d3f49df-ab54-3a92-8865-f9188611da89",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <7b7387650dcf2881fd8bb55bcf3c8bd6c9542dd7"
    },
    {
      "id": "66383ab7-12b6-3bf4-b2b0-d595229da45b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.155"
    },
    {
      "id": "72060655-21b0-3f6a-9cf2-8f2bf8e1302a",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.5"
    },
    {
      "id": "7367e7cb-785e-3de9-b13b-474a52652f4d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.10"
    },
    {
      "id": "802c921f-067e-37e7-ae73-107b1553de28",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "bf905257-e12a-312b-9fc7-46c71211e840",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.300"
    },
    {
      "id": "c0adee13-f9ed-342f-98fb-ce3a98716ae7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.245"
    },
    {
      "id": "cbed0ba4-fb04-3af7-b196-35e455cd429f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "d506a965-37cd-316e-9f90-ab3386a94300",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <c9c2a51f91aea70e89b496cac360cd795a2b3c26"
    },
    {
      "id": "d511196d-d507-317c-b8bc-fc69bc109c4d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.109"
    },
    {
      "id": "da51af11-ffe5-3fe3-8b56-e63acce0d981",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.194"
    },
    {
      "id": "ff4148da-7b3e-3c08-a914-6ead3733d026",
      "product": {
        "name": "Linux"
      },
      "product_version": "4aae8d1c051ea00b456da6811bc36d1f69de5445 <c1dc0524ab2cc3982d4e0d2bfac71a0cd4d65c39"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "a0baa211-5689-344a-ac3c-62e02b9de1f5",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-40006"
}