{
  "id": "EUVD-2021-8632",
  "enisaUuid": "55c3cc9d-e6ad-37d2-8221-5fa10fc6f704",
  "description": "OneDev is an all-in-one devops platform. In OneDev before version 4.0.3, there is an issue involving YAML parsing which can lead to post-auth remote code execution. In order to parse and process YAML files, OneDev uses SnakeYaml which by default (when not using `SafeConstructor`) allows the instantiation of arbitrary classes. We can leverage that to run arbitrary code by instantiating classes such as `javax.script.ScriptEngineManager` and using `URLClassLoader` to load the script engine provider, resulting in the instantiation of a user controlled class. For a full example refer to the referenced GHSA. This issue was addressed in 4.0.3 by only allowing certain known classes to be deserialized",
  "datePublished": "Jan 15, 2021, 8:10:31 PM",
  "dateUpdated": "Aug 3, 2024, 6:09:15 PM",
  "baseScore": 9.6,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N",
  "references": [
    "https://github.com/theonedev/onedev/security/advisories/GHSA-7xhq-m2q9-6hpm",
    "https://github.com/theonedev/onedev/commit/d6fc4212b1ac1e9bbe3ce444e95f9af1e3ab8b66"
  ],
  "aliases": [
    "CVE-2021-21249",
    "GSD-2021-21249"
  ],
  "assigner": "GitHub_M",
  "epss": 1.33,
  "enisaIdProduct": [
    {
      "id": "1494f0db-6c7e-360d-bf1e-888a20335ce9",
      "product": {
        "name": "onedev"
      },
      "product_version": "< 4.0.3"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "0d7849ce-d217-38b9-a3c5-8e37e032f0bb",
      "vendor": {
        "name": "theonedev"
      }
    }
  ]
}