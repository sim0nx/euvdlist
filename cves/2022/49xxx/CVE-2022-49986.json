{
  "id": "EUVD-2022-55265",
  "enisaUuid": "44853303-b8c3-3f7e-a1a9-5da06f0efb74",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: storvsc: Remove WQ_MEM_RECLAIM from storvsc_error_wq\n\nstorvsc_error_wq workqueue should not be marked as WQ_MEM_RECLAIM as it\ndoesn't need to make forward progress under memory pressure.  Marking this\nworkqueue as WQ_MEM_RECLAIM may cause deadlock while flushing a\nnon-WQ_MEM_RECLAIM workqueue.  In the current state it causes the following\nwarning:\n\n[   14.506347] ------------[ cut here ]------------\n[   14.506354] workqueue: WQ_MEM_RECLAIM storvsc_error_wq_0:storvsc_remove_lun is flushing !WQ_MEM_RECLAIM events_freezable_power_:disk_events_workfn\n[   14.506360] WARNING: CPU: 0 PID: 8 at <-snip->kernel/workqueue.c:2623 check_flush_dependency+0xb5/0x130\n[   14.506390] CPU: 0 PID: 8 Comm: kworker/u4:0 Not tainted 5.4.0-1086-azure #91~18.04.1-Ubuntu\n[   14.506391] Hardware name: Microsoft Corporation Virtual Machine/Virtual Machine, BIOS Hyper-V UEFI Release v4.1 05/09/2022\n[   14.506393] Workqueue: storvsc_error_wq_0 storvsc_remove_lun\n[   14.506395] RIP: 0010:check_flush_dependency+0xb5/0x130\n\t\t<-snip->\n[   14.506408] Call Trace:\n[   14.506412]  __flush_work+0xf1/0x1c0\n[   14.506414]  __cancel_work_timer+0x12f/0x1b0\n[   14.506417]  ? kernfs_put+0xf0/0x190\n[   14.506418]  cancel_delayed_work_sync+0x13/0x20\n[   14.506420]  disk_block_events+0x78/0x80\n[   14.506421]  del_gendisk+0x3d/0x2f0\n[   14.506423]  sr_remove+0x28/0x70\n[   14.506427]  device_release_driver_internal+0xef/0x1c0\n[   14.506428]  device_release_driver+0x12/0x20\n[   14.506429]  bus_remove_device+0xe1/0x150\n[   14.506431]  device_del+0x167/0x380\n[   14.506432]  __scsi_remove_device+0x11d/0x150\n[   14.506433]  scsi_remove_device+0x26/0x40\n[   14.506434]  storvsc_remove_lun+0x40/0x60\n[   14.506436]  process_one_work+0x209/0x400\n[   14.506437]  worker_thread+0x34/0x400\n[   14.506439]  kthread+0x121/0x140\n[   14.506440]  ? process_one_work+0x400/0x400\n[   14.506441]  ? kthread_park+0x90/0x90\n[   14.506443]  ret_from_fork+0x35/0x40\n[   14.506445] ---[ end trace 2d9633159fdc6ee7 ]---",
  "datePublished": "Jun 18, 2025, 11:00:47 AM",
  "dateUpdated": "Jun 18, 2025, 11:00:47 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/b692c238ddfa61f00d97c4c1f021425d132ba96f",
    "https://git.kernel.org/stable/c/b4c928ace9a123629eeb14ec5d7ee8f73e5ac668",
    "https://git.kernel.org/stable/c/46fcb0fc884db78a0384be92cc2a51927e6581b8",
    "https://git.kernel.org/stable/c/cd2a50d0a097a42b6de283377da98ff757505120",
    "https://git.kernel.org/stable/c/828f57ac75eaccd6607ee4d1468d34e983e32c68",
    "https://git.kernel.org/stable/c/d957e7ffb2c72410bcc1a514153a46719255a5da"
  ],
  "aliases": [
    "CVE-2022-49986"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "092f9c81-2dc8-3a05-9de4-af01a9c12e54",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.257"
    },
    {
      "id": "19c3cfbb-86c6-337c-9aab-5ab7fe0b628b",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <d957e7ffb2c72410bcc1a514153a46719255a5da"
    },
    {
      "id": "34e4e56e-a37c-32f2-97f1-f505aff08c73",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <46fcb0fc884db78a0384be92cc2a51927e6581b8"
    },
    {
      "id": "3fd28b82-b73a-3cd7-88dd-3fa5ca25b07e",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <b4c928ace9a123629eeb14ec5d7ee8f73e5ac668"
    },
    {
      "id": "405c3996-9167-3213-b35f-267efe0a0d88",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.212"
    },
    {
      "id": "566fca73-d5c5-36be-82a2-d99eb93b6304",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "69a748cd-84ef-3d99-80d7-8b52c4ea0422",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.15"
    },
    {
      "id": "7d4efca4-fcdf-3990-b48b-4b2948c68d57",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <828f57ac75eaccd6607ee4d1468d34e983e32c68"
    },
    {
      "id": "8b820ac8-257c-3acb-9010-0b4ebc0c1873",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.6"
    },
    {
      "id": "97dfaf8c-fc91-32b7-a3f5-e76355e744d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <cd2a50d0a097a42b6de283377da98ff757505120"
    },
    {
      "id": "9a1ae18e-b62b-3752-90a7-4215ebf508cb",
      "product": {
        "name": "Linux"
      },
      "product_version": "436ad941335386c5fc7faa915a8fbdfe8c908084 <b692c238ddfa61f00d97c4c1f021425d132ba96f"
    },
    {
      "id": "a0d34eac-6bc3-329a-92e1-d3a36d72ba0b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "a16f0c92-af59-333f-813c-84eac6014b22",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.64"
    },
    {
      "id": "aa555ffe-2b4a-3a12-90b9-75690bde735f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.140"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "db4dd51c-08e6-3eb7-9db7-dfe0a0ad028e",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49986"
}