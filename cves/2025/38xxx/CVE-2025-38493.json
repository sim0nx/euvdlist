{
  "id": "EUVD-2025-22870",
  "enisaUuid": "949093e2-fd2b-3167-af56-4fd6b93a3fc9",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing/osnoise: Fix crash in timerlat_dump_stack()\n\nWe have observed kernel panics when using timerlat with stack saving,\nwith the following dmesg output:\n\nmemcpy: detected buffer overflow: 88 byte write of buffer size 0\nWARNING: CPU: 2 PID: 8153 at lib/string_helpers.c:1032 __fortify_report+0x55/0xa0\nCPU: 2 UID: 0 PID: 8153 Comm: timerlatu/2 Kdump: loaded Not tainted 6.15.3-200.fc42.x86_64 #1 PREEMPT(lazy)\nCall Trace:\n <TASK>\n ? trace_buffer_lock_reserve+0x2a/0x60\n __fortify_panic+0xd/0xf\n __timerlat_dump_stack.cold+0xd/0xd\n timerlat_dump_stack.part.0+0x47/0x80\n timerlat_fd_read+0x36d/0x390\n vfs_read+0xe2/0x390\n ? syscall_exit_to_user_mode+0x1d5/0x210\n ksys_read+0x73/0xe0\n do_syscall_64+0x7b/0x160\n ? exc_page_fault+0x7e/0x1a0\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\n__timerlat_dump_stack() constructs the ftrace stack entry like this:\n\nstruct stack_entry *entry;\n...\nmemcpy(&entry->caller, fstack->calls, size);\nentry->size = fstack->nr_entries;\n\nSince commit e7186af7fb26 (\"tracing: Add back FORTIFY_SOURCE logic to\nkernel_stack event structure\"), struct stack_entry marks its caller\nfield with __counted_by(size). At the time of the memcpy, entry->size\ncontains garbage from the ringbuffer, which under some circumstances is\nzero, triggering a kernel panic by buffer overflow.\n\nPopulate the size field before the memcpy so that the out-of-bounds\ncheck knows the correct size. This is analogous to\n__ftrace_trace_stack().",
  "datePublished": "Jul 28, 2025, 11:22:02 AM",
  "dateUpdated": "Jul 28, 2025, 11:22:02 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/823d798900481875ba6c68217af028c5ffd2976b",
    "https://git.kernel.org/stable/c/7bb9ea515cda027c9e717e27fefcf34f092e7c41",
    "https://git.kernel.org/stable/c/fbf90f5aa7ac7cddc69148a71d58f12c8709ce2b",
    "https://git.kernel.org/stable/c/85a3bce695b361d85fc528e6fbb33e4c8089c806"
  ],
  "aliases": [
    "CVE-2025-38493"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1935f098-864b-3250-9d86-2818196c76b2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.40"
    },
    {
      "id": "3fcd7acd-6f1a-3c87-9a63-dc9f30f6ac7c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "536f1d6e-51f2-3d30-85e8-21d66a306d6b",
      "product": {
        "name": "Linux"
      },
      "product_version": "e7186af7fb2609584a8bfb3da3c6ae09da5a5224 <fbf90f5aa7ac7cddc69148a71d58f12c8709ce2b"
    },
    {
      "id": "674fd8e7-09d2-3d6b-9226-48b323b2550d",
      "product": {
        "name": "Linux"
      },
      "product_version": "e7186af7fb2609584a8bfb3da3c6ae09da5a5224 <7bb9ea515cda027c9e717e27fefcf34f092e7c41"
    },
    {
      "id": "6ba0bd0a-b435-3df4-82a5-f1b43191e9c6",
      "product": {
        "name": "Linux"
      },
      "product_version": "e7186af7fb2609584a8bfb3da3c6ae09da5a5224 <823d798900481875ba6c68217af028c5ffd2976b"
    },
    {
      "id": "71f9b9e1-da4b-3622-8aa4-1fd659b19a0c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "78c7764f-4145-3881-8e3c-62576a5c0a9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.100"
    },
    {
      "id": "7e0c3729-bf85-32a3-8ab2-9de3b018ad14",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.8"
    },
    {
      "id": "a2feb8ba-b842-3562-a3b5-d90e98da8d2b",
      "product": {
        "name": "Linux"
      },
      "product_version": "e7186af7fb2609584a8bfb3da3c6ae09da5a5224 <85a3bce695b361d85fc528e6fbb33e4c8089c806"
    },
    {
      "id": "def021f8-6e2b-3a60-8c32-64eaa3e9fc81",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.6"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "ab7b1119-193e-3d1c-80ba-d7d28d439e37",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38493"
}