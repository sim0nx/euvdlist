{
  "id": "EUVD-2022-55137",
  "enisaUuid": "f641e140-956d-3303-9cc1-272b9ec3dfeb",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc: Fix virt_addr_valid() for 64-bit Book3E & 32-bit\n\nmpe: On 64-bit Book3E vmalloc space starts at 0x8000000000000000.\n\nBecause of the way __pa() works we have:\n  __pa(0x8000000000000000) == 0, and therefore\n  virt_to_pfn(0x8000000000000000) == 0, and therefore\n  virt_addr_valid(0x8000000000000000) == true\n\nWhich is wrong, virt_addr_valid() should be false for vmalloc space.\nIn fact all vmalloc addresses that alias with a valid PFN will return\ntrue from virt_addr_valid(). That can cause bugs with hardened usercopy\nas described below by Kefeng Wang:\n\n  When running ethtool eth0 on 64-bit Book3E, a BUG occurred:\n\n    usercopy: Kernel memory exposure attempt detected from SLUB object not in SLUB page?! (offset 0, size 1048)!\n    kernel BUG at mm/usercopy.c:99\n    ...\n    usercopy_abort+0x64/0xa0 (unreliable)\n    __check_heap_object+0x168/0x190\n    __check_object_size+0x1a0/0x200\n    dev_ethtool+0x2494/0x2b20\n    dev_ioctl+0x5d0/0x770\n    sock_do_ioctl+0xf0/0x1d0\n    sock_ioctl+0x3ec/0x5a0\n    __se_sys_ioctl+0xf0/0x160\n    system_call_exception+0xfc/0x1f0\n    system_call_common+0xf8/0x200\n\n  The code shows below,\n\n    data = vzalloc(array_size(gstrings.len, ETH_GSTRING_LEN));\n    copy_to_user(useraddr, data, gstrings.len * ETH_GSTRING_LEN))\n\n  The data is alloced by vmalloc(), virt_addr_valid(ptr) will return true\n  on 64-bit Book3E, which leads to the panic.\n\n  As commit 4dd7554a6456 (\"powerpc/64: Add VIRTUAL_BUG_ON checks for __va\n  and __pa addresses\") does, make sure the virt addr above PAGE_OFFSET in\n  the virt_addr_valid() for 64-bit, also add upper limit check to make\n  sure the virt is below high_memory.\n\n  Meanwhile, for 32-bit PAGE_OFFSET is the virtual address of the start\n  of lowmem, high_memory is the upper low virtual address, the check is\n  suitable for 32-bit, this will fix the issue mentioned in commit\n  602946ec2f90 (\"powerpc: Set max_mapnr correctly\") too.\n\nOn 32-bit there is a similar problem with high memory, that was fixed in\ncommit 602946ec2f90 (\"powerpc: Set max_mapnr correctly\"), but that\ncommit breaks highmem and needs to be reverted.\n\nWe can't easily fix __pa(), we have code that relies on its current\nbehaviour. So for now add extra checks to virt_addr_valid().\n\nFor 64-bit Book3S the extra checks are not necessary, the combination of\nvirt_to_pfn() and pfn_valid() should yield the correct result, but they\nare harmless.\n\n[mpe: Add additional change log detail]",
  "datePublished": "Oct 14, 2025, 9:30:25 PM",
  "dateUpdated": "Oct 14, 2025, 9:30:25 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/deab81144d5a043f42804207fb76cfbd8a806978",
    "https://git.kernel.org/stable/c/d36febbcd537fcc50284e8b89609632d0146529f",
    "https://git.kernel.org/stable/c/fddb88bd266f4513abab7c36bca98935c9148a98",
    "https://git.kernel.org/stable/c/a3727c25eacd7e437c4f560957fa3a376fe93e6b",
    "https://git.kernel.org/stable/c/cbc065efcba000ad8f615f506ebe61b6d3c5145b",
    "https://git.kernel.org/stable/c/ffa0b64e3be58519ae472ea29a1a1ad681e32f48",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49067"
  ],
  "aliases": [
    "CVE-2022-49067"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "02c526c7-7e2f-36ac-a27a-a021c5ace2ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.111"
    },
    {
      "id": "28713c56-42d4-3910-9232-2057684ddd0b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ffa0b64e3be58519ae472ea29a1a1ad681e32f48"
    },
    {
      "id": "2df5632c-0000-3219-8355-22545a625a1c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d36febbcd537fcc50284e8b89609632d0146529f"
    },
    {
      "id": "6b4b1cd8-a91b-39f9-9300-9ee1467c8b98",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.20"
    },
    {
      "id": "76f27d17-7782-3992-90f3-d7236db61165",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    },
    {
      "id": "83205f6f-b336-3073-9a0b-556517126925",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cbc065efcba000ad8f615f506ebe61b6d3c5145b"
    },
    {
      "id": "9a22bbe5-d6ab-30bc-a62c-6fb3519eef00",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.34"
    },
    {
      "id": "b1361363-6231-33c2-819b-d30729726590",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <deab81144d5a043f42804207fb76cfbd8a806978"
    },
    {
      "id": "b744178f-cbf2-3b32-b160-91c97235f7bb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.190"
    },
    {
      "id": "dc274642-45b9-31f8-a0d8-feb4200eb3ec",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.3"
    },
    {
      "id": "e7f3f972-ccfc-394f-b3dd-69bcd3def123",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a3727c25eacd7e437c4f560957fa3a376fe93e6b"
    },
    {
      "id": "ecc09402-88f8-3dfd-9506-32f6f8a7139b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fddb88bd266f4513abab7c36bca98935c9148a98"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "d39c4edf-68e4-3dda-88e1-05c634b79c25",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}