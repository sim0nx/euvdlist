{
  "id": "EUVD-2024-53196",
  "enisaUuid": "1dc12d41-126e-3104-ad2c-053bb7969752",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: don't query the device logical block size multiple times\n\nDevices block sizes may change. One of these cases is a loop device by\nusing ioctl LOOP_SET_BLOCK_SIZE.\n\nWhile this may cause other issues like IO being rejected, in the case of\nhfsplus, it will allocate a block by using that size and potentially write\nout-of-bounds when hfsplus_read_wrapper calls hfsplus_submit_bio and the\nlatter function reads a different io_size.\n\nUsing a new min_io_size initally set to sb_min_blocksize works for the\npurposes of the original fix, since it will be set to the max between\nHFSPLUS_SECTOR_SIZE and the first seen logical block size. We still use the\nmax between HFSPLUS_SECTOR_SIZE and min_io_size in case the latter is not\ninitialized.\n\nTested by mounting an hfsplus filesystem with loop block sizes 512, 1024\nand 4096.\n\nThe produced KASAN report before the fix looks like this:\n\n[  419.944641] ==================================================================\n[  419.945655] BUG: KASAN: slab-use-after-free in hfsplus_read_wrapper+0x659/0xa0a\n[  419.946703] Read of size 2 at addr ffff88800721fc00 by task repro/10678\n[  419.947612]\n[  419.947846] CPU: 0 UID: 0 PID: 10678 Comm: repro Not tainted 6.12.0-rc5-00008-gdf56e0f2f3ca #84\n[  419.949007] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.15.0-1 04/01/2014\n[  419.950035] Call Trace:\n[  419.950384]  <TASK>\n[  419.950676]  dump_stack_lvl+0x57/0x78\n[  419.951212]  ? hfsplus_read_wrapper+0x659/0xa0a\n[  419.951830]  print_report+0x14c/0x49e\n[  419.952361]  ? __virt_addr_valid+0x267/0x278\n[  419.952979]  ? kmem_cache_debug_flags+0xc/0x1d\n[  419.953561]  ? hfsplus_read_wrapper+0x659/0xa0a\n[  419.954231]  kasan_report+0x89/0xb0\n[  419.954748]  ? hfsplus_read_wrapper+0x659/0xa0a\n[  419.955367]  hfsplus_read_wrapper+0x659/0xa0a\n[  419.955948]  ? __pfx_hfsplus_read_wrapper+0x10/0x10\n[  419.956618]  ? do_raw_spin_unlock+0x59/0x1a9\n[  419.957214]  ? _raw_spin_unlock+0x1a/0x2e\n[  419.957772]  hfsplus_fill_super+0x348/0x1590\n[  419.958355]  ? hlock_class+0x4c/0x109\n[  419.958867]  ? __pfx_hfsplus_fill_super+0x10/0x10\n[  419.959499]  ? __pfx_string+0x10/0x10\n[  419.960006]  ? lock_acquire+0x3e2/0x454\n[  419.960532]  ? bdev_name.constprop.0+0xce/0x243\n[  419.961129]  ? __pfx_bdev_name.constprop.0+0x10/0x10\n[  419.961799]  ? pointer+0x3f0/0x62f\n[  419.962277]  ? __pfx_pointer+0x10/0x10\n[  419.962761]  ? vsnprintf+0x6c4/0xfba\n[  419.963178]  ? __pfx_vsnprintf+0x10/0x10\n[  419.963621]  ? setup_bdev_super+0x376/0x3b3\n[  419.964029]  ? snprintf+0x9d/0xd2\n[  419.964344]  ? __pfx_snprintf+0x10/0x10\n[  419.964675]  ? lock_acquired+0x45c/0x5e9\n[  419.965016]  ? set_blocksize+0x139/0x1c1\n[  419.965381]  ? sb_set_blocksize+0x6d/0xae\n[  419.965742]  ? __pfx_hfsplus_fill_super+0x10/0x10\n[  419.966179]  mount_bdev+0x12f/0x1bf\n[  419.966512]  ? __pfx_mount_bdev+0x10/0x10\n[  419.966886]  ? vfs_parse_fs_string+0xce/0x111\n[  419.967293]  ? __pfx_vfs_parse_fs_string+0x10/0x10\n[  419.967702]  ? __pfx_hfsplus_mount+0x10/0x10\n[  419.968073]  legacy_get_tree+0x104/0x178\n[  419.968414]  vfs_get_tree+0x86/0x296\n[  419.968751]  path_mount+0xba3/0xd0b\n[  419.969157]  ? __pfx_path_mount+0x10/0x10\n[  419.969594]  ? kmem_cache_free+0x1e2/0x260\n[  419.970311]  do_mount+0x99/0xe0\n[  419.970630]  ? __pfx_do_mount+0x10/0x10\n[  419.971008]  __do_sys_mount+0x199/0x1c9\n[  419.971397]  do_syscall_64+0xd0/0x135\n[  419.971761]  entry_SYSCALL_64_after_hwframe+0x76/0x7e\n[  419.972233] RIP: 0033:0x7c3cb812972e\n[  419.972564] Code: 48 8b 0d f5 46 0d 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa 49 89 ca b8 a5 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d c2 46 0d 00 f7 d8 64 89 01 48\n[  419.974371] RSP: 002b:00007ffe30632548 EFLAGS: 00000286 ORIG_RAX: 00000000000000a5\n[  419.975048] RAX: ffffffffffffffda RBX: 00007ffe306328d8 RCX: 00007c3cb812972e\n[  419.975701] RDX: 0000000020000000 RSI: 0000000020000c80 RDI:\n---truncated---",
  "datePublished": "Dec 27, 2024, 2:11:29 PM",
  "dateUpdated": "Oct 1, 2025, 8:07:16 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://git.kernel.org/stable/c/baccb5e12577b7a9eff54ffba301fdaa0f3ee5a8",
    "https://git.kernel.org/stable/c/f57725bcc5816425e25218fdf5fb6923bc578cdf",
    "https://git.kernel.org/stable/c/e8a2b1c1c2ea85e9a5a2d0c5a5a7e7c639feb866",
    "https://git.kernel.org/stable/c/06cbfbb13ac88f4154c2eb4bc4176f9d10139847",
    "https://git.kernel.org/stable/c/3d7bda75e1a6239db053c73acde17ca146317824",
    "https://git.kernel.org/stable/c/21900e8478126ff6afe3b66679f676e74d1f8830",
    "https://git.kernel.org/stable/c/2667c9b7b76efcbc7adbfea249892f20c313b0da",
    "https://git.kernel.org/stable/c/bfeecda050aa9376f642d5b2a71c4112cc6c8216",
    "https://git.kernel.org/stable/c/1c82587cb57687de3f18ab4b98a8850c789bedcf",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-56548"
  ],
  "aliases": [
    "CVE-2024-56548"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "10516347-fd4b-3410-8f5f-15b03a439dd2",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <f57725bcc5816425e25218fdf5fb6923bc578cdf"
    },
    {
      "id": "147f65f7-daca-3a87-ac1b-d9c4fcefec46",
      "product": {
        "name": "Linux"
      },
      "product_version": "c53c89aba3ebdfc3e9acdb18bb5ee9d2f8a328d0"
    },
    {
      "id": "1be4c8fa-1251-3ac4-87ab-e6bc0d608f05",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "1c510484-2cd2-3c31-8863-95173d9a4192",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.325"
    },
    {
      "id": "1e59fb6c-01ab-3551-a099-2d4f1ccbc9b6",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.1"
    },
    {
      "id": "26a1b3fe-7e8f-3016-9103-a619d6f81092",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <1c82587cb57687de3f18ab4b98a8850c789bedcf"
    },
    {
      "id": "286e18d2-2bdb-3db9-9aef-4ff97dea48f8",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <06cbfbb13ac88f4154c2eb4bc4176f9d10139847"
    },
    {
      "id": "34e6d866-0670-31c0-b4af-bf384c25e7f9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.120"
    },
    {
      "id": "3e572023-9aca-31fd-a5e7-5c7fac26905b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <bfeecda050aa9376f642d5b2a71c4112cc6c8216"
    },
    {
      "id": "64d53438-81eb-37a4-ae3d-37a674c81983",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.64"
    },
    {
      "id": "7d5cd40a-d29e-30fc-9c4a-3ce904287176",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <3d7bda75e1a6239db053c73acde17ca146317824"
    },
    {
      "id": "90be31b1-6701-3365-8adf-2a9734e42142",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.287"
    },
    {
      "id": "94e5dff5-ace5-313b-92fa-8e0387931bd8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.231"
    },
    {
      "id": "9cdb2e34-3059-3e1a-a4d7-fb7bbf749119",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "ab428c43-c8d4-3597-85d5-1c6349b08ba5",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <21900e8478126ff6afe3b66679f676e74d1f8830"
    },
    {
      "id": "ac35c878-188c-340a-9bb6-d5932e3bb0e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.11"
    },
    {
      "id": "acd77001-77af-3245-be19-4792fb99186b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <baccb5e12577b7a9eff54ffba301fdaa0f3ee5a8"
    },
    {
      "id": "b35bb9ff-b60c-310f-95d7-2a1ad9513e04",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.2"
    },
    {
      "id": "d9f1dfbe-e8ba-3aa2-9675-5f6a1dc68c66",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.174"
    },
    {
      "id": "da15b3ac-dc36-3538-8fb1-bff829686ae8",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <2667c9b7b76efcbc7adbfea249892f20c313b0da"
    },
    {
      "id": "f7262ca5-7760-3fa1-be66-2188883ce9ce",
      "product": {
        "name": "Linux"
      },
      "product_version": "6596528e391ad978a6a120142cba97a1d7324cb6 <e8a2b1c1c2ea85e9a5a2d0c5a5a7e7c639feb866"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "abaec5b3-527a-36d1-a8e1-c79f51e8c752",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}