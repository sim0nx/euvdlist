{
  "id": "EUVD-2022-54823",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock: Fix potential deadlock in blk_ia_range_sysfs_show()\n\nWhen being read, a sysfs attribute is already protected against removal\nwith the kobject node active reference counter. As a result, in\nblk_ia_range_sysfs_show(), there is no need to take the queue sysfs\nlock when reading the value of a range attribute. Using the queue sysfs\nlock in this function creates a potential deadlock situation with the\ndisk removal, something that a lockdep signals with a splat when the\ndevice is removed:\n\n[  760.703551]  Possible unsafe locking scenario:\n[  760.703551]\n[  760.703554]        CPU0                    CPU1\n[  760.703556]        ----                    ----\n[  760.703558]   lock(&q->sysfs_lock);\n[  760.703565]                                lock(kn->active#385);\n[  760.703573]                                lock(&q->sysfs_lock);\n[  760.703579]   lock(kn->active#385);\n[  760.703587]\n[  760.703587]  *** DEADLOCK ***\n\nSolve this by removing the mutex_lock()/mutex_unlock() calls from\nblk_ia_range_sysfs_show().",
  "datePublished": "Feb 26, 2025, 2:12:31 AM",
  "dateUpdated": "Feb 26, 2025, 2:12:31 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/dc107c805cde709866b59867ef72b9390199205e",
    "https://git.kernel.org/stable/c/717b078bc745ba9a262abebed9806a17e8bbb77b",
    "https://git.kernel.org/stable/c/41e46b3c2aa24f755b2ae9ec4ce931ba5f0d8532"
  ],
  "aliases": [
    "CVE-2022-49406"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "300f169d-624c-397a-a316-eb01b3531bda",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "372e26ad-c7e9-3b9c-9356-1c72555dfbbf",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.16"
    },
    {
      "id": "37fa00ae-05e8-3777-8410-e8c675bbaafc",
      "product": {
        "name": "Linux"
      },
      "product_version": "a2247f19ee1c5ad75ef095cdfb909a3244b88aa8 <41e46b3c2aa24f755b2ae9ec4ce931ba5f0d8532"
    },
    {
      "id": "90c33666-a449-30aa-94c6-0a84216c1f59",
      "product": {
        "name": "Linux"
      },
      "product_version": "a2247f19ee1c5ad75ef095cdfb909a3244b88aa8 <dc107c805cde709866b59867ef72b9390199205e"
    },
    {
      "id": "97e8881b-3393-3d0c-8bd4-55fdd2b8db29",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.14"
    },
    {
      "id": "9cf44955-2298-3dae-85e3-79420474b2d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "e883f364-a345-36b0-9db3-f64bf56a45ca",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.3"
    },
    {
      "id": "ea2cd6dd-362c-3bc8-96ed-0b9dc3a0c6a0",
      "product": {
        "name": "Linux"
      },
      "product_version": "a2247f19ee1c5ad75ef095cdfb909a3244b88aa8 <717b078bc745ba9a262abebed9806a17e8bbb77b"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "54a5d504-bc9e-3cbe-a9c5-7bc3a383a1ef",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49406"
}
