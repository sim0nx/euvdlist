{
  "id": "EUVD-2022-54905",
  "enisaUuid": "116131bd-f1cb-3e65-b2f8-9ea98d540c6a",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntracing: Fix sleeping function called from invalid context on RT kernel\n\nWhen setting bootparams=\"trace_event=initcall:initcall_start tp_printk=1\" in the\ncmdline, the output_printk() was called, and the spin_lock_irqsave() was called in the\natomic and irq disable interrupt context suitation. On the PREEMPT_RT kernel,\nthese locks are replaced with sleepable rt-spinlock, so the stack calltrace will\nbe triggered.\nFix it by raw_spin_lock_irqsave when PREEMPT_RT and \"trace_event=initcall:initcall_start\ntp_printk=1\" enabled.\n\n BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:46\n in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 1, name: swapper/0\n preempt_count: 2, expected: 0\n RCU nest depth: 0, expected: 0\n Preemption disabled at:\n [<ffffffff8992303e>] try_to_wake_up+0x7e/0xba0\n CPU: 0 PID: 1 Comm: swapper/0 Not tainted 5.17.1-rt17+ #19 34c5812404187a875f32bee7977f7367f9679ea7\n Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-2 04/01/2014\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0x60/0x8c\n  dump_stack+0x10/0x12\n  __might_resched.cold+0x11d/0x155\n  rt_spin_lock+0x40/0x70\n  trace_event_buffer_commit+0x2fa/0x4c0\n  ? map_vsyscall+0x93/0x93\n  trace_event_raw_event_initcall_start+0xbe/0x110\n  ? perf_trace_initcall_finish+0x210/0x210\n  ? probe_sched_wakeup+0x34/0x40\n  ? ttwu_do_wakeup+0xda/0x310\n  ? trace_hardirqs_on+0x35/0x170\n  ? map_vsyscall+0x93/0x93\n  do_one_initcall+0x217/0x3c0\n  ? trace_event_raw_event_initcall_level+0x170/0x170\n  ? push_cpu_stop+0x400/0x400\n  ? cblist_init_generic+0x241/0x290\n  kernel_init_freeable+0x1ac/0x347\n  ? _raw_spin_unlock_irq+0x65/0x80\n  ? rest_init+0xf0/0xf0\n  kernel_init+0x1e/0x150\n  ret_from_fork+0x22/0x30\n  </TASK>",
  "datePublished": "Feb 26, 2025, 2:10:46 AM",
  "dateUpdated": "Oct 1, 2025, 7:46:56 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/be1f323fb9d9b14a505ca22d742d321769454de1",
    "https://git.kernel.org/stable/c/40f9fde06b25884baa0c4bd138b909a9b67218b4",
    "https://git.kernel.org/stable/c/48c6ee7d6c614f09b2c8553a95eefef6ecf196e0",
    "https://git.kernel.org/stable/c/1788e6dbb61286215442b1af99e51405a6206762",
    "https://git.kernel.org/stable/c/9b534640a2c6a8d88168febc82ec6d161184f2ec",
    "https://git.kernel.org/stable/c/43bfc4dccc416c964b53cbdc430e814f8b6f770b",
    "https://git.kernel.org/stable/c/9abf3db8bdb63ab545034148ef2118f4d088ca59",
    "https://git.kernel.org/stable/c/12025abdc8539ed9d5014e2d647a3fd1bd3de5cd"
  ],
  "aliases": [
    "CVE-2022-49322"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1456fe9b-003b-3ce7-bf1c-17204e89dfcd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.47"
    },
    {
      "id": "240490a8-ee43-38f8-966f-7be58a3df368",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.247"
    },
    {
      "id": "25025b42-cccf-3054-b56e-37b54ccf99d1",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9b534640a2c6a8d88168febc82ec6d161184f2ec"
    },
    {
      "id": "31491136-181d-37c6-a7a3-65d5ebf25f45",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <12025abdc8539ed9d5014e2d647a3fd1bd3de5cd"
    },
    {
      "id": "47330e70-996d-3cbf-be19-dd681a0554b3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9abf3db8bdb63ab545034148ef2118f4d088ca59"
    },
    {
      "id": "4c8b6323-1bc2-360c-abe9-474c170e2100",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <40f9fde06b25884baa0c4bd138b909a9b67218b4"
    },
    {
      "id": "7e5adfba-5254-3c8a-ba70-c345e19ac3ce",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "879e9121-f88e-3866-bfc9-078c14e16c66",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.122"
    },
    {
      "id": "983c33bb-b62a-3d9c-8948-22e9bfd3e812",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.4"
    },
    {
      "id": "996d7489-30ee-3219-abb1-3e7d428b7c9a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <43bfc4dccc416c964b53cbdc430e814f8b6f770b"
    },
    {
      "id": "d5535497-ed81-36e4-a5c6-4fa0c9c24144",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <be1f323fb9d9b14a505ca22d742d321769454de1"
    },
    {
      "id": "d71166f7-2a21-3bf8-bc7b-c8b6181c7ca6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.198"
    },
    {
      "id": "ee574791-2e3c-3669-86de-f9e23d9bedcf",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <48c6ee7d6c614f09b2c8553a95eefef6ecf196e0"
    },
    {
      "id": "ef504075-ac1a-3c96-b8d5-c94872e48635",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1788e6dbb61286215442b1af99e51405a6206762"
    },
    {
      "id": "f532583c-22a3-3d8a-9422-7ba1a3e1ecb2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.283"
    },
    {
      "id": "f9f01dd1-fd63-31ef-992b-e0eb3c6f8f06",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.15"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "52416aa2-ea97-3a87-a554-f097cecf0732",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}