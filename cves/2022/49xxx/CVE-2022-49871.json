{
  "id": "EUVD-2025-12909",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: tun: Fix memory leaks of napi_get_frags\n\nkmemleak reports after running test_progs:\n\nunreferenced object 0xffff8881b1672dc0 (size 232):\n  comm \"test_progs\", pid 394388, jiffies 4354712116 (age 841.975s)\n  hex dump (first 32 bytes):\n    e0 84 d7 a8 81 88 ff ff 80 2c 67 b1 81 88 ff ff  .........,g.....\n    00 40 c5 9b 81 88 ff ff 00 00 00 00 00 00 00 00  .@..............\n  backtrace:\n    [<00000000c8f01748>] napi_skb_cache_get+0xd4/0x150\n    [<0000000041c7fc09>] __napi_build_skb+0x15/0x50\n    [<00000000431c7079>] __napi_alloc_skb+0x26e/0x540\n    [<000000003ecfa30e>] napi_get_frags+0x59/0x140\n    [<0000000099b2199e>] tun_get_user+0x183d/0x3bb0 [tun]\n    [<000000008a5adef0>] tun_chr_write_iter+0xc0/0x1b1 [tun]\n    [<0000000049993ff4>] do_iter_readv_writev+0x19f/0x320\n    [<000000008f338ea2>] do_iter_write+0x135/0x630\n    [<000000008a3377a4>] vfs_writev+0x12e/0x440\n    [<00000000a6b5639a>] do_writev+0x104/0x280\n    [<00000000ccf065d8>] do_syscall_64+0x3b/0x90\n    [<00000000d776e329>] entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nThe issue occurs in the following scenarios:\ntun_get_user()\n  napi_gro_frags()\n    napi_frags_finish()\n      case GRO_NORMAL:\n        gro_normal_one()\n          list_add_tail(&skb->list, &napi->rx_list);\n          <-- While napi->rx_count < READ_ONCE(gro_normal_batch),\n          <-- gro_normal_list() is not called, napi->rx_list is not empty\n  <-- not ask to complete the gro work, will cause memory leaks in\n  <-- following tun_napi_del()\n...\ntun_napi_del()\n  netif_napi_del()\n    __netif_napi_del()\n    <-- &napi->rx_list is not empty, which caused memory leaks\n\nTo fix, add napi_complete() after napi_gro_frags().",
  "datePublished": "May 1, 2025, 2:10:21 PM",
  "dateUpdated": "May 4, 2025, 8:47:23 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49871",
    "https://git.kernel.org/stable/c/1118b2049d77ca0b505775fc1a8d1909cf19a7ec",
    "https://git.kernel.org/stable/c/223ef6a94e52331a6a7ef31e59921e0e82d2d40a",
    "https://git.kernel.org/stable/c/3401f964028ac941425b9b2c8ff8a022539ef44a",
    "https://git.kernel.org/stable/c/8b12a020b20a78f62bedc50f26db3bf4fadf8cb9",
    "https://git.kernel.org/stable/c/a4f73f6adc53fd7a3f9771cbc89a03ef39b0b755",
    "https://git.kernel.org/stable/c/d7569302a7a52a9305d2fb054df908ff985553bb"
  ],
  "aliases": [
    "CVE-2022-49871",
    "GHSA-jfw6-w783-5hhm"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "28a4ea5e-cff7-3b18-a5cd-589f085310c0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.225"
    },
    {
      "id": "37491e9d-82a5-3ecc-ab77-681382730c34",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.155"
    },
    {
      "id": "46545a39-7705-386f-92ae-e7b34a5f9a66",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "55683735-670e-3b0c-b88d-625d2c824d95",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <3401f964028ac941425b9b2c8ff8a022539ef44a"
    },
    {
      "id": "729c0e09-8d6a-3309-be71-a4ba23129058",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.267"
    },
    {
      "id": "7849e302-1a2c-3203-8095-7c2430b19dbc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.79"
    },
    {
      "id": "7959e20a-056b-3ca9-84a8-e9766eeedbd9",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <1118b2049d77ca0b505775fc1a8d1909cf19a7ec"
    },
    {
      "id": "80805ac2-e466-3824-baa3-21fc631dbc91",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "8d500c63-afb8-3233-84cf-0439a58587e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.9"
    },
    {
      "id": "a93b3c04-53b7-388a-8040-f9982985853b",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.15"
    },
    {
      "id": "ac771917-fedb-3a62-bb5f-2b831896a925",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <a4f73f6adc53fd7a3f9771cbc89a03ef39b0b755"
    },
    {
      "id": "d38d3867-913f-3ad0-b229-9433cc66858f",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <223ef6a94e52331a6a7ef31e59921e0e82d2d40a"
    },
    {
      "id": "d40f4871-d78f-3c07-ab7e-cf2951261de8",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <8b12a020b20a78f62bedc50f26db3bf4fadf8cb9"
    },
    {
      "id": "f8176d88-bc41-3031-841b-39ef1185cb3e",
      "product": {
        "name": "Linux"
      },
      "product_version": "90e33d45940793def6f773b2d528e9f3c84ffdc7 <d7569302a7a52a9305d2fb054df908ff985553bb"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "30c8f35f-8496-3da3-aac7-86f373cf0a2e",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49871"
}
