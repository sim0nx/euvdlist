{
  "id": "EUVD-2022-55189",
  "enisaUuid": "3e9fa41d-b7a1-3118-94ad-abf43e29e643",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbinder: fix UAF of ref->proc caused by race condition\n\nA transaction of type BINDER_TYPE_WEAK_HANDLE can fail to increment the\nreference for a node. In this case, the target proc normally releases\nthe failed reference upon close as expected. However, if the target is\ndying in parallel the call will race with binder_deferred_release(), so\nthe target could have released all of its references by now leaving the\ncleanup of the new failed reference unhandled.\n\nThe transaction then ends and the target proc gets released making the\nref->proc now a dangling pointer. Later on, ref->node is closed and we\nattempt to take spin_lock(&ref->proc->inner_lock), which leads to the\nuse-after-free bug reported below. Let's fix this by cleaning up the\nfailed reference on the spot instead of relying on the target to do so.\n\n  ==================================================================\n  BUG: KASAN: use-after-free in _raw_spin_lock+0xa8/0x150\n  Write of size 4 at addr ffff5ca207094238 by task kworker/1:0/590\n\n  CPU: 1 PID: 590 Comm: kworker/1:0 Not tainted 5.19.0-rc8 #10\n  Hardware name: linux,dummy-virt (DT)\n  Workqueue: events binder_deferred_func\n  Call trace:\n   dump_backtrace.part.0+0x1d0/0x1e0\n   show_stack+0x18/0x70\n   dump_stack_lvl+0x68/0x84\n   print_report+0x2e4/0x61c\n   kasan_report+0xa4/0x110\n   kasan_check_range+0xfc/0x1a4\n   __kasan_check_write+0x3c/0x50\n   _raw_spin_lock+0xa8/0x150\n   binder_deferred_func+0x5e0/0x9b0\n   process_one_work+0x38c/0x5f0\n   worker_thread+0x9c/0x694\n   kthread+0x188/0x190\n   ret_from_fork+0x10/0x20",
  "datePublished": "Jun 18, 2025, 10:54:40 AM",
  "dateUpdated": "Jun 18, 2025, 10:54:40 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/229f47603dd306bc0eb1a831439adb8e48bb0eae",
    "https://git.kernel.org/stable/c/06e5b43ca4dab06a92bf4c2f33766e6fb11b880a",
    "https://git.kernel.org/stable/c/30d0901b307f27d36b2655fb3048cf31ee0e89c0",
    "https://git.kernel.org/stable/c/9629f2dfdb1dad294b468038ff8e161e94d0b609",
    "https://git.kernel.org/stable/c/c2a4b5dc8fa71af73bab704d0cac42ac39767ed6",
    "https://git.kernel.org/stable/c/603a47f2ae56bf68288784d3c0a8c5b8e0a827ed",
    "https://git.kernel.org/stable/c/a0e44c64b6061dda7e00b7c458e4523e2331b739"
  ],
  "aliases": [
    "CVE-2022-49939"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "0108d974-a26e-35b4-b34e-60282440cb27",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.66"
    },
    {
      "id": "0fdcf88b-dd99-3b2f-8698-ced9f50098f3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.258"
    },
    {
      "id": "33bb336d-0202-3b87-b92b-4fcd740b4990",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.142"
    },
    {
      "id": "3b836d24-0020-395f-bd63-16b2855708c7",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <06e5b43ca4dab06a92bf4c2f33766e6fb11b880a"
    },
    {
      "id": "3f987fd1-3fdb-3b2d-85d5-fa85c8a48ef9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "44fd5038-4f60-3d96-955c-8eaeabdc4b41",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <603a47f2ae56bf68288784d3c0a8c5b8e0a827ed"
    },
    {
      "id": "4ca32bd4-8678-3ede-a1a4-b640cb20fd87",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <229f47603dd306bc0eb1a831439adb8e48bb0eae"
    },
    {
      "id": "4fe8bc01-d3db-3bad-81f8-c7475bf689cb",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c2a4b5dc8fa71af73bab704d0cac42ac39767ed6"
    },
    {
      "id": "529b9afd-2c69-37f1-9c5c-a52e7f2dcd84",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a0e44c64b6061dda7e00b7c458e4523e2331b739"
    },
    {
      "id": "7f207e93-3b94-3c11-87a9-514ae6fc9743",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.293"
    },
    {
      "id": "cae72559-2d1f-3f41-a734-9d3fb065d9b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.213"
    },
    {
      "id": "ddbd148d-9aef-34d5-b96e-57880227e1c6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.8"
    },
    {
      "id": "e2bae971-fd79-3ebe-9c3f-51ca3edfd245",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9629f2dfdb1dad294b468038ff8e161e94d0b609"
    },
    {
      "id": "f344c8d2-8312-3133-b682-ad7f456c063b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <30d0901b307f27d36b2655fb3048cf31ee0e89c0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "9259d53b-18ef-3461-b26f-6e79141669b3",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}