{
  "id": "EUVD-2024-53805",
  "enisaUuid": "30fff774-cb7c-326d-ab0b-2ec881e086b2",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_packet: fix vlan_get_tci() vs MSG_PEEK\n\nBlamed commit forgot MSG_PEEK case, allowing a crash [1] as found\nby syzbot.\n\nRework vlan_get_tci() to not touch skb at all,\nso that it can be used from many cpus on the same skb.\n\nAdd a const qualifier to skb argument.\n\n[1]\nskbuff: skb_under_panic: text:ffffffff8a8da482 len:32 put:14 head:ffff88807a1d5800 data:ffff88807a1d5810 tail:0x14 end:0x140 dev:<NULL>\n------------[ cut here ]------------\n kernel BUG at net/core/skbuff.c:206 !\nOops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI\nCPU: 0 UID: 0 PID: 5880 Comm: syz-executor172 Not tainted 6.13.0-rc3-syzkaller-00762-g9268abe611b0 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\n RIP: 0010:skb_panic net/core/skbuff.c:206 [inline]\n RIP: 0010:skb_under_panic+0x14b/0x150 net/core/skbuff.c:216\nCode: 0b 8d 48 c7 c6 9e 6c 26 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 3a 5a 79 f7 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3\nRSP: 0018:ffffc90003baf5b8 EFLAGS: 00010286\nRAX: 0000000000000087 RBX: dffffc0000000000 RCX: 8565c1eec37aa000\nRDX: 0000000000000000 RSI: 0000000080000000 RDI: 0000000000000000\nRBP: ffff88802616fb50 R08: ffffffff817f0a4c R09: 1ffff92000775e50\nR10: dffffc0000000000 R11: fffff52000775e51 R12: 0000000000000140\nR13: ffff88807a1d5800 R14: ffff88807a1d5810 R15: 0000000000000014\nFS:  00007fa03261f6c0(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007ffd65753000 CR3: 0000000031720000 CR4: 00000000003526f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n  skb_push+0xe5/0x100 net/core/skbuff.c:2636\n  vlan_get_tci+0x272/0x550 net/packet/af_packet.c:565\n  packet_recvmsg+0x13c9/0x1ef0 net/packet/af_packet.c:3616\n  sock_recvmsg_nosec net/socket.c:1044 [inline]\n  sock_recvmsg+0x22f/0x280 net/socket.c:1066\n  ____sys_recvmsg+0x1c6/0x480 net/socket.c:2814\n  ___sys_recvmsg net/socket.c:2856 [inline]\n  do_recvmmsg+0x426/0xab0 net/socket.c:2951\n  __sys_recvmmsg net/socket.c:3025 [inline]\n  __do_sys_recvmmsg net/socket.c:3048 [inline]\n  __se_sys_recvmmsg net/socket.c:3041 [inline]\n  __x64_sys_recvmmsg+0x199/0x250 net/socket.c:3041\n  do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n  do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83",
  "datePublished": "Jan 15, 2025, 1:05:58 PM",
  "dateUpdated": "Oct 1, 2025, 7:57:18 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/66ffb0cf2125dcf9e902eede4a43653a24fd9cb2",
    "https://git.kernel.org/stable/c/fa57f07ba0622c8692f40e1300adca59277b0044",
    "https://git.kernel.org/stable/c/65c67049e9ed481f6b52264b39618b8c6dfb1d3e",
    "https://git.kernel.org/stable/c/d91b4a9baa018a001d5c884e236c0cfd31f9f4a1",
    "https://git.kernel.org/stable/c/7aa78d0d8546d8ce5a764add3f55d72e707c18f1",
    "https://git.kernel.org/stable/c/b65292a548d847099a4fe0fff53122a06e798e25",
    "https://git.kernel.org/stable/c/77ee7a6d16b6ec07b5c3ae2b6b60a24c1afbed09",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-57902"
  ],
  "aliases": [
    "CVE-2024-57902"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "18e0d233-8e43-3423-94ca-e6090fcd30be",
      "product": {
        "name": "Linux"
      },
      "product_version": "79eecf631c14e7f4057186570ac20e2cfac3802e <77ee7a6d16b6ec07b5c3ae2b6b60a24c1afbed09"
    },
    {
      "id": "19385688-0554-3e62-93d3-56a8379c9e87",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.289"
    },
    {
      "id": "1d257ce4-f100-3e90-9be3-0ae0de80ea74",
      "product": {
        "name": "Linux"
      },
      "product_version": "c77064e76c768fb101ea5ff92dc771142fc9d8fd <66ffb0cf2125dcf9e902eede4a43653a24fd9cb2"
    },
    {
      "id": "2f346e2d-f4b3-3f10-a31f-45ea9047c34f",
      "product": {
        "name": "Linux"
      },
      "product_version": "66f23a7b5174b5d3e7111fd2d0d5a4f3faaa12e5"
    },
    {
      "id": "3fe5d117-f37b-36e2-8250-2989b3663a90",
      "product": {
        "name": "Linux"
      },
      "product_version": "3dfd84aa72fa7329ed4a257c8f40e0c9aff4dc8f"
    },
    {
      "id": "421a8cad-5ace-37c1-88ba-442ddd19e0c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.233"
    },
    {
      "id": "473442e8-20c3-3ddb-9015-0f20d4db3ec7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "6ea0945b-81e7-353c-aa61-3044dad345a2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "844649a0-5ef9-3012-ba90-1f904263a7af",
      "product": {
        "name": "Linux"
      },
      "product_version": "d0a1f9aa70f0d8a05b6320e8a3f3b83adab8dac3 <65c67049e9ed481f6b52264b39618b8c6dfb1d3e"
    },
    {
      "id": "87c0ab1e-b9df-3167-a824-19048ada2312",
      "product": {
        "name": "Linux"
      },
      "product_version": "79eecf631c14e7f4057186570ac20e2cfac3802e <b65292a548d847099a4fe0fff53122a06e798e25"
    },
    {
      "id": "8b7f7b33-09a4-3efb-ba97-10fe0fa9bc52",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.9"
    },
    {
      "id": "8f2af521-979a-3405-8834-28a6e2954cb0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.70"
    },
    {
      "id": "9cf327d3-6089-38f1-8583-31303e71e647",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.176"
    },
    {
      "id": "a5c88aa1-a8ca-3408-b8f0-3128f8e4cf9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "5a041d25b67042cbe06a0fb292ee22fd1147e65c <7aa78d0d8546d8ce5a764add3f55d72e707c18f1"
    },
    {
      "id": "cfae0aa9-e881-3626-8fe1-4719fdbc91f9",
      "product": {
        "name": "Linux"
      },
      "product_version": "83e2dfadcb6258fe3111c8a8ec9cf34465e55e64 <fa57f07ba0622c8692f40e1300adca59277b0044"
    },
    {
      "id": "d4f0fd83-5260-37fb-b062-1bcffdd6c2cf",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.11"
    },
    {
      "id": "e42e54d0-5585-3627-9960-ac79c3c516d3",
      "product": {
        "name": "Linux"
      },
      "product_version": "5839f59ff1dd4e35b9e767927931a039484839e1 <d91b4a9baa018a001d5c884e236c0cfd31f9f4a1"
    },
    {
      "id": "fc21d30e-8307-38e1-ad61-11b3f8a5ce0e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.124"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "f4becd43-2175-3141-8417-c4863ca057a2",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}