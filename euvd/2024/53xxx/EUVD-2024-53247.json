{
  "id": "EUVD-2024-53247",
  "enisaUuid": "d1100fbb-ccfd-3da9-9c4f-319005169cb9",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: ath10k: avoid NULL pointer error during sdio remove\n\nWhen running 'rmmod ath10k', ath10k_sdio_remove() will free sdio\nworkqueue by destroy_workqueue(). But if CONFIG_INIT_ON_FREE_DEFAULT_ON\nis set to yes, kernel panic will happen:\nCall trace:\n destroy_workqueue+0x1c/0x258\n ath10k_sdio_remove+0x84/0x94\n sdio_bus_remove+0x50/0x16c\n device_release_driver_internal+0x188/0x25c\n device_driver_detach+0x20/0x2c\n\nThis is because during 'rmmod ath10k', ath10k_sdio_remove() will call\nath10k_core_destroy() before destroy_workqueue(). wiphy_dev_release()\nwill finally be called in ath10k_core_destroy(). This function will free\nstruct cfg80211_registered_device *rdev and all its members, including\nwiphy, dev and the pointer of sdio workqueue. Then the pointer of sdio\nworkqueue will be set to NULL due to CONFIG_INIT_ON_FREE_DEFAULT_ON.\n\nAfter device release, destroy_workqueue() will use NULL pointer then the\nkernel panic happen.\n\nCall trace:\nath10k_sdio_remove\n  ->ath10k_core_unregister\n    \u2026\u2026\n    ->ath10k_core_stop\n      ->ath10k_hif_stop\n        ->ath10k_sdio_irq_disable\n    ->ath10k_hif_power_down\n      ->del_timer_sync(&ar_sdio->sleep_timer)\n  ->ath10k_core_destroy\n    ->ath10k_mac_destroy\n      ->ieee80211_free_hw\n        ->wiphy_free\n    \u2026\u2026\n          ->wiphy_dev_release\n  ->destroy_workqueue\n\nNeed to call destroy_workqueue() before ath10k_core_destroy(), free\nthe work queue buffer first and then free pointer of work queue by\nath10k_core_destroy(). This order matches the error path order in\nath10k_sdio_probe().\n\nNo work will be queued on sdio workqueue between it is destroyed and\nath10k_core_destroy() is called. Based on the call_stack above, the\nreason is:\nOnly ath10k_sdio_sleep_timer_handler(), ath10k_sdio_hif_tx_sg() and\nath10k_sdio_irq_disable() will queue work on sdio workqueue.\nSleep timer will be deleted before ath10k_core_destroy() in\nath10k_hif_power_down().\nath10k_sdio_irq_disable() only be called in ath10k_hif_stop().\nath10k_core_unregister() will call ath10k_hif_power_down() to stop hif\nbus, so ath10k_sdio_hif_tx_sg() won't be called anymore.\n\nTested-on: QCA6174 hw3.2 SDIO WLAN.RMH.4.4.1-00189",
  "datePublished": "Dec 27, 2024, 2:51:05 PM",
  "dateUpdated": "Sep 15, 2025, 12:14:27 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/6e5dbd1c04abf2c19b2282915e6fa48b6ccc6921",
    "https://git.kernel.org/stable/c/b35de9e01fc79c7baac666fb2dcb4ba7698a1d97",
    "https://git.kernel.org/stable/c/543c0924d446b21f35701ca084d7feca09511220",
    "https://git.kernel.org/stable/c/95c38953cb1ecf40399a676a1f85dfe2b5780a9a",
    "https://git.kernel.org/stable/c/27d5d217ae7ffb99dd623375a17a7d3418d9c755",
    "https://git.kernel.org/stable/c/27fda36eedad9e4ec795dc481f307901d1885112"
  ],
  "aliases": [
    "CVE-2024-56599"
  ],
  "assigner": "Linux",
  "epss": 0.07,
  "enisaIdProduct": [
    {
      "id": "02af3efe-0726-3e6f-bebe-650b4f0448b2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.237"
    },
    {
      "id": "1a1ce381-1a9b-326c-8030-b7c032dde391",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.70"
    },
    {
      "id": "1ede0a9f-7910-3076-93fd-e38e8a863fae",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b35de9e01fc79c7baac666fb2dcb4ba7698a1d97"
    },
    {
      "id": "36d9d4f5-d6b0-3b7a-955d-a185a5393281",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <27d5d217ae7ffb99dd623375a17a7d3418d9c755"
    },
    {
      "id": "3a2bb0a1-9a74-3001-aedf-400e1481857e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6e5dbd1c04abf2c19b2282915e6fa48b6ccc6921"
    },
    {
      "id": "50714cc0-fd17-3b50-8642-bdaeea57c4ab",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <95c38953cb1ecf40399a676a1f85dfe2b5780a9a"
    },
    {
      "id": "5174e030-e4ad-322d-af2a-a45de843db52",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <27fda36eedad9e4ec795dc481f307901d1885112"
    },
    {
      "id": "7767d002-d14b-3418-a6ea-561f7fd46dc5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "8b04e356-e0b6-3010-8a5a-f53b3c9b1f12",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.11"
    },
    {
      "id": "961939c9-f2df-3c07-8fb3-3e6cd31b4b77",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "9941b585-3041-3072-b84e-ee7053692c22",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <95c38953cb1ecf40399a676a1f85dfe2b5780a9a"
    },
    {
      "id": "a829e47a-c0dd-3116-8798-4c68bc9f6031",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <b35de9e01fc79c7baac666fb2dcb4ba7698a1d97"
    },
    {
      "id": "b2a299a2-c887-3734-bce0-714453493edd",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <6e5dbd1c04abf2c19b2282915e6fa48b6ccc6921"
    },
    {
      "id": "c28f483a-b720-3235-9051-42b9602d4443",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.5"
    },
    {
      "id": "e9942b3a-a570-37d6-bb32-58d1b1a6ce65",
      "product": {
        "name": "Linux"
      },
      "product_version": "5e3dd157d7e70f0e3cea3f2573ed69fb156a19d5 <543c0924d446b21f35701ca084d7feca09511220"
    },
    {
      "id": "f0b2b14b-0e6d-3b1e-9a86-f0e47e36013a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.127"
    },
    {
      "id": "f5cb9c78-c7be-3af6-bb5b-6de0634b7c97",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <543c0924d446b21f35701ca084d7feca09511220"
    },
    {
      "id": "fe662f55-07b8-3ce2-b6c1-53030f43d2e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.181"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "ec9783d4-5f4e-319d-9830-213b24d23151",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}