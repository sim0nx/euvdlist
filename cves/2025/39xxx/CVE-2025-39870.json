{
  "id": "EUVD-2025-30864",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndmaengine: idxd: Fix double free in idxd_setup_wqs()\n\nThe clean up in idxd_setup_wqs() has had a couple bugs because the error\nhandling is a bit subtle.  It's simpler to just re-write it in a cleaner\nway.  The issues here are:\n\n1) If \"idxd->max_wqs\" is <= 0 then we call put_device(conf_dev) when\n   \"conf_dev\" hasn't been initialized.\n2) If kzalloc_node() fails then again \"conf_dev\" is invalid.  It's\n   either uninitialized or it points to the \"conf_dev\" from the\n   previous iteration so it leads to a double free.\n\nIt's better to free partial loop iterations within the loop and then\nthe unwinding at the end can handle whole loop iterations.  I also\nrenamed the labels to describe what the goto does and not where the goto\nwas located.",
  "datePublished": "Sep 23, 2025, 6:00:44 AM",
  "dateUpdated": "Sep 29, 2025, 6:01:26 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39870",
    "https://git.kernel.org/stable/c/25e6146c2812487a88f619d5ff6efbdcd5b2bc31",
    "https://git.kernel.org/stable/c/39aaa337449e71a41d4813be0226a722827ba606",
    "https://git.kernel.org/stable/c/9f0e225635475b2285b966271d5e82cba74295b1",
    "https://git.kernel.org/stable/c/df82c7901513fd0fc738052a8e6a330d92cc8ec9",
    "https://git.kernel.org/stable/c/ec5430d090d0b6ace8fefa290fc37e88930017d2"
  ],
  "aliases": [
    "CVE-2025-39870",
    "GHSA-c3f5-89cx-rxg5"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1b4bda23-d351-3943-b403-19e78f8991fb",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed2c66000aa64c0d2621864831f0d04c820a1441"
    },
    {
      "id": "30995c87-ca3d-3739-93b2-707da91911d4",
      "product": {
        "name": "Linux"
      },
      "product_version": "3fd2f4bc010cdfbc07dd21018dc65bd9370eb7a4 <39aaa337449e71a41d4813be0226a722827ba606"
    },
    {
      "id": "52c26310-cdba-3e06-877f-96bff3859d3c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.15"
    },
    {
      "id": "66cdc980-d636-31fa-875f-528931df781a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "6922f425-64a6-31a8-9a98-fbc2b14affd6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.107"
    },
    {
      "id": "73414252-c6bd-3749-8b21-9e964c5dfdc0",
      "product": {
        "name": "Linux"
      },
      "product_version": "d584acdf54f409cb7eae1359ae6c12aaabedeed8 <25e6146c2812487a88f619d5ff6efbdcd5b2bc31"
    },
    {
      "id": "938a5872-5deb-322a-b648-6c706c8d3140",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc6"
    },
    {
      "id": "a5f6a3d7-d199-3b3f-a241-0a9bf2d67e2f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.153"
    },
    {
      "id": "c83791d4-5634-3252-938d-9ed294813371",
      "product": {
        "name": "Linux"
      },
      "product_version": "5fcd392dae6d6aba7dc64ffdbb838ff191315da3 <ec5430d090d0b6ace8fefa290fc37e88930017d2"
    },
    {
      "id": "c8b99ef5-077b-344d-8217-b14f9c4aed98",
      "product": {
        "name": "Linux"
      },
      "product_version": "47846211998a9ffb0fcc08092eb95ac783d2b11a <df82c7901513fd0fc738052a8e6a330d92cc8ec9"
    },
    {
      "id": "ce4df518-5693-39ad-b7bb-0c4a6809d637",
      "product": {
        "name": "Linux"
      },
      "product_version": "3fd2f4bc010cdfbc07dd21018dc65bd9370eb7a4 <9f0e225635475b2285b966271d5e82cba74295b1"
    },
    {
      "id": "d12105e2-316a-3874-a928-ba15d337ed1f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.8"
    },
    {
      "id": "fa9d458e-8d59-30f2-9858-cb2b5e8ad7e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "fb404350-1697-310e-b8e2-12f72a8809a7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.48"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "30adef4e-3216-398b-b275-50d34cfa35b3",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39870"
}