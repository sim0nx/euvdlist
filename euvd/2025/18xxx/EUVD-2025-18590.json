{
  "id": "EUVD-2025-18590",
  "enisaUuid": "121ffe5d-70c8-3ddc-8fb7-7663936fa37d",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm: fix unconditional IO throttle caused by REQ_PREFLUSH\n\nWhen a bio with REQ_PREFLUSH is submitted to dm, __send_empty_flush()\ngenerates a flush_bio with REQ_OP_WRITE | REQ_PREFLUSH | REQ_SYNC,\nwhich causes the flush_bio to be throttled by wbt_wait().\n\nAn example from v5.4, similar problem also exists in upstream:\n\n    crash> bt 2091206\n    PID: 2091206  TASK: ffff2050df92a300  CPU: 109  COMMAND: \"kworker/u260:0\"\n     #0 [ffff800084a2f7f0] __switch_to at ffff80004008aeb8\n     #1 [ffff800084a2f820] __schedule at ffff800040bfa0c4\n     #2 [ffff800084a2f880] schedule at ffff800040bfa4b4\n     #3 [ffff800084a2f8a0] io_schedule at ffff800040bfa9c4\n     #4 [ffff800084a2f8c0] rq_qos_wait at ffff8000405925bc\n     #5 [ffff800084a2f940] wbt_wait at ffff8000405bb3a0\n     #6 [ffff800084a2f9a0] __rq_qos_throttle at ffff800040592254\n     #7 [ffff800084a2f9c0] blk_mq_make_request at ffff80004057cf38\n     #8 [ffff800084a2fa60] generic_make_request at ffff800040570138\n     #9 [ffff800084a2fae0] submit_bio at ffff8000405703b4\n    #10 [ffff800084a2fb50] xlog_write_iclog at ffff800001280834 [xfs]\n    #11 [ffff800084a2fbb0] xlog_sync at ffff800001280c3c [xfs]\n    #12 [ffff800084a2fbf0] xlog_state_release_iclog at ffff800001280df4 [xfs]\n    #13 [ffff800084a2fc10] xlog_write at ffff80000128203c [xfs]\n    #14 [ffff800084a2fcd0] xlog_cil_push at ffff8000012846dc [xfs]\n    #15 [ffff800084a2fda0] xlog_cil_push_work at ffff800001284a2c [xfs]\n    #16 [ffff800084a2fdb0] process_one_work at ffff800040111d08\n    #17 [ffff800084a2fe00] worker_thread at ffff8000401121cc\n    #18 [ffff800084a2fe70] kthread at ffff800040118de4\n\nAfter commit 2def2845cc33 (\"xfs: don't allow log IO to be throttled\"),\nthe metadata submitted by xlog_write_iclog() should not be throttled.\nBut due to the existence of the dm layer, throttling flush_bio indirectly\ncauses the metadata bio to be throttled.\n\nFix this by conditionally adding REQ_IDLE to flush_bio.bi_opf, which makes\nwbt_should_throttle() return false to avoid wbt_wait().",
  "datePublished": "Jun 18, 2025, 9:33:41 AM",
  "dateUpdated": "Jun 18, 2025, 9:33:41 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/95d08924335f3b6f4ea0b92ebfe4fe0731c502d9",
    "https://git.kernel.org/stable/c/52aa28f7b1708d76e315d78b5ed397932a1a97c3",
    "https://git.kernel.org/stable/c/b55a97d1bd4083729a60d19beffe85d4c96680de",
    "https://git.kernel.org/stable/c/2858cda9a8d95e6deee7e3b0a26adde696a9a4f5",
    "https://git.kernel.org/stable/c/88f7f56d16f568f19e1a695af34a7f4a6ce537a6"
  ],
  "aliases": [
    "CVE-2025-38063"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "381b0d0d-22fa-34a9-9af4-a0b0ecb2111e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.31"
    },
    {
      "id": "39c4537e-1eae-3b7f-8631-e8568eea2ee4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15"
    },
    {
      "id": "47be94d9-3741-3ee5-a9da-556c6e7c3963",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.141"
    },
    {
      "id": "494810b7-374e-3981-aa87-7378de807892",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2858cda9a8d95e6deee7e3b0a26adde696a9a4f5"
    },
    {
      "id": "56079129-9eaa-39e2-91ff-5f3ccf351595",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <52aa28f7b1708d76e315d78b5ed397932a1a97c3"
    },
    {
      "id": "8485b309-70bc-394f-87bd-2808bbc66732",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.93"
    },
    {
      "id": "8c46f233-c48c-36e7-80f0-56691f19862a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b55a97d1bd4083729a60d19beffe85d4c96680de"
    },
    {
      "id": "9bb764f4-5e43-3542-a277-6df58c1ba339",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.9"
    },
    {
      "id": "a8e67204-1897-32cf-b369-b654b54eaabc",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <95d08924335f3b6f4ea0b92ebfe4fe0731c502d9"
    },
    {
      "id": "beca69a8-1031-393c-becb-91cd0106372d",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <88f7f56d16f568f19e1a695af34a7f4a6ce537a6"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7c1e3049-c0a9-3004-9804-b13963420e3e",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}