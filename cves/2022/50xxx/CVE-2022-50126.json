{
  "id": "EUVD-2022-55392",
  "enisaUuid": "e7e3ac32-840a-30e4-9843-af4e2a1c66da",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\njbd2: fix assertion 'jh->b_frozen_data == NULL' failure when journal aborted\n\nFollowing process will fail assertion 'jh->b_frozen_data == NULL' in\njbd2_journal_dirty_metadata():\n\n                   jbd2_journal_commit_transaction\nunlink(dir/a)\n jh->b_transaction = trans1\n jh->b_jlist = BJ_Metadata\n                    journal->j_running_transaction = NULL\n                    trans1->t_state = T_COMMIT\nunlink(dir/b)\n handle->h_trans = trans2\n do_get_write_access\n  jh->b_modified = 0\n  jh->b_frozen_data = frozen_buffer\n  jh->b_next_transaction = trans2\n jbd2_journal_dirty_metadata\n  is_handle_aborted\n   is_journal_aborted // return false\n\n           --> jbd2 abort <--\n\n                     while (commit_transaction->t_buffers)\n                      if (is_journal_aborted)\n                       jbd2_journal_refile_buffer\n                        __jbd2_journal_refile_buffer\n                         WRITE_ONCE(jh->b_transaction,\n\t\t\t\t\t\tjh->b_next_transaction)\n                         WRITE_ONCE(jh->b_next_transaction, NULL)\n                         __jbd2_journal_file_buffer(jh, BJ_Reserved)\n        J_ASSERT_JH(jh, jh->b_frozen_data == NULL) // assertion failure !\n\nThe reproducer (See detail in [Link]) reports:\n ------------[ cut here ]------------\n kernel BUG at fs/jbd2/transaction.c:1629!\n invalid opcode: 0000 [#1] PREEMPT SMP\n CPU: 2 PID: 584 Comm: unlink Tainted: G        W\n 5.19.0-rc6-00115-g4a57a8400075-dirty #697\n RIP: 0010:jbd2_journal_dirty_metadata+0x3c5/0x470\n RSP: 0018:ffffc90000be7ce0 EFLAGS: 00010202\n Call Trace:\n  <TASK>\n  __ext4_handle_dirty_metadata+0xa0/0x290\n  ext4_handle_dirty_dirblock+0x10c/0x1d0\n  ext4_delete_entry+0x104/0x200\n  __ext4_unlink+0x22b/0x360\n  ext4_unlink+0x275/0x390\n  vfs_unlink+0x20b/0x4c0\n  do_unlinkat+0x42f/0x4c0\n  __x64_sys_unlink+0x37/0x50\n  do_syscall_64+0x35/0x80\n\nAfter journal aborting, __jbd2_journal_refile_buffer() is executed with\nholding @jh->b_state_lock, we can fix it by moving 'is_handle_aborted()'\ninto the area protected by @jh->b_state_lock.",
  "datePublished": "Jun 18, 2025, 11:02:53 AM",
  "dateUpdated": "Jun 18, 2025, 11:02:53 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0f61c6dc4b714be9d79cf0782ca02ba01c1b7ac3",
    "https://git.kernel.org/stable/c/6073389db83b903678a0920554fa19f5bdc51c48",
    "https://git.kernel.org/stable/c/fa5b65d39332fef7a11ae99cb1f0696012a61527",
    "https://git.kernel.org/stable/c/f7161d0da975adc234161cd0641d0e484f5ce375",
    "https://git.kernel.org/stable/c/e62f79827784f56499a50ea2e893c98317b5407b",
    "https://git.kernel.org/stable/c/731c1662d838fe954c6759e3ee43229b0d928fe4",
    "https://git.kernel.org/stable/c/ddd896792e1718cb84c96f3e618270589b6886dc",
    "https://git.kernel.org/stable/c/4a734f0869f970b8a9b65062ea40b09a5da9dba8"
  ],
  "aliases": [
    "CVE-2022-50126"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "04aee99d-38ef-39a5-a50f-2365f452ea15",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "06e6d5b6-1612-31a7-a2a1-83583a43b9b1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.61"
    },
    {
      "id": "1f7abc1b-15e3-32c4-865e-1c0aa6457b89",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <f7161d0da975adc234161cd0641d0e484f5ce375"
    },
    {
      "id": "20df3e42-b663-3871-b0bf-9e4b3fa8cadc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "2d0f4df8-9d09-37c5-8150-7455b8847fb0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.256"
    },
    {
      "id": "3b9875a4-4198-3e1d-a7cc-2415b53cdc66",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.137"
    },
    {
      "id": "53d6d79d-b4a8-3c08-bca1-dd696a582ca3",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <fa5b65d39332fef7a11ae99cb1f0696012a61527"
    },
    {
      "id": "5f0a71ac-f7ac-3c6b-ac7a-c1c6f4faed9b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.291"
    },
    {
      "id": "683bfdec-463f-3b95-955a-fe78c554664e",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <731c1662d838fe954c6759e3ee43229b0d928fe4"
    },
    {
      "id": "92c465b7-5f50-30dd-8421-bef6137a5704",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <4a734f0869f970b8a9b65062ea40b09a5da9dba8"
    },
    {
      "id": "9b515c0a-05b6-390b-84a5-411eead80551",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <0f61c6dc4b714be9d79cf0782ca02ba01c1b7ac3"
    },
    {
      "id": "a0b4667c-8b8d-321d-93f6-7a5b3ea73439",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.2"
    },
    {
      "id": "bda5aa51-bf37-3b48-ba63-1e0f8c61946c",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.19"
    },
    {
      "id": "c9b2d7d3-6d01-3095-a109-fda26080eef8",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <e62f79827784f56499a50ea2e893c98317b5407b"
    },
    {
      "id": "cbd26cc4-b46d-34cc-b04c-4fc45cb6237b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.18"
    },
    {
      "id": "d79c5a94-3a24-34c8-b728-1dcb25998c14",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.211"
    },
    {
      "id": "d8720b19-41ce-33ed-a02e-7987bfe6fad7",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <ddd896792e1718cb84c96f3e618270589b6886dc"
    },
    {
      "id": "ea4bb059-f479-3be4-a724-c2731794292d",
      "product": {
        "name": "Linux"
      },
      "product_version": "470decc613ab2048b619a01028072d932d9086ee <6073389db83b903678a0920554fa19f5bdc51c48"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "fe26f757-c0d8-3f00-b931-185e56e56de5",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50126"
}