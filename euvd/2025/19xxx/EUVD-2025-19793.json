{
  "id": "EUVD-2025-19793",
  "enisaUuid": "9fb42fe2-77da-3d26-aca2-9c27b54cc75d",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_packet: move notifier's packet_dev_mc out of rcu critical section\n\nSyzkaller reports the following issue:\n\n BUG: sleeping function called from invalid context at kernel/locking/mutex.c:578\n __mutex_lock+0x106/0xe80 kernel/locking/mutex.c:746\n team_change_rx_flags+0x38/0x220 drivers/net/team/team_core.c:1781\n dev_change_rx_flags net/core/dev.c:9145 [inline]\n __dev_set_promiscuity+0x3f8/0x590 net/core/dev.c:9189\n netif_set_promiscuity+0x50/0xe0 net/core/dev.c:9201\n dev_set_promiscuity+0x126/0x260 net/core/dev_api.c:286 packet_dev_mc net/packet/af_packet.c:3698 [inline]\n packet_dev_mclist_delete net/packet/af_packet.c:3722 [inline]\n packet_notifier+0x292/0xa60 net/packet/af_packet.c:4247\n notifier_call_chain+0x1b3/0x3e0 kernel/notifier.c:85\n call_netdevice_notifiers_extack net/core/dev.c:2214 [inline]\n call_netdevice_notifiers net/core/dev.c:2228 [inline]\n unregister_netdevice_many_notify+0x15d8/0x2330 net/core/dev.c:11972\n rtnl_delete_link net/core/rtnetlink.c:3522 [inline]\n rtnl_dellink+0x488/0x710 net/core/rtnetlink.c:3564\n rtnetlink_rcv_msg+0x7cf/0xb70 net/core/rtnetlink.c:6955\n netlink_rcv_skb+0x219/0x490 net/netlink/af_netlink.c:2534\n\nCalling `PACKET_ADD_MEMBERSHIP` on an ops-locked device can trigger\nthe `NETDEV_UNREGISTER` notifier, which may require disabling promiscuous\nand/or allmulti mode. Both of these operations require acquiring\nthe netdev instance lock.\n\nMove the call to `packet_dev_mc` outside of the RCU critical section.\nThe `mclist` modifications (add, del, flush, unregister) are protected by\nthe RTNL, not the RCU. The RCU only protects the `sklist` and its\nassociated `sks`. The delayed operation on the `mclist` entry remains\nwithin the RTNL.",
  "datePublished": "Jul 3, 2025, 8:35:55 AM",
  "dateUpdated": "Jul 28, 2025, 4:13:39 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/2dd4781c5af99415ebbd2f7cc763feb109863c05",
    "https://git.kernel.org/stable/c/d8d85ef0a631df9127f202e6371bb33a0b589952"
  ],
  "aliases": [
    "CVE-2025-38150"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1544f5a7-816a-3d10-a332-3532d7c10281",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.15"
    },
    {
      "id": "46b40666-d5c7-3402-b147-56074bb181e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "66450607-ef39-3da9-844f-58a24edaed22",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad7c7b2172c388818a111455643491d75f535e90 <d8d85ef0a631df9127f202e6371bb33a0b589952"
    },
    {
      "id": "7280625a-7107-3806-bd84-a5cb2ee13a22",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad7c7b2172c388818a111455643491d75f535e90 <2dd4781c5af99415ebbd2f7cc763feb109863c05"
    },
    {
      "id": "c83bc260-6bcb-3b67-a1ae-6129aff20411",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "ea08d3ea-45ca-3c3f-b27b-d45c25ed5ca5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "f61b923e-6524-358a-a0b4-f976e8dfa4c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.3"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7b5431a0-8c7b-35e7-aa55-41cfb00f1503",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}