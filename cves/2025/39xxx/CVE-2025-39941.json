{
  "id": "EUVD-2025-32389",
  "enisaUuid": "0d589145-c327-3fb3-90b2-4175ae656873",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nzram: fix slot write race condition\n\nParallel concurrent writes to the same zram index result in leaked\nzsmalloc handles.  Schematically we can have something like this:\n\nCPU0                              CPU1\nzram_slot_lock()\nzs_free(handle)\nzram_slot_lock()\n\t\t\t\tzram_slot_lock()\n\t\t\t\tzs_free(handle)\n\t\t\t\tzram_slot_lock()\n\ncompress\t\t\tcompress\nhandle = zs_malloc()\t\thandle = zs_malloc()\nzram_slot_lock\nzram_set_handle(handle)\nzram_slot_lock\n\t\t\t\tzram_slot_lock\n\t\t\t\tzram_set_handle(handle)\n\t\t\t\tzram_slot_lock\n\nEither CPU0 or CPU1 zsmalloc handle will leak because zs_free() is done\ntoo early.  In fact, we need to reset zram entry right before we set its\nnew handle, all under the same slot lock scope.",
  "datePublished": "Oct 4, 2025, 7:31:04 AM",
  "dateUpdated": "Oct 4, 2025, 7:31:04 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39941",
    "https://git.kernel.org/stable/c/ce4be9e4307c5a60701ff6e0cafa74caffdc54ce",
    "https://git.kernel.org/stable/c/ff750e9f2c4d63854c33967d1646b5e89a9a19a2"
  ],
  "aliases": [
    "CVE-2025-39941",
    "GHSA-mjg7-65xv-hcjw"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "4dd4095c-1c0a-3340-a734-8a1778aaca16",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "6ad8ba26-f43c-351a-a434-b4e6a517e186",
      "product": {
        "name": "Linux"
      },
      "product_version": "71268035f5d734ad6373d953298bd5779985497a <ff750e9f2c4d63854c33967d1646b5e89a9a19a2"
    },
    {
      "id": "8cbf198d-953f-3542-bd97-c1fce0c8bf7b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.14"
    },
    {
      "id": "8e5072bb-f08e-3936-a58d-bbbf5428c76e",
      "product": {
        "name": "Linux"
      },
      "product_version": "71268035f5d734ad6373d953298bd5779985497a <ce4be9e4307c5a60701ff6e0cafa74caffdc54ce"
    },
    {
      "id": "c112cf8a-baa7-3823-aad7-7738ab9f45d5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "dc4a1d76-419b-3114-92d5-851796829b78",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.9"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "caa63dfc-6976-3f3e-ba93-f1ff0f471c88",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39941"
}