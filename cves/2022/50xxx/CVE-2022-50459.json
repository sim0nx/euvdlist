{
  "id": "EUVD-2025-31953",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: iscsi: iscsi_tcp: Fix null-ptr-deref while calling getpeername()\n\nFix a NULL pointer crash that occurs when we are freeing the socket at the\nsame time we access it via sysfs.\n\nThe problem is that:\n\n 1. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() take\n    the frwd_lock and do sock_hold() then drop the frwd_lock. sock_hold()\n    does a get on the \"struct sock\".\n\n 2. iscsi_sw_tcp_release_conn() does sockfd_put() which does the last put\n    on the \"struct socket\" and that does __sock_release() which sets the\n    sock->ops to NULL.\n\n 3. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() then\n    call kernel_getpeername() which accesses the NULL sock->ops.\n\nAbove we do a get on the \"struct sock\", but we needed a get on the \"struct\nsocket\". Originally, we just held the frwd_lock the entire time but in\ncommit bcf3a2953d36 (\"scsi: iscsi: iscsi_tcp: Avoid holding spinlock while\ncalling getpeername()\") we switched to refcount based because the network\nlayer changed and started taking a mutex in that path, so we could no\nlonger hold the frwd_lock.\n\nInstead of trying to maintain multiple refcounts, this just has us use a\nmutex for accessing the socket in the interface code paths.",
  "datePublished": "Oct 1, 2025, 11:45:31 AM",
  "dateUpdated": "Oct 1, 2025, 11:45:31 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50459",
    "https://git.kernel.org/stable/c/0a0b861fce2657ba08ec356a74346b37ca4b2008",
    "https://git.kernel.org/stable/c/57569c37f0add1b6489e1a1563c71519daf732cf",
    "https://git.kernel.org/stable/c/884a788f065578bb640382279a83d1df433b13e6",
    "https://git.kernel.org/stable/c/897dbbc57d71e8a34ec1af8e573a142de457da38",
    "https://git.kernel.org/stable/c/a26b0658751bb0a3b28386fca715333b104d32a2"
  ],
  "aliases": [
    "CVE-2022-50459",
    "GHSA-f7xj-99j9-66q2"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "009fff71-73e7-3d36-9625-9b43c122c61b",
      "product": {
        "name": "Linux"
      },
      "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <884a788f065578bb640382279a83d1df433b13e6"
    },
    {
      "id": "0963cedc-142e-3e1b-8908-83b2938aa149",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.75"
    },
    {
      "id": "0b64aee4-c881-3b8c-971b-0a5dd125f18c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "29ad893c-748b-3b85-99fb-22cfee10fb08",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.17"
    },
    {
      "id": "3726cac7-e716-3f16-81fa-5f19122ef0b7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.150"
    },
    {
      "id": "4cd05cea-fbd4-3d78-bbbb-5fef8fe5393e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.3"
    },
    {
      "id": "537c7077-fe71-374a-b932-26f3e2bb976d",
      "product": {
        "name": "Linux"
      },
      "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <57569c37f0add1b6489e1a1563c71519daf732cf"
    },
    {
      "id": "62c39ed3-1d26-3414-a004-77c6cd4e7d8a",
      "product": {
        "name": "Linux"
      },
      "product_version": "7d29e950766327f658cb92722b9445ac3b3ae023"
    },
    {
      "id": "74df6973-4ae8-32e7-829e-58f0ddb2c0e6",
      "product": {
        "name": "Linux"
      },
      "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <a26b0658751bb0a3b28386fca715333b104d32a2"
    },
    {
      "id": "a3fbc4dc-ac26-31a8-9a98-fa39193394ca",
      "product": {
        "name": "Linux"
      },
      "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <897dbbc57d71e8a34ec1af8e573a142de457da38"
    },
    {
      "id": "bb41f25e-3069-3f1b-a983-71caa3720f23",
      "product": {
        "name": "Linux"
      },
      "product_version": "bcf3a2953d36bbfb9bd44ccb3db0897d935cc485 <0a0b861fce2657ba08ec356a74346b37ca4b2008"
    },
    {
      "id": "c02c6672-f80a-3482-8fe9-2ec4fa613111",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.9"
    },
    {
      "id": "d756234b-b92c-3007-ad33-422d6b54a23d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "295340cb-c017-39b3-8bbf-84bdd3470467",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50459"
}