{
  "id": "EUVD-2025-32840",
  "enisaUuid": "82a20f42-858f-30a9-bf88-322495a6f20f",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmtd: core: Fix refcount error in del_mtd_device()\n\ndel_mtd_device() will call of_node_put() to mtd_get_of_node(mtd), which\nis mtd->dev.of_node. However, memset(&mtd->dev, 0) is called before\nof_node_put(). As the result, of_node_put() won't do anything in\ndel_mtd_device(), and causes the refcount leak.\n\ndel_mtd_device()\n    memset(&mtd->dev, 0, sizeof(mtd->dev) # clear mtd->dev\n    of_node_put()\n        mtd_get_of_node(mtd) # mtd->dev is cleared, can't locate of_node\n                             # of_node_put(NULL) won't do anything\n\nFix the error by caching the pointer of the device_node.\n\nOF: ERROR: memory leak, expected refcount 1 instead of 2,\nof_node_get()/of_node_put() unbalanced - destroy cset entry: attach\noverlay node /spi/spi-sram@0\nCPU: 3 PID: 275 Comm: python3 Tainted: G N 6.1.0-rc3+ #54\n    0d8a1edddf51f172ff5226989a7565c6313b08e2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\nrel-1.15.0-0-g2dd4b9b3f840-prebuilt.qemu.org 04/01/2014\nCall Trace:\n<TASK>\n    dump_stack_lvl+0x67/0x83\n    kobject_get+0x155/0x160\n    of_node_get+0x1f/0x30\n    of_fwnode_get+0x43/0x70\n    fwnode_handle_get+0x54/0x80\n    fwnode_get_nth_parent+0xc9/0xe0\n    fwnode_full_name_string+0x3f/0xa0\n    device_node_string+0x30f/0x750\n    pointer+0x598/0x7a0\n    vsnprintf+0x62d/0x9b0\n    ...\n    cfs_overlay_release+0x30/0x90\n    config_item_release+0xbe/0x1a0\n    config_item_put+0x5e/0x80\n    configfs_rmdir+0x3bd/0x540\n    vfs_rmdir+0x18c/0x320\n    do_rmdir+0x198/0x330\n    __x64_sys_rmdir+0x2c/0x40\n    do_syscall_64+0x37/0x90\n    entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\n[<miquel.raynal@bootlin.com>: Light reword of the commit log]",
  "datePublished": "Oct 1, 2025, 11:45:30 AM",
  "dateUpdated": "Oct 1, 2025, 11:45:30 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50457",
    "https://git.kernel.org/stable/c/56570bdad5e31c5c538cd6efff5c4510256e1bb4",
    "https://git.kernel.org/stable/c/616dc895d982026f41f500c88d1bfea004938cc8",
    "https://git.kernel.org/stable/c/f6016557f1ef7735963bd8691592d2797bbf91d2"
  ],
  "aliases": [
    "CVE-2022-50457",
    "GHSA-j49h-xgx7-8459"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1fad5166-e45a-3ca4-af7e-a0d23c3764c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.16"
    },
    {
      "id": "5a454074-a0d8-3dab-81de-97da5b7db4de",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2"
    },
    {
      "id": "5cab9f0e-2e1e-3497-8c37-700dcd0c36b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.2"
    },
    {
      "id": "6d505ff1-a964-332f-ae79-70feb42ea8f2",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    },
    {
      "id": "8815b352-fc5e-3de6-b3db-9297bf0d313e",
      "product": {
        "name": "Linux"
      },
      "product_version": "00596576a05145a1b5672897a82ef87af00becf4 <f6016557f1ef7735963bd8691592d2797bbf91d2"
    },
    {
      "id": "afd0d3ec-a014-3855-9b18-f9d2f00c2a58",
      "product": {
        "name": "Linux"
      },
      "product_version": "00596576a05145a1b5672897a82ef87af00becf4 <616dc895d982026f41f500c88d1bfea004938cc8"
    },
    {
      "id": "b3e638e8-1453-3272-b294-9bb5215490d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "dfb38ae0-a868-3b79-9010-3dae151ca13f",
      "product": {
        "name": "Linux"
      },
      "product_version": "00596576a05145a1b5672897a82ef87af00becf4 <56570bdad5e31c5c538cd6efff5c4510256e1bb4"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "1c17b7b7-7d5b-3d00-b438-a8ee7eccc90e",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}