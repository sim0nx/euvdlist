{
  "id": "EUVD-2024-44803",
  "enisaUuid": "31b8a74f-af3b-3e10-8b11-d57360dfa97b",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsecurity/keys: fix slab-out-of-bounds in key_task_permission\n\nKASAN reports an out of bounds read:\nBUG: KASAN: slab-out-of-bounds in __kuid_val include/linux/uidgid.h:36\nBUG: KASAN: slab-out-of-bounds in uid_eq include/linux/uidgid.h:63 [inline]\nBUG: KASAN: slab-out-of-bounds in key_task_permission+0x394/0x410\nsecurity/keys/permission.c:54\nRead of size 4 at addr ffff88813c3ab618 by task stress-ng/4362\n\nCPU: 2 PID: 4362 Comm: stress-ng Not tainted 5.10.0-14930-gafbffd6c3ede #15\nCall Trace:\n __dump_stack lib/dump_stack.c:82 [inline]\n dump_stack+0x107/0x167 lib/dump_stack.c:123\n print_address_description.constprop.0+0x19/0x170 mm/kasan/report.c:400\n __kasan_report.cold+0x6c/0x84 mm/kasan/report.c:560\n kasan_report+0x3a/0x50 mm/kasan/report.c:585\n __kuid_val include/linux/uidgid.h:36 [inline]\n uid_eq include/linux/uidgid.h:63 [inline]\n key_task_permission+0x394/0x410 security/keys/permission.c:54\n search_nested_keyrings+0x90e/0xe90 security/keys/keyring.c:793\n\nThis issue was also reported by syzbot.\n\nIt can be reproduced by following these steps(more details [1]):\n1. Obtain more than 32 inputs that have similar hashes, which ends with the\n   pattern '0xxxxxxxe6'.\n2. Reboot and add the keys obtained in step 1.\n\nThe reproducer demonstrates how this issue happened:\n1. In the search_nested_keyrings function, when it iterates through the\n   slots in a node(below tag ascend_to_node), if the slot pointer is meta\n   and node->back_pointer != NULL(it means a root), it will proceed to\n   descend_to_node. However, there is an exception. If node is the root,\n   and one of the slots points to a shortcut, it will be treated as a\n   keyring.\n2. Whether the ptr is keyring decided by keyring_ptr_is_keyring function.\n   However, KEYRING_PTR_SUBTYPE is 0x2UL, the same as\n   ASSOC_ARRAY_PTR_SUBTYPE_MASK.\n3. When 32 keys with the similar hashes are added to the tree, the ROOT\n   has keys with hashes that are not similar (e.g. slot 0) and it splits\n   NODE A without using a shortcut. When NODE A is filled with keys that\n   all hashes are xxe6, the keys are similar, NODE A will split with a\n   shortcut. Finally, it forms the tree as shown below, where slot 6 points\n   to a shortcut.\n\n                      NODE A\n              +------>+---+\n      ROOT    |       | 0 | xxe6\n      +---+   |       +---+\n xxxx | 0 | shortcut  :   : xxe6\n      +---+   |       +---+\n xxe6 :   :   |       |   | xxe6\n      +---+   |       +---+\n      | 6 |---+       :   : xxe6\n      +---+           +---+\n xxe6 :   :           | f | xxe6\n      +---+           +---+\n xxe6 | f |\n      +---+\n\n4. As mentioned above, If a slot(slot 6) of the root points to a shortcut,\n   it may be mistakenly transferred to a key*, leading to a read\n   out-of-bounds read.\n\nTo fix this issue, one should jump to descend_to_node if the ptr is a\nshortcut, regardless of whether the node is root or not.\n\n[1] https://lore.kernel.org/linux-kernel/1cfa878e-8c7b-4570-8606-21daf5e13ce7@huaweicloud.com/\n\n[jarkko: tweaked the commit message a bit to have an appropriate closes\n tag.]",
  "datePublished": "Nov 19, 2024, 1:30:49 AM",
  "dateUpdated": "Oct 1, 2025, 8:17:19 PM",
  "baseScore": 7.1,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/c3ce634ad953ce48c75c39bdfd8b711dd95f346f",
    "https://git.kernel.org/stable/c/4efb69a0e294ef201bcdf7ce3d6202cd0a545a5d",
    "https://git.kernel.org/stable/c/1e4332581cd4eed75aea77af6f66cdcdda8b49b9",
    "https://git.kernel.org/stable/c/199c20fb7499c79557a075dc24e9a7dae7d9f1ce",
    "https://git.kernel.org/stable/c/bbad2d5b6c99db468d8f88b6ba6a56ed409b4881",
    "https://git.kernel.org/stable/c/3e79ad156bedf2da0ab909a118d2cec6c9c22b79",
    "https://git.kernel.org/stable/c/e0a317ad68e4ea48a0158187238c5407e4fdec8b",
    "https://git.kernel.org/stable/c/4a74da044ec9ec8679e6beccc4306b936b62873f"
  ],
  "aliases": [
    "CVE-2024-50301"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "098a4d57-a988-3b77-b484-100c3658f240",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <e0a317ad68e4ea48a0158187238c5407e4fdec8b"
    },
    {
      "id": "1a6ed86c-5489-314c-a9a3-8de921a81851",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <4efb69a0e294ef201bcdf7ce3d6202cd0a545a5d"
    },
    {
      "id": "1a9627fb-f6c2-3b77-a901-59d36e5ba506",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.172"
    },
    {
      "id": "279daeb2-d8ab-3179-aeed-3b50027ff390",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.230"
    },
    {
      "id": "29afe0b0-553e-3aab-ae7e-09288aac90dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.61"
    },
    {
      "id": "4dae05cd-516b-3ee0-a8d8-b8f3f7c0df9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <bbad2d5b6c99db468d8f88b6ba6a56ed409b4881"
    },
    {
      "id": "4df0ab1f-05b2-3bb9-8f49-0d7e37ce1983",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <c3ce634ad953ce48c75c39bdfd8b711dd95f346f"
    },
    {
      "id": "5a4288fe-2ace-346f-827e-ff72c3abc227",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "5a7e1f59-ffb0-37aa-8ac2-7181649d2ad9",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <3e79ad156bedf2da0ab909a118d2cec6c9c22b79"
    },
    {
      "id": "6f757eb1-d70c-3e4a-81df-8cb85bf3dba0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.286"
    },
    {
      "id": "807501eb-96a4-3b4a-9f3f-1b4d14a78584",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12"
    },
    {
      "id": "808fd9b1-c4e9-3261-a8de-638eb13fe25c",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.13"
    },
    {
      "id": "aa14583a-e6f1-362a-89aa-fd4d21ad13dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <4a74da044ec9ec8679e6beccc4306b936b62873f"
    },
    {
      "id": "cb625269-93c5-3aea-8463-0cd47bd244d3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.8"
    },
    {
      "id": "d0b6878e-d547-3c7a-9baa-5c35cf74b2e8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.324"
    },
    {
      "id": "d19facc9-5f87-3250-8457-d7b698ea2b1e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.117"
    },
    {
      "id": "dca127c8-5f0c-36d3-8945-a835f42cb9ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <199c20fb7499c79557a075dc24e9a7dae7d9f1ce"
    },
    {
      "id": "e1eb8752-2dac-3f09-9d6d-b9028d27fc3b",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2a4df200d570b2c33a57e1ebfa5896e4bc81b69 <1e4332581cd4eed75aea77af6f66cdcdda8b49b9"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "6455b1a2-1381-3409-b990-53189293a998",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}