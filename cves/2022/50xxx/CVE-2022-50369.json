{
  "id": "EUVD-2022-55629",
  "enisaUuid": "3e2f2836-48be-3494-8eb1-88bb40a572c7",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/vkms: Fix null-ptr-deref in vkms_release()\n\nA null-ptr-deref is triggered when it tries to destroy the workqueue in\nvkms->output.composer_workq in vkms_release().\n\n KASAN: null-ptr-deref in range [0x0000000000000118-0x000000000000011f]\n CPU: 5 PID: 17193 Comm: modprobe Not tainted 6.0.0-11331-gd465bff130bf #24\n RIP: 0010:destroy_workqueue+0x2f/0x710\n ...\n Call Trace:\n  <TASK>\n  ? vkms_config_debugfs_init+0x50/0x50 [vkms]\n  __devm_drm_dev_alloc+0x15a/0x1c0 [drm]\n  vkms_init+0x245/0x1000 [vkms]\n  do_one_initcall+0xd0/0x4f0\n  do_init_module+0x1a4/0x680\n  load_module+0x6249/0x7110\n  __do_sys_finit_module+0x140/0x200\n  do_syscall_64+0x35/0x80\n  entry_SYSCALL_64_after_hwframe+0x46/0xb0\n\nThe reason is that an OOM happened which triggers the destroy of the\nworkqueue, however, the workqueue is alloced in the later process,\nthus a null-ptr-deref happened. A simple call graph is shown as below:\n\n vkms_init()\n  vkms_create()\n    devm_drm_dev_alloc()\n      __devm_drm_dev_alloc()\n        devm_drm_dev_init()\n          devm_add_action_or_reset()\n            devm_add_action() # an error happened\n            devm_drm_dev_init_release()\n              drm_dev_put()\n                kref_put()\n                  drm_dev_release()\n                    vkms_release()\n                      destroy_workqueue() # null-ptr-deref happened\n    vkms_modeset_init()\n      vkms_output_init()\n        vkms_crtc_init() # where the workqueue get allocated\n\nFix this by checking if composer_workq is NULL before passing it to\nthe destroy_workqueue() in vkms_release().",
  "datePublished": "Sep 17, 2025, 2:56:24 PM",
  "dateUpdated": "Sep 17, 2025, 2:56:24 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0b8f390e2251191f1b179cc87f65d54c96565f0d",
    "https://git.kernel.org/stable/c/1f9836f95271e7acf016667eee0aeae3386f9645",
    "https://git.kernel.org/stable/c/596f1ba3987e601e31a5abf1f75ce1d2635aceac",
    "https://git.kernel.org/stable/c/57031c474c3a920ea73afeb5dc352e537f5793ee",
    "https://git.kernel.org/stable/c/2fe2a8f40c21161ffe7653cc234e7934db5b7cc5",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50369"
  ],
  "aliases": [
    "CVE-2022-50369"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "18a51f23-1088-3287-8846-b3e0b6d2af09",
      "product": {
        "name": "Linux"
      },
      "product_version": "6c234fe37c57627a5baf96f552afa1fae2b67d4d <1f9836f95271e7acf016667eee0aeae3386f9645"
    },
    {
      "id": "32ed8c9d-8040-3782-b0b0-8b6134ce770c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6c234fe37c57627a5baf96f552afa1fae2b67d4d <2fe2a8f40c21161ffe7653cc234e7934db5b7cc5"
    },
    {
      "id": "3678a3fa-f24a-3ac1-b101-ce0508aeedbb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.3"
    },
    {
      "id": "3bf22fe1-5888-39f1-8b40-80749adf9048",
      "product": {
        "name": "Linux"
      },
      "product_version": "6c234fe37c57627a5baf96f552afa1fae2b67d4d <57031c474c3a920ea73afeb5dc352e537f5793ee"
    },
    {
      "id": "3bf3f637-8bca-3045-84cc-4d1f8edb727c",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.20"
    },
    {
      "id": "51ae8f09-cabc-3377-9c7c-7e4e53ffb5b9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "71848040-72b9-3b52-93c8-b847c90c1117",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.173"
    },
    {
      "id": "77c54484-2fd1-34bd-aeb6-341f24742fa5",
      "product": {
        "name": "Linux"
      },
      "product_version": "6c234fe37c57627a5baf96f552afa1fae2b67d4d <0b8f390e2251191f1b179cc87f65d54c96565f0d"
    },
    {
      "id": "880135b6-f4ab-389b-a742-02400e7ee1a4",
      "product": {
        "name": "Linux"
      },
      "product_version": "6c234fe37c57627a5baf96f552afa1fae2b67d4d <596f1ba3987e601e31a5abf1f75ce1d2635aceac"
    },
    {
      "id": "a5d92cff-f9f7-359e-8490-a99a011692d6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.16"
    },
    {
      "id": "c73b86ed-69c6-35ab-bc96-177b2a086f5d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2.3"
    },
    {
      "id": "e95cc21f-f095-3faf-8df5-90f337892143",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.99"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8fa326b0-c2c7-30ad-a020-6c15e272cc30",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50369"
}