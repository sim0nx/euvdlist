{
  "id": "EUVD-2025-32007",
  "enisaUuid": "94155aeb-d9d0-3993-8e7a-74b8a62b4b33",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, arm64: Fixed a BTI error on returning to patched function\n\nWhen BPF_TRAMP_F_CALL_ORIG is set, BPF trampoline uses BLR to jump\nback to the instruction next to call site to call the patched function.\nFor BTI-enabled kernel, the instruction next to call site is usually\nPACIASP, in this case, it's safe to jump back with BLR. But when\nthe call site is not followed by a PACIASP or bti, a BTI exception\nis triggered.\n\nHere is a fault log:\n\n Unhandled 64-bit el1h sync exception on CPU0, ESR 0x0000000034000002 -- BTI\n CPU: 0 PID: 263 Comm: test_progs Tainted: GF\n Hardware name: linux,dummy-virt (DT)\n pstate: 40400805 (nZcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=-c)\n pc : bpf_fentry_test1+0xc/0x30\n lr : bpf_trampoline_6442573892_0+0x48/0x1000\n sp : ffff80000c0c3a50\n x29: ffff80000c0c3a90 x28: ffff0000c2e6c080 x27: 0000000000000000\n x26: 0000000000000000 x25: 0000000000000000 x24: 0000000000000050\n x23: 0000000000000000 x22: 0000ffffcfd2a7f0 x21: 000000000000000a\n x20: 0000ffffcfd2a7f0 x19: 0000000000000000 x18: 0000000000000000\n x17: 0000000000000000 x16: 0000000000000000 x15: 0000ffffcfd2a7f0\n x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000000000\n x11: 0000000000000000 x10: ffff80000914f5e4 x9 : ffff8000082a1528\n x8 : 0000000000000000 x7 : 0000000000000000 x6 : 0101010101010101\n x5 : 0000000000000000 x4 : 00000000fffffff2 x3 : 0000000000000001\n x2 : ffff8001f4b82000 x1 : 0000000000000000 x0 : 0000000000000001\n Kernel panic - not syncing: Unhandled exception\n CPU: 0 PID: 263 Comm: test_progs Tainted: GF\n Hardware name: linux,dummy-virt (DT)\n Call trace:\n  dump_backtrace+0xec/0x144\n  show_stack+0x24/0x7c\n  dump_stack_lvl+0x8c/0xb8\n  dump_stack+0x18/0x34\n  panic+0x1cc/0x3ec\n  __el0_error_handler_common+0x0/0x130\n  el1h_64_sync_handler+0x60/0xd0\n  el1h_64_sync+0x78/0x7c\n  bpf_fentry_test1+0xc/0x30\n  bpf_fentry_test1+0xc/0x30\n  bpf_prog_test_run_tracing+0xdc/0x2a0\n  __sys_bpf+0x438/0x22a0\n  __arm64_sys_bpf+0x30/0x54\n  invoke_syscall+0x78/0x110\n  el0_svc_common.constprop.0+0x6c/0x1d0\n  do_el0_svc+0x38/0xe0\n  el0_svc+0x30/0xd0\n  el0t_64_sync_handler+0x1ac/0x1b0\n  el0t_64_sync+0x1a0/0x1a4\n Kernel Offset: disabled\n CPU features: 0x0000,00034c24,f994fdab\n Memory Limit: none\n\nAnd the instruction next to call site of bpf_fentry_test1 is ADD,\nnot PACIASP:\n\n<bpf_fentry_test1>:\n\tbti     c\n\tnop\n\tnop\n\tadd     w0, w0, #0x1\n\tpaciasp\n\nFor BPF prog, JIT always puts a PACIASP after call site for BTI-enabled\nkernel, so there is no problem. To fix it, replace BLR with RET to bypass\nthe branch target check.",
  "datePublished": "Oct 7, 2025, 3:19:36 PM",
  "dateUpdated": "Oct 7, 2025, 3:19:36 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53634",
    "https://git.kernel.org/stable/c/738a96c4a8c36950803fdd27e7c30aca92dccefd",
    "https://git.kernel.org/stable/c/8b9c64942ada229f52fe6f1b537a50f88b3c2673",
    "https://git.kernel.org/stable/c/eabc166919d169e105263974991f52b0351e431a"
  ],
  "aliases": [
    "CVE-2023-53634",
    "GHSA-826h-69x5-63pc"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1a4a1dd1-6857-3a8e-a19d-8c7c2b6e838f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2.12"
    },
    {
      "id": "241bb1d7-b20e-34b4-b01d-2870bf8d0d13",
      "product": {
        "name": "Linux"
      },
      "product_version": "efc9909fdce00a827a37609628223cd45bf95d0b <eabc166919d169e105263974991f52b0351e431a"
    },
    {
      "id": "65cec607-3b53-34a4-bb83-7c60efe6e62b",
      "product": {
        "name": "Linux"
      },
      "product_version": "efc9909fdce00a827a37609628223cd45bf95d0b <738a96c4a8c36950803fdd27e7c30aca92dccefd"
    },
    {
      "id": "73a2bba5-0b7e-33cc-8cfb-4612321d3049",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "a17c9d18-1c7b-3bf9-a279-4715a34a3b24",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.0"
    },
    {
      "id": "d829aafe-c1cb-3de4-8067-e17511003a37",
      "product": {
        "name": "Linux"
      },
      "product_version": "efc9909fdce00a827a37609628223cd45bf95d0b <8b9c64942ada229f52fe6f1b537a50f88b3c2673"
    },
    {
      "id": "d9fb40b9-ef0e-33a2-9852-e96814cc7293",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.25"
    },
    {
      "id": "ef411d7b-5d62-3585-af00-628b36b8f71a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.3"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "4689e31d-e404-3781-9e72-7d8ec410ce24",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2023-53634"
}