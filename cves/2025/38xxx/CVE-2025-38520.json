{
  "id": "EUVD-2025-25078",
  "enisaUuid": "99b0938b-450a-3406-b08a-a456b9a554c6",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amdkfd: Don't call mmput from MMU notifier callback\n\nIf the process is exiting, the mmput inside mmu notifier callback from\ncompactd or fork or numa balancing could release the last reference\nof mm struct to call exit_mmap and free_pgtable, this triggers deadlock\nwith below backtrace.\n\nThe deadlock will leak kfd process as mmu notifier release is not called\nand cause VRAM leaking.\n\nThe fix is to take mm reference mmget_non_zero when adding prange to the\ndeferred list to pair with mmput in deferred list work.\n\nIf prange split and add into pchild list, the pchild work_item.mm is not\nused, so remove the mm parameter from svm_range_unmap_split and\nsvm_range_add_child.\n\nThe backtrace of hung task:\n\n INFO: task python:348105 blocked for more than 64512 seconds.\n Call Trace:\n  __schedule+0x1c3/0x550\n  schedule+0x46/0xb0\n  rwsem_down_write_slowpath+0x24b/0x4c0\n  unlink_anon_vmas+0xb1/0x1c0\n  free_pgtables+0xa9/0x130\n  exit_mmap+0xbc/0x1a0\n  mmput+0x5a/0x140\n  svm_range_cpu_invalidate_pagetables+0x2b/0x40 [amdgpu]\n  mn_itree_invalidate+0x72/0xc0\n  __mmu_notifier_invalidate_range_start+0x48/0x60\n  try_to_unmap_one+0x10fa/0x1400\n  rmap_walk_anon+0x196/0x460\n  try_to_unmap+0xbb/0x210\n  migrate_page_unmap+0x54d/0x7e0\n  migrate_pages_batch+0x1c3/0xae0\n  migrate_pages_sync+0x98/0x240\n  migrate_pages+0x25c/0x520\n  compact_zone+0x29d/0x590\n  compact_zone_order+0xb6/0xf0\n  try_to_compact_pages+0xbe/0x220\n  __alloc_pages_direct_compact+0x96/0x1a0\n  __alloc_pages_slowpath+0x410/0x930\n  __alloc_pages_nodemask+0x3a9/0x3e0\n  do_huge_pmd_anonymous_page+0xd7/0x3e0\n  __handle_mm_fault+0x5e3/0x5f0\n  handle_mm_fault+0xf7/0x2e0\n  hmm_vma_fault.isra.0+0x4d/0xa0\n  walk_pmd_range.isra.0+0xa8/0x310\n  walk_pud_range+0x167/0x240\n  walk_pgd_range+0x55/0x100\n  __walk_page_range+0x87/0x90\n  walk_page_range+0xf6/0x160\n  hmm_range_fault+0x4f/0x90\n  amdgpu_hmm_range_get_pages+0x123/0x230 [amdgpu]\n  amdgpu_ttm_tt_get_user_pages+0xb1/0x150 [amdgpu]\n  init_user_pages+0xb1/0x2a0 [amdgpu]\n  amdgpu_amdkfd_gpuvm_alloc_memory_of_gpu+0x543/0x7d0 [amdgpu]\n  kfd_ioctl_alloc_memory_of_gpu+0x24c/0x4e0 [amdgpu]\n  kfd_ioctl+0x29d/0x500 [amdgpu]\n\n(cherry picked from commit a29e067bd38946f752b0ef855f3dfff87e77bec7)",
  "datePublished": "Aug 16, 2025, 10:55:07 AM",
  "dateUpdated": "Aug 16, 2025, 10:55:07 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/c1bde9d48e09933c361521720f77a8072083c83a",
    "https://git.kernel.org/stable/c/145a56bd68f4bff098d59fbc7c263d20dfef4fc4",
    "https://git.kernel.org/stable/c/e90ee15ce28c61f6d83a0511c3e02e2662478350",
    "https://git.kernel.org/stable/c/a7eb0a25010a674c8fdfbece38353ef7be8c5834",
    "https://git.kernel.org/stable/c/cf234231fcbc7d391e2135b9518613218cc5347f"
  ],
  "aliases": [
    "CVE-2025-38520"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "20e5968a-e769-3650-a567-aee20e44dac7",
      "product": {
        "name": "Linux"
      },
      "product_version": "fa582c6f3684ac0098a9d02ddf0ed52a02b37127 <145a56bd68f4bff098d59fbc7c263d20dfef4fc4"
    },
    {
      "id": "34ee97fa-b8b0-3f9d-861a-e4fbc4e45fe7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "429b5508-40e7-3d3a-9cce-eecec7c8ec30",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.148"
    },
    {
      "id": "5ed1ef93-5018-3bd7-947f-29f2a897d4f0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.39"
    },
    {
      "id": "70fbbffb-c0b7-36fb-b6d1-b99f04e50c0d",
      "product": {
        "name": "Linux"
      },
      "product_version": "4b29b8d7c20f54eec0ff266b4a3f419bd251ed83"
    },
    {
      "id": "731818ab-5dac-3c17-9de9-eafafa8c4403",
      "product": {
        "name": "Linux"
      },
      "product_version": "fa582c6f3684ac0098a9d02ddf0ed52a02b37127 <a7eb0a25010a674c8fdfbece38353ef7be8c5834"
    },
    {
      "id": "7d55864e-031a-3108-b79b-a5d252be33ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.19"
    },
    {
      "id": "c5a39a75-6df3-3e36-adbd-799edc310a3b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "c8d2f885-74bf-3df9-a350-74715fb1a893",
      "product": {
        "name": "Linux"
      },
      "product_version": "fa582c6f3684ac0098a9d02ddf0ed52a02b37127 <c1bde9d48e09933c361521720f77a8072083c83a"
    },
    {
      "id": "d992a321-deaa-3f15-975e-50f9955a2208",
      "product": {
        "name": "Linux"
      },
      "product_version": "09c5cdbc62d99fc6306a21b24b60eb11a3bd0963"
    },
    {
      "id": "df0e2099-57fc-35c2-846e-97270aadbebc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.101"
    },
    {
      "id": "e29d2733-fbdb-3c0e-849a-fb8a7e928887",
      "product": {
        "name": "Linux"
      },
      "product_version": "fa582c6f3684ac0098a9d02ddf0ed52a02b37127 <cf234231fcbc7d391e2135b9518613218cc5347f"
    },
    {
      "id": "ebe1bdb2-d81f-3d27-abe2-376ab451e2fd",
      "product": {
        "name": "Linux"
      },
      "product_version": "fa582c6f3684ac0098a9d02ddf0ed52a02b37127 <e90ee15ce28c61f6d83a0511c3e02e2662478350"
    },
    {
      "id": "f86be737-dfea-3d79-a64a-00d5d8152914",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.7"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "f99a4d0d-6f3d-3b25-a861-35088b57772a",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38520"
}