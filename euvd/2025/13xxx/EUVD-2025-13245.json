{
  "id": "EUVD-2025-13245",
  "enisaUuid": "c9fac8de-511b-3dda-8af5-0c864a288de0",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet_sched: hfsc: Fix a UAF vulnerability in class handling\n\nThis patch fixes a Use-After-Free vulnerability in the HFSC qdisc class\nhandling. The issue occurs due to a time-of-check/time-of-use condition\nin hfsc_change_class() when working with certain child qdiscs like netem\nor codel.\n\nThe vulnerability works as follows:\n1. hfsc_change_class() checks if a class has packets (q.qlen != 0)\n2. It then calls qdisc_peek_len(), which for certain qdiscs (e.g.,\n   codel, netem) might drop packets and empty the queue\n3. The code continues assuming the queue is still non-empty, adding\n   the class to vttree\n4. This breaks HFSC scheduler assumptions that only non-empty classes\n   are in vttree\n5. Later, when the class is destroyed, this can lead to a Use-After-Free\n\nThe fix adds a second queue length check after qdisc_peek_len() to verify\nthe queue wasn't emptied.",
  "datePublished": "May 2, 2025, 2:16:01 PM",
  "dateUpdated": "May 2, 2025, 2:16:01 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-37797",
    "https://git.kernel.org/stable/c/20d584a33e480ae80d105f43e0e7b56784da41b9",
    "https://git.kernel.org/stable/c/28b09a067831f7317c3841812276022d6c940677",
    "https://git.kernel.org/stable/c/39b9095dd3b55d9b2743df038c32138efa34a9de",
    "https://git.kernel.org/stable/c/3aa852e3605000d5c47035c3fc3a986d14ccfa9f",
    "https://git.kernel.org/stable/c/3df275ef0a6ae181e8428a6589ef5d5231e58b5c",
    "https://git.kernel.org/stable/c/86cd4641c713455a4f1c8e54c370c598c2b1cee0",
    "https://git.kernel.org/stable/c/bb583c88d23b72d8d16453d24856c99bd93dadf5",
    "https://git.kernel.org/stable/c/fcc8ede663569c704fb00a702973bd6c00373283"
  ],
  "aliases": [
    "CVE-2025-37797",
    "GHSA-hvr4-ppmm-c7fp"
  ],
  "assigner": "Linux",
  "epss": 0.06,
  "enisaIdProduct": [
    {
      "id": "08c7c006-486b-358d-8ccf-b3f2873e9c83",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <20d584a33e480ae80d105f43e0e7b56784da41b9"
    },
    {
      "id": "222afc6d-fac3-3792-b6ed-aaa979339e0f",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.14"
    },
    {
      "id": "26cf4490-b204-3259-9236-079391453433",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.5"
    },
    {
      "id": "353f628e-b804-3594-99b7-65163d48fac6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.89"
    },
    {
      "id": "418c4192-3102-3bf7-aad9-c94e864630c1",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <bb583c88d23b72d8d16453d24856c99bd93dadf5"
    },
    {
      "id": "429e4241-7f53-3599-8529-7384204c3f5c",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <86cd4641c713455a4f1c8e54c370c598c2b1cee0"
    },
    {
      "id": "4865cab2-f488-3ff6-baa1-d1a942511ae8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.181"
    },
    {
      "id": "487f4702-f6be-3584-9adc-9a3b90579f83",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <3aa852e3605000d5c47035c3fc3a986d14ccfa9f"
    },
    {
      "id": "5727f098-0407-369d-aed3-9f93e7893268",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.136"
    },
    {
      "id": "65f0bcce-9929-3ec9-afb3-622ac2dc0aa7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15-rc4"
    },
    {
      "id": "66c59040-a68c-3a1b-a89d-956dbce750e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.293"
    },
    {
      "id": "6a17ca7a-0c13-3652-990b-a840eb9fced4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.26"
    },
    {
      "id": "7226a744-a2aa-3d1a-b1ba-4806f7a28891",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.237"
    },
    {
      "id": "77de6bf2-a56b-3ef9-9145-438cf70b87cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <39b9095dd3b55d9b2743df038c32138efa34a9de"
    },
    {
      "id": "8f32f667-8e7f-3800-9043-85bbfa992524",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <28b09a067831f7317c3841812276022d6c940677"
    },
    {
      "id": "c49d062e-cd3d-3d1a-ba60-0ad5faf96d03",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <3df275ef0a6ae181e8428a6589ef5d5231e58b5c"
    },
    {
      "id": "e63b66f5-1847-35c5-a082-7dd2668fd57b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "f7122d5e-9fea-3cb4-aec5-4d48743ecd70",
      "product": {
        "name": "Linux"
      },
      "product_version": "21f4d5cc25ec0e6e8eb8420dd2c399e6d2fc7d14 <fcc8ede663569c704fb00a702973bd6c00373283"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "08851e3a-e2d0-35e7-b028-dab778f15ed1",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}