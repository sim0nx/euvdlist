{
  "id": "EUVD-2025-28931",
  "enisaUuid": "cdfc7baa-8647-3f89-a535-2fc257406665",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\njbd2: prevent softlockup in jbd2_log_do_checkpoint()\n\nBoth jbd2_log_do_checkpoint() and jbd2_journal_shrink_checkpoint_list()\nperiodically release j_list_lock after processing a batch of buffers to\navoid long hold times on the j_list_lock. However, since both functions\ncontend for j_list_lock, the combined time spent waiting and processing\ncan be significant.\n\njbd2_journal_shrink_checkpoint_list() explicitly calls cond_resched() when\nneed_resched() is true to avoid softlockups during prolonged operations.\nBut jbd2_log_do_checkpoint() only exits its loop when need_resched() is\ntrue, relying on potentially sleeping functions like __flush_batch() or\nwait_on_buffer() to trigger rescheduling. If those functions do not sleep,\nthe kernel may hit a softlockup.\n\nwatchdog: BUG: soft lockup - CPU#3 stuck for 156s! [kworker/u129:2:373]\nCPU: 3 PID: 373 Comm: kworker/u129:2 Kdump: loaded Not tainted 6.6.0+ #10\nHardware name: Huawei TaiShan 2280 /BC11SPCD, BIOS 1.27 06/13/2017\nWorkqueue: writeback wb_workfn (flush-7:2)\npstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : native_queued_spin_lock_slowpath+0x358/0x418\nlr : jbd2_log_do_checkpoint+0x31c/0x438 [jbd2]\nCall trace:\n native_queued_spin_lock_slowpath+0x358/0x418\n jbd2_log_do_checkpoint+0x31c/0x438 [jbd2]\n __jbd2_log_wait_for_space+0xfc/0x2f8 [jbd2]\n add_transaction_credits+0x3bc/0x418 [jbd2]\n start_this_handle+0xf8/0x560 [jbd2]\n jbd2__journal_start+0x118/0x228 [jbd2]\n __ext4_journal_start_sb+0x110/0x188 [ext4]\n ext4_do_writepages+0x3dc/0x740 [ext4]\n ext4_writepages+0xa4/0x190 [ext4]\n do_writepages+0x94/0x228\n __writeback_single_inode+0x48/0x318\n writeback_sb_inodes+0x204/0x590\n __writeback_inodes_wb+0x54/0xf8\n wb_writeback+0x2cc/0x3d8\n wb_do_writeback+0x2e0/0x2f8\n wb_workfn+0x80/0x2a8\n process_one_work+0x178/0x3e8\n worker_thread+0x234/0x3b8\n kthread+0xf0/0x108\n ret_from_fork+0x10/0x20\n\nSo explicitly call cond_resched() in jbd2_log_do_checkpoint() to avoid\nsoftlockup.",
  "datePublished": "Sep 11, 2025, 4:56:32 PM",
  "dateUpdated": "Sep 29, 2025, 5:59:18 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/f683d611518d30334813eecf9a8c687453e2800e",
    "https://git.kernel.org/stable/c/f7ee8fd689e6d534f9fd2494b9266f7998082e65",
    "https://git.kernel.org/stable/c/84ff98c1ea19acd3f9389e4bb6061364e943f85e",
    "https://git.kernel.org/stable/c/26cb9aad94cb1811d8fae115594cc71fa3d91ab0",
    "https://git.kernel.org/stable/c/41f40038de62e8306897cf6840791b268996432a",
    "https://git.kernel.org/stable/c/429d50cbaff45090d52a1ea850d5de8c14881ee7",
    "https://git.kernel.org/stable/c/3faac5e1d14c63260fd1bf789d96bde3ab3d9e54",
    "https://git.kernel.org/stable/c/9d98cf4632258720f18265a058e62fde120c0151",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39782"
  ],
  "aliases": [
    "CVE-2025-39782"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "09eaa6f7-015f-38e2-9676-21ce7c0b12fe",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.297"
    },
    {
      "id": "11dad177-2be2-3070-8515-ef1d8d8ba02b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "38c44024-4fbc-3fb4-8df8-f350f7d307e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.149"
    },
    {
      "id": "3c2b94b6-495e-3225-bec2-f76fed5e0363",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <26cb9aad94cb1811d8fae115594cc71fa3d91ab0"
    },
    {
      "id": "42887959-934c-35b0-8d78-4320c2963eb6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9d98cf4632258720f18265a058e62fde120c0151"
    },
    {
      "id": "4cdb86f8-8c0f-3bd8-af41-fd6d5315e9ad",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.241"
    },
    {
      "id": "70404c0a-e4b0-3bb5-b335-c4a212b3fb98",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3faac5e1d14c63260fd1bf789d96bde3ab3d9e54"
    },
    {
      "id": "7cae1ef6-e0e5-3fb6-9c51-c5a5726387fa",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f7ee8fd689e6d534f9fd2494b9266f7998082e65"
    },
    {
      "id": "9e600267-a457-3423-acf0-91bd70b3b03a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.44"
    },
    {
      "id": "a30f4b0f-4b77-3d7f-b326-3649f1a24df5",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <429d50cbaff45090d52a1ea850d5de8c14881ee7"
    },
    {
      "id": "c5ecc6a9-724f-37ee-b106-9735b82b2f2d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.190"
    },
    {
      "id": "cbed17ce-19a2-378d-b608-e710c59a0373",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.4"
    },
    {
      "id": "cccd6091-c024-3565-a0fd-9dcddba0736a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc3"
    },
    {
      "id": "ccebbad8-8ff8-3e39-842d-1e2eeb1f68fd",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <84ff98c1ea19acd3f9389e4bb6061364e943f85e"
    },
    {
      "id": "d08de69e-4bdf-385f-9dcf-2616f9ef1890",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.103"
    },
    {
      "id": "e9c1070b-45e6-372b-936c-0010493def68",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f683d611518d30334813eecf9a8c687453e2800e"
    },
    {
      "id": "eee8a26d-faf6-37d2-b056-ddf02ca14279",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <41f40038de62e8306897cf6840791b268996432a"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "c4b8f925-8dc0-37ff-b403-a35f52979c51",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}