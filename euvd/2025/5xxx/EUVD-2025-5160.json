{
  "id": "EUVD-2025-5160",
  "enisaUuid": "3cee926a-c4ea-39b9-8817-0e9e48d65753",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nclocksource: Use migrate_disable() to avoid calling get_random_u32() in atomic context\n\nThe following bug report happened with a PREEMPT_RT kernel:\n\n  BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48\n  in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 2012, name: kwatchdog\n  preempt_count: 1, expected: 0\n  RCU nest depth: 0, expected: 0\n  get_random_u32+0x4f/0x110\n  clocksource_verify_choose_cpus+0xab/0x1a0\n  clocksource_verify_percpu.part.0+0x6b/0x330\n  clocksource_watchdog_kthread+0x193/0x1a0\n\nIt is due to the fact that clocksource_verify_choose_cpus() is invoked with\npreemption disabled.  This function invokes get_random_u32() to obtain\nrandom numbers for choosing CPUs.  The batched_entropy_32 local lock and/or\nthe base_crng.lock spinlock in driver/char/random.c will be acquired during\nthe call. In PREEMPT_RT kernel, they are both sleeping locks and so cannot\nbe acquired in atomic context.\n\nFix this problem by using migrate_disable() to allow smp_processor_id() to\nbe reliably used without introducing atomic context. preempt_disable() is\nthen called after clocksource_verify_choose_cpus() but before the\nclocksource measurement is being run to avoid introducing unexpected\nlatency.",
  "datePublished": "Feb 27, 2025, 2:18:17 AM",
  "dateUpdated": "May 4, 2025, 1:06:30 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-21767",
    "https://git.kernel.org/stable/c/0fb534187d2355f6c8f995321e76d1ccd1262ac1",
    "https://git.kernel.org/stable/c/6bb05a33337b2c842373857b63de5c9bf1ae2a09",
    "https://git.kernel.org/stable/c/852805b6cbdb69c298a8fc9fbe79994c95106e04",
    "https://git.kernel.org/stable/c/8783ceeee797d9aa9cfe150690fb9d0bac8cc459",
    "https://git.kernel.org/stable/c/cc3d79e7c806cb57d71c28a4a35e7d7fb3265faa",
    "https://git.kernel.org/stable/c/60f54f0d4ea530950549a8263e6fdd70a40490a4",
    "https://git.kernel.org/stable/c/d9c217fadfcff7a8df58567517d1e4253f3fd243"
  ],
  "aliases": [
    "CVE-2025-21767",
    "GHSA-h97w-34cr-4pxx"
  ],
  "assigner": "Linux",
  "epss": 0.13,
  "enisaIdProduct": [
    {
      "id": "12c494a2-94c4-36ef-8d67-617ecbe62275",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.129"
    },
    {
      "id": "1448a51b-3706-3e71-a42c-dc6b00c22510",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.235"
    },
    {
      "id": "210c2923-7294-357b-8bbd-8c233c4b873e",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.14"
    },
    {
      "id": "28f7a5a4-188e-3e93-b50d-ccdac6248109",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <cc3d79e7c806cb57d71c28a4a35e7d7fb3265faa"
    },
    {
      "id": "2de445c7-fd82-389d-9bb4-4745783d4dd5",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <60f54f0d4ea530950549a8263e6fdd70a40490a4"
    },
    {
      "id": "2fe1ea91-ba20-370b-81b3-2faf885a8d18",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.79"
    },
    {
      "id": "3c49370e-83a2-3dd4-a18e-565d0b5df09b",
      "product": {
        "name": "Linux"
      },
      "product_version": "d9b40ebd448e437ffbc65f013836f98252279a82 <d9c217fadfcff7a8df58567517d1e4253f3fd243"
    },
    {
      "id": "3cca5e3f-eef4-3e06-94f2-3a7bd7c9af4e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "4d4125e2-5359-3fc5-bc0f-70a4b7465d5c",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <852805b6cbdb69c298a8fc9fbe79994c95106e04"
    },
    {
      "id": "4df8d44e-ffc1-3bc0-b01b-7b0874333a86",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <0fb534187d2355f6c8f995321e76d1ccd1262ac1"
    },
    {
      "id": "521c242c-c069-3ea1-89e6-88fcebb7d698",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <8783ceeee797d9aa9cfe150690fb9d0bac8cc459"
    },
    {
      "id": "5e6c3c49-5c67-3f89-898c-40de3d60af24",
      "product": {
        "name": "Linux"
      },
      "product_version": "7560c02bdffb7c52d1457fa551b9e745d4b9e754 <6bb05a33337b2c842373857b63de5c9bf1ae2a09"
    },
    {
      "id": "5f274887-f978-343a-afff-151ca1242cf7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.179"
    },
    {
      "id": "7af6bab5-61c7-34e1-a18c-25536514cf27",
      "product": {
        "name": "Linux"
      },
      "product_version": "193e14e68e907b2a7a936a7726accbaa4df25a4d"
    },
    {
      "id": "7d1aa2cd-d4a0-3d4c-8441-2b6123b7d1d9",
      "product": {
        "name": "Linux"
      },
      "product_version": "155d3c5d24ee13cafa6236b49fc02b240a511d59"
    },
    {
      "id": "7f2ccd8c-26e7-331d-9d08-c40f87bfa8fd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.16"
    },
    {
      "id": "8df9b659-7be3-3456-907c-b48acc6f7c5b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "90ee0db0-ec7e-3daa-8069-df8ece28e27f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.4"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "10245e12-79e5-3364-9ded-6b8a799c2350",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}