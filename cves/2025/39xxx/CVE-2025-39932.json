{
  "id": "EUVD-2025-32398",
  "enisaUuid": "53de27e8-ae74-3e07-ab04-7eb81502b4d7",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: let smbd_destroy() call disable_work_sync(&info->post_send_credits_work)\n\nIn smbd_destroy() we may destroy the memory so we better\nwait until post_send_credits_work is no longer pending\nand will never be started again.\n\nI actually just hit the case using rxe:\n\nWARNING: CPU: 0 PID: 138 at drivers/infiniband/sw/rxe/rxe_verbs.c:1032 rxe_post_recv+0x1ee/0x480 [rdma_rxe]\n...\n[ 5305.686979] [    T138]  smbd_post_recv+0x445/0xc10 [cifs]\n[ 5305.687135] [    T138]  ? srso_alias_return_thunk+0x5/0xfbef5\n[ 5305.687149] [    T138]  ? __kasan_check_write+0x14/0x30\n[ 5305.687185] [    T138]  ? __pfx_smbd_post_recv+0x10/0x10 [cifs]\n[ 5305.687329] [    T138]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10\n[ 5305.687356] [    T138]  ? srso_alias_return_thunk+0x5/0xfbef5\n[ 5305.687368] [    T138]  ? srso_alias_return_thunk+0x5/0xfbef5\n[ 5305.687378] [    T138]  ? _raw_spin_unlock_irqrestore+0x11/0x60\n[ 5305.687389] [    T138]  ? srso_alias_return_thunk+0x5/0xfbef5\n[ 5305.687399] [    T138]  ? get_receive_buffer+0x168/0x210 [cifs]\n[ 5305.687555] [    T138]  smbd_post_send_credits+0x382/0x4b0 [cifs]\n[ 5305.687701] [    T138]  ? __pfx_smbd_post_send_credits+0x10/0x10 [cifs]\n[ 5305.687855] [    T138]  ? __pfx___schedule+0x10/0x10\n[ 5305.687865] [    T138]  ? __pfx__raw_spin_lock_irq+0x10/0x10\n[ 5305.687875] [    T138]  ? queue_delayed_work_on+0x8e/0xa0\n[ 5305.687889] [    T138]  process_one_work+0x629/0xf80\n[ 5305.687908] [    T138]  ? srso_alias_return_thunk+0x5/0xfbef5\n[ 5305.687917] [    T138]  ? __kasan_check_write+0x14/0x30\n[ 5305.687933] [    T138]  worker_thread+0x87f/0x1570\n...\n\nIt means rxe_post_recv was called after rdma_destroy_qp().\nThis happened because put_receive_buffer() was triggered\nby ib_drain_qp() and called:\nqueue_work(info->workqueue, &info->post_send_credits_work);",
  "datePublished": "Oct 4, 2025, 7:30:56 AM",
  "dateUpdated": "Oct 4, 2025, 7:30:56 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39932",
    "https://git.kernel.org/stable/c/3fabb1236f2e3ad78d531be0a4ad9f4a4ccdda87",
    "https://git.kernel.org/stable/c/6ae90a2baf923e85eb037b636aa641250bf4220f",
    "https://git.kernel.org/stable/c/d9dcbbcf9145b68aa85c40947311a6907277e097"
  ],
  "aliases": [
    "CVE-2025-39932",
    "GHSA-ww7h-mcjr-5643"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "074f00e3-c3f5-3976-8b7b-a4d101a555c4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "459428ef-fe60-3ed1-928e-19fe2bb85e5a",
      "product": {
        "name": "Linux"
      },
      "product_version": "f198186aa9bbd60fae7a2061f4feec614d880299 <3fabb1236f2e3ad78d531be0a4ad9f4a4ccdda87"
    },
    {
      "id": "6f60a641-996b-397c-84af-2568b0ce5f5e",
      "product": {
        "name": "Linux"
      },
      "product_version": "f198186aa9bbd60fae7a2061f4feec614d880299 <6ae90a2baf923e85eb037b636aa641250bf4220f"
    },
    {
      "id": "aaa969a1-c6c2-338e-b8a9-4c855bfa0f04",
      "product": {
        "name": "Linux"
      },
      "product_version": "f198186aa9bbd60fae7a2061f4feec614d880299 <d9dcbbcf9145b68aa85c40947311a6907277e097"
    },
    {
      "id": "b3deb18b-25be-3af3-8289-0597743c3304",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.9"
    },
    {
      "id": "e0821851-0428-38c1-b692-a639ecfdfe1f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "e8c42f5c-41f4-3bdf-892a-e1fb4e03f240",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.16"
    },
    {
      "id": "ea82cd29-8cba-3eee-8922-5674a806df90",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.49"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "feb5399b-b8a8-3b48-a773-65f4af9a4a66",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39932"
}