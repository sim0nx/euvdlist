{
  "id": "EUVD-2025-8492",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/vt-d: Fix suspicious RCU usage\n\nCommit <d74169ceb0d2> (\"iommu/vt-d: Allocate DMAR fault interrupts\nlocally\") moved the call to enable_drhd_fault_handling() to a code\npath that does not hold any lock while traversing the drhd list. Fix\nit by ensuring the dmar_global_lock lock is held when traversing the\ndrhd list.\n\nWithout this fix, the following warning is triggered:\n =============================\n WARNING: suspicious RCU usage\n 6.14.0-rc3 #55 Not tainted\n -----------------------------\n drivers/iommu/intel/dmar.c:2046 RCU-list traversed in non-reader section!!\n               other info that might help us debug this:\n               rcu_scheduler_active = 1, debug_locks = 1\n 2 locks held by cpuhp/1/23:\n #0: ffffffff84a67c50 (cpu_hotplug_lock){++++}-{0:0}, at: cpuhp_thread_fun+0x87/0x2c0\n #1: ffffffff84a6a380 (cpuhp_state-up){+.+.}-{0:0}, at: cpuhp_thread_fun+0x87/0x2c0\n stack backtrace:\n CPU: 1 UID: 0 PID: 23 Comm: cpuhp/1 Not tainted 6.14.0-rc3 #55\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0xb7/0xd0\n  lockdep_rcu_suspicious+0x159/0x1f0\n  ? __pfx_enable_drhd_fault_handling+0x10/0x10\n  enable_drhd_fault_handling+0x151/0x180\n  cpuhp_invoke_callback+0x1df/0x990\n  cpuhp_thread_fun+0x1ea/0x2c0\n  smpboot_thread_fn+0x1f5/0x2e0\n  ? __pfx_smpboot_thread_fn+0x10/0x10\n  kthread+0x12a/0x2d0\n  ? __pfx_kthread+0x10/0x10\n  ret_from_fork+0x4a/0x60\n  ? __pfx_kthread+0x10/0x10\n  ret_from_fork_asm+0x1a/0x30\n  </TASK>\n\nHolding the lock in enable_drhd_fault_handling() triggers a lockdep splat\nabout a possible deadlock between dmar_global_lock and cpu_hotplug_lock.\nThis is avoided by not holding dmar_global_lock when calling\niommu_device_register(), which initiates the device probe process.",
  "datePublished": "Mar 27, 2025, 2:57:06 PM",
  "dateUpdated": "May 4, 2025, 7:23:02 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-21876",
    "https://git.kernel.org/stable/c/4117c72938493a77ab53cc4b8284be8fb6ec8065",
    "https://git.kernel.org/stable/c/b150654f74bf0df8e6a7936d5ec51400d9ec06d8",
    "https://git.kernel.org/stable/c/c603ccbe91d189849e1439134598ec567088dcec"
  ],
  "aliases": [
    "CVE-2025-21876",
    "GHSA-23g4-q58q-5pxc"
  ],
  "assigner": "Linux",
  "epss": 0.0,
  "enisaIdProduct": [
    {
      "id": "03a9bd3c-e2c0-3416-b4e9-049d67b786e6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.6"
    },
    {
      "id": "3ab94a3d-c129-30ec-9767-e67f6ea5acfb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "764f7eed-9420-3f67-8607-667cff218f4a",
      "product": {
        "name": "Linux"
      },
      "product_version": "d74169ceb0d2e32438946a2f1f9fc8c803304bd6 <c603ccbe91d189849e1439134598ec567088dcec"
    },
    {
      "id": "8c48c633-65c5-37c7-af9e-68a32bcc53be",
      "product": {
        "name": "Linux"
      },
      "product_version": "d74169ceb0d2e32438946a2f1f9fc8c803304bd6 <4117c72938493a77ab53cc4b8284be8fb6ec8065"
    },
    {
      "id": "980eb008-0609-3c00-966f-07891bda2799",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.10"
    },
    {
      "id": "c81363bb-8038-3248-8cbf-ce31386f5dbb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "cdf05852-9214-3820-823d-81560ea0439a",
      "product": {
        "name": "Linux"
      },
      "product_version": "d74169ceb0d2e32438946a2f1f9fc8c803304bd6 <b150654f74bf0df8e6a7936d5ec51400d9ec06d8"
    },
    {
      "id": "e080746a-f614-38d0-b9dd-e29a7e0ef8dd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.18"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "1e19a53f-af95-338f-9337-7f6716e5d26b",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-21876"
}
