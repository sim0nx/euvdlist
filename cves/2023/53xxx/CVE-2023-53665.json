{
  "id": "EUVD-2025-31974",
  "enisaUuid": "36503cce-1987-344c-ab3c-3943a469d2c1",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmd: don't dereference mddev after export_rdev()\n\nExcept for initial reference, mddev->kobject is referenced by\nrdev->kobject, and if the last rdev is freed, there is no guarantee that\nmddev is still valid. Hence mddev should not be used anymore after\nexport_rdev().\n\nThis problem can be triggered by following test for mdadm at very\nlow rate:\n\nNew file: mdadm/tests/23rdev-lifetime\n\ndevname=${dev0##*/}\ndevt=`cat /sys/block/$devname/dev`\npid=\"\"\nruntime=2\n\nclean_up_test() {\n        pill -9 $pid\n        echo clear > /sys/block/md0/md/array_state\n}\n\ntrap 'clean_up_test' EXIT\n\nadd_by_sysfs() {\n        while true; do\n                echo $devt > /sys/block/md0/md/new_dev\n        done\n}\n\nremove_by_sysfs(){\n        while true; do\n                echo remove > /sys/block/md0/md/dev-${devname}/state\n        done\n}\n\necho md0 > /sys/module/md_mod/parameters/new_array || die \"create md0 failed\"\n\nadd_by_sysfs &\npid=\"$pid $!\"\n\nremove_by_sysfs &\npid=\"$pid $!\"\n\nsleep $runtime\nexit 0\n\nTest cmd:\n\n./test --save-logs --logdir=/tmp/ --keep-going --dev=loop --tests=23rdev-lifetime\n\nTest result:\n\ngeneral protection fault, probably for non-canonical address 0x6b6b6b6b6b6b6bcb: 0000 [#4] PREEMPT SMP\nCPU: 0 PID: 1292 Comm: test Tainted: G      D W          6.5.0-rc2-00121-g01e55c376936 #562\nRIP: 0010:md_wakeup_thread+0x9e/0x320 [md_mod]\nCall Trace:\n <TASK>\n mddev_unlock+0x1b6/0x310 [md_mod]\n rdev_attr_store+0xec/0x190 [md_mod]\n sysfs_kf_write+0x52/0x70\n kernfs_fop_write_iter+0x19a/0x2a0\n vfs_write+0x3b5/0x770\n ksys_write+0x74/0x150\n __x64_sys_write+0x22/0x30\n do_syscall_64+0x40/0x90\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nFix this problem by don't dereference mddev after export_rdev().",
  "datePublished": "Oct 7, 2025, 3:21:23 PM",
  "dateUpdated": "Oct 7, 2025, 3:21:23 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53665",
    "https://git.kernel.org/stable/c/7deac114be5fb25a4e865212ed0feaf5f85f2a28",
    "https://git.kernel.org/stable/c/ad430ad0669d2757377373390d68e1454fc7a344"
  ],
  "aliases": [
    "CVE-2023-53665",
    "GHSA-3wc5-j3q5-m2xc"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "1004763b-9237-3e42-8dce-5b9f1efd767d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6"
    },
    {
      "id": "1c2cb364-9698-3879-a4b5-cfb3d65bb8bf",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.5.5"
    },
    {
      "id": "6945df47-0938-3b20-aa41-3a9c1185b1fb",
      "product": {
        "name": "Linux"
      },
      "product_version": "3ce94ce5d05ae89190a23f6187f64d8f4b2d3782 <ad430ad0669d2757377373390d68e1454fc7a344"
    },
    {
      "id": "7371dc7b-9e67-368b-bf51-1d106a4a5f09",
      "product": {
        "name": "Linux"
      },
      "product_version": "3ce94ce5d05ae89190a23f6187f64d8f4b2d3782 <7deac114be5fb25a4e865212ed0feaf5f85f2a28"
    },
    {
      "id": "84a7f919-fca7-330d-a25a-eec3d63264e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "8b3f30bc-c070-3f86-be8a-903e68dc028c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.5"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "260dd854-1598-32f0-a3fa-d23be56b69bb",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2023-53665"
}