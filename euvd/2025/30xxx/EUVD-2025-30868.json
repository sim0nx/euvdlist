{
  "id": "EUVD-2025-30868",
  "enisaUuid": "207589dd-3fce-3857-bbaa-12c74b112315",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm/damon/sysfs: fix use-after-free in state_show()\n\nstate_show() reads kdamond->damon_ctx without holding damon_sysfs_lock. \nThis allows a use-after-free race:\n\nCPU 0                         CPU 1\n-----                         -----\nstate_show()                  damon_sysfs_turn_damon_on()\nctx = kdamond->damon_ctx;     mutex_lock(&damon_sysfs_lock);\n                              damon_destroy_ctx(kdamond->damon_ctx);\n                              kdamond->damon_ctx = NULL;\n                              mutex_unlock(&damon_sysfs_lock);\ndamon_is_running(ctx);        /* ctx is freed */\nmutex_lock(&ctx->kdamond_lock); /* UAF */\n\n(The race can also occur with damon_sysfs_kdamonds_rm_dirs() and\ndamon_sysfs_kdamond_release(), which free or replace the context under\ndamon_sysfs_lock.)\n\nFix by taking damon_sysfs_lock before dereferencing the context, mirroring\nthe locking used in pid_show().\n\nThe bug has existed since state_show() first accessed kdamond->damon_ctx.",
  "datePublished": "Sep 23, 2025, 6:00:48 AM",
  "dateUpdated": "Sep 29, 2025, 6:01:35 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39877",
    "https://git.kernel.org/stable/c/26d29b2ac87a2989071755f9828ebf839b560d4c",
    "https://git.kernel.org/stable/c/3260a3f0828e06f5f13fac69fb1999a6d60d9cff",
    "https://git.kernel.org/stable/c/3858c44341ad49dc7544b19cc9f9ecffaa7cc50e",
    "https://git.kernel.org/stable/c/4e87f461d61959647464a94d11ae15c011be58ce",
    "https://git.kernel.org/stable/c/60d7a3d2b985a395318faa1d88da6915fad11c19"
  ],
  "aliases": [
    "CVE-2025-39877",
    "GHSA-46f8-9r54-mw7h"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "026c3d61-ac07-3b60-8d04-b74dd114d494",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.107"
    },
    {
      "id": "36eb7f97-7dc9-3eec-b4a1-1102e98b1b6a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.48"
    },
    {
      "id": "407d60a7-24fd-3a89-b6e3-503fdb3d8169",
      "product": {
        "name": "Linux"
      },
      "product_version": "a61ea561c87139992fe32afdee48a6f6b85d824a <60d7a3d2b985a395318faa1d88da6915fad11c19"
    },
    {
      "id": "4a15db16-993e-31e5-b71f-c3677a27618d",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.18"
    },
    {
      "id": "53ad5b1c-2958-3373-a69e-6cd1d89f85ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "573a7886-70e9-34c8-a7f8-09a893d5caa6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.153"
    },
    {
      "id": "653c8fe1-708b-3082-a9ad-d8ae09b9d68a",
      "product": {
        "name": "Linux"
      },
      "product_version": "a61ea561c87139992fe32afdee48a6f6b85d824a <26d29b2ac87a2989071755f9828ebf839b560d4c"
    },
    {
      "id": "8657393d-58b6-3534-9071-8878a3238992",
      "product": {
        "name": "Linux"
      },
      "product_version": "a61ea561c87139992fe32afdee48a6f6b85d824a <4e87f461d61959647464a94d11ae15c011be58ce"
    },
    {
      "id": "90259f37-37e8-38b9-9631-c42294cec79e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc6"
    },
    {
      "id": "aa7e1e98-bad3-32b8-afd5-063d85f5d422",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "adf7348f-8469-329f-8352-bfb646156838",
      "product": {
        "name": "Linux"
      },
      "product_version": "a61ea561c87139992fe32afdee48a6f6b85d824a <3858c44341ad49dc7544b19cc9f9ecffaa7cc50e"
    },
    {
      "id": "fe02356b-bd24-391f-b860-faa8a8e36cd8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.8"
    },
    {
      "id": "ffb3fadf-5052-31d2-a046-cad6c020e823",
      "product": {
        "name": "Linux"
      },
      "product_version": "a61ea561c87139992fe32afdee48a6f6b85d824a <3260a3f0828e06f5f13fac69fb1999a6d60d9cff"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "f852a8e0-0a22-3d9e-95f6-cc052f917cb7",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}