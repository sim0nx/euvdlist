{
  "id": "EUVD-2025-30357",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmm: slub: avoid wake up kswapd in set_track_prepare\n\nset_track_prepare() can incur lock recursion.\nThe issue is that it is called from hrtimer_start_range_ns\nholding the per_cpu(hrtimer_bases)[n].lock, but when enabled\nCONFIG_DEBUG_OBJECTS_TIMERS, may wake up kswapd in set_track_prepare,\nand try to hold the per_cpu(hrtimer_bases)[n].lock.\n\nAvoid deadlock caused by implicitly waking up kswapd by passing in\nallocation flags, which do not contain __GFP_KSWAPD_RECLAIM in the\ndebug_objects_fill_pool() case. Inside stack depot they are processed by\ngfp_nested_mask().\nSince ___slab_alloc() has preemption disabled, we mask out\n__GFP_DIRECT_RECLAIM from the flags there.\n\nThe oops looks something like:\n\nBUG: spinlock recursion on CPU#3, swapper/3/0\n lock: 0xffffff8a4bf29c80, .magic: dead4ead, .owner: swapper/3/0, .owner_cpu: 3\nHardware name: Qualcomm Technologies, Inc. Popsicle based on SM8850 (DT)\nCall trace:\nspin_bug+0x0\n_raw_spin_lock_irqsave+0x80\nhrtimer_try_to_cancel+0x94\ntask_contending+0x10c\nenqueue_dl_entity+0x2a4\ndl_server_start+0x74\nenqueue_task_fair+0x568\nenqueue_task+0xac\ndo_activate_task+0x14c\nttwu_do_activate+0xcc\ntry_to_wake_up+0x6c8\ndefault_wake_function+0x20\nautoremove_wake_function+0x1c\n__wake_up+0xac\nwakeup_kswapd+0x19c\nwake_all_kswapds+0x78\n__alloc_pages_slowpath+0x1ac\n__alloc_pages_noprof+0x298\nstack_depot_save_flags+0x6b0\nstack_depot_save+0x14\nset_track_prepare+0x5c\n___slab_alloc+0xccc\n__kmalloc_cache_noprof+0x470\n__set_page_owner+0x2bc\npost_alloc_hook[jt]+0x1b8\nprep_new_page+0x28\nget_page_from_freelist+0x1edc\n__alloc_pages_noprof+0x13c\nalloc_slab_page+0x244\nallocate_slab+0x7c\n___slab_alloc+0x8e8\nkmem_cache_alloc_noprof+0x450\ndebug_objects_fill_pool+0x22c\ndebug_object_activate+0x40\nenqueue_hrtimer[jt]+0xdc\nhrtimer_start_range_ns+0x5f8\n...",
  "datePublished": "Sep 19, 2025, 3:26:17 PM",
  "dateUpdated": "Sep 29, 2025, 6:00:52 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/994b03b9605d36d814c611385fbf90ca6db20aa8",
    "https://git.kernel.org/stable/c/522ffe298627cfe72539d72167c2e20e72b5e856",
    "https://git.kernel.org/stable/c/243b705a90ed8449f561a271cf251fd2e939f3db",
    "https://git.kernel.org/stable/c/eb3240ffd243bfb8b1e9dc568d484ecf9fd660ab",
    "https://git.kernel.org/stable/c/850470a8413a8a78e772c4f6bd9fe81ec6bd5b0f",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39843"
  ],
  "aliases": [
    "CVE-2025-39843"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "058f3e07-6457-3cf0-a34c-4629d5ce38c4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "19e18fa0-9446-3b4a-b00a-e213dd0267ce",
      "product": {
        "name": "Linux"
      },
      "product_version": "5cf909c553e9efed573811de4b3f5172898d5515 <243b705a90ed8449f561a271cf251fd2e939f3db"
    },
    {
      "id": "2fe71d9d-e7d6-3b3a-9f56-88f0a0047a1b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc5"
    },
    {
      "id": "33aadfaf-13cd-3882-b0f7-1e1d09c18b05",
      "product": {
        "name": "Linux"
      },
      "product_version": "5cf909c553e9efed573811de4b3f5172898d5515 <994b03b9605d36d814c611385fbf90ca6db20aa8"
    },
    {
      "id": "37adb33f-9d62-3e12-9cd2-a64e73efc23d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.105"
    },
    {
      "id": "38b760c2-66a3-3ce7-80c7-b14521e6afc9",
      "product": {
        "name": "Linux"
      },
      "product_version": "5cf909c553e9efed573811de4b3f5172898d5515 <522ffe298627cfe72539d72167c2e20e72b5e856"
    },
    {
      "id": "626772c4-16b9-3db2-a0e0-fa23bd1bff82",
      "product": {
        "name": "Linux"
      },
      "product_version": "5cf909c553e9efed573811de4b3f5172898d5515 <850470a8413a8a78e772c4f6bd9fe81ec6bd5b0f"
    },
    {
      "id": "68af4adc-fdef-368f-b568-39bbd81620a8",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.19"
    },
    {
      "id": "7e077965-324e-3af8-bfb9-8d6980cdcb21",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.151"
    },
    {
      "id": "8dc6c56b-8e54-35df-abb5-267b94d6afef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.46"
    },
    {
      "id": "a1448326-609c-395d-b8b0-e1579a8d14ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "5cf909c553e9efed573811de4b3f5172898d5515 <eb3240ffd243bfb8b1e9dc568d484ecf9fd660ab"
    },
    {
      "id": "b64ed287-af47-30b5-88c0-e1b8dd548f28",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "f48a33a7-2d68-364d-99d1-709e0c09f8cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.6"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "45a3ab30-0eca-3f0f-8e21-4b9977fc1e33",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39843"
}