{
  "id": "EUVD-2025-22867",
  "enisaUuid": "b3d96e74-358f-3ea9-b03c-a512a1447f86",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm-bufio: fix sched in atomic context\n\nIf \"try_verify_in_tasklet\" is set for dm-verity, DM_BUFIO_CLIENT_NO_SLEEP\nis enabled for dm-bufio. However, when bufio tries to evict buffers, there\nis a chance to trigger scheduling in spin_lock_bh, the following warning\nis hit:\n\nBUG: sleeping function called from invalid context at drivers/md/dm-bufio.c:2745\nin_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 123, name: kworker/2:2\npreempt_count: 201, expected: 0\nRCU nest depth: 0, expected: 0\n4 locks held by kworker/2:2/123:\n #0: ffff88800a2d1548 ((wq_completion)dm_bufio_cache){....}-{0:0}, at: process_one_work+0xe46/0x1970\n #1: ffffc90000d97d20 ((work_completion)(&dm_bufio_replacement_work)){....}-{0:0}, at: process_one_work+0x763/0x1970\n #2: ffffffff8555b528 (dm_bufio_clients_lock){....}-{3:3}, at: do_global_cleanup+0x1ce/0x710\n #3: ffff88801d5820b8 (&c->spinlock){....}-{2:2}, at: do_global_cleanup+0x2a5/0x710\nPreemption disabled at:\n[<0000000000000000>] 0x0\nCPU: 2 UID: 0 PID: 123 Comm: kworker/2:2 Not tainted 6.16.0-rc3-g90548c634bd0 #305 PREEMPT(voluntary)\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014\nWorkqueue: dm_bufio_cache do_global_cleanup\nCall Trace:\n <TASK>\n dump_stack_lvl+0x53/0x70\n __might_resched+0x360/0x4e0\n do_global_cleanup+0x2f5/0x710\n process_one_work+0x7db/0x1970\n worker_thread+0x518/0xea0\n kthread+0x359/0x690\n ret_from_fork+0xf3/0x1b0\n ret_from_fork_asm+0x1a/0x30\n </TASK>\n\nThat can be reproduced by:\n\n  veritysetup format --data-block-size=4096 --hash-block-size=4096 /dev/vda /dev/vdb\n  SIZE=$(blockdev --getsz /dev/vda)\n  dmsetup create myverity -r --table \"0 $SIZE verity 1 /dev/vda /dev/vdb 4096 4096 <data_blocks> 1 sha256 <root_hash> <salt> 1 try_verify_in_tasklet\"\n  mount /dev/dm-0 /mnt -o ro\n  echo 102400 > /sys/module/dm_bufio/parameters/max_cache_size_bytes\n  [read files in /mnt]",
  "datePublished": "Jul 28, 2025, 11:22:05 AM",
  "dateUpdated": "Jul 28, 2025, 11:22:05 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/469a39a33a9934af157299bf11c58f6e6cb53f85",
    "https://git.kernel.org/stable/c/68860d1ade385eef9fcdbf6552f061283091fdb8",
    "https://git.kernel.org/stable/c/3edfdb1d4ef81320dae0caa40bc24baf8c1bbb86",
    "https://git.kernel.org/stable/c/b1bf1a782fdf5c482215c0c661b5da98b8e75773"
  ],
  "aliases": [
    "CVE-2025-38496"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "14984266-1c33-3374-b985-fd8d66d83829",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.8"
    },
    {
      "id": "153c9c3a-f111-3f05-aee2-fe69ca0a8ea7",
      "product": {
        "name": "Linux"
      },
      "product_version": "450e8dee51aa6fa1dd0f64073e88235f1a77b035 <3edfdb1d4ef81320dae0caa40bc24baf8c1bbb86"
    },
    {
      "id": "44030cfe-0b61-3507-ae51-982d451e27b0",
      "product": {
        "name": "Linux"
      },
      "product_version": "450e8dee51aa6fa1dd0f64073e88235f1a77b035 <b1bf1a782fdf5c482215c0c661b5da98b8e75773"
    },
    {
      "id": "6fc72b5e-f1c4-3853-ad2f-fa922c470dd0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "84240e73-9c04-3598-89d4-173af1cb0326",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.100"
    },
    {
      "id": "bc3c7a89-aca3-32eb-b32a-426c0e379819",
      "product": {
        "name": "Linux"
      },
      "product_version": "450e8dee51aa6fa1dd0f64073e88235f1a77b035 <68860d1ade385eef9fcdbf6552f061283091fdb8"
    },
    {
      "id": "c71a72e9-07e5-3d10-9cf8-4661cc809043",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.4"
    },
    {
      "id": "e551d52a-2d9c-3d18-8303-d8fb31adc7cf",
      "product": {
        "name": "Linux"
      },
      "product_version": "450e8dee51aa6fa1dd0f64073e88235f1a77b035 <469a39a33a9934af157299bf11c58f6e6cb53f85"
    },
    {
      "id": "ee35edc6-0ea7-308a-8e9c-107d302af539",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "f4dbbc22-aa7c-3b80-9846-059b19daab1a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.40"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "4e82057d-f529-3849-ae5c-20a5f910306d",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38496"
}