{
  "id": "EUVD-2022-55245",
  "enisaUuid": "62aecf1e-2bdb-31af-a04c-2aa798bf8799",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/i915/ttm: fix CCS handling\n\nCrucible + recent Mesa seems to sometimes hit:\n\nGEM_BUG_ON(num_ccs_blks > NUM_CCS_BLKS_PER_XFER)\n\nAnd it looks like we can also trigger this with gem_lmem_swapping, if we\nmodify the test to use slightly larger object sizes.\n\nLooking closer it looks like we have the following issues in\nmigrate_copy():\n\n  - We are using plain integer in various places, which we can easily\n    overflow with a large object.\n\n  - We pass the entire object size (when the src is lmem) into\n    emit_pte() and then try to copy it, which doesn't work, since we\n    only have a few fixed sized windows in which to map the pages and\n    perform the copy. With an object > 8M we therefore aren't properly\n    copying the pages. And then with an object > 64M we trigger the\n    GEM_BUG_ON(num_ccs_blks > NUM_CCS_BLKS_PER_XFER).\n\nSo it looks like our copy handling for any object > 8M (which is our\nCHUNK_SZ) is currently broken on DG2.\n\nTestcase: igt@gem_lmem_swapping\n(cherry picked from commit 8676145eb2f53a9940ff70910caf0125bd8a4bc2)",
  "datePublished": "Jun 18, 2025, 11:00:24 AM",
  "dateUpdated": "Jun 18, 2025, 11:00:24 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/97434cb55bd884bd268626ec41489f79b261b2d4",
    "https://git.kernel.org/stable/c/8d905254162965c8e6be697d82c7dbf5d08f574d"
  ],
  "aliases": [
    "CVE-2022-49963"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "01f52bcf-9ce1-3709-affb-7de1a6a6b9c3",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.19"
    },
    {
      "id": "08be4a84-07ab-3186-8072-5c5afb0160d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "da0595ae91da837929a00470ab40546090e5b9ae <97434cb55bd884bd268626ec41489f79b261b2d4"
    },
    {
      "id": "373b7c0f-fd8b-388b-baf7-ede01339ef52",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "b1f0a4ba-79be-3bc4-84e7-1830cad6d57b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.8"
    },
    {
      "id": "bbdbddb7-96f9-34a0-b979-dbe1957e7520",
      "product": {
        "name": "Linux"
      },
      "product_version": "da0595ae91da837929a00470ab40546090e5b9ae <8d905254162965c8e6be697d82c7dbf5d08f574d"
    },
    {
      "id": "f6e25228-0142-3905-aa47-c03f9299714b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "650deeef-ea79-3f13-ba70-15f8fd9a71ad",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49963"
}