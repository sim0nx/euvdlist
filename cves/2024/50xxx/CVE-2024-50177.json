{
  "id": "EUVD-2024-44679",
  "enisaUuid": "8db63f7f-6085-3346-bf90-464f5d74c4f0",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/amd/display: fix a UBSAN warning in DML2.1\n\nWhen programming phantom pipe, since cursor_width is explicity set to 0,\nthis causes calculation logic to trigger overflow for an unsigned int\ntriggering the kernel's UBSAN check as below:\n\n[   40.962845] UBSAN: shift-out-of-bounds in /tmp/amd.EfpumTkO/amd/amdgpu/../display/dc/dml2/dml21/src/dml2_core/dml2_core_dcn4_calcs.c:3312:34\n[   40.962849] shift exponent 4294967170 is too large for 32-bit type 'unsigned int'\n[   40.962852] CPU: 1 PID: 1670 Comm: gnome-shell Tainted: G        W  OE      6.5.0-41-generic #41~22.04.2-Ubuntu\n[   40.962854] Hardware name: Gigabyte Technology Co., Ltd. X670E AORUS PRO X/X670E AORUS PRO X, BIOS F21 01/10/2024\n[   40.962856] Call Trace:\n[   40.962857]  <TASK>\n[   40.962860]  dump_stack_lvl+0x48/0x70\n[   40.962870]  dump_stack+0x10/0x20\n[   40.962872]  __ubsan_handle_shift_out_of_bounds+0x1ac/0x360\n[   40.962878]  calculate_cursor_req_attributes.cold+0x1b/0x28 [amdgpu]\n[   40.963099]  dml_core_mode_support+0x6b91/0x16bc0 [amdgpu]\n[   40.963327]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.963331]  ? CalculateWatermarksMALLUseAndDRAMSpeedChangeSupport+0x18b8/0x2790 [amdgpu]\n[   40.963534]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.963536]  ? dml_core_mode_support+0xb3db/0x16bc0 [amdgpu]\n[   40.963730]  dml2_core_calcs_mode_support_ex+0x2c/0x90 [amdgpu]\n[   40.963906]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.963909]  ? dml2_core_calcs_mode_support_ex+0x2c/0x90 [amdgpu]\n[   40.964078]  core_dcn4_mode_support+0x72/0xbf0 [amdgpu]\n[   40.964247]  dml2_top_optimization_perform_optimization_phase+0x1d3/0x2a0 [amdgpu]\n[   40.964420]  dml2_build_mode_programming+0x23d/0x750 [amdgpu]\n[   40.964587]  dml21_validate+0x274/0x770 [amdgpu]\n[   40.964761]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.964763]  ? resource_append_dpp_pipes_for_plane_composition+0x27c/0x3b0 [amdgpu]\n[   40.964942]  dml2_validate+0x504/0x750 [amdgpu]\n[   40.965117]  ? dml21_copy+0x95/0xb0 [amdgpu]\n[   40.965291]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.965295]  dcn401_validate_bandwidth+0x4e/0x70 [amdgpu]\n[   40.965491]  update_planes_and_stream_state+0x38d/0x5c0 [amdgpu]\n[   40.965672]  update_planes_and_stream_v3+0x52/0x1e0 [amdgpu]\n[   40.965845]  ? srso_alias_return_thunk+0x5/0x7f\n[   40.965849]  dc_update_planes_and_stream+0x71/0xb0 [amdgpu]\n\nFix this by adding a guard for checking cursor width before triggering\nthe size calculation.",
  "datePublished": "Nov 8, 2024, 5:23:59 AM",
  "dateUpdated": "Oct 1, 2025, 8:27:10 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/27bc3da5eae57e3af8f5648b4498ffde48781434",
    "https://git.kernel.org/stable/c/eaf3adb8faab611ba57594fa915893fc93a7788c"
  ],
  "aliases": [
    "CVE-2024-50177"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "012b91e2-f1a3-333b-8810-92ff38bd4bee",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "194a9ed8-4b52-3568-86dd-3fa5fdd1aea0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.3"
    },
    {
      "id": "2f339194-0453-3742-928c-e171f9cc9da5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12"
    },
    {
      "id": "3352ffd1-423c-33e8-b570-24414f04d4e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.11"
    },
    {
      "id": "6c0826f1-f757-3ab3-8564-440d8b8e52e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "70839da6360500a82e4d5f78499284474cbed7c1 <eaf3adb8faab611ba57594fa915893fc93a7788c"
    },
    {
      "id": "6fb6f7c2-6599-31a2-bbf4-a00ddea4922a",
      "product": {
        "name": "Linux"
      },
      "product_version": "70839da6360500a82e4d5f78499284474cbed7c1 <27bc3da5eae57e3af8f5648b4498ffde48781434"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "b12c4fd5-3571-3242-8746-4657f45031aa",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2024-50177"
}