{
  "id": "EUVD-2021-34655",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nASoC: soc-compress: prevent the potentially use of null pointer\n\nThere is one call trace that snd_soc_register_card()\n->snd_soc_bind_card()->soc_init_pcm_runtime()\n->snd_soc_dai_compress_new()->snd_soc_new_compress().\nIn the trace the 'codec_dai' transfers from card->dai_link,\nand we can see from the snd_soc_add_pcm_runtime() in\nsnd_soc_bind_card() that, if value of card->dai_link->num_codecs\nis 0, then 'codec_dai' could be null pointer caused\nby index out of bound in 'asoc_rtd_to_codec(rtd, 0)'.\nAnd snd_soc_register_card() is called by various platforms.\nTherefore, it is better to add the check in the case of misusing.\nAnd because 'cpu_dai' has already checked in soc_init_pcm_runtime(),\nthere is no need to check again.\nAdding the check as follow, then if 'codec_dai' is null,\nsnd_soc_new_compress() will not pass through the check\n'if (playback + capture != 1)', avoiding the leftover use of\n'codec_dai'.",
  "datePublished": "Feb 26, 2025, 1:54:17 AM",
  "dateUpdated": "Feb 26, 2025, 1:54:17 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/68a69ad8df959e5211ed4a8e120783b2d352ea74",
    "https://git.kernel.org/stable/c/4639c1d97f385f4784f44d66a3da0672f4951ada",
    "https://git.kernel.org/stable/c/fc237b8d624f4bcb0f21a532627ce4e3b3a85569",
    "https://git.kernel.org/stable/c/08af6da684b44097ea09f1d74d5858b837ed203b",
    "https://git.kernel.org/stable/c/f69a75cb8a98c6c487d620442c68595726a69f60",
    "https://git.kernel.org/stable/c/de2c6f98817fa5decb9b7d3b3a8a3ab864c10588"
  ],
  "aliases": [
    "CVE-2021-47650"
  ],
  "assigner": "Linux",
  "epss": 0.06,
  "enisaIdProduct": [
    {
      "id": "297d7029-4f7c-37fc-9bfd-a96ec9454c56",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.4"
    },
    {
      "id": "40c357ae-f4ff-38a5-8118-5811eef5ba2b",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <fc237b8d624f4bcb0f21a532627ce4e3b3a85569"
    },
    {
      "id": "65845c81-f7f2-3a74-81d4-a3519720a467",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.189"
    },
    {
      "id": "74270f83-aeb1-3836-82c3-08c4875111f3",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <68a69ad8df959e5211ed4a8e120783b2d352ea74"
    },
    {
      "id": "81734882-5efb-3d8e-b5c8-81e358461022",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <de2c6f98817fa5decb9b7d3b3a8a3ab864c10588"
    },
    {
      "id": "83203408-9cbc-3ec9-bdfc-c43940bc2fe6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.19"
    },
    {
      "id": "b1f1a88a-2931-3c58-8ac4-14ae84e84161",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <f69a75cb8a98c6c487d620442c68595726a69f60"
    },
    {
      "id": "bb2a4d5c-539e-3a09-8146-feb225e13344",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "bdec591c-adaf-3cf6-8c03-df9f8bca2e95",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <4639c1d97f385f4784f44d66a3da0672f4951ada"
    },
    {
      "id": "bfec0495-4388-3ae7-b686-5ee911b789bf",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.2"
    },
    {
      "id": "ce87b75c-af8c-3d8f-8cc6-5f30aefc25a5",
      "product": {
        "name": "Linux"
      },
      "product_version": "467fece8fbc6774a3a3bd0981e1a342fb5022706 <08af6da684b44097ea09f1d74d5858b837ed203b"
    },
    {
      "id": "d00e53d3-d9d8-3ce8-9928-a6b2810464e9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.33"
    },
    {
      "id": "e145043d-1778-31b5-9a23-6eaa4adcd9f1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.110"
    },
    {
      "id": "f9479b89-be92-3f22-82a4-3c365f518756",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "68b4b108-068d-3432-acf8-f85b4e73927e",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2021-47650"
}
