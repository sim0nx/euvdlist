{
  "id": "EUVD-2025-12860",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: L2CAP: fix use-after-free in l2cap_conn_del()\n\nWhen l2cap_recv_frame() is invoked to receive data, and the cid is\nL2CAP_CID_A2MP, if the channel does not exist, it will create a channel.\nHowever, after a channel is created, the hold operation of the channel\nis not performed. In this case, the value of channel reference counting\nis 1. As a result, after hci_error_reset() is triggered, l2cap_conn_del()\ninvokes the close hook function of A2MP to release the channel. Then\n l2cap_chan_unlock(chan) will trigger UAF issue.\n\nThe process is as follows:\nReceive data:\nl2cap_data_channel()\n    a2mp_channel_create()  --->channel ref is 2\n    l2cap_chan_put()       --->channel ref is 1\n\nTriger event:\n    hci_error_reset()\n        hci_dev_do_close()\n        ...\n        l2cap_disconn_cfm()\n            l2cap_conn_del()\n                l2cap_chan_hold()    --->channel ref is 2\n                l2cap_chan_del()     --->channel ref is 1\n                a2mp_chan_close_cb() --->channel ref is 0, release channel\n                l2cap_chan_unlock()  --->UAF of channel\n\nThe detailed Call Trace is as follows:\nBUG: KASAN: use-after-free in __mutex_unlock_slowpath+0xa6/0x5e0\nRead of size 8 at addr ffff8880160664b8 by task kworker/u11:1/7593\nWorkqueue: hci0 hci_error_reset\nCall Trace:\n <TASK>\n dump_stack_lvl+0xcd/0x134\n print_report.cold+0x2ba/0x719\n kasan_report+0xb1/0x1e0\n kasan_check_range+0x140/0x190\n __mutex_unlock_slowpath+0xa6/0x5e0\n l2cap_conn_del+0x404/0x7b0\n l2cap_disconn_cfm+0x8c/0xc0\n hci_conn_hash_flush+0x11f/0x260\n hci_dev_close_sync+0x5f5/0x11f0\n hci_dev_do_close+0x2d/0x70\n hci_error_reset+0x9e/0x140\n process_one_work+0x98a/0x1620\n worker_thread+0x665/0x1080\n kthread+0x2e4/0x3a0\n ret_from_fork+0x1f/0x30\n </TASK>\n\nAllocated by task 7593:\n kasan_save_stack+0x1e/0x40\n __kasan_kmalloc+0xa9/0xd0\n l2cap_chan_create+0x40/0x930\n amp_mgr_create+0x96/0x990\n a2mp_channel_create+0x7d/0x150\n l2cap_recv_frame+0x51b8/0x9a70\n l2cap_recv_acldata+0xaa3/0xc00\n hci_rx_work+0x702/0x1220\n process_one_work+0x98a/0x1620\n worker_thread+0x665/0x1080\n kthread+0x2e4/0x3a0\n ret_from_fork+0x1f/0x30\n\nFreed by task 7593:\n kasan_save_stack+0x1e/0x40\n kasan_set_track+0x21/0x30\n kasan_set_free_info+0x20/0x30\n ____kasan_slab_free+0x167/0x1c0\n slab_free_freelist_hook+0x89/0x1c0\n kfree+0xe2/0x580\n l2cap_chan_put+0x22a/0x2d0\n l2cap_conn_del+0x3fc/0x7b0\n l2cap_disconn_cfm+0x8c/0xc0\n hci_conn_hash_flush+0x11f/0x260\n hci_dev_close_sync+0x5f5/0x11f0\n hci_dev_do_close+0x2d/0x70\n hci_error_reset+0x9e/0x140\n process_one_work+0x98a/0x1620\n worker_thread+0x665/0x1080\n kthread+0x2e4/0x3a0\n ret_from_fork+0x1f/0x30\n\nLast potentially related work creation:\n kasan_save_stack+0x1e/0x40\n __kasan_record_aux_stack+0xbe/0xd0\n call_rcu+0x99/0x740\n netlink_release+0xe6a/0x1cf0\n __sock_release+0xcd/0x280\n sock_close+0x18/0x20\n __fput+0x27c/0xa90\n task_work_run+0xdd/0x1a0\n exit_to_user_mode_prepare+0x23c/0x250\n syscall_exit_to_user_mode+0x19/0x50\n do_syscall_64+0x42/0x80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nSecond to last potentially related work creation:\n kasan_save_stack+0x1e/0x40\n __kasan_record_aux_stack+0xbe/0xd0\n call_rcu+0x99/0x740\n netlink_release+0xe6a/0x1cf0\n __sock_release+0xcd/0x280\n sock_close+0x18/0x20\n __fput+0x27c/0xa90\n task_work_run+0xdd/0x1a0\n exit_to_user_mode_prepare+0x23c/0x250\n syscall_exit_to_user_mode+0x19/0x50\n do_syscall_64+0x42/0x80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd",
  "datePublished": "May 1, 2025, 2:10:52 PM",
  "dateUpdated": "May 4, 2025, 12:45:25 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49909",
    "https://git.kernel.org/stable/c/0d0e2d032811280b927650ff3c15fe5020e82533",
    "https://git.kernel.org/stable/c/17c6164854f8bb80bf76f32b2c2f199c16b53703",
    "https://git.kernel.org/stable/c/7f7bfdd9a9af3b12c33d9da9a012e7f4d5c91f4b",
    "https://git.kernel.org/stable/c/8f7e4cf0694149a5d999d676ebd9ecf1b4cb2cc9",
    "https://git.kernel.org/stable/c/a3a7b2ac64de232edb67279e804932cb42f0b52a",
    "https://git.kernel.org/stable/c/c1f594dddd9ffd747c39f49cc5b67a9b7677d2ab",
    "https://git.kernel.org/stable/c/d9ec6e2fbd4a565b2345d4852f586b7ae3ab41fd",
    "https://git.kernel.org/stable/c/db4a0783ed78beb2ebaa32f5f785bfd79c580689"
  ],
  "aliases": [
    "CVE-2022-49909",
    "GHSA-2f6p-9573-fp98"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "03989ee8-b08a-3a4c-8a21-c2353e48609a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "259d7670-1480-3e2f-a0b0-829877a1d5cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "098e07ef0059296e710a801cdbd74b59016e6624 <c1f594dddd9ffd747c39f49cc5b67a9b7677d2ab"
    },
    {
      "id": "2d824361-1853-3589-8345-20515c987d57",
      "product": {
        "name": "Linux"
      },
      "product_version": "de5d4654ac6c22b1be756fdf7db18471e7df01ea <d9ec6e2fbd4a565b2345d4852f586b7ae3ab41fd"
    },
    {
      "id": "3ac0d173-f94c-3932-b143-0ede5701b1ec",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.333"
    },
    {
      "id": "3f25f768-2faf-3cdc-92e5-0ffe0ff1e7aa",
      "product": {
        "name": "Linux"
      },
      "product_version": "d255c861e268ba342e855244639a15f12d7a0bf2 <db4a0783ed78beb2ebaa32f5f785bfd79c580689"
    },
    {
      "id": "3f52605b-cb81-3635-9b59-df070b5c98a0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.224"
    },
    {
      "id": "52b98089-51c9-3495-8855-dcfdb008359c",
      "product": {
        "name": "Linux"
      },
      "product_version": "5bb395334392891dffae5a0e8f37dbe1d70496c9 <17c6164854f8bb80bf76f32b2c2f199c16b53703"
    },
    {
      "id": "562ed77b-835e-308e-afaf-3c4307ffbf41",
      "product": {
        "name": "Linux"
      },
      "product_version": "f32d5615a78a1256c4f557ccc6543866e75d03f4 <a3a7b2ac64de232edb67279e804932cb42f0b52a"
    },
    {
      "id": "59bf367c-9beb-38c5-8276-93cc6ce8b337",
      "product": {
        "name": "Linux"
      },
      "product_version": "59a55ec33a54a7179fa178f8aaf8b1cb8e63bd93"
    },
    {
      "id": "5dc47802-dd84-3bdc-8567-77771b6de4d9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.8"
    },
    {
      "id": "7982d7bd-6589-3e66-9dfa-357975fe8317",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.265"
    },
    {
      "id": "895810cc-39df-3282-ad00-ab562685e3bb",
      "product": {
        "name": "Linux"
      },
      "product_version": "d0be8347c623e0ac4202a1d4e0373882821f56b0 <0d0e2d032811280b927650ff3c15fe5020e82533"
    },
    {
      "id": "95e8d400-71e5-3604-b29e-e45ed836a9c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.154"
    },
    {
      "id": "9e3a68dc-e133-3b8d-b023-a8e8930b9f5b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.78"
    },
    {
      "id": "a2744379-04de-369a-8c70-ba2b8e9cca04",
      "product": {
        "name": "Linux"
      },
      "product_version": "bbd1fdb0e1adf827997a93bf108f20ede038e56e <7f7bfdd9a9af3b12c33d9da9a012e7f4d5c91f4b"
    },
    {
      "id": "a50417bf-3b8d-3f5c-be7d-b2ca56bd8ba6",
      "product": {
        "name": "Linux"
      },
      "product_version": "d0be8347c623e0ac4202a1d4e0373882821f56b0 <8f7e4cf0694149a5d999d676ebd9ecf1b4cb2cc9"
    },
    {
      "id": "cbb57922-5342-36fb-a0ad-1d651d2f9e3f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "e52e19b1-a669-3e63-bd67-bce30fa11f1f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.299"
    },
    {
      "id": "ea498ead-9e8c-3702-9185-d87d08729be1",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.19"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "6083ebd6-bc05-3570-9ea9-1661de599b93",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49909"
}
