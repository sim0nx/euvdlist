{
  "id": "EUVD-2025-11232",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nidpf: fix adapter NULL pointer dereference on reboot\n\nWith SRIOV enabled, idpf ends up calling into idpf_remove() twice.\nFirst via idpf_shutdown() and then again when idpf_remove() calls into\nsriov_disable(), because the VF devices use the idpf driver, hence the\nsame remove routine. When that happens, it is possible for the adapter\nto be NULL from the first call to idpf_remove(), leading to a NULL\npointer dereference.\n\necho 1 > /sys/class/net/<netif>/device/sriov_numvfs\nreboot\n\nBUG: kernel NULL pointer dereference, address: 0000000000000020\n...\nRIP: 0010:idpf_remove+0x22/0x1f0 [idpf]\n...\n? idpf_remove+0x22/0x1f0 [idpf]\n? idpf_remove+0x1e4/0x1f0 [idpf]\npci_device_remove+0x3f/0xb0\ndevice_release_driver_internal+0x19f/0x200\npci_stop_bus_device+0x6d/0x90\npci_stop_and_remove_bus_device+0x12/0x20\npci_iov_remove_virtfn+0xbe/0x120\nsriov_disable+0x34/0xe0\nidpf_sriov_configure+0x58/0x140 [idpf]\nidpf_remove+0x1b9/0x1f0 [idpf]\nidpf_shutdown+0x12/0x30 [idpf]\npci_device_shutdown+0x35/0x60\ndevice_shutdown+0x156/0x200\n...\n\nReplace the direct idpf_remove() call in idpf_shutdown() with\nidpf_vc_core_deinit() and idpf_deinit_dflt_mbx(), which perform\nthe bulk of the cleanup, such as stopping the init task, freeing IRQs,\ndestroying the vports and freeing the mailbox. This avoids the calls to\nsriov_disable() in addition to a small netdev cleanup, and destroying\nworkqueues, which don't seem to be required on shutdown.",
  "datePublished": "Apr 16, 2025, 3:34:42 PM",
  "dateUpdated": "May 6, 2025, 6:30:36 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-22065",
    "https://git.kernel.org/stable/c/4c9106f4906a85f6b13542d862e423bcdc118cc3",
    "https://git.kernel.org/stable/c/79618e952ef4dfa1a17ee0631d5549603fab58d8",
    "https://git.kernel.org/stable/c/88a6d562e92a295648f8636acf2a6aa714241771",
    "https://git.kernel.org/stable/c/9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6"
  ],
  "aliases": [
    "CVE-2025-22065",
    "GHSA-r2xg-g23x-9jj5"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "030891ce-ca10-3645-9cb3-57e8240678ca",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.11"
    },
    {
      "id": "1618b613-d384-3d68-a4ad-19925dea3f2c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.7"
    },
    {
      "id": "39331404-19ef-3177-a236-29e5aa7ab8dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "e850efed5e152e6bdd367d5b82019f21298c0653 <9fc9b3dc0d0c189ed205acf1e5fbd73e0becc4d6"
    },
    {
      "id": "4153283b-f575-33a6-908b-cfec7e55c771",
      "product": {
        "name": "Linux"
      },
      "product_version": "e850efed5e152e6bdd367d5b82019f21298c0653 <4c9106f4906a85f6b13542d862e423bcdc118cc3"
    },
    {
      "id": "68bf0c6a-8a16-383d-be7b-045c6a028ae8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.23"
    },
    {
      "id": "84487f79-a1a4-3b6b-9c24-3c91efd4adb1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.2"
    },
    {
      "id": "9ec29b0b-0a9f-364d-b4bd-55cce5c15b7f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "aa66bd5d-0493-3ffa-bc9b-1e37aebb7890",
      "product": {
        "name": "Linux"
      },
      "product_version": "e850efed5e152e6bdd367d5b82019f21298c0653 <88a6d562e92a295648f8636acf2a6aa714241771"
    },
    {
      "id": "e675fc44-c8cb-33fe-8ec5-22322b83fb9c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15-rc1"
    },
    {
      "id": "fc449373-d3a9-3925-922b-9d68945bd120",
      "product": {
        "name": "Linux"
      },
      "product_version": "e850efed5e152e6bdd367d5b82019f21298c0653 <79618e952ef4dfa1a17ee0631d5549603fab58d8"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "33da3d32-596f-3d36-b780-55aa07d32809",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-22065"
}
