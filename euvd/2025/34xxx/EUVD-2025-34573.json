{
  "id": "EUVD-2025-34573",
  "enisaUuid": "aa6a815c-2d76-3a68-ac52-afe93f87b939",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: rtw89: fix use-after-free in rtw89_core_tx_kick_off_and_wait()\n\nThere is a bug observed when rtw89_core_tx_kick_off_and_wait() tries to\naccess already freed skb_data:\n\n BUG: KFENCE: use-after-free write in rtw89_core_tx_kick_off_and_wait drivers/net/wireless/realtek/rtw89/core.c:1110\n\n CPU: 6 UID: 0 PID: 41377 Comm: kworker/u64:24 Not tainted  6.17.0-rc1+ #1 PREEMPT(lazy)\n Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS edk2-20250523-14.fc42 05/23/2025\n Workqueue: events_unbound cfg80211_wiphy_work [cfg80211]\n\n Use-after-free write at 0x0000000020309d9d (in kfence-#251):\n rtw89_core_tx_kick_off_and_wait drivers/net/wireless/realtek/rtw89/core.c:1110\n rtw89_core_scan_complete drivers/net/wireless/realtek/rtw89/core.c:5338\n rtw89_hw_scan_complete_cb drivers/net/wireless/realtek/rtw89/fw.c:7979\n rtw89_chanctx_proceed_cb drivers/net/wireless/realtek/rtw89/chan.c:3165\n rtw89_chanctx_proceed drivers/net/wireless/realtek/rtw89/chan.h:141\n rtw89_hw_scan_complete drivers/net/wireless/realtek/rtw89/fw.c:8012\n rtw89_mac_c2h_scanofld_rsp drivers/net/wireless/realtek/rtw89/mac.c:5059\n rtw89_fw_c2h_work drivers/net/wireless/realtek/rtw89/fw.c:6758\n process_one_work kernel/workqueue.c:3241\n worker_thread kernel/workqueue.c:3400\n kthread kernel/kthread.c:463\n ret_from_fork arch/x86/kernel/process.c:154\n ret_from_fork_asm arch/x86/entry/entry_64.S:258\n\n kfence-#251: 0x0000000056e2393d-0x000000009943cb62, size=232, cache=skbuff_head_cache\n\n allocated by task 41377 on cpu 6 at 77869.159548s (0.009551s ago):\n __alloc_skb net/core/skbuff.c:659\n __netdev_alloc_skb net/core/skbuff.c:734\n ieee80211_nullfunc_get net/mac80211/tx.c:5844\n rtw89_core_send_nullfunc drivers/net/wireless/realtek/rtw89/core.c:3431\n rtw89_core_scan_complete drivers/net/wireless/realtek/rtw89/core.c:5338\n rtw89_hw_scan_complete_cb drivers/net/wireless/realtek/rtw89/fw.c:7979\n rtw89_chanctx_proceed_cb drivers/net/wireless/realtek/rtw89/chan.c:3165\n rtw89_chanctx_proceed drivers/net/wireless/realtek/rtw89/chan.c:3194\n rtw89_hw_scan_complete drivers/net/wireless/realtek/rtw89/fw.c:8012\n rtw89_mac_c2h_scanofld_rsp drivers/net/wireless/realtek/rtw89/mac.c:5059\n rtw89_fw_c2h_work drivers/net/wireless/realtek/rtw89/fw.c:6758\n process_one_work kernel/workqueue.c:3241\n worker_thread kernel/workqueue.c:3400\n kthread kernel/kthread.c:463\n ret_from_fork arch/x86/kernel/process.c:154\n ret_from_fork_asm arch/x86/entry/entry_64.S:258\n\n freed by task 1045 on cpu 9 at 77869.168393s (0.001557s ago):\n ieee80211_tx_status_skb net/mac80211/status.c:1117\n rtw89_pci_release_txwd_skb drivers/net/wireless/realtek/rtw89/pci.c:564\n rtw89_pci_release_tx_skbs.isra.0 drivers/net/wireless/realtek/rtw89/pci.c:651\n rtw89_pci_release_tx drivers/net/wireless/realtek/rtw89/pci.c:676\n rtw89_pci_napi_poll drivers/net/wireless/realtek/rtw89/pci.c:4238\n __napi_poll net/core/dev.c:7495\n net_rx_action net/core/dev.c:7557 net/core/dev.c:7684\n handle_softirqs kernel/softirq.c:580\n do_softirq.part.0 kernel/softirq.c:480\n __local_bh_enable_ip kernel/softirq.c:407\n rtw89_pci_interrupt_threadfn drivers/net/wireless/realtek/rtw89/pci.c:927\n irq_thread_fn kernel/irq/manage.c:1133\n irq_thread kernel/irq/manage.c:1257\n kthread kernel/kthread.c:463\n ret_from_fork arch/x86/kernel/process.c:154\n ret_from_fork_asm arch/x86/entry/entry_64.S:258\n\nIt is a consequence of a race between the waiting and the signaling side\nof the completion:\n\n            Waiting thread                            Completing thread\n\nrtw89_core_tx_kick_off_and_wait()\n  rcu_assign_pointer(skb_data->wait, wait)\n  /* start waiting */\n  wait_for_completion_timeout()\n                                                rtw89_pci_tx_status()\n                                                  rtw89_core_tx_wait_complete()\n                                                    rcu_read_lock()\n                                                    /* signals completion and\n   \n---truncated---",
  "datePublished": "Oct 15, 2025, 9:30:17 AM",
  "dateUpdated": "Oct 15, 2025, 9:30:17 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/895cccf639ac015f3d5f993218cf098db82ac145",
    "https://git.kernel.org/stable/c/f21f530b03b4b23448edb531a0cfea434cb76bb4",
    "https://git.kernel.org/stable/c/bdb3c41b358cf87d99e39d393e164f9e4a6088e6",
    "https://git.kernel.org/stable/c/3e31a6bc07312b448fad3b45de578471f86f0e77",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-40000"
  ],
  "aliases": [
    "CVE-2025-40000"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "2a512303-0b60-35d2-bb56-72f00ecd9c80",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17.1"
    },
    {
      "id": "2a8ef8ae-6933-348b-aa72-739ebbb98807",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ae5ca615285d5d4f72d1de464716d85dffef19f <bdb3c41b358cf87d99e39d393e164f9e4a6088e6"
    },
    {
      "id": "3f7bdc77-72c8-3848-afa3-3347e3fff529",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ae5ca615285d5d4f72d1de464716d85dffef19f <3e31a6bc07312b448fad3b45de578471f86f0e77"
    },
    {
      "id": "44e0c3d4-ef8d-3e46-aa55-aa59532a3f71",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.4"
    },
    {
      "id": "504d6e3c-a1b9-3736-ac32-7ccb8ca0f751",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.12"
    },
    {
      "id": "a5411dd7-352e-3f07-9bdc-e4da4d89e29b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.52"
    },
    {
      "id": "d006e474-6a35-3930-a651-ff5136918d9d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18-rc1"
    },
    {
      "id": "d6413ad0-82e5-3e0d-83ca-9b407bac4bec",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "e51eba84-8c91-3018-bc2b-d07fdb8f8148",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ae5ca615285d5d4f72d1de464716d85dffef19f <895cccf639ac015f3d5f993218cf098db82ac145"
    },
    {
      "id": "e994783e-4b5b-32ec-ac8a-7a38cc288294",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ae5ca615285d5d4f72d1de464716d85dffef19f <f21f530b03b4b23448edb531a0cfea434cb76bb4"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "940a20b6-3983-3f49-a5f5-650a4cfcf934",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}