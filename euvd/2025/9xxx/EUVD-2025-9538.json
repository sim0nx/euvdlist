{
  "id": "EUVD-2025-9538",
  "enisaUuid": "61b439e3-3aa9-3f2c-86c4-e27cfa2f8174",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nx86/microcode/AMD: Fix out-of-bounds on systems with CPU-less NUMA nodes\n\nCurrently, load_microcode_amd() iterates over all NUMA nodes, retrieves their\nCPU masks and unconditionally accesses per-CPU data for the first CPU of each\nmask.\n\nAccording to Documentation/admin-guide/mm/numaperf.rst:\n\n  \"Some memory may share the same node as a CPU, and others are provided as\n  memory only nodes.\"\n\nTherefore, some node CPU masks may be empty and wouldn't have a \"first CPU\".\n\nOn a machine with far memory (and therefore CPU-less NUMA nodes):\n- cpumask_of_node(nid) is 0\n- cpumask_first(0) is CONFIG_NR_CPUS\n- cpu_data(CONFIG_NR_CPUS) accesses the cpu_info per-CPU array at an\n  index that is 1 out of bounds\n\nThis does not have any security implications since flashing microcode is\na privileged operation but I believe this has reliability implications by\npotentially corrupting memory while flashing a microcode update.\n\nWhen booting with CONFIG_UBSAN_BOUNDS=y on an AMD machine that flashes\na microcode update. I get the following splat:\n\n  UBSAN: array-index-out-of-bounds in arch/x86/kernel/cpu/microcode/amd.c:X:Y\n  index 512 is out of range for type 'unsigned long[512]'\n  [...]\n  Call Trace:\n   dump_stack\n   __ubsan_handle_out_of_bounds\n   load_microcode_amd\n   request_microcode_amd\n   reload_store\n   kernfs_fop_write_iter\n   vfs_write\n   ksys_write\n   do_syscall_64\n   entry_SYSCALL_64_after_hwframe\n\nChange the loop to go over only NUMA nodes which have CPUs before determining\nwhether the first CPU on the respective node needs microcode update.\n\n  [ bp: Massage commit message, fix typo. ]",
  "datePublished": "Apr 2, 2025, 12:53:14 PM",
  "dateUpdated": "Oct 1, 2025, 5:13:42 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-21991",
    "https://git.kernel.org/stable/c/488ffc0cac38f203979f83634236ee53251ce593",
    "https://git.kernel.org/stable/c/5ac295dfccb5b015493f86694fa13a0dde4d3665",
    "https://git.kernel.org/stable/c/e3e89178a9f4a80092578af3ff3c8478f9187d59",
    "https://git.kernel.org/stable/c/e686349cc19e800dac8971929089ba5ff59abfb0",
    "https://git.kernel.org/stable/c/ec52240622c4d218d0240079b7c1d3ec2328a9f4",
    "https://git.kernel.org/stable/c/d509c4731090ebd9bbdb72c70a2d70003ae81f4f",
    "https://git.kernel.org/stable/c/985a536e04bbfffb1770df43c6470f635a6b1073",
    "https://git.kernel.org/stable/c/18b5d857c6496b78ead2fd10001b81ae32d30cac"
  ],
  "aliases": [
    "CVE-2025-21991",
    "GHSA-vp9x-33x6-jvvm"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "013d8167-0ccd-3dfa-be94-219c57a34c65",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.132"
    },
    {
      "id": "15840df3-91be-3c95-bdbb-8d15e203b873",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.84"
    },
    {
      "id": "2602450d-f35f-357c-a906-807d15075fe2",
      "product": {
        "name": "Linux"
      },
      "product_version": "44a44b57e88f311c1415be1f567c50050913c149 <985a536e04bbfffb1770df43c6470f635a6b1073"
    },
    {
      "id": "29d59379-63e5-395e-bd35-46480dde219f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "2c26776c-2eca-3960-b2ee-e2cb5255bcdf",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.20"
    },
    {
      "id": "393dd1ea-7617-390e-b21c-3e4bfbb24bfd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.236"
    },
    {
      "id": "515b5090-6c84-3a24-ae17-2eef5a790083",
      "product": {
        "name": "Linux"
      },
      "product_version": "979e197968a1e8f09bf0d706801dba4432f85ab3 <d509c4731090ebd9bbdb72c70a2d70003ae81f4f"
    },
    {
      "id": "69b4b36c-8445-3b1d-b721-39d181e28b22",
      "product": {
        "name": "Linux"
      },
      "product_version": "7ff6edf4fef38ab404ee7861f257e28eaaeed35f <5ac295dfccb5b015493f86694fa13a0dde4d3665"
    },
    {
      "id": "6a498b47-0537-3299-ab74-08897a531aad",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.3"
    },
    {
      "id": "6e4df187-64fb-3cae-8691-6cbcb01335ab",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "704bb4f2-21c6-386c-a657-47684115ae23",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.292"
    },
    {
      "id": "71b5ccf8-2afa-3f09-bf81-6dec99fc3d6c",
      "product": {
        "name": "Linux"
      },
      "product_version": "eaf5dea1eb8c2928554b3ca717575cbe232b843c"
    },
    {
      "id": "ad908d9c-17ca-3c2b-bedb-dcc01d289871",
      "product": {
        "name": "Linux"
      },
      "product_version": "7ff6edf4fef38ab404ee7861f257e28eaaeed35f <e3e89178a9f4a80092578af3ff3c8478f9187d59"
    },
    {
      "id": "b4045fac-0901-3e6a-95ee-ec921184056a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.180"
    },
    {
      "id": "b5e7d858-aa3f-32c7-b2e5-0118a3cb42aa",
      "product": {
        "name": "Linux"
      },
      "product_version": "d6353e2fc12c5b8f00f86efa30ed73d2da2f77be"
    },
    {
      "id": "c0cdd249-f705-3e6b-bdf1-05622850cff9",
      "product": {
        "name": "Linux"
      },
      "product_version": "be2710deaed3ab1402379a2ede30a3754fe6767a <18b5d857c6496b78ead2fd10001b81ae32d30cac"
    },
    {
      "id": "c577e92c-4491-3a91-aeea-1dcab258fb86",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.8"
    },
    {
      "id": "e6b9616a-eb79-3908-925d-d1672975757e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1b1e0eb1d2971a686b9f7bdc146115bcefcbb960"
    },
    {
      "id": "e9fd36e3-3fd6-34ac-a167-4ba8e5deb5ff",
      "product": {
        "name": "Linux"
      },
      "product_version": "7ff6edf4fef38ab404ee7861f257e28eaaeed35f <488ffc0cac38f203979f83634236ee53251ce593"
    },
    {
      "id": "f2e9d91b-1e6b-37bc-a854-3b231986e83b",
      "product": {
        "name": "Linux"
      },
      "product_version": "d576547f489c935b9897d4acf8beee3325dea8a5 <ec52240622c4d218d0240079b7c1d3ec2328a9f4"
    },
    {
      "id": "fa6c23bc-0fed-3e20-b5b7-72d2889ed46a",
      "product": {
        "name": "Linux"
      },
      "product_version": "7ff6edf4fef38ab404ee7861f257e28eaaeed35f <e686349cc19e800dac8971929089ba5ff59abfb0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7df78c5d-f3b8-3782-8dbd-0cd792b97bb7",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}