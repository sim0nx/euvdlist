{
  "id": "EUVD-2025-20053",
  "enisaUuid": "1cf44485-6360-3310-b86c-d364a8773a91",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\njfs: Fix null-ptr-deref in jfs_ioc_trim\n\n[ Syzkaller Report ]\n\nOops: general protection fault, probably for non-canonical address\n0xdffffc0000000087: 0000 [#1\nKASAN: null-ptr-deref in range [0x0000000000000438-0x000000000000043f]\nCPU: 2 UID: 0 PID: 10614 Comm: syz-executor.0 Not tainted\n6.13.0-rc6-gfbfd64d25c7a-dirty #1\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014\nSched_ext: serialise (enabled+all), task: runnable_at=-30ms\nRIP: 0010:jfs_ioc_trim+0x34b/0x8f0\nCode: e7 e8 59 a4 87 fe 4d 8b 24 24 4d 8d bc 24 38 04 00 00 48 8d 93\n90 82 fe ff 4c 89 ff 31 f6\nRSP: 0018:ffffc900055f7cd0 EFLAGS: 00010206\nRAX: 0000000000000087 RBX: 00005866a9e67ff8 RCX: 000000000000000a\nRDX: 0000000000000001 RSI: 0000000000000004 RDI: 0000000000000001\nRBP: dffffc0000000000 R08: ffff88807c180003 R09: 1ffff1100f830000\nR10: dffffc0000000000 R11: ffffed100f830001 R12: 0000000000000000\nR13: 0000000000000000 R14: 0000000000000001 R15: 0000000000000438\nFS:  00007fe520225640(0000) GS:ffff8880b7e80000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00005593c91b2c88 CR3: 000000014927c000 CR4: 00000000000006f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n<TASK>\n? __die_body+0x61/0xb0\n? die_addr+0xb1/0xe0\n? exc_general_protection+0x333/0x510\n? asm_exc_general_protection+0x26/0x30\n? jfs_ioc_trim+0x34b/0x8f0\njfs_ioctl+0x3c8/0x4f0\n? __pfx_jfs_ioctl+0x10/0x10\n? __pfx_jfs_ioctl+0x10/0x10\n__se_sys_ioctl+0x269/0x350\n? __pfx___se_sys_ioctl+0x10/0x10\n? do_syscall_64+0xfb/0x210\ndo_syscall_64+0xee/0x210\n? syscall_exit_to_user_mode+0x1e0/0x330\nentry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7fe51f4903ad\nCode: c3 e8 a7 2b 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48\n89 f7 48 89 d6 48 89 ca 4d\nRSP: 002b:00007fe5202250c8 EFLAGS: 00000246 ORIG_RAX: 0000000000000010\nRAX: ffffffffffffffda RBX: 00007fe51f5cbf80 RCX: 00007fe51f4903ad\nRDX: 0000000020000680 RSI: 00000000c0185879 RDI: 0000000000000005\nRBP: 0000000000000000 R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000246 R12: 00007fe520225640\nR13: 000000000000000e R14: 00007fe51f44fca0 R15: 00007fe52021d000\n</TASK>\nModules linked in:\n---[ end trace 0000000000000000 ]---\nRIP: 0010:jfs_ioc_trim+0x34b/0x8f0\nCode: e7 e8 59 a4 87 fe 4d 8b 24 24 4d 8d bc 24 38 04 00 00 48 8d 93\n90 82 fe ff 4c 89 ff 31 f6\nRSP: 0018:ffffc900055f7cd0 EFLAGS: 00010206\nRAX: 0000000000000087 RBX: 00005866a9e67ff8 RCX: 000000000000000a\nRDX: 0000000000000001 RSI: 0000000000000004 RDI: 0000000000000001\nRBP: dffffc0000000000 R08: ffff88807c180003 R09: 1ffff1100f830000\nR10: dffffc0000000000 R11: ffffed100f830001 R12: 0000000000000000\nR13: 0000000000000000 R14: 0000000000000001 R15: 0000000000000438\nFS:  00007fe520225640(0000) GS:ffff8880b7e80000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00005593c91b2c88 CR3: 000000014927c000 CR4: 00000000000006f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nKernel panic - not syncing: Fatal exception\n\n[ Analysis ]\n\nWe believe that we have found a concurrency bug in the `fs/jfs` module\nthat results in a null pointer dereference. There is a closely related\nissue which has been fixed:\n\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d6c1b3599b2feb5c7291f5ac3a36e5fa7cedb234\n\n... but, unfortunately, the accepted patch appears to still be\nsusceptible to a null pointer dereference under some interleavings.\n\nTo trigger the bug, we think that `JFS_SBI(ipbmap->i_sb)->bmap` is set\nto NULL in `dbFreeBits` and then dereferenced in `jfs_ioc_trim`. This\nbug manifests quite rarely under normal circumstances, but is\ntriggereable from a syz-program.",
  "datePublished": "Jul 4, 2025, 1:37:23 PM",
  "dateUpdated": "Jul 28, 2025, 4:14:59 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0d50231d473f89024158dc62624930de45d13718",
    "https://git.kernel.org/stable/c/a9d41c925069c950e18160e12a7e10e0f58c56fb",
    "https://git.kernel.org/stable/c/4a8cb9908b51500a76f5156423bd295df53bff89",
    "https://git.kernel.org/stable/c/9806ae34d7d661c372247cd36f83bfa0523d60ed",
    "https://git.kernel.org/stable/c/a4685408ff6c3e2af366ad9a7274f45ff3f394ee"
  ],
  "aliases": [
    "CVE-2025-38203"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1e555fcc-6117-3821-ad7b-ada57585efb2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a9d41c925069c950e18160e12a7e10e0f58c56fb"
    },
    {
      "id": "3b4c1441-1585-3c14-9dd2-7eeb55ad8dac",
      "product": {
        "name": "Linux"
      },
      "product_version": "b40c2e665cd552eae5fbdbb878bc29a34357668e <4a8cb9908b51500a76f5156423bd295df53bff89"
    },
    {
      "id": "4330eab8-ed6f-3ce5-8fb9-396db42f56bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.239"
    },
    {
      "id": "4ee274c5-4a13-3570-994a-2faa1f3b0c78",
      "product": {
        "name": "Linux"
      },
      "product_version": "b40c2e665cd552eae5fbdbb878bc29a34357668e <0d50231d473f89024158dc62624930de45d13718"
    },
    {
      "id": "519f955d-531e-3dcb-accf-07d8ec435b92",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a4685408ff6c3e2af366ad9a7274f45ff3f394ee"
    },
    {
      "id": "56414f00-c64a-3c0b-9076-b1e6a9a9da28",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.186"
    },
    {
      "id": "58ea5e44-a809-35ab-95b8-903916f4cc36",
      "product": {
        "name": "Linux"
      },
      "product_version": "b40c2e665cd552eae5fbdbb878bc29a34357668e <9806ae34d7d661c372247cd36f83bfa0523d60ed"
    },
    {
      "id": "5a378a6a-e4d3-30c3-9ec1-18005b9b5374",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "62d00778-1b06-381a-9c96-35bcd0e3436c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.4"
    },
    {
      "id": "64a11584-1f66-3f8e-94da-06ab21d1c814",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "8d962ac3-67f3-3581-a511-b7ded972400c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0d50231d473f89024158dc62624930de45d13718"
    },
    {
      "id": "a2a9ca1c-b81f-3bfe-b2f5-ced18cd23beb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.295"
    },
    {
      "id": "b5920ba3-2341-35cb-a964-773994d961a5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "c9b03e39-e0b9-3217-a3c1-122c1a346321",
      "product": {
        "name": "Linux"
      },
      "product_version": "b40c2e665cd552eae5fbdbb878bc29a34357668e <a9d41c925069c950e18160e12a7e10e0f58c56fb"
    },
    {
      "id": "de9e94f2-f07c-3d55-9c63-6d930ffc7735",
      "product": {
        "name": "Linux"
      },
      "product_version": "b40c2e665cd552eae5fbdbb878bc29a34357668e <a4685408ff6c3e2af366ad9a7274f45ff3f394ee"
    },
    {
      "id": "e74a8aaf-85c6-323b-ad87-b78d57e25f1b",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.7"
    },
    {
      "id": "e9494d9f-4392-3c76-b636-eee7d899f662",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4a8cb9908b51500a76f5156423bd295df53bff89"
    },
    {
      "id": "f54ba900-df55-3a07-83bd-8ce10d4a692a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9806ae34d7d661c372247cd36f83bfa0523d60ed"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "fda4df1a-284f-361a-9bf7-b728fae9cc48",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38203"
}