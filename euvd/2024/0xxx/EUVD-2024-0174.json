{
  "id": "EUVD-2024-0174",
  "enisaUuid": "7adf514b-f1f5-3420-b5c5-7a4d993af806",
  "description": "Vyper is a Pythonic Smart Contract Language for the EVM. There is an error in the stack management when compiling the `IR` for `sha3_64`. Concretely, the `height` variable is miscalculated. The vulnerability can't be triggered without writing the `IR` by hand (that is, it cannot be triggered from regular vyper code). `sha3_64` is used for retrieval in mappings. No flow that would cache the `key` was found so the issue shouldn't be possible to trigger when compiling the compiler-generated `IR`. This issue isn't triggered during normal compilation of vyper code so the impact is low. At the time of publication there is no patch available.",
  "datePublished": "Feb 5, 2024, 11:15:00 AM",
  "dateUpdated": "Nov 21, 2024, 4:23:02 AM",
  "baseScore": 3.7,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
  "references": [
    "https://github.com/vyperlang/vyper/security/advisories/GHSA-6845-xw22-ffxv",
    "https://github.com/vyperlang/vyper/blob/c150fc49ee9375a930d177044559b83cb95f7963/vyper/ir/compile_ir.py#L585-L586",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-24559",
    "https://github.com/vyperlang/vyper/pull/4063",
    "https://github.com/vyperlang/vyper/commit/d9f9fdadd81a148cbc68f02dbbbcdc0c92fad652",
    "https://github.com/pypa/advisory-database/tree/main/vulns/vyper/PYSEC-2024-147.yaml"
  ],
  "aliases": [
    "CVE-2024-24559",
    "GHSA-6845-xw22-ffxv",
    "PYSEC-2024-147"
  ],
  "assigner": "GitHub_M",
  "epss": 0.19,
  "enisaIdProduct": [
    {
      "id": "7e18a704-58e5-3a9e-ac5d-380b63d000a9",
      "product": {
        "name": "vyper"
      },
      "product_version": "\u2264 0.3.10"
    },
    {
      "id": "8ee35d07-ebf1-36f6-93d2-84faff377967",
      "product": {
        "name": "vyper"
      }
    }
  ],
  "enisaIdVendor": [
    {
      "id": "14962cc9-5b11-38ef-983d-3962c1def12f",
      "vendor": {
        "name": "vyperlang"
      }
    }
  ]
}