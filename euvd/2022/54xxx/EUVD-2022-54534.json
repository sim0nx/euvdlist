{
  "id": "EUVD-2022-54534",
  "enisaUuid": "83ad14ec-a7d7-308d-8a23-bd351ea953a8",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ibmvfc: Allocate/free queue resource only during probe/remove\n\nCurrently, the sub-queues and event pool resources are allocated/freed for\nevery CRQ connection event such as reset and LPM. This exposes the driver\nto a couple issues. First the inefficiency of freeing and reallocating\nmemory that can simply be resued after being sanitized. Further, a system\nunder memory pressue runs the risk of allocation failures that could result\nin a crippled driver. Finally, there is a race window where command\nsubmission/compeletion can try to pull/return elements from/to an event\npool that is being deleted or already has been deleted due to the lack of\nhost state around freeing/allocating resources. The following is an example\nof list corruption following a live partition migration (LPM):\n\nOops: Exception in kernel mode, sig: 5 [#1]\nLE PAGE_SIZE=64K MMU=Hash SMP NR_CPUS=2048 NUMA pSeries\nModules linked in: vfat fat isofs cdrom ext4 mbcache jbd2 nft_counter nft_compat nf_tables nfnetlink rpadlpar_io rpaphp xsk_diag nfsv3 nfs_acl nfs lockd grace fscache netfs rfkill bonding tls sunrpc pseries_rng drm drm_panel_orientation_quirks xfs libcrc32c dm_service_time sd_mod t10_pi sg ibmvfc scsi_transport_fc ibmveth vmx_crypto dm_multipath dm_mirror dm_region_hash dm_log dm_mod ipmi_devintf ipmi_msghandler fuse\nCPU: 0 PID: 2108 Comm: ibmvfc_0 Kdump: loaded Not tainted 5.14.0-70.9.1.el9_0.ppc64le #1\nNIP: c0000000007c4bb0 LR: c0000000007c4bac CTR: 00000000005b9a10\nREGS: c00000025c10b760 TRAP: 0700  Not tainted (5.14.0-70.9.1.el9_0.ppc64le)\nMSR: 800000000282b033 <SF,VEC,VSX,EE,FP,ME,IR,DR,RI,LE> CR: 2800028f XER: 0000000f\nCFAR: c0000000001f55bc IRQMASK: 0\n        GPR00: c0000000007c4bac c00000025c10ba00 c000000002a47c00 000000000000004e\n        GPR04: c0000031e3006f88 c0000031e308bd00 c00000025c10b768 0000000000000027\n        GPR08: 0000000000000000 c0000031e3009dc0 00000031e0eb0000 0000000000000000\n        GPR12: c0000031e2ffffa8 c000000002dd0000 c000000000187108 c00000020fcee2c0\n        GPR16: 0000000000000000 0000000000000000 0000000000000000 0000000000000000\n        GPR20: 0000000000000000 0000000000000000 0000000000000000 c008000002f81300\n        GPR24: 5deadbeef0000100 5deadbeef0000122 c000000263ba6910 c00000024cc88000\n        GPR28: 000000000000003c c0000002430a0000 c0000002430ac300 000000000000c300\nNIP [c0000000007c4bb0] __list_del_entry_valid+0x90/0x100\nLR [c0000000007c4bac] __list_del_entry_valid+0x8c/0x100\nCall Trace:\n[c00000025c10ba00] [c0000000007c4bac] __list_del_entry_valid+0x8c/0x100 (unreliable)\n[c00000025c10ba60] [c008000002f42284] ibmvfc_free_queue+0xec/0x210 [ibmvfc]\n[c00000025c10bb10] [c008000002f4246c] ibmvfc_deregister_scsi_channel+0xc4/0x160 [ibmvfc]\n[c00000025c10bba0] [c008000002f42580] ibmvfc_release_sub_crqs+0x78/0x130 [ibmvfc]\n[c00000025c10bc20] [c008000002f4f6cc] ibmvfc_do_work+0x5c4/0xc70 [ibmvfc]\n[c00000025c10bce0] [c008000002f4fdec] ibmvfc_work+0x74/0x1e8 [ibmvfc]\n[c00000025c10bda0] [c0000000001872b8] kthread+0x1b8/0x1c0\n[c00000025c10be10] [c00000000000cd64] ret_from_kernel_thread+0x5c/0x64\nInstruction dump:\n40820034 38600001 38210060 4e800020 7c0802a6 7c641b78 3c62fe7a 7d254b78\n3863b590 f8010070 4ba309cd 60000000 <0fe00000> 7c0802a6 3c62fe7a 3863b640\n---[ end trace 11a2b65a92f8b66c ]---\nibmvfc 30000003: Send warning. Receive queue closed, will retry.\n\nAdd registration/deregistration helpers that are called instead during\nconnection resets to sanitize and reconfigure the queues.",
  "datePublished": "Feb 26, 2025, 2:24:21 AM",
  "dateUpdated": "Feb 26, 2025, 2:24:21 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/161ec2a0807ddd58bc0f24f3e1e7e3d4fef5297f",
    "https://git.kernel.org/stable/c/9f23c499ca601b2a1e1d2e761d03964b739bca0e",
    "https://git.kernel.org/stable/c/72ea7fe0db73d65c7d977208842d8ade9b823de9"
  ],
  "aliases": [
    "CVE-2022-49701"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "116d3ddb-b8b6-356d-8aed-c7ed396e55f9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "262ffdc0-5403-31ef-8be4-3a0da83976b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.51"
    },
    {
      "id": "7129d503-8b1a-3e29-a316-3831f85bb238",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.12"
    },
    {
      "id": "93816187-7b7a-3780-b711-c57d18cdda85",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.8"
    },
    {
      "id": "a5e155b1-c867-3d6d-ad90-dc79c3491405",
      "product": {
        "name": "Linux"
      },
      "product_version": "3034ebe26389740bb6b4a463e05afb51dc93c336 <161ec2a0807ddd58bc0f24f3e1e7e3d4fef5297f"
    },
    {
      "id": "a9ce26a0-d441-3463-b9da-fe371475519a",
      "product": {
        "name": "Linux"
      },
      "product_version": "3034ebe26389740bb6b4a463e05afb51dc93c336 <9f23c499ca601b2a1e1d2e761d03964b739bca0e"
    },
    {
      "id": "cf598dd8-eb05-3430-8d9a-2067426e021d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "fa10e974-6ee2-3792-9127-43ebcfa4fbbe",
      "product": {
        "name": "Linux"
      },
      "product_version": "3034ebe26389740bb6b4a463e05afb51dc93c336 <72ea7fe0db73d65c7d977208842d8ade9b823de9"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "4a93d7be-5b1a-3f4b-9cb2-7330593a8e0a",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}