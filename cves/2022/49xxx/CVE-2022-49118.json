{
  "id": "EUVD-2022-55096",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: hisi_sas: Free irq vectors in order for v3 HW\n\nIf the driver probe fails to request the channel IRQ or fatal IRQ, the\ndriver will free the IRQ vectors before freeing the IRQs in free_irq(),\nand this will cause a kernel BUG like this:\n\n------------[ cut here ]------------\nkernel BUG at drivers/pci/msi.c:369!\nInternal error: Oops - BUG: 0 [#1] PREEMPT SMP\nCall trace:\n   free_msi_irqs+0x118/0x13c\n   pci_disable_msi+0xfc/0x120\n   pci_free_irq_vectors+0x24/0x3c\n   hisi_sas_v3_probe+0x360/0x9d0 [hisi_sas_v3_hw]\n   local_pci_probe+0x44/0xb0\n   work_for_cpu_fn+0x20/0x34\n   process_one_work+0x1d0/0x340\n   worker_thread+0x2e0/0x460\n   kthread+0x180/0x190\n   ret_from_fork+0x10/0x20\n---[ end trace b88990335b610c11 ]---\n\nSo we use devm_add_action() to control the order in which we free the\nvectors.",
  "datePublished": "Feb 26, 2025, 1:55:00 AM",
  "dateUpdated": "Mar 26, 2025, 5:44:53 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/224903cc60d045576393c3b16907742f23e6c740",
    "https://git.kernel.org/stable/c/f05a0d8de2ea49af36821a20b0b501e20ced937e",
    "https://git.kernel.org/stable/c/8b6eab9d683bae7f88dc894b8c851f866032301c",
    "https://git.kernel.org/stable/c/b4cc04fa8f1fc3816c8494d77abab3f72b9d2292",
    "https://git.kernel.org/stable/c/554fb72ee34f4732c7f694f56c3c6e67790352a0"
  ],
  "aliases": [
    "CVE-2022-49118"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0db75aad-73dc-3bad-83dc-520447eafb3c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    },
    {
      "id": "160bc8ee-386a-3ac8-9106-fb3f003c1992",
      "product": {
        "name": "Linux"
      },
      "product_version": "47caad1577cd7a39e2048c5e4edbce4b863dc12b <8b6eab9d683bae7f88dc894b8c851f866032301c"
    },
    {
      "id": "4343b813-f889-36ea-9052-c4b4c380a287",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "45cab424-64bb-3f14-b799-82f3c1583d9c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.34"
    },
    {
      "id": "6443ca70-13a5-3298-ab05-41ea84c6ee65",
      "product": {
        "name": "Linux"
      },
      "product_version": "47caad1577cd7a39e2048c5e4edbce4b863dc12b <224903cc60d045576393c3b16907742f23e6c740"
    },
    {
      "id": "720ca265-919d-3f43-9137-eff2a1c4ec70",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f05a0d8de2ea49af36821a20b0b501e20ced937e"
    },
    {
      "id": "77345d44-395d-3c92-b9b2-6414b5499984",
      "product": {
        "name": "Linux"
      },
      "product_version": "47caad1577cd7a39e2048c5e4edbce4b863dc12b <554fb72ee34f4732c7f694f56c3c6e67790352a0"
    },
    {
      "id": "82b1e4f9-6cf6-3a04-ac98-735182ba9773",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.111"
    },
    {
      "id": "86bc6c31-6f03-3199-b25a-4b6001143129",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.20"
    },
    {
      "id": "8ebc6358-1f9e-3c79-9ddd-42959864dcdc",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8b6eab9d683bae7f88dc894b8c851f866032301c"
    },
    {
      "id": "9bcdb530-16fe-31ba-985e-441df2691b54",
      "product": {
        "name": "Linux"
      },
      "product_version": "47caad1577cd7a39e2048c5e4edbce4b863dc12b <b4cc04fa8f1fc3816c8494d77abab3f72b9d2292"
    },
    {
      "id": "a8d1fa4c-44c5-3954-b537-1779444da268",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <554fb72ee34f4732c7f694f56c3c6e67790352a0"
    },
    {
      "id": "ccfc4aae-7310-3b9b-b7f1-13adcabf0885",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <224903cc60d045576393c3b16907742f23e6c740"
    },
    {
      "id": "d66e3e09-d1dc-3810-a4a6-7cb4d796e349",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b4cc04fa8f1fc3816c8494d77abab3f72b9d2292"
    },
    {
      "id": "d9eb7a56-8dff-30c0-8466-ec1d33ec488f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.3"
    },
    {
      "id": "e24add88-bdd9-33a7-b304-70847c28675c",
      "product": {
        "name": "Linux"
      },
      "product_version": "47caad1577cd7a39e2048c5e4edbce4b863dc12b <f05a0d8de2ea49af36821a20b0b501e20ced937e"
    },
    {
      "id": "fd10f63c-0927-3367-919a-a97174882af1",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.5"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "1e99ceca-55c7-30a9-bce7-4fd9edd1b06b",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49118"
}
