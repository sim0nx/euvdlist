{
  "id": "EUVD-2025-31540",
  "enisaUuid": "1d4903a4-95c0-34a8-9b55-a7da870ccfd8",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncomedi: Fix use of uninitialized memory in do_insn_ioctl() and do_insnlist_ioctl()\n\nsyzbot reports a KMSAN kernel-infoleak in `do_insn_ioctl()`.  A kernel\nbuffer is allocated to hold `insn->n` samples (each of which is an\n`unsigned int`).  For some instruction types, `insn->n` samples are\ncopied back to user-space, unless an error code is being returned.  The\nproblem is that not all the instruction handlers that need to return\ndata to userspace fill in the whole `insn->n` samples, so that there is\nan information leak.  There is a similar syzbot report for\n`do_insnlist_ioctl()`, although it does not have a reproducer for it at\nthe time of writing.\n\nOne culprit is `insn_rw_emulate_bits()` which is used as the handler for\n`INSN_READ` or `INSN_WRITE` instructions for subdevices that do not have\na specific handler for that instruction, but do have an `INSN_BITS`\nhandler.  For `INSN_READ` it only fills in at most 1 sample, so if\n`insn->n` is greater than 1, the remaining `insn->n - 1` samples copied\nto userspace will be uninitialized kernel data.\n\nAnother culprit is `vm80xx_ai_insn_read()` in the \"vm80xx\" driver.  It\nnever returns an error, even if it fails to fill the buffer.\n\nFix it in `do_insn_ioctl()` and `do_insnlist_ioctl()` by making sure\nthat uninitialized parts of the allocated buffer are zeroed before\nhandling each instruction.\n\nThanks to Arnaud Lecomte for their fix to `do_insn_ioctl()`.  That fix\nreplaced the call to `kmalloc_array()` with `kcalloc()`, but it is not\nalways necessary to clear the whole buffer.",
  "datePublished": "Sep 5, 2025, 5:20:50 PM",
  "dateUpdated": "Sep 29, 2025, 5:57:21 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/868a1b68dcd9f2805bb86aa64862402f785d8c4a",
    "https://git.kernel.org/stable/c/ff4a7c18799c7fe999fa56c5cf276e13866b8c1a",
    "https://git.kernel.org/stable/c/d84f6e77ebe3359394df32ecd97e0d76a25283dc",
    "https://git.kernel.org/stable/c/f3b0c9ec54736f3b8118f93a473d22e11ee65743",
    "https://git.kernel.org/stable/c/aecf0d557ddd95ce68193a5ee1dc4c87415ff08a",
    "https://git.kernel.org/stable/c/3cd212e895ca2d58963fdc6422502b10dd3966bb"
  ],
  "aliases": [
    "CVE-2025-39684"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0a040dd2-09f1-373f-9dec-22746e07daa4",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.29"
    },
    {
      "id": "116879de-d203-347b-81d9-ae4778a1bcc7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.149"
    },
    {
      "id": "2f5b5665-a8f0-3e1c-ba25-b03fcda54f80",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "3c5ca70d-daa2-3736-9dac-b1c0391c1927",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <ff4a7c18799c7fe999fa56c5cf276e13866b8c1a"
    },
    {
      "id": "401c4cb8-5fb6-3024-a723-8882f02480bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.44"
    },
    {
      "id": "7b2ba0bb-6ffe-38b0-9c7c-1768b873a435",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.4"
    },
    {
      "id": "81ad57ea-bf05-357e-949c-48619aebe3bb",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <aecf0d557ddd95ce68193a5ee1dc4c87415ff08a"
    },
    {
      "id": "93fe1a73-620a-388b-a9ff-f89947f08b46",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <f3b0c9ec54736f3b8118f93a473d22e11ee65743"
    },
    {
      "id": "b6fdd1d5-099e-3229-8381-5710c164c456",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <868a1b68dcd9f2805bb86aa64862402f785d8c4a"
    },
    {
      "id": "b8a1d2b8-91fb-37fc-8bc9-d62aa517cd26",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <d84f6e77ebe3359394df32ecd97e0d76a25283dc"
    },
    {
      "id": "ca9109e3-b376-3a39-a2d3-a324471fc1dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "dccd0fa8-1360-3078-ad61-f83078a3fbeb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.103"
    },
    {
      "id": "de39d386-096d-3777-8950-a456206cdc6e",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed9eccbe8970f6eedc1b978c157caf1251a896d4 <3cd212e895ca2d58963fdc6422502b10dd3966bb"
    },
    {
      "id": "e26ed56a-4ddf-3f12-99d6-94d16fd0cebd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.190"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "ee95907f-da3a-3c48-9fe5-c671cda2953d",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}