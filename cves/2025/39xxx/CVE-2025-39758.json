{
  "id": "EUVD-2025-28954",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nRDMA/siw: Fix the sendmsg byte count in siw_tcp_sendpages\n\nEver since commit c2ff29e99a76 (\"siw: Inline do_tcp_sendpages()\"),\nwe have been doing this:\n\nstatic int siw_tcp_sendpages(struct socket *s, struct page **page, int offset,\n                             size_t size)\n[...]\n        /* Calculate the number of bytes we need to push, for this page\n         * specifically */\n        size_t bytes = min_t(size_t, PAGE_SIZE - offset, size);\n        /* If we can't splice it, then copy it in, as normal */\n        if (!sendpage_ok(page[i]))\n                msg.msg_flags &= ~MSG_SPLICE_PAGES;\n        /* Set the bvec pointing to the page, with len $bytes */\n        bvec_set_page(&bvec, page[i], bytes, offset);\n        /* Set the iter to $size, aka the size of the whole sendpages (!!!) */\n        iov_iter_bvec(&msg.msg_iter, ITER_SOURCE, &bvec, 1, size);\ntry_page_again:\n        lock_sock(sk);\n        /* Sendmsg with $size size (!!!) */\n        rv = tcp_sendmsg_locked(sk, &msg, size);\n\nThis means we've been sending oversized iov_iters and tcp_sendmsg calls\nfor a while. This has a been a benign bug because sendpage_ok() always\nreturned true. With the recent slab allocator changes being slowly\nintroduced into next (that disallow sendpage on large kmalloc\nallocations), we have recently hit out-of-bounds crashes, due to slight\ndifferences in iov_iter behavior between the MSG_SPLICE_PAGES and\n\"regular\" copy paths:\n\n(MSG_SPLICE_PAGES)\nskb_splice_from_iter\n  iov_iter_extract_pages\n    iov_iter_extract_bvec_pages\n      uses i->nr_segs to correctly stop in its tracks before OoB'ing everywhere\n  skb_splice_from_iter gets a \"short\" read\n\n(!MSG_SPLICE_PAGES)\nskb_copy_to_page_nocache copy=iov_iter_count\n [...]\n   copy_from_iter\n        /* this doesn't help */\n        if (unlikely(iter->count < len))\n                len = iter->count;\n          iterate_bvec\n            ... and we run off the bvecs\n\nFix this by properly setting the iov_iter's byte count, plus sending the\ncorrect byte count to tcp_sendmsg_locked.",
  "datePublished": "Sep 11, 2025, 4:52:27 PM",
  "dateUpdated": "Sep 29, 2025, 5:58:48 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/5661fdd218c2799001b88c17acd19f4395e4488e",
    "https://git.kernel.org/stable/c/673cf582fd788af12cdacfb62a6a593083542481",
    "https://git.kernel.org/stable/c/42ebc16d9d2563f1a1ce0f05b643ee68d54fabf8",
    "https://git.kernel.org/stable/c/edf82bc8150570167a33a7d54627d66614cbf841",
    "https://git.kernel.org/stable/c/c18646248fed07683d4cee8a8af933fc4fe83c0d",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39758"
  ],
  "aliases": [
    "CVE-2025-39758"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "03af1f84-7db6-3ec7-9c4c-fcff9142f95b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.2"
    },
    {
      "id": "1feda8da-abee-3877-9baf-0bb4859054bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "c2ff29e99a764769eb2ce3a1a5585013633ee9a6 <c18646248fed07683d4cee8a8af933fc4fe83c0d"
    },
    {
      "id": "208cea3e-85cc-31ef-bcc8-0ef2afa72cb2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.103"
    },
    {
      "id": "31b8b7c5-46e9-38f8-af4c-7e33bb7291bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.5"
    },
    {
      "id": "37d5c1aa-238b-380d-8742-f1097f845902",
      "product": {
        "name": "Linux"
      },
      "product_version": "c2ff29e99a764769eb2ce3a1a5585013633ee9a6 <673cf582fd788af12cdacfb62a6a593083542481"
    },
    {
      "id": "52b36858-df01-304d-bd83-032fe72e5d13",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "62b03098-763f-35f4-91af-bffe4ad5c534",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc1"
    },
    {
      "id": "6562c688-0ce5-3dad-9cc2-50abda55ed2f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.11"
    },
    {
      "id": "a6d8c411-a35e-3406-b4ec-b32562b18088",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "d64799db-ba4c-385a-ba09-3b8701d53cc0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.43"
    },
    {
      "id": "db90229a-55e3-3ce7-b951-8130756b28e8",
      "product": {
        "name": "Linux"
      },
      "product_version": "c2ff29e99a764769eb2ce3a1a5585013633ee9a6 <5661fdd218c2799001b88c17acd19f4395e4488e"
    },
    {
      "id": "e88eb97c-b553-3345-9ddc-cbdf4dc5a587",
      "product": {
        "name": "Linux"
      },
      "product_version": "c2ff29e99a764769eb2ce3a1a5585013633ee9a6 <42ebc16d9d2563f1a1ce0f05b643ee68d54fabf8"
    },
    {
      "id": "eda0cd95-03e4-3df9-b985-58b10d22febb",
      "product": {
        "name": "Linux"
      },
      "product_version": "c2ff29e99a764769eb2ce3a1a5585013633ee9a6 <edf82bc8150570167a33a7d54627d66614cbf841"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "ef659d9a-231d-3e1f-8fbf-bd535e56ad15",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39758"
}