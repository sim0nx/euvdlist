{
  "id": "EUVD-2024-53367",
  "enisaUuid": "3c0923be-d6c1-37b6-8fbd-9ba5f83d9817",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: stmmac: fix TSO DMA API usage causing oops\n\nCommit 66600fac7a98 (\"net: stmmac: TSO: Fix unbalanced DMA map/unmap\nfor non-paged SKB data\") moved the assignment of tx_skbuff_dma[]'s\nmembers to be later in stmmac_tso_xmit().\n\nThe buf (dma cookie) and len stored in this structure are passed to\ndma_unmap_single() by stmmac_tx_clean(). The DMA API requires that\nthe dma cookie passed to dma_unmap_single() is the same as the value\nreturned from dma_map_single(). However, by moving the assignment\nlater, this is not the case when priv->dma_cap.addr64 > 32 as \"des\"\nis offset by proto_hdr_len.\n\nThis causes problems such as:\n\n  dwc-eth-dwmac 2490000.ethernet eth0: Tx DMA map failed\n\nand with DMA_API_DEBUG enabled:\n\n  DMA-API: dwc-eth-dwmac 2490000.ethernet: device driver tries to +free DMA memory it has not allocated [device address=0x000000ffffcf65c0] [size=66 bytes]\n\nFix this by maintaining \"des\" as the original DMA cookie, and use\ntso_des to pass the offset DMA cookie to stmmac_tso_allocator().\n\nFull details of the crashes can be found at:\nhttps://lore.kernel.org/all/d8112193-0386-4e14-b516-37c2d838171a@nvidia.com/\nhttps://lore.kernel.org/all/klkzp5yn5kq5efgtrow6wbvnc46bcqfxs65nz3qy77ujr5turc@bwwhelz2l4dw/",
  "datePublished": "Dec 29, 2024, 8:48:51 AM",
  "dateUpdated": "Oct 1, 2025, 8:07:06 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/db3667c9bbfbbf5de98e6c9542f7e03fb5243286",
    "https://git.kernel.org/stable/c/9d5dd7ccea1b46a9a7c6b3c2b9e5ed8864e185e2",
    "https://git.kernel.org/stable/c/4c49f38e20a57f8abaebdf95b369295b153d1f8e"
  ],
  "aliases": [
    "CVE-2024-56719"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "0cf19e74-46cf-31bc-8952-792318072512",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.68"
    },
    {
      "id": "338498c9-1d2c-376b-b9ee-8aebd600ee7c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "39327668-33a3-3a14-958c-d0c867e3ec8a",
      "product": {
        "name": "Linux"
      },
      "product_version": "58d23d835eb498336716cca55b5714191a309286"
    },
    {
      "id": "59d58a9b-3032-3f95-b0ab-d5921746d161",
      "product": {
        "name": "Linux"
      },
      "product_version": "a3ff23f7c3f0e13f718900803e090fd3997d6bc9"
    },
    {
      "id": "62e85de8-25bd-3c08-9a7e-3e1adf6b1239",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "6854629d-360d-3aa2-9d82-9b8a334932f5",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.12"
    },
    {
      "id": "689a55e7-8a8a-3a5c-a204-8745ca08da35",
      "product": {
        "name": "Linux"
      },
      "product_version": "ece593fc9c00741b682869d3f3dc584d37b7c9df"
    },
    {
      "id": "8c23fa08-77fa-338f-976b-250930a199f2",
      "product": {
        "name": "Linux"
      },
      "product_version": "66600fac7a984dea4ae095411f644770b2561ede <9d5dd7ccea1b46a9a7c6b3c2b9e5ed8864e185e2"
    },
    {
      "id": "8cde0e61-f265-3e21-83df-44c4865e71dc",
      "product": {
        "name": "Linux"
      },
      "product_version": "07c9c26e37542486e34d767505e842f48f29c3f6 <db3667c9bbfbbf5de98e6c9542f7e03fb5243286"
    },
    {
      "id": "abc8729e-5503-3482-9e13-d0d40c0c56e8",
      "product": {
        "name": "Linux"
      },
      "product_version": "66600fac7a984dea4ae095411f644770b2561ede <4c49f38e20a57f8abaebdf95b369295b153d1f8e"
    },
    {
      "id": "cda9400a-5a0a-37dc-8510-496ca5557fef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.7"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "532e2c6b-748f-394f-839b-eba2a7d2949c",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}