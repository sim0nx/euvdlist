{
  "id": "EUVD-2025-34587",
  "enisaUuid": "2bcbac7f-e98b-330c-a7c9-8173b610c0c4",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: mcba_usb: populate ndo_change_mtu() to prevent buffer overflow\n\nSending an PF_PACKET allows to bypass the CAN framework logic and to\ndirectly reach the xmit() function of a CAN driver. The only check\nwhich is performed by the PF_PACKET framework is to make sure that\nskb->len fits the interface's MTU.\n\nUnfortunately, because the mcba_usb driver does not populate its\nnet_device_ops->ndo_change_mtu(), it is possible for an attacker to\nconfigure an invalid MTU by doing, for example:\n\n  $ ip link set can0 mtu 9999\n\nAfter doing so, the attacker could open a PF_PACKET socket using the\nETH_P_CANXL protocol:\n\n\tsocket(PF_PACKET, SOCK_RAW, htons(ETH_P_CANXL))\n\nto inject a malicious CAN XL frames. For example:\n\n\tstruct canxl_frame frame = {\n\t\t.flags = 0xff,\n\t\t.len = 2048,\n\t};\n\nThe CAN drivers' xmit() function are calling can_dev_dropped_skb() to\ncheck that the skb is valid, unfortunately under above conditions, the\nmalicious packet is able to go through can_dev_dropped_skb() checks:\n\n  1. the skb->protocol is set to ETH_P_CANXL which is valid (the\n     function does not check the actual device capabilities).\n\n  2. the length is a valid CAN XL length.\n\nAnd so, mcba_usb_start_xmit() receives a CAN XL frame which it is not\nable to correctly handle and will thus misinterpret it as a CAN frame.\n\nThis can result in a buffer overflow. The driver will consume cf->len\nas-is with no further checks on these lines:\n\n\tusb_msg.dlc = cf->len;\n\n\tmemcpy(usb_msg.data, cf->data, usb_msg.dlc);\n\nHere, cf->len corresponds to the flags field of the CAN XL frame. In\nour previous example, we set canxl_frame->flags to 0xff. Because the\nmaximum expected length is 8, a buffer overflow of 247 bytes occurs!\n\nPopulate net_device_ops->ndo_change_mtu() to ensure that the\ninterface's MTU can not be set to anything bigger than CAN_MTU. By\nfixing the root cause, this prevents the buffer overflow.",
  "datePublished": "Oct 15, 2025, 9:30:17 AM",
  "dateUpdated": "Oct 15, 2025, 9:30:17 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0fa9303c4b9493727e0d3a6ac3729300e3013930",
    "https://git.kernel.org/stable/c/37aed407496bf6de8910e588edb04d2435fa7011",
    "https://git.kernel.org/stable/c/6eec67bfb25637f9b51e584cf59ddace59925bc8",
    "https://git.kernel.org/stable/c/ca4e51359608e1f29bf1f2c33c3ddf775b6b7ed1",
    "https://git.kernel.org/stable/c/3664ae91b26d1fd7e4cee9cde17301361f4c89d5",
    "https://git.kernel.org/stable/c/6b9fb82df8868dbe9ffea5874b8d35f951faedbb",
    "https://git.kernel.org/stable/c/b638c3fb0f163e69785ceddb3b434a9437878bec",
    "https://git.kernel.org/stable/c/17c8d794527f01def0d1c8b7dc2d7b8d34fed0e6",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39985"
  ],
  "aliases": [
    "CVE-2025-39985"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0fd949b8-6ad9-3606-8fb8-1f1dae47d61f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "24710ee8-6ecb-3fd6-9f0c-8512ab75e992",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.12"
    },
    {
      "id": "2e1038fd-4487-3eb2-89b7-9bb897a16388",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.10"
    },
    {
      "id": "30ba59ff-75e9-385c-875f-84ce1da7f083",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.245"
    },
    {
      "id": "310475c7-2ec8-3cc9-972b-4c60a2caa972",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <6b9fb82df8868dbe9ffea5874b8d35f951faedbb"
    },
    {
      "id": "312654ed-0fda-3ba7-a5b1-99a73c8e48a0",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <ca4e51359608e1f29bf1f2c33c3ddf775b6b7ed1"
    },
    {
      "id": "3b9bbb3f-5fbb-3962-839b-d54fe37a08e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <6eec67bfb25637f9b51e584cf59ddace59925bc8"
    },
    {
      "id": "61016543-bef4-388e-93d0-7731d83da1ff",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <b638c3fb0f163e69785ceddb3b434a9437878bec"
    },
    {
      "id": "6627b1a5-3772-339f-967e-796f3c8e799c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "8106d3a0-a0a4-3290-bbca-d5af3aa06754",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.155"
    },
    {
      "id": "9883e832-317d-3003-ae41-911c2f1cc40f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.109"
    },
    {
      "id": "9a09d644-ed62-3f87-9e2f-1a90e988ec0a",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <0fa9303c4b9493727e0d3a6ac3729300e3013930"
    },
    {
      "id": "9e693ba7-2984-3205-b9f5-bbe2f4bfd56c",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <37aed407496bf6de8910e588edb04d2435fa7011"
    },
    {
      "id": "b12af400-5aaa-39e2-93e8-ba52b294ca9d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.194"
    },
    {
      "id": "b46b5621-5acf-377b-87ee-9e82a997ae68",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <17c8d794527f01def0d1c8b7dc2d7b8d34fed0e6"
    },
    {
      "id": "bb61a103-2054-314a-a49b-1d8d4dd8ac4b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.50"
    },
    {
      "id": "d67364d9-5e05-3fa4-b263-ae9480c87a5e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.300"
    },
    {
      "id": "e131414d-00c5-314e-88ff-811141c402ce",
      "product": {
        "name": "Linux"
      },
      "product_version": "51f3baad7de943780ce0c17bd7975df567dd6e14 <3664ae91b26d1fd7e4cee9cde17301361f4c89d5"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8fafba85-5667-36ab-9718-171089f7c5a2",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39985"
}