{
  "id": "EUVD-2026-4307",
  "enisaUuid": "59f93449-547a-3d8c-89e0-0acbde40661d",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: fix memory leak in skb_segment_list for GRO packets\n\nWhen skb_segment_list() is called during packet forwarding, it handles\npackets that were aggregated by the GRO engine.\n\nHistorically, the segmentation logic in skb_segment_list assumes that\nindividual segments are split from a parent SKB and may need to carry\ntheir own socket memory accounting. Accordingly, the code transfers\ntruesize from the parent to the newly created segments.\n\nPrior to commit ed4cccef64c1 (\"gro: fix ownership transfer\"), this\ntruesize subtraction in skb_segment_list() was valid because fragments\nstill carry a reference to the original socket.\n\nHowever, commit ed4cccef64c1 (\"gro: fix ownership transfer\") changed\nthis behavior by ensuring that fraglist entries are explicitly\norphaned (skb->sk = NULL) to prevent illegal orphaning later in the\nstack. This change meant that the entire socket memory charge remained\nwith the head SKB, but the corresponding accounting logic in\nskb_segment_list() was never updated.\n\nAs a result, the current code unconditionally adds each fragment's\ntruesize to delta_truesize and subtracts it from the parent SKB. Since\nthe fragments are no longer charged to the socket, this subtraction\nresults in an effective under-count of memory when the head is freed.\nThis causes sk_wmem_alloc to remain non-zero, preventing socket\ndestruction and leading to a persistent memory leak.\n\nThe leak can be observed via KMEMLEAK when tearing down the networking\nenvironment:\n\nunreferenced object 0xffff8881e6eb9100 (size 2048):\n  comm \"ping\", pid 6720, jiffies 4295492526\n  backtrace:\n    kmem_cache_alloc_noprof+0x5c6/0x800\n    sk_prot_alloc+0x5b/0x220\n    sk_alloc+0x35/0xa00\n    inet6_create.part.0+0x303/0x10d0\n    __sock_create+0x248/0x640\n    __sys_socket+0x11b/0x1d0\n\nSince skb_segment_list() is exclusively used for SKB_GSO_FRAGLIST\npackets constructed by GRO, the truesize adjustment is removed.\n\nThe call to skb_release_head_state() must be preserved. As documented in\ncommit cf673ed0e057 (\"net: fix fraglist segmentation reference count\nleak\"), it is still required to correctly drop references to SKB\nextensions that may be overwritten during __copy_skb_header().",
  "datePublished": "Jan 23, 2026, 3:24:01 PM",
  "dateUpdated": "Jan 23, 2026, 3:24:01 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2026-22979",
    "https://git.kernel.org/stable/c/0b27828ebd1ed3107d7929c3737adbe862e99e74",
    "https://git.kernel.org/stable/c/238e03d0466239410b72294b79494e43d4fabe77",
    "https://git.kernel.org/stable/c/3264881431e308b9c72cb8a0159d57a56d67dd79",
    "https://git.kernel.org/stable/c/88bea149db2057112af3aaf63534b24fab5858ab",
    "https://git.kernel.org/stable/c/c114a32a2e70b82d447f409f7ffcfa3058f9d5bd"
  ],
  "aliases": [
    "CVE-2026-22979",
    "GHSA-w4ch-7p82-3m56"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "221c86f3-372f-37e5-af19-7c96d40b909e",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed4cccef64c1d0d5b91e69f7a8a6697c3a865486 <238e03d0466239410b72294b79494e43d4fabe77"
    },
    {
      "id": "2cf9bfa9-bd4e-37cc-8400-193b5ad58bf1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.19-rc5"
    },
    {
      "id": "37e7cc3a-2447-33f5-9dd2-69f118e0ef56",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed4cccef64c1d0d5b91e69f7a8a6697c3a865486 <c114a32a2e70b82d447f409f7ffcfa3058f9d5bd"
    },
    {
      "id": "46b546ea-f5cd-3c94-b219-70f9cdbbe93e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.121"
    },
    {
      "id": "89a20ae9-5485-3ef1-9831-987cf9b6d5a3",
      "product": {
        "name": "Linux"
      },
      "product_version": "d225b0ac96dc40d7e8ae2bc227eb2c56e130975f"
    },
    {
      "id": "92221923-36a6-3ea8-9e96-7ab5f3aabfe3",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.9"
    },
    {
      "id": "ba625c90-9c12-326d-9bc7-6bd88adee727",
      "product": {
        "name": "Linux"
      },
      "product_version": "2eeab8c47c3c0276e0746bc382f405c9a236a5ad <0b27828ebd1ed3107d7929c3737adbe862e99e74"
    },
    {
      "id": "c7989c1b-b245-3540-810a-33c4cb1194d7",
      "product": {
        "name": "Linux"
      },
      "product_version": "5b3b67f731296027cceb3efad881ae281213f86f"
    },
    {
      "id": "c95eeb66-a3f9-3cee-9017-1b269699220c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "d3a2e9dc-7986-311b-9c7e-c9c2f943784a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18.6"
    },
    {
      "id": "d6aca03e-879a-3c61-bdf2-3001a8c45df9",
      "product": {
        "name": "Linux"
      },
      "product_version": "fc126c1d51e9552eacd2d717b9ffe9262a8a4cd6 <88bea149db2057112af3aaf63534b24fab5858ab"
    },
    {
      "id": "e2168f44-3918-3cb6-9cd8-c1b100bd1c50",
      "product": {
        "name": "Linux"
      },
      "product_version": "ed4cccef64c1d0d5b91e69f7a8a6697c3a865486 <3264881431e308b9c72cb8a0159d57a56d67dd79"
    },
    {
      "id": "f203ae9a-7cef-3b70-8f91-ff0247baf504",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.161"
    },
    {
      "id": "ff531f64-4a52-39b6-97b2-9fd0e8afefe6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.66"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7945e736-f818-3481-b1a6-cffc8b2942b3",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2026-22979"
}