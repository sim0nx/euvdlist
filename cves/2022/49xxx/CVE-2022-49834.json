{
  "id": "EUVD-2025-12938",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix use-after-free bug of ns_writer on remount\n\nIf a nilfs2 filesystem is downgraded to read-only due to metadata\ncorruption on disk and is remounted read/write, or if emergency read-only\nremount is performed, detaching a log writer and synchronizing the\nfilesystem can be done at the same time.\n\nIn these cases, use-after-free of the log writer (hereinafter\nnilfs->ns_writer) can happen as shown in the scenario below:\n\n Task1                               Task2\n --------------------------------    ------------------------------\n nilfs_construct_segment\n   nilfs_segctor_sync\n     init_wait\n     init_waitqueue_entry\n     add_wait_queue\n     schedule\n                                     nilfs_remount (R/W remount case)\n\t\t\t\t       nilfs_attach_log_writer\n                                         nilfs_detach_log_writer\n                                           nilfs_segctor_destroy\n                                             kfree\n     finish_wait\n       _raw_spin_lock_irqsave\n         __raw_spin_lock_irqsave\n           do_raw_spin_lock\n             debug_spin_lock_before  <-- use-after-free\n\nWhile Task1 is sleeping, nilfs->ns_writer is freed by Task2.  After Task1\nwaked up, Task1 accesses nilfs->ns_writer which is already freed.  This\nscenario diagram is based on the Shigeru Yoshida's post [1].\n\nThis patch fixes the issue by not detaching nilfs->ns_writer on remount so\nthat this UAF race doesn't happen.  Along with this change, this patch\nalso inserts a few necessary read-only checks with superblock instance\nwhere only the ns_writer pointer was used to check if the filesystem is\nread-only.",
  "datePublished": "May 1, 2025, 2:09:52 PM",
  "dateUpdated": "May 4, 2025, 8:46:30 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49834",
    "https://git.kernel.org/stable/c/39a3ed68270b079c6b874d4e4727a512b9b4882c",
    "https://git.kernel.org/stable/c/4feedde5486c07ea79787839153a71ca71329c7d",
    "https://git.kernel.org/stable/c/8cccf05fe857a18ee26e20d11a8455a73ffd4efd",
    "https://git.kernel.org/stable/c/9b162e81045266a2d5b44df9dffdf05c54de9cca",
    "https://git.kernel.org/stable/c/afbd1188382a75f6cfe22c0b68533f7f9664f182",
    "https://git.kernel.org/stable/c/b152300d5a1ba4258dacf9916bff20e6a8c7603b",
    "https://git.kernel.org/stable/c/b2fbf10040216ef5ee270773755fc2f5da65b749",
    "https://git.kernel.org/stable/c/b4736ab5542112fe0a40f140a0a0b072954f34da"
  ],
  "aliases": [
    "CVE-2022-49834",
    "GHSA-7jwj-6g7w-4c9q"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0021750f-e0a2-3257-8fd5-eaa7e8943602",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <afbd1188382a75f6cfe22c0b68533f7f9664f182"
    },
    {
      "id": "0efb4858-8c42-3d71-a1ab-bbf9525b0d11",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.9"
    },
    {
      "id": "11ed7d0d-93f9-3073-9285-586c4d40e51c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.300"
    },
    {
      "id": "2abb7234-9690-354d-9e57-84b02ac9c831",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b152300d5a1ba4258dacf9916bff20e6a8c7603b"
    },
    {
      "id": "5b0b75cf-af48-3699-a5ab-f7ff593c55a1",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9b162e81045266a2d5b44df9dffdf05c54de9cca"
    },
    {
      "id": "681661a4-3272-3c33-a96d-5fadc629d941",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.79"
    },
    {
      "id": "71e06aae-427f-315f-adb6-03481fca83c3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b4736ab5542112fe0a40f140a0a0b072954f34da"
    },
    {
      "id": "8f887e87-fd7d-3589-a404-54f81b0dc47f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.267"
    },
    {
      "id": "9561e003-8ad7-3b19-975d-051e75566bef",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8cccf05fe857a18ee26e20d11a8455a73ffd4efd"
    },
    {
      "id": "972ace8c-2a4a-3398-bf07-3a9e3fba67bf",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.225"
    },
    {
      "id": "b39b92e2-2d31-3cd8-897c-e7e8d3ca1dec",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <39a3ed68270b079c6b874d4e4727a512b9b4882c"
    },
    {
      "id": "b73e2a42-74e6-3079-ae89-84800e7c4a41",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b2fbf10040216ef5ee270773755fc2f5da65b749"
    },
    {
      "id": "c7a3bf26-26a0-3813-b924-faf8a211ed4a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4feedde5486c07ea79787839153a71ca71329c7d"
    },
    {
      "id": "d79e64b2-0616-3d35-8601-309130aa45fa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.155"
    },
    {
      "id": "e2cdd7f0-27dd-3c59-8469-3ed863269e38",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "e34faf99-d8fc-3c69-a21d-b3d0fc2e42a4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.334"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "97296309-aef8-3605-89b0-143749c76412",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49834"
}
