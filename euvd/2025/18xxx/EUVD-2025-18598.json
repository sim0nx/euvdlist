{
  "id": "EUVD-2025-18598",
  "enisaUuid": "a8404ebe-df1d-3d14-895b-ceb8ab58b498",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nperf/x86/intel: Fix segfault with PEBS-via-PT with sample_freq\n\nCurrently, using PEBS-via-PT with a sample frequency instead of a sample\nperiod, causes a segfault.  For example:\n\n    BUG: kernel NULL pointer dereference, address: 0000000000000195\n    <NMI>\n    ? __die_body.cold+0x19/0x27\n    ? page_fault_oops+0xca/0x290\n    ? exc_page_fault+0x7e/0x1b0\n    ? asm_exc_page_fault+0x26/0x30\n    ? intel_pmu_pebs_event_update_no_drain+0x40/0x60\n    ? intel_pmu_pebs_event_update_no_drain+0x32/0x60\n    intel_pmu_drain_pebs_icl+0x333/0x350\n    handle_pmi_common+0x272/0x3c0\n    intel_pmu_handle_irq+0x10a/0x2e0\n    perf_event_nmi_handler+0x2a/0x50\n\nThat happens because intel_pmu_pebs_event_update_no_drain() assumes all the\npebs_enabled bits represent counter indexes, which is not always the case.\nIn this particular case, bits 60 and 61 are set for PEBS-via-PT purposes.\n\nThe behaviour of PEBS-via-PT with sample frequency is questionable because\nalthough a PMI is generated (PEBS_PMI_AFTER_EACH_RECORD), the period is not\nadjusted anyway.\n\nPutting that aside, fix intel_pmu_pebs_event_update_no_drain() by passing\nthe mask of counter bits instead of 'size'.  Note, prior to the Fixes\ncommit, 'size' would be limited to the maximum counter index, so the issue\nwas not hit.",
  "datePublished": "Jun 18, 2025, 9:33:35 AM",
  "dateUpdated": "Jun 18, 2025, 9:33:35 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/ca51db23166767a8445deb8331c9b8d5205d9287",
    "https://git.kernel.org/stable/c/0b1874a5b1173fbcb2185ab828f4c33d067e551e",
    "https://git.kernel.org/stable/c/99bcd91fabada0dbb1d5f0de44532d8008db93c6"
  ],
  "aliases": [
    "CVE-2025-38055"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "23d0b72e-d05e-3afc-b10c-9c3bda55f800",
      "product": {
        "name": "Linux"
      },
      "product_version": "a9d6d466bcf0621a872e1052bc40e4c6f0541b8d"
    },
    {
      "id": "23dd848a-93d6-375e-800c-26c7611d6803",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.11"
    },
    {
      "id": "4e6b84d1-6ca4-3a1b-bdf0-3e31f39f7da0",
      "product": {
        "name": "Linux"
      },
      "product_version": "722e42e45c2f1c6d1adec7813651dba5139f52f4 <0b1874a5b1173fbcb2185ab828f4c33d067e551e"
    },
    {
      "id": "575eede4-6e06-373e-8d12-ddde709a66ee",
      "product": {
        "name": "Linux"
      },
      "product_version": "722e42e45c2f1c6d1adec7813651dba5139f52f4 <99bcd91fabada0dbb1d5f0de44532d8008db93c6"
    },
    {
      "id": "98e8ae51-f880-34bb-9230-d5a12935d1b3",
      "product": {
        "name": "Linux"
      },
      "product_version": "722e42e45c2f1c6d1adec7813651dba5139f52f4 <ca51db23166767a8445deb8331c9b8d5205d9287"
    },
    {
      "id": "aad6a1ec-93ba-320d-86e5-bf950f695c8c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.9"
    },
    {
      "id": "bafafa4b-4d75-34f5-8fbd-da34097bc2e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15"
    },
    {
      "id": "e0992680-2837-3f97-aa2f-ade2511b491e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.31"
    },
    {
      "id": "fc023563-422a-326f-bea5-de67b817b339",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "c2f33d7b-5ea4-30b9-9ebe-108ce77380e2",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}