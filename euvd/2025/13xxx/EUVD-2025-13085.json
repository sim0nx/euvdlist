{
  "id": "EUVD-2025-13085",
  "enisaUuid": "97f343c8-170f-3f2d-8168-140182071e0f",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: vmd: Make vmd_dev::cfg_lock a raw_spinlock_t type\n\nThe access to the PCI config space via pci_ops::read and pci_ops::write is\na low-level hardware access. The functions can be accessed with disabled\ninterrupts even on PREEMPT_RT. The pci_lock is a raw_spinlock_t for this\npurpose.\n\nA spinlock_t becomes a sleeping lock on PREEMPT_RT, so it cannot be\nacquired with disabled interrupts. The vmd_dev::cfg_lock is accessed in\nthe same context as the pci_lock.\n\nMake vmd_dev::cfg_lock a raw_spinlock_t type so it can be used with\ninterrupts disabled.\n\nThis was reported as:\n\n  BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48\n  Call Trace:\n   rt_spin_lock+0x4e/0x130\n   vmd_pci_read+0x8d/0x100 [vmd]\n   pci_user_read_config_byte+0x6f/0xe0\n   pci_read_config+0xfe/0x290\n   sysfs_kf_bin_read+0x68/0x90\n\n[bigeasy: reword commit message]\nTested-off-by: Luis Claudio R. Goncalves <lgoncalv@redhat.com>\n[kwilczynski: commit log]\n[bhelgaas: add back report info from\nhttps://lore.kernel.org/lkml/20241218115951.83062-1-ryotkkr98@gmail.com/]",
  "datePublished": "May 1, 2025, 12:55:46 PM",
  "dateUpdated": "May 2, 2025, 6:15:59 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-23161",
    "https://git.kernel.org/stable/c/13e5148f70e81991acbe0bab5b1b50ba699116e7",
    "https://git.kernel.org/stable/c/18056a48669a040bef491e63b25896561ee14d90",
    "https://git.kernel.org/stable/c/20d0a9062c031068fa39f725a32f182b709b5525",
    "https://git.kernel.org/stable/c/2358046ead696ca5c7c628d6c0e2c6792619a3e5",
    "https://git.kernel.org/stable/c/5c3cfcf0b4bf43530788b08a8eaf7896ec567484",
    "https://git.kernel.org/stable/c/c2968c812339593ac6e2bdd5cc3adabe3f05fa53",
    "https://git.kernel.org/stable/c/c250262d6485ca333e9821f85b07eb383ec546b1"
  ],
  "aliases": [
    "CVE-2025-23161",
    "GHSA-q3v6-chw5-g495"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "138c8812-43fd-3714-80c2-df66b5fc592c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <18056a48669a040bef491e63b25896561ee14d90"
    },
    {
      "id": "1ba967e1-f9c3-384a-87cf-c6e071e67d13",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.181"
    },
    {
      "id": "285fc8c0-8901-3d78-acb0-8352bcef2337",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <20d0a9062c031068fa39f725a32f182b709b5525"
    },
    {
      "id": "37f7bba8-0310-34a1-b112-92e507e16af0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <13e5148f70e81991acbe0bab5b1b50ba699116e7"
    },
    {
      "id": "510388c7-8fec-3361-8425-5480f7d22694",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c2968c812339593ac6e2bdd5cc3adabe3f05fa53"
    },
    {
      "id": "6e75435e-b8f0-3ebe-bee8-b540b2746d8c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.135"
    },
    {
      "id": "79a2878c-b356-37db-8b46-615677599d90",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.88"
    },
    {
      "id": "804ab1c2-07c2-3ac4-8a0d-1b7993ac61c2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.24"
    },
    {
      "id": "9517c04f-56d5-389d-b042-4e2d34621ca0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.3"
    },
    {
      "id": "a90f119c-704b-3d1a-a099-7b977e455ebc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.12"
    },
    {
      "id": "b8b17d60-f78c-32f0-9ed0-9cfc3974b17e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2358046ead696ca5c7c628d6c0e2c6792619a3e5"
    },
    {
      "id": "e0394e7b-efd2-3a51-8764-c020e31352ad",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5c3cfcf0b4bf43530788b08a8eaf7896ec567484"
    },
    {
      "id": "edfe506b-8d68-3114-a842-905596e4cbe3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c250262d6485ca333e9821f85b07eb383ec546b1"
    },
    {
      "id": "ee23e429-08eb-3d1f-9ea1-0f64c6be1e1c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15-rc1"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "3096fb1d-8cc3-3688-b19b-b8004171087d",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}