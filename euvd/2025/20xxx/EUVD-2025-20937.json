{
  "id": "EUVD-2025-20937",
  "enisaUuid": "5870d5b8-12bf-3704-a8c1-df217242a066",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niavf: get rid of the crit lock\n\nGet rid of the crit lock.\nThat frees us from the error prone logic of try_locks.\n\nThanks to netdev_lock() by Jakub it is now easy, and in most cases we were\nprotected by it already - replace crit lock by netdev lock when it was not\nthe case.\n\nLockdep reports that we should cancel the work under crit_lock [splat1],\nand that was the scheme we have mostly followed since [1] by Slawomir.\nBut when that is done we still got into deadlocks [splat2]. So instead\nwe should look at the bigger problem, namely \"weird locking/scheduling\"\nof the iavf. The first step to fix that is to remove the crit lock.\nI will followup with a -next series that simplifies scheduling/tasks.\n\nCancel the work without netdev lock (weird unlock+lock scheme),\nto fix the [splat2] (which would be totally ugly if we would kept\nthe crit lock).\n\nExtend protected part of iavf_watchdog_task() to include scheduling\nmore work.\n\nNote that the removed comment in iavf_reset_task() was misplaced,\nit belonged to inside of the removed if condition, so it's gone now.\n\n[splat1] - w/o this patch - The deadlock during VF removal:\n     WARNING: possible circular locking dependency detected\n     sh/3825 is trying to acquire lock:\n      ((work_completion)(&(&adapter->watchdog_task)->work)){+.+.}-{0:0}, at: start_flush_work+0x1a1/0x470\n          but task is already holding lock:\n      (&adapter->crit_lock){+.+.}-{4:4}, at: iavf_remove+0xd1/0x690 [iavf]\n          which lock already depends on the new lock.\n\n[splat2] - when cancelling work under crit lock, w/o this series,\n\t   see [2] for the band aid attempt\n    WARNING: possible circular locking dependency detected\n    sh/3550 is trying to acquire lock:\n    ((wq_completion)iavf){+.+.}-{0:0}, at: touch_wq_lockdep_map+0x26/0x90\n        but task is already holding lock:\n    (&dev->lock){+.+.}-{4:4}, at: iavf_remove+0xa6/0x6e0 [iavf]\n        which lock already depends on the new lock.\n\n[1] fc2e6b3b132a (\"iavf: Rework mutexes for better synchronisation\")\n[2] https://github.com/pkitszel/linux/commit/52dddbfc2bb60294083f5711a158a",
  "datePublished": "Jul 10, 2025, 7:42:20 AM",
  "dateUpdated": "Jul 28, 2025, 4:18:15 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/620ab4d6215de0b25227f9fff1a8c7fb66837cb8",
    "https://git.kernel.org/stable/c/120f28a6f314fef7f282c99f196923fe44081cad"
  ],
  "aliases": [
    "CVE-2025-38311"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "08f9d97c-63e3-32e1-a909-d1ebe2856bb0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "326af664-2f0f-3158-b282-d06d92969ce1",
      "product": {
        "name": "Linux"
      },
      "product_version": "d1639a17319ba78a018280cd2df6577a7e5d9fab <620ab4d6215de0b25227f9fff1a8c7fb66837cb8"
    },
    {
      "id": "5c26d84e-e8e9-3a6e-8695-a9f5a6e7db48",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "8b9e1d88-d761-35e8-b0ed-f9fd6d9de226",
      "product": {
        "name": "Linux"
      },
      "product_version": "d1639a17319ba78a018280cd2df6577a7e5d9fab <120f28a6f314fef7f282c99f196923fe44081cad"
    },
    {
      "id": "94fc4dfd-41cc-3634-9785-eba55c8c28e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.5"
    },
    {
      "id": "988a03b4-fc07-3051-aace-b1482e5cccb9",
      "product": {
        "name": "Linux"
      },
      "product_version": "2647ff59c52ef42c853c905817ed1a7f092d59a5"
    },
    {
      "id": "ccfe1eb0-fd6d-3feb-88d2-754a37fb1db8",
      "product": {
        "name": "Linux"
      },
      "product_version": "63d14a43128540016ebd4f7fa3ad3a2f0d6e642c"
    },
    {
      "id": "d0a23a4f-239d-300a-b003-e23c566a4f78",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.3"
    },
    {
      "id": "d15c13c1-cdd6-3e55-86ca-a50d537e4500",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "e41ceddd-2791-3dac-8048-8b089f921a71",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}