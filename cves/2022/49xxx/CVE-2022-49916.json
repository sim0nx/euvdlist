{
  "id": "EUVD-2025-12852",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrose: Fix NULL pointer dereference in rose_send_frame()\n\nThe syzkaller reported an issue:\n\nKASAN: null-ptr-deref in range [0x0000000000000380-0x0000000000000387]\nCPU: 0 PID: 4069 Comm: kworker/0:15 Not tainted 6.0.0-syzkaller-02734-g0326074ff465 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022\nWorkqueue: rcu_gp srcu_invoke_callbacks\nRIP: 0010:rose_send_frame+0x1dd/0x2f0 net/rose/rose_link.c:101\nCall Trace:\n <IRQ>\n rose_transmit_clear_request+0x1d5/0x290 net/rose/rose_link.c:255\n rose_rx_call_request+0x4c0/0x1bc0 net/rose/af_rose.c:1009\n rose_loopback_timer+0x19e/0x590 net/rose/rose_loopback.c:111\n call_timer_fn+0x1a0/0x6b0 kernel/time/timer.c:1474\n expire_timers kernel/time/timer.c:1519 [inline]\n __run_timers.part.0+0x674/0xa80 kernel/time/timer.c:1790\n __run_timers kernel/time/timer.c:1768 [inline]\n run_timer_softirq+0xb3/0x1d0 kernel/time/timer.c:1803\n __do_softirq+0x1d0/0x9c8 kernel/softirq.c:571\n [...]\n </IRQ>\n\nIt triggers NULL pointer dereference when 'neigh->dev->dev_addr' is\ncalled in the rose_send_frame(). It's the first occurrence of the\n`neigh` is in rose_loopback_timer() as `rose_loopback_neigh', and\nthe 'dev' in 'rose_loopback_neigh' is initialized sa nullptr.\n\nIt had been fixed by commit 3b3fd068c56e3fbea30090859216a368398e39bf\n(\"rose: Fix Null pointer dereference in rose_send_frame()\") ever.\nBut it's introduced by commit 3c53cd65dece47dd1f9d3a809f32e59d1d87b2b8\n(\"rose: check NULL rose_loopback_neigh->loopback\") again.\n\nWe fix it by add NULL check in rose_transmit_clear_request(). When\nthe 'dev' in 'neigh' is NULL, we don't reply the request and just\nclear it.\n\nsyzkaller don't provide repro, and I provide a syz repro like:\nr0 = syz_init_net_socket$bt_sco(0x1f, 0x5, 0x2)\nioctl$sock_inet_SIOCSIFFLAGS(r0, 0x8914, &(0x7f0000000180)={'rose0\\x00', 0x201})\nr1 = syz_init_net_socket$rose(0xb, 0x5, 0x0)\nbind$rose(r1, &(0x7f00000000c0)=@full={0xb, @dev, @null, 0x0, [@null, @null, @netrom, @netrom, @default, @null]}, 0x40)\nconnect$rose(r1, &(0x7f0000000240)=@short={0xb, @dev={0xbb, 0xbb, 0xbb, 0x1, 0x0}, @remote={0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0xcc, 0x1}, 0x1, @netrom={0xbb, 0xbb, 0xbb, 0xbb, 0xbb, 0x0, 0x0}}, 0x1c)",
  "datePublished": "May 1, 2025, 2:10:56 PM",
  "dateUpdated": "May 4, 2025, 12:45:26 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49916",
    "https://git.kernel.org/stable/c/01b9c68c121847d05a4ccef68244dadf82bfa331",
    "https://git.kernel.org/stable/c/3e2129c67daca21043a26575108f6286c85e71f6",
    "https://git.kernel.org/stable/c/5b46adfbee1e429f33b10a88d6c00fa88f3d6c77",
    "https://git.kernel.org/stable/c/a601e5eded33bb88b8a42743db8fef3ad41dd97e",
    "https://git.kernel.org/stable/c/b13be5e852b03f376058027e462fad4230240891",
    "https://git.kernel.org/stable/c/bbc03d74e641e824754443b908454ca9e203773e",
    "https://git.kernel.org/stable/c/e97c089d7a49f67027395ddf70bf327eeac2611e",
    "https://git.kernel.org/stable/c/f06186e5271b980bac03f5c97276ed0146ddc9b0"
  ],
  "aliases": [
    "CVE-2022-49916",
    "GHSA-7qcm-qx74-j7hr"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "0100ede6-0cfd-350b-96d5-1e35a476b01a",
      "product": {
        "name": "Linux"
      },
      "product_version": "3c53cd65dece47dd1f9d3a809f32e59d1d87b2b8 <e97c089d7a49f67027395ddf70bf327eeac2611e"
    },
    {
      "id": "06936f08-f6fd-3695-a905-470f69db7be7",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.0"
    },
    {
      "id": "2250c184-97cc-3eed-a6de-b53e0e28d266",
      "product": {
        "name": "Linux"
      },
      "product_version": "0aae33feb7a56b28318f92c960a3d08d9c305984 <5b46adfbee1e429f33b10a88d6c00fa88f3d6c77"
    },
    {
      "id": "2e5c6613-7af5-3003-9fc1-a97ab903d441",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.333"
    },
    {
      "id": "2f64a938-c967-3631-82bf-5979658a65a3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.224"
    },
    {
      "id": "3179cd83-0a14-37ad-8107-3ac74bf8e0f7",
      "product": {
        "name": "Linux"
      },
      "product_version": "6e4b20d548fc97ecbdca15c8d96302ee5e3e6313 <b13be5e852b03f376058027e462fad4230240891"
    },
    {
      "id": "325172e5-3eb6-37c9-ba96-212f28647348",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "42d3ecee-292e-361b-a0c5-5c7ed9eb29d4",
      "product": {
        "name": "Linux"
      },
      "product_version": "3c53cd65dece47dd1f9d3a809f32e59d1d87b2b8 <a601e5eded33bb88b8a42743db8fef3ad41dd97e"
    },
    {
      "id": "42ec3428-2862-33ed-99ae-71535fdeef8b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.299"
    },
    {
      "id": "52acbda6-1f5e-3fab-a8f3-047e1b5f6e00",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.8"
    },
    {
      "id": "5748477e-8430-3700-80ff-593cd516c199",
      "product": {
        "name": "Linux"
      },
      "product_version": "76885373129b13df35ecc9b4ee86ea5840f12133 <01b9c68c121847d05a4ccef68244dadf82bfa331"
    },
    {
      "id": "686156cc-5ab8-3507-a7a3-b0375755e22d",
      "product": {
        "name": "Linux"
      },
      "product_version": "b8f9de195d6303f52bae16c7911f35ac14ba7e3d <bbc03d74e641e824754443b908454ca9e203773e"
    },
    {
      "id": "7fb59dc3-d0dd-37ed-8a9a-356253c83dcc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "9996450c-b18d-3955-a2bc-2fb888edf381",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.78"
    },
    {
      "id": "c7bc6392-5de6-3740-9602-00bc07a522e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "9197ca40fd9de265caedba70d0cb5814c4e45952"
    },
    {
      "id": "d50718eb-ef04-3e51-8efa-7ed50167e19a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.154"
    },
    {
      "id": "da98e829-cbac-387b-a626-a4e0435458fa",
      "product": {
        "name": "Linux"
      },
      "product_version": "9cf85759e104d7e9c3fd8920a554195b715d6797 <3e2129c67daca21043a26575108f6286c85e71f6"
    },
    {
      "id": "f51a9006-7d91-3386-88a9-74424a8ce519",
      "product": {
        "name": "Linux"
      },
      "product_version": "de3deadd11987070788b48825bec4647458b988d <f06186e5271b980bac03f5c97276ed0146ddc9b0"
    },
    {
      "id": "f8c7e4b5-47c4-3f2c-a9be-8e20ab51b076",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.265"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7517abae-2de7-31af-93a9-c870663b3019",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49916"
}
