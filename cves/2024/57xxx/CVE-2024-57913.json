{
  "id": "EUVD-2024-53816",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: f_fs: Remove WARN_ON in functionfs_bind\n\nThis commit addresses an issue related to below kernel panic where\npanic_on_warn is enabled. It is caused by the unnecessary use of WARN_ON\nin functionsfs_bind, which easily leads to the following scenarios.\n\n1.adb_write in adbd               2. UDC write via configfs\n  =================\t             =====================\n\n->usb_ffs_open_thread()           ->UDC write\n ->open_functionfs()               ->configfs_write_iter()\n  ->adb_open()                      ->gadget_dev_desc_UDC_store()\n   ->adb_write()                     ->usb_gadget_register_driver_owner\n                                      ->driver_register()\n->StartMonitor()                       ->bus_add_driver()\n ->adb_read()                           ->gadget_bind_driver()\n<times-out without BIND event>           ->configfs_composite_bind()\n                                          ->usb_add_function()\n->open_functionfs()                        ->ffs_func_bind()\n ->adb_open()                               ->functionfs_bind()\n                                       <ffs->state !=FFS_ACTIVE>\n\nThe adb_open, adb_read, and adb_write operations are invoked from the\ndaemon, but trying to bind the function is a process that is invoked by\nUDC write through configfs, which opens up the possibility of a race\ncondition between the two paths. In this race scenario, the kernel panic\noccurs due to the WARN_ON from functionfs_bind when panic_on_warn is\nenabled. This commit fixes the kernel panic by removing the unnecessary\nWARN_ON.\n\nKernel panic - not syncing: kernel: panic_on_warn set ...\n[   14.542395] Call trace:\n[   14.542464]  ffs_func_bind+0x1c8/0x14a8\n[   14.542468]  usb_add_function+0xcc/0x1f0\n[   14.542473]  configfs_composite_bind+0x468/0x588\n[   14.542478]  gadget_bind_driver+0x108/0x27c\n[   14.542483]  really_probe+0x190/0x374\n[   14.542488]  __driver_probe_device+0xa0/0x12c\n[   14.542492]  driver_probe_device+0x3c/0x220\n[   14.542498]  __driver_attach+0x11c/0x1fc\n[   14.542502]  bus_for_each_dev+0x104/0x160\n[   14.542506]  driver_attach+0x24/0x34\n[   14.542510]  bus_add_driver+0x154/0x270\n[   14.542514]  driver_register+0x68/0x104\n[   14.542518]  usb_gadget_register_driver_owner+0x48/0xf4\n[   14.542523]  gadget_dev_desc_UDC_store+0xf8/0x144\n[   14.542526]  configfs_write_iter+0xf0/0x138",
  "datePublished": "Jan 19, 2025, 12:31:26 PM",
  "dateUpdated": "Feb 28, 2025, 12:30:51 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/bfe60030fcd976e3546e1f73d6d0eb3fea26442e",
    "https://git.kernel.org/stable/c/3e4d32cc145955d5c56c5498a3ff057e4aafa9d1",
    "https://git.kernel.org/stable/c/19fc1c83454ca9d5699e39633ec79ce26355251c",
    "https://git.kernel.org/stable/c/82f60f3600aecd9ffcd0fbc4e193694511c85b47",
    "https://git.kernel.org/stable/c/ea6a1498742430eb2effce0d1439ff29ef37dd7d",
    "https://git.kernel.org/stable/c/a8b6a18b9b66cc4c016d63132b59ce5383f7cdd2",
    "https://git.kernel.org/stable/c/dfc51e48bca475bbee984e90f33fdc537ce09699",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-57913"
  ],
  "aliases": [
    "CVE-2024-57913"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "03aeebfe-7cc7-3d38-bf8a-629131a81ef8",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <a8b6a18b9b66cc4c016d63132b59ce5383f7cdd2"
    },
    {
      "id": "1920ac9b-84d2-3958-89d7-cf8740cc4858",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <bfe60030fcd976e3546e1f73d6d0eb3fea26442e"
    },
    {
      "id": "21ed4966-5876-3b3c-a471-5e34478e9e06",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.10"
    },
    {
      "id": "2935c46b-1843-3d39-970f-422a4e7f3324",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.72"
    },
    {
      "id": "6d3d0828-3849-3d5b-89fa-9142b9d4bc45",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <ea6a1498742430eb2effce0d1439ff29ef37dd7d"
    },
    {
      "id": "6e552457-dcc6-3174-9bc7-c95268cd1f9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.290"
    },
    {
      "id": "823fb090-92a3-3c2b-b334-762822852668",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <dfc51e48bca475bbee984e90f33fdc537ce09699"
    },
    {
      "id": "96c0f51a-3c7b-3b68-b3e9-3cb3e98ad2a7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.125"
    },
    {
      "id": "a57051e5-21f6-3c47-a83c-68f622a1802f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.234"
    },
    {
      "id": "a598893b-5316-3ed4-a733-56c1146343b5",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.35"
    },
    {
      "id": "a86f4642-71b8-322e-a8c6-503291369d97",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <82f60f3600aecd9ffcd0fbc4e193694511c85b47"
    },
    {
      "id": "b811cac7-9564-3976-bc8d-babb91a05431",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.177"
    },
    {
      "id": "b934508c-ab52-3b0f-816c-c7c05ba58cee",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <19fc1c83454ca9d5699e39633ec79ce26355251c"
    },
    {
      "id": "bab0e749-3ac2-3fec-81b0-12776215ef33",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "de9c4c62-03fa-3c41-8ed3-da6aea497eaf",
      "product": {
        "name": "Linux"
      },
      "product_version": "ddf8abd2599491cbad959c700b90ba72a5dce8d0 <3e4d32cc145955d5c56c5498a3ff057e4aafa9d1"
    },
    {
      "id": "ffaa9051-9d3d-3792-979c-57eda9473ad8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "573b8280-fcdf-3a39-b9f3-cd05f1aab1e5",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2024-57913"
}
