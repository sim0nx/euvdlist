{
  "id": "EUVD-2025-31974",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfs/ntfs3: Validate buffer length while parsing index\n\nindx_read is called when we have some NTFS directory operations that\nneed more information from the index buffers. This adds a sanity check\nto make sure the returned index buffer length is legit, or we may have\nsome out-of-bound memory accesses.\n\n[  560.897595] BUG: KASAN: slab-out-of-bounds in hdr_find_e.isra.0+0x10c/0x320\n[  560.898321] Read of size 2 at addr ffff888009497238 by task exp/245\n[  560.898760]\n[  560.899129] CPU: 0 PID: 245 Comm: exp Not tainted 6.0.0-rc6 #37\n[  560.899505] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014\n[  560.900170] Call Trace:\n[  560.900407]  <TASK>\n[  560.900732]  dump_stack_lvl+0x49/0x63\n[  560.901108]  print_report.cold+0xf5/0x689\n[  560.901395]  ? hdr_find_e.isra.0+0x10c/0x320\n[  560.901716]  kasan_report+0xa7/0x130\n[  560.901950]  ? hdr_find_e.isra.0+0x10c/0x320\n[  560.902208]  __asan_load2+0x68/0x90\n[  560.902427]  hdr_find_e.isra.0+0x10c/0x320\n[  560.902846]  ? cmp_uints+0xe0/0xe0\n[  560.903363]  ? cmp_sdh+0x90/0x90\n[  560.903883]  ? ntfs_bread_run+0x190/0x190\n[  560.904196]  ? rwsem_down_read_slowpath+0x750/0x750\n[  560.904969]  ? ntfs_fix_post_read+0xe0/0x130\n[  560.905259]  ? __kasan_check_write+0x14/0x20\n[  560.905599]  ? up_read+0x1a/0x90\n[  560.905853]  ? indx_read+0x22c/0x380\n[  560.906096]  indx_find+0x2ef/0x470\n[  560.906352]  ? indx_find_buffer+0x2d0/0x2d0\n[  560.906692]  ? __kasan_kmalloc+0x88/0xb0\n[  560.906977]  dir_search_u+0x196/0x2f0\n[  560.907220]  ? ntfs_nls_to_utf16+0x450/0x450\n[  560.907464]  ? __kasan_check_write+0x14/0x20\n[  560.907747]  ? mutex_lock+0x8f/0xe0\n[  560.907970]  ? __mutex_lock_slowpath+0x20/0x20\n[  560.908214]  ? kmem_cache_alloc+0x143/0x4b0\n[  560.908459]  ntfs_lookup+0xe0/0x100\n[  560.908788]  __lookup_slow+0x116/0x220\n[  560.909050]  ? lookup_fast+0x1b0/0x1b0\n[  560.909309]  ? lookup_fast+0x13f/0x1b0\n[  560.909601]  walk_component+0x187/0x230\n[  560.909944]  link_path_walk.part.0+0x3f0/0x660\n[  560.910285]  ? handle_lookup_down+0x90/0x90\n[  560.910618]  ? path_init+0x642/0x6e0\n[  560.911084]  ? percpu_counter_add_batch+0x6e/0xf0\n[  560.912559]  ? __alloc_file+0x114/0x170\n[  560.913008]  path_openat+0x19c/0x1d10\n[  560.913419]  ? getname_flags+0x73/0x2b0\n[  560.913815]  ? kasan_save_stack+0x3a/0x50\n[  560.914125]  ? kasan_save_stack+0x26/0x50\n[  560.914542]  ? __kasan_slab_alloc+0x6d/0x90\n[  560.914924]  ? kmem_cache_alloc+0x143/0x4b0\n[  560.915339]  ? getname_flags+0x73/0x2b0\n[  560.915647]  ? getname+0x12/0x20\n[  560.916114]  ? __x64_sys_open+0x4c/0x60\n[  560.916460]  ? path_lookupat.isra.0+0x230/0x230\n[  560.916867]  ? __isolate_free_page+0x2e0/0x2e0\n[  560.917194]  do_filp_open+0x15c/0x1f0\n[  560.917448]  ? may_open_dev+0x60/0x60\n[  560.917696]  ? expand_files+0xa4/0x3a0\n[  560.917923]  ? __kasan_check_write+0x14/0x20\n[  560.918185]  ? _raw_spin_lock+0x88/0xdb\n[  560.918409]  ? _raw_spin_lock_irqsave+0x100/0x100\n[  560.918783]  ? _find_next_bit+0x4a/0x130\n[  560.919026]  ? _raw_spin_unlock+0x19/0x40\n[  560.919276]  ? alloc_fd+0x14b/0x2d0\n[  560.919635]  do_sys_openat2+0x32a/0x4b0\n[  560.920035]  ? file_open_root+0x230/0x230\n[  560.920336]  ? __rcu_read_unlock+0x5b/0x280\n[  560.920813]  do_sys_open+0x99/0xf0\n[  560.921208]  ? filp_open+0x60/0x60\n[  560.921482]  ? exit_to_user_mode_prepare+0x49/0x180\n[  560.921867]  __x64_sys_open+0x4c/0x60\n[  560.922128]  do_syscall_64+0x3b/0x90\n[  560.922369]  entry_SYSCALL_64_after_hwframe+0x63/0xcd\n[  560.923030] RIP: 0033:0x7f7dff2e4469\n[  560.923681] Code: 00 f3 c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 088\n[  560.924451] RSP: 002b:00007ffd41a210b8 EFLAGS: 00000206 ORIG_RAX: 0000000000000002\n[  560.925168] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f7dff2e4469\n[  560.925655] RDX: 0000000000000000 RSI: 0000000000000002 RDI:\n---truncated---",
  "datePublished": "Oct 1, 2025, 11:42:18 AM",
  "dateUpdated": "Oct 2, 2025, 7:04:16 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50442",
    "https://git.kernel.org/stable/c/3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96",
    "https://git.kernel.org/stable/c/3f6f75e8863f41c8b3dbfd9d99e3963aaca42601",
    "https://git.kernel.org/stable/c/4d42ecda239cc13738d6fd84d098a32e67b368b9",
    "https://git.kernel.org/stable/c/b15374365c9d10445ea7d66cdf885457a0223fc2"
  ],
  "aliases": [
    "CVE-2022-50442",
    "GHSA-qqgg-499c-j47v"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "216254e8-6930-31ad-aa21-0f8fdddae263",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.17"
    },
    {
      "id": "27b500d0-6763-30e3-adb0-2d6f21d24385",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2"
    },
    {
      "id": "3150cc1c-a759-3d6b-8bc2-db26e0ab2597",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96"
    },
    {
      "id": "3a513fab-17e3-34c0-bd31-235189833580",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.3"
    },
    {
      "id": "5adb907f-79be-3b81-9917-ef71db3cb0d1",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b15374365c9d10445ea7d66cdf885457a0223fc2"
    },
    {
      "id": "5c1908cb-e41f-3669-8fa8-357d44f5b5b6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3f6f75e8863f41c8b3dbfd9d99e3963aaca42601"
    },
    {
      "id": "6b5df371-de58-30c3-8987-5609c7540a52",
      "product": {
        "name": "Linux"
      },
      "product_version": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e <3cd9e5b41b83bb57ac3cf9888f9fef2a6ef8ed96"
    },
    {
      "id": "84a7f919-fca7-330d-a25a-eec3d63264e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "932b705d-f37b-3821-9c15-46a58c7bbaa0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4d42ecda239cc13738d6fd84d098a32e67b368b9"
    },
    {
      "id": "c12bce00-d169-3a3a-ae98-e2d04a6571cf",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.87"
    },
    {
      "id": "d4447d53-749f-3d0c-9a10-0fe83720c67f",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.15"
    },
    {
      "id": "da527269-8044-321c-ba6d-2d5d851ab158",
      "product": {
        "name": "Linux"
      },
      "product_version": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e <b15374365c9d10445ea7d66cdf885457a0223fc2"
    },
    {
      "id": "dc053a73-a208-3c11-92d5-606dacaaf748",
      "product": {
        "name": "Linux"
      },
      "product_version": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e <4d42ecda239cc13738d6fd84d098a32e67b368b9"
    },
    {
      "id": "edec4d1c-6597-3cf1-b13f-6935c9001642",
      "product": {
        "name": "Linux"
      },
      "product_version": "4534a70b7056fd4b9a1c6db5a4ce3c98546b291e <3f6f75e8863f41c8b3dbfd9d99e3963aaca42601"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "260dd854-1598-32f0-a3fa-d23be56b69bb",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50442"
}