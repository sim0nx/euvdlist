{
  "id": "EUVD-2025-11365",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmemstick: rtsx_usb_ms: Fix slab-use-after-free in rtsx_usb_ms_drv_remove\n\nThis fixes the following crash:\n\n==================================================================\nBUG: KASAN: slab-use-after-free in rtsx_usb_ms_poll_card+0x159/0x200 [rtsx_usb_ms]\nRead of size 8 at addr ffff888136335380 by task kworker/6:0/140241\n\nCPU: 6 UID: 0 PID: 140241 Comm: kworker/6:0 Kdump: loaded Tainted: G            E      6.14.0-rc6+ #1\nTainted: [E]=UNSIGNED_MODULE\nHardware name: LENOVO 30FNA1V7CW/1057, BIOS S0EKT54A 07/01/2024\nWorkqueue: events rtsx_usb_ms_poll_card [rtsx_usb_ms]\nCall Trace:\n <TASK>\n dump_stack_lvl+0x51/0x70\n print_address_description.constprop.0+0x27/0x320\n ? rtsx_usb_ms_poll_card+0x159/0x200 [rtsx_usb_ms]\n print_report+0x3e/0x70\n kasan_report+0xab/0xe0\n ? rtsx_usb_ms_poll_card+0x159/0x200 [rtsx_usb_ms]\n rtsx_usb_ms_poll_card+0x159/0x200 [rtsx_usb_ms]\n ? __pfx_rtsx_usb_ms_poll_card+0x10/0x10 [rtsx_usb_ms]\n ? __pfx___schedule+0x10/0x10\n ? kick_pool+0x3b/0x270\n process_one_work+0x357/0x660\n worker_thread+0x390/0x4c0\n ? __pfx_worker_thread+0x10/0x10\n kthread+0x190/0x1d0\n ? __pfx_kthread+0x10/0x10\n ret_from_fork+0x2d/0x50\n ? __pfx_kthread+0x10/0x10\n ret_from_fork_asm+0x1a/0x30\n </TASK>\n\nAllocated by task 161446:\n kasan_save_stack+0x20/0x40\n kasan_save_track+0x10/0x30\n __kasan_kmalloc+0x7b/0x90\n __kmalloc_noprof+0x1a7/0x470\n memstick_alloc_host+0x1f/0xe0 [memstick]\n rtsx_usb_ms_drv_probe+0x47/0x320 [rtsx_usb_ms]\n platform_probe+0x60/0xe0\n call_driver_probe+0x35/0x120\n really_probe+0x123/0x410\n __driver_probe_device+0xc7/0x1e0\n driver_probe_device+0x49/0xf0\n __device_attach_driver+0xc6/0x160\n bus_for_each_drv+0xe4/0x160\n __device_attach+0x13a/0x2b0\n bus_probe_device+0xbd/0xd0\n device_add+0x4a5/0x760\n platform_device_add+0x189/0x370\n mfd_add_device+0x587/0x5e0\n mfd_add_devices+0xb1/0x130\n rtsx_usb_probe+0x28e/0x2e0 [rtsx_usb]\n usb_probe_interface+0x15c/0x460\n call_driver_probe+0x35/0x120\n really_probe+0x123/0x410\n __driver_probe_device+0xc7/0x1e0\n driver_probe_device+0x49/0xf0\n __device_attach_driver+0xc6/0x160\n bus_for_each_drv+0xe4/0x160\n __device_attach+0x13a/0x2b0\n rebind_marked_interfaces.isra.0+0xcc/0x110\n usb_reset_device+0x352/0x410\n usbdev_do_ioctl+0xe5c/0x1860\n usbdev_ioctl+0xa/0x20\n __x64_sys_ioctl+0xc5/0xf0\n do_syscall_64+0x59/0x170\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nFreed by task 161506:\n kasan_save_stack+0x20/0x40\n kasan_save_track+0x10/0x30\n kasan_save_free_info+0x36/0x60\n __kasan_slab_free+0x34/0x50\n kfree+0x1fd/0x3b0\n device_release+0x56/0xf0\n kobject_cleanup+0x73/0x1c0\n rtsx_usb_ms_drv_remove+0x13d/0x220 [rtsx_usb_ms]\n platform_remove+0x2f/0x50\n device_release_driver_internal+0x24b/0x2e0\n bus_remove_device+0x124/0x1d0\n device_del+0x239/0x530\n platform_device_del.part.0+0x19/0xe0\n platform_device_unregister+0x1c/0x40\n mfd_remove_devices_fn+0x167/0x170\n device_for_each_child_reverse+0xc9/0x130\n mfd_remove_devices+0x6e/0xa0\n rtsx_usb_disconnect+0x2e/0xd0 [rtsx_usb]\n usb_unbind_interface+0xf3/0x3f0\n device_release_driver_internal+0x24b/0x2e0\n proc_disconnect_claim+0x13d/0x220\n usbdev_do_ioctl+0xb5e/0x1860\n usbdev_ioctl+0xa/0x20\n __x64_sys_ioctl+0xc5/0xf0\n do_syscall_64+0x59/0x170\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nLast potentially related work creation:\n kasan_save_stack+0x20/0x40\n kasan_record_aux_stack+0x85/0x90\n insert_work+0x29/0x100\n __queue_work+0x34a/0x540\n call_timer_fn+0x2a/0x160\n expire_timers+0x5f/0x1f0\n __run_timer_base.part.0+0x1b6/0x1e0\n run_timer_softirq+0x8b/0xe0\n handle_softirqs+0xf9/0x360\n __irq_exit_rcu+0x114/0x130\n sysvec_apic_timer_interrupt+0x72/0x90\n asm_sysvec_apic_timer_interrupt+0x16/0x20\n\nSecond to last potentially related work creation:\n kasan_save_stack+0x20/0x40\n kasan_record_aux_stack+0x85/0x90\n insert_work+0x29/0x100\n __queue_work+0x34a/0x540\n call_timer_fn+0x2a/0x160\n expire_timers+0x5f/0x1f0\n __run_timer_base.part.0+0x1b6/0x1e0\n run_timer_softirq+0x8b/0xe0\n handle_softirqs+0xf9/0x\n---truncated---",
  "datePublished": "Apr 16, 2025, 10:20:37 AM",
  "dateUpdated": "May 4, 2025, 7:27:51 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-22020",
    "https://git.kernel.org/stable/c/0067cb7d7e7c277e91a0887a3c24e71462379469",
    "https://git.kernel.org/stable/c/31f0eaed6914333f42501fc7e0f6830879f5ef2d",
    "https://git.kernel.org/stable/c/4676741a3464b300b486e70585c3c9b692be1632",
    "https://git.kernel.org/stable/c/52d942a5302eefb3b7a3bfee310a5a33feeedc21",
    "https://git.kernel.org/stable/c/6186fb2cd36317277a8423687982140a7f3f7841",
    "https://git.kernel.org/stable/c/75123adf204f997e11bbddee48408c284f51c050",
    "https://git.kernel.org/stable/c/914c5e5bfceb9878f3056eaf4d1c88f2cbe0a185",
    "https://git.kernel.org/stable/c/9dfaf4d723c62bda8d9d1340e2e78acf0c190439",
    "https://git.kernel.org/stable/c/b094e8e3988e02e8cef7a756c8d2cea9c12509ab"
  ],
  "aliases": [
    "CVE-2025-22020",
    "GHSA-h2g5-mxp5-qrcx"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "2111ffaa-8271-30a4-bb54-d3ea693db040",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "28331cdf-ea8f-3b4b-833f-6d2eaf800214",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.180"
    },
    {
      "id": "39d30c82-6dda-35b1-9dfa-7871193fa947",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.292"
    },
    {
      "id": "4cc45dbc-6a85-3531-a7d1-0614a7644e61",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.22"
    },
    {
      "id": "4eb330ae-1c64-3e5d-a48f-ca4d5df903b0",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.0"
    },
    {
      "id": "66cacdd6-c3f7-37f9-97cc-96c8c4fb2a12",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <52d942a5302eefb3b7a3bfee310a5a33feeedc21"
    },
    {
      "id": "6e36e8b5-b317-3258-9b94-1492897f820b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15-rc1"
    },
    {
      "id": "79dd8a68-f962-393b-96aa-fdbfa99c8a45",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.10"
    },
    {
      "id": "8f4805a3-b2bc-31ff-afce-4b4c9fc7b66c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.86"
    },
    {
      "id": "9534c2d5-0575-32a9-acf6-e5ca76dc1ce1",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <9dfaf4d723c62bda8d9d1340e2e78acf0c190439"
    },
    {
      "id": "9545a6af-ce83-33c3-a50c-4e31216d2853",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <b094e8e3988e02e8cef7a756c8d2cea9c12509ab"
    },
    {
      "id": "a95b98af-7540-3e85-b6f3-877992207804",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <914c5e5bfceb9878f3056eaf4d1c88f2cbe0a185"
    },
    {
      "id": "acbce832-6893-3412-b7ce-3335011f5a70",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <31f0eaed6914333f42501fc7e0f6830879f5ef2d"
    },
    {
      "id": "b2793537-9b6b-38ca-b65a-6f76c56116cb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.133"
    },
    {
      "id": "c72f22b7-ea92-3405-873a-f9aac48e3728",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <6186fb2cd36317277a8423687982140a7f3f7841"
    },
    {
      "id": "cccf0f44-5f1d-3a80-bafa-7cfecd143a42",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <4676741a3464b300b486e70585c3c9b692be1632"
    },
    {
      "id": "d4d873d1-349e-3203-a121-c7eb9f21ac43",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <75123adf204f997e11bbddee48408c284f51c050"
    },
    {
      "id": "e3e0f2ba-b917-3bf0-829b-b48bcf0f5e9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "6827ca573c03385439fdfc8b512d556dc7c54fc9 <0067cb7d7e7c277e91a0887a3c24e71462379469"
    },
    {
      "id": "ee12c79d-8637-3df2-8b93-3b66a1a19ff3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.1"
    },
    {
      "id": "f9f28314-b4b1-33f6-bf47-1d768f7175b0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.236"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "30093bb6-5c22-33ed-b0e9-691b676c323e",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-22020"
}
