{
  "id": "EUVD-2022-55464",
  "enisaUuid": "3b0b2c5d-c008-3767-81a5-c24029736555",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nPM: hibernate: defer device probing when resuming from hibernation\n\nsyzbot is reporting hung task at misc_open() [1], for there is a race\nwindow of AB-BA deadlock which involves probe_count variable. Currently\nwait_for_device_probe() from snapshot_open() from misc_open() can sleep\nforever with misc_mtx held if probe_count cannot become 0.\n\nWhen a device is probed by hub_event() work function, probe_count is\nincremented before the probe function starts, and probe_count is\ndecremented after the probe function completed.\n\nThere are three cases that can prevent probe_count from dropping to 0.\n\n  (a) A device being probed stopped responding (i.e. broken/malicious\n      hardware).\n\n  (b) A process emulating a USB device using /dev/raw-gadget interface\n      stopped responding for some reason.\n\n  (c) New device probe requests keeps coming in before existing device\n      probe requests complete.\n\nThe phenomenon syzbot is reporting is (b). A process which is holding\nsystem_transition_mutex and misc_mtx is waiting for probe_count to become\n0 inside wait_for_device_probe(), but the probe function which is called\n from hub_event() work function is waiting for the processes which are\nblocked at mutex_lock(&misc_mtx) to respond via /dev/raw-gadget interface.\n\nThis patch mitigates (b) by deferring wait_for_device_probe() from\nsnapshot_open() to snapshot_write() and snapshot_ioctl(). Please note that\nthe possibility of (b) remains as long as any thread which is emulating a\nUSB device via /dev/raw-gadget interface can be blocked by uninterruptible\nblocking operations (e.g. mutex_lock()).\n\nPlease also note that (a) and (c) are not addressed. Regarding (c), we\nshould change the code to wait for only one device which contains the\nimage for resuming from hibernation. I don't know how to address (a), for\nuse of timeout for wait_for_device_probe() might result in loss of user\ndata in the image. Maybe we should require the userland to wait for the\nimage device before opening /dev/snapshot interface.",
  "datePublished": "Jun 18, 2025, 11:03:43 AM",
  "dateUpdated": "Jun 18, 2025, 11:03:43 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/8c90947e5f1801e6c7120021c6ea0f3ad6a4eb91",
    "https://git.kernel.org/stable/c/5a283b59bce72c05c60e9f0fa92a28b5b850d8bb",
    "https://git.kernel.org/stable/c/3c48d3067eaf878642276f053575a5c642600a50",
    "https://git.kernel.org/stable/c/003a456ae6f70bb97e436e02fc5105be577c1570",
    "https://git.kernel.org/stable/c/2f0e18e0db42f4f8bc87d3d98333680065ceeff8",
    "https://git.kernel.org/stable/c/b8e1ae9433d7bd95f2dcc044a7a6f20a4c40d258",
    "https://git.kernel.org/stable/c/f7042cf9dd40733f387b7cac021e626c74b8856f",
    "https://git.kernel.org/stable/c/8386c414e27caba8501119948e9551e52b527f59"
  ],
  "aliases": [
    "CVE-2022-50202"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "04f0d14c-08eb-3a5d-97b7-5410e4f0f45c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8386c414e27caba8501119948e9551e52b527f59"
    },
    {
      "id": "1c05ba20-7d95-3e5d-9755-a6be32b9eec1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.137"
    },
    {
      "id": "288f46d0-bc6d-39c9-af7f-39327383ec22",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.211"
    },
    {
      "id": "3a182589-4022-333b-98b1-a7bac8caa69f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3c48d3067eaf878642276f053575a5c642600a50"
    },
    {
      "id": "419ebc5a-ef19-348b-aae0-f5f2b3cc9907",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.256"
    },
    {
      "id": "476ad62a-747f-31f8-ad3d-2584fd1662bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <003a456ae6f70bb97e436e02fc5105be577c1570"
    },
    {
      "id": "4ca49313-7a43-3fde-b56f-d3724dbc49e6",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f7042cf9dd40733f387b7cac021e626c74b8856f"
    },
    {
      "id": "7441509d-1f6d-3fb5-8c5f-b29b1ecb262e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.18"
    },
    {
      "id": "77d469e1-5fc7-3a69-9e93-820cfe7d6482",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "9ef04b06-eeed-3798-8378-6293c1f15be2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2f0e18e0db42f4f8bc87d3d98333680065ceeff8"
    },
    {
      "id": "a01ff632-4b24-3e02-9083-b0b8e311ac02",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.2"
    },
    {
      "id": "a8ec84c3-c1c3-35c4-87c8-253224deb94e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b8e1ae9433d7bd95f2dcc044a7a6f20a4c40d258"
    },
    {
      "id": "bc559c06-7636-3952-a2b8-5f361d7a64fa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.61"
    },
    {
      "id": "d68d6a10-99e2-32e1-b9e4-6543b62ce151",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8c90947e5f1801e6c7120021c6ea0f3ad6a4eb91"
    },
    {
      "id": "eabf594b-f438-3918-b1f9-7e121cd2f5a0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.291"
    },
    {
      "id": "f189dd3b-351d-3cd8-bcf6-f851e6c64085",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5a283b59bce72c05c60e9f0fa92a28b5b850d8bb"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7962f187-bd7f-3df0-90ca-bfdefdd91680",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}