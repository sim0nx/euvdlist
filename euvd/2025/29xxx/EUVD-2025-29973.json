{
  "id": "EUVD-2025-29973",
  "enisaUuid": "ab201314-af8b-3586-bd02-b9192382a695",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: sched: fix memory leak in tcindex_set_parms\n\nSyzkaller reports a memory leak as follows:\n====================================\nBUG: memory leak\nunreferenced object 0xffff88810c287f00 (size 256):\n  comm \"syz-executor105\", pid 3600, jiffies 4294943292 (age 12.990s)\n  hex dump (first 32 bytes):\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n  backtrace:\n    [<ffffffff814cf9f0>] kmalloc_trace+0x20/0x90 mm/slab_common.c:1046\n    [<ffffffff839c9e07>] kmalloc include/linux/slab.h:576 [inline]\n    [<ffffffff839c9e07>] kmalloc_array include/linux/slab.h:627 [inline]\n    [<ffffffff839c9e07>] kcalloc include/linux/slab.h:659 [inline]\n    [<ffffffff839c9e07>] tcf_exts_init include/net/pkt_cls.h:250 [inline]\n    [<ffffffff839c9e07>] tcindex_set_parms+0xa7/0xbe0 net/sched/cls_tcindex.c:342\n    [<ffffffff839caa1f>] tcindex_change+0xdf/0x120 net/sched/cls_tcindex.c:553\n    [<ffffffff8394db62>] tc_new_tfilter+0x4f2/0x1100 net/sched/cls_api.c:2147\n    [<ffffffff8389e91c>] rtnetlink_rcv_msg+0x4dc/0x5d0 net/core/rtnetlink.c:6082\n    [<ffffffff839eba67>] netlink_rcv_skb+0x87/0x1d0 net/netlink/af_netlink.c:2540\n    [<ffffffff839eab87>] netlink_unicast_kernel net/netlink/af_netlink.c:1319 [inline]\n    [<ffffffff839eab87>] netlink_unicast+0x397/0x4c0 net/netlink/af_netlink.c:1345\n    [<ffffffff839eb046>] netlink_sendmsg+0x396/0x710 net/netlink/af_netlink.c:1921\n    [<ffffffff8383e796>] sock_sendmsg_nosec net/socket.c:714 [inline]\n    [<ffffffff8383e796>] sock_sendmsg+0x56/0x80 net/socket.c:734\n    [<ffffffff8383eb08>] ____sys_sendmsg+0x178/0x410 net/socket.c:2482\n    [<ffffffff83843678>] ___sys_sendmsg+0xa8/0x110 net/socket.c:2536\n    [<ffffffff838439c5>] __sys_sendmmsg+0x105/0x330 net/socket.c:2622\n    [<ffffffff83843c14>] __do_sys_sendmmsg net/socket.c:2651 [inline]\n    [<ffffffff83843c14>] __se_sys_sendmmsg net/socket.c:2648 [inline]\n    [<ffffffff83843c14>] __x64_sys_sendmmsg+0x24/0x30 net/socket.c:2648\n    [<ffffffff84605fd5>] do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n    [<ffffffff84605fd5>] do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80\n    [<ffffffff84800087>] entry_SYSCALL_64_after_hwframe+0x63/0xcd\n====================================\n\nKernel uses tcindex_change() to change an existing\nfilter properties.\n\nYet the problem is that, during the process of changing,\nif `old_r` is retrieved from `p->perfect`, then\nkernel uses tcindex_alloc_perfect_hash() to newly\nallocate filter results, uses tcindex_filter_result_init()\nto clear the old filter result, without destroying\nits tcf_exts structure, which triggers the above memory leak.\n\nTo be more specific, there are only two source for the `old_r`,\naccording to the tcindex_lookup(). `old_r` is retrieved from\n`p->perfect`, or `old_r` is retrieved from `p->h`.\n\n  * If `old_r` is retrieved from `p->perfect`, kernel uses\ntcindex_alloc_perfect_hash() to newly allocate the\nfilter results. Then `r` is assigned with `cp->perfect + handle`,\nwhich is newly allocated. So condition `old_r && old_r != r` is\ntrue in this situation, and kernel uses tcindex_filter_result_init()\nto clear the old filter result, without destroying\nits tcf_exts structure\n\n  * If `old_r` is retrieved from `p->h`, then `p->perfect` is NULL\naccording to the tcindex_lookup(). Considering that `cp->h`\nis directly copied from `p->h` and `p->perfect` is NULL,\n`r` is assigned with `tcindex_lookup(cp, handle)`, whose value\nshould be the same as `old_r`, so condition `old_r && old_r != r`\nis false in this situation, kernel ignores using\ntcindex_filter_result_init() to clear the old filter result.\n\nSo only when `old_r` is retrieved from `p->perfect` does kernel use\ntcindex_filter_result_init() to clear the old filter result, which\ntriggers the above memory leak.\n\nConsidering that there already exists a tc_filter_wq workqueue\nto destroy the old tcindex_d\n---truncated---",
  "datePublished": "Sep 18, 2025, 3:30:33 PM",
  "dateUpdated": "Sep 29, 2025, 12:30:26 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50396",
    "https://git.kernel.org/stable/c/399ab7fe0fa0d846881685fd4e57e9a8ef7559f7",
    "https://git.kernel.org/stable/c/55ac68b53f1cea1926ee2313afc5d66b91daad71",
    "https://git.kernel.org/stable/c/6c55953e232ea668731091d111066521f3b7719b",
    "https://git.kernel.org/stable/c/b314f6c3512108d7a656c5caf07c82d1bbbdc0f1",
    "https://git.kernel.org/stable/c/c4de6057e7c6654983acb63d939d26ac0d7bbf39",
    "https://git.kernel.org/stable/c/facc4405e8b7407e03216207b1d1d640127de0c8",
    "https://git.kernel.org/stable/c/53af9c793f644d5841d84d8e0ad83bd7ab47f3e0",
    "https://git.kernel.org/stable/c/01d0d2b8b4e3cf2110baba9371c0c3d04ad5c77b",
    "https://git.kernel.org/stable/c/7a6fb69bbcb21e9ce13bdf18c008c268874f0480",
    "https://git.kernel.org/stable/c/18c3fa7a7fdbb4d21dafc8a7710ae2c1680930f6",
    "https://git.kernel.org/stable/c/7c183dc0af472dec33d2c0786a5e356baa8cad19",
    "https://git.kernel.org/stable/c/3abebc503a5148072052c229c6b04b329a420ecd",
    "https://git.kernel.org/stable/c/372ae77cf11d11fb118cbe2d37def9dd5f826abd"
  ],
  "aliases": [
    "CVE-2022-50396",
    "GHSA-8gwc-c833-gwmc"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0771b521-5ba5-3c05-ba35-35563faef0d7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.87"
    },
    {
      "id": "0c5262d5-b77f-39ce-9be8-f07ac784ca0f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2"
    },
    {
      "id": "0fe75621-b11e-3899-bafa-7a9624007f9e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2.5"
    },
    {
      "id": "140beb9e-f54e-3c36-8351-4d6677a95a0d",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <55ac68b53f1cea1926ee2313afc5d66b91daad71"
    },
    {
      "id": "24df1a7b-e9d2-337b-9369-65fe7fae49ff",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <7c183dc0af472dec33d2c0786a5e356baa8cad19"
    },
    {
      "id": "268c13de-5f04-34c5-85a4-5ac8d361d552",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <b314f6c3512108d7a656c5caf07c82d1bbbdc0f1"
    },
    {
      "id": "338b2de9-e168-3031-91fa-0ef51f438498",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.9"
    },
    {
      "id": "3693ca6a-fdc5-3a41-b277-7ebf4857f164",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.276"
    },
    {
      "id": "43b0e0a0-1de5-380d-b207-a9c20e31feae",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.18"
    },
    {
      "id": "5d8b3701-301d-3477-a4f6-a794aebf1a8b",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <53af9c793f644d5841d84d8e0ad83bd7ab47f3e0"
    },
    {
      "id": "5ec6bce7-49d9-3992-8cfe-27643f616ea0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.100"
    },
    {
      "id": "63d853f3-f07d-3006-9eff-5b36656629c2",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <399ab7fe0fa0d846881685fd4e57e9a8ef7559f7"
    },
    {
      "id": "6709b71a-239d-339e-b261-676a2793c5bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <6c55953e232ea668731091d111066521f3b7719b"
    },
    {
      "id": "67f32b00-867f-3a3a-b86f-b196de90afe6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.19"
    },
    {
      "id": "69a7a23c-7e3b-34ea-9669-f77194c94af2",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <3abebc503a5148072052c229c6b04b329a420ecd"
    },
    {
      "id": "6f64e6f6-eb17-3c64-a3c4-b123a04dc7e5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "7de73d09-2cd1-3d3e-acd1-09b4abba812c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.163"
    },
    {
      "id": "8a90f0ef-d2c0-30d9-94b4-4c144d178af0",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <18c3fa7a7fdbb4d21dafc8a7710ae2c1680930f6"
    },
    {
      "id": "95d6e2c1-651d-3c68-906d-6093efb92cea",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.229"
    },
    {
      "id": "9717fc9c-f276-3dc4-8756-65512b2e4cac",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <372ae77cf11d11fb118cbe2d37def9dd5f826abd"
    },
    {
      "id": "97d33f22-de59-3183-a11c-cecea1649241",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.5"
    },
    {
      "id": "97ee9419-5364-396b-a858-737d9404a318",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <01d0d2b8b4e3cf2110baba9371c0c3d04ad5c77b"
    },
    {
      "id": "a0bde58d-5cf6-3561-aa45-f69bc607062f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.308"
    },
    {
      "id": "a3133b40-6f2f-38bd-88d1-bd7d002c4925",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.235"
    },
    {
      "id": "accac46a-ede7-3235-a3dc-b2527cad8750",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <7a6fb69bbcb21e9ce13bdf18c008c268874f0480"
    },
    {
      "id": "b0633d0a-d1c0-30bc-935a-f4a846b56383",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.173"
    },
    {
      "id": "c6c4bf15-ffcd-3932-9c1c-e4f1812b50c1",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <c4de6057e7c6654983acb63d939d26ac0d7bbf39"
    },
    {
      "id": "e6711bba-8297-32e2-bf38-e482e9935cf2",
      "product": {
        "name": "Linux"
      },
      "product_version": "b9a24bb76bf611a5268ceffe04219e6ad264559b <facc4405e8b7407e03216207b1d1d640127de0c8"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "249922cf-c848-3027-b6ba-c4d668e3368b",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}