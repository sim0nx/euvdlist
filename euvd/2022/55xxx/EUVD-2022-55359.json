{
  "id": "EUVD-2022-55359",
  "enisaUuid": "eb2e0a58-1635-3713-8146-a68436825009",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/vt-d: avoid invalid memory access via node_online(NUMA_NO_NODE)\n\nKASAN reports:\n\n[ 4.668325][ T0] BUG: KASAN: wild-memory-access in dmar_parse_one_rhsa (arch/x86/include/asm/bitops.h:214 arch/x86/include/asm/bitops.h:226 include/asm-generic/bitops/instrumented-non-atomic.h:142 include/linux/nodemask.h:415 drivers/iommu/intel/dmar.c:497)\n[    4.676149][    T0] Read of size 8 at addr 1fffffff85115558 by task swapper/0/0\n[    4.683454][    T0]\n[    4.685638][    T0] CPU: 0 PID: 0 Comm: swapper/0 Not tainted 5.19.0-rc3-00004-g0e862838f290 #1\n[    4.694331][    T0] Hardware name: Supermicro SYS-5018D-FN4T/X10SDV-8C-TLN4F, BIOS 1.1 03/02/2016\n[    4.703196][    T0] Call Trace:\n[    4.706334][    T0]  <TASK>\n[ 4.709133][ T0] ? dmar_parse_one_rhsa (arch/x86/include/asm/bitops.h:214 arch/x86/include/asm/bitops.h:226 include/asm-generic/bitops/instrumented-non-atomic.h:142 include/linux/nodemask.h:415 drivers/iommu/intel/dmar.c:497)\n\nafter converting the type of the first argument (@nr, bit number)\nof arch_test_bit() from `long` to `unsigned long`[0].\n\nUnder certain conditions (for example, when ACPI NUMA is disabled\nvia command line), pxm_to_node() can return %NUMA_NO_NODE (-1).\nIt is valid 'magic' number of NUMA node, but not valid bit number\nto use in bitops.\nnode_online() eventually descends to test_bit() without checking\nfor the input, assuming it's on caller side (which might be good\nfor perf-critical tasks). There, -1 becomes %ULONG_MAX which leads\nto an insane array index when calculating bit position in memory.\n\nFor now, add an explicit check for @node being not %NUMA_NO_NODE\nbefore calling test_bit(). The actual logics didn't change here\nat all.\n\n[0] https://github.com/norov/linux/commit/0e862838f290147ea9c16db852d8d494b552d38d",
  "datePublished": "Jun 18, 2025, 11:02:31 AM",
  "dateUpdated": "Jun 18, 2025, 11:02:31 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/b12304984654d8e58a2b22ff94c4410906d6267f",
    "https://git.kernel.org/stable/c/5659efdadf04b56707d58c1b758df16d2e0eff2c",
    "https://git.kernel.org/stable/c/0b4c0003aeda32a600f95df53b2848da8a5aa3fa",
    "https://git.kernel.org/stable/c/73ce2046e04ad488cecc66757c36cbe1bdf089d4",
    "https://git.kernel.org/stable/c/c2304c50f4d94f56c2e326f25c9dc8cf2ba6f5fa",
    "https://git.kernel.org/stable/c/b0b0b77ea611e3088e9523e60860f4f41b62b235"
  ],
  "aliases": [
    "CVE-2022-50093"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "1e7c3942-b224-32c5-9da9-5fe6bd0485f1",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.33"
    },
    {
      "id": "265d16d7-2072-3f0e-837c-ec37593b4d70",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <c2304c50f4d94f56c2e326f25c9dc8cf2ba6f5fa"
    },
    {
      "id": "4cd5142e-4d13-30c5-9c92-02ec1d65a513",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.211"
    },
    {
      "id": "4e212b2b-f071-38b4-874e-0c238c952e4e",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <b0b0b77ea611e3088e9523e60860f4f41b62b235"
    },
    {
      "id": "68bd77f3-7fdc-3d7a-b973-6765f0af4c1b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.137"
    },
    {
      "id": "8afaa06e-d142-364d-ae86-6ffd57d3d0d6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "8b625775-517c-3afb-8de8-55d6299472cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.2"
    },
    {
      "id": "8d216241-1a55-3fa9-a691-a39045573395",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.61"
    },
    {
      "id": "abba2ea0-6aaf-3ba6-bc57-f1b72edd220b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "b1321fc3-c6e1-347f-b03c-24c00974374a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.18"
    },
    {
      "id": "d0fbfb5d-2b90-3cdd-9533-cc866407191e",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <b12304984654d8e58a2b22ff94c4410906d6267f"
    },
    {
      "id": "eaeaf41a-23d1-340b-9059-685c2cbd3f18",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <5659efdadf04b56707d58c1b758df16d2e0eff2c"
    },
    {
      "id": "f70450d4-cc96-3199-9191-b3f847515dd9",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <0b4c0003aeda32a600f95df53b2848da8a5aa3fa"
    },
    {
      "id": "fbdaa88f-f69c-3e5a-bab6-d350a3381818",
      "product": {
        "name": "Linux"
      },
      "product_version": "ee34b32d8c2950f66038c8975747ef9aec855289 <73ce2046e04ad488cecc66757c36cbe1bdf089d4"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "ffd6fca6-0045-30bd-8998-d53d8dbc8113",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}