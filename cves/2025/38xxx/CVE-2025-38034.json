{
  "id": "EUVD-2025-18618",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: correct the order of prelim_ref arguments in btrfs__prelim_ref\n\nbtrfs_prelim_ref() calls the old and new reference variables in the\nincorrect order. This causes a NULL pointer dereference because oldref\nis passed as NULL to trace_btrfs_prelim_ref_insert().\n\nNote, trace_btrfs_prelim_ref_insert() is being called with newref as\noldref (and oldref as NULL) on purpose in order to print out\nthe values of newref.\n\nTo reproduce:\necho 1 > /sys/kernel/debug/tracing/events/btrfs/btrfs_prelim_ref_insert/enable\n\nPerform some writeback operations.\n\nBacktrace:\nBUG: kernel NULL pointer dereference, address: 0000000000000018\n #PF: supervisor read access in kernel mode\n #PF: error_code(0x0000) - not-present page\n PGD 115949067 P4D 115949067 PUD 11594a067 PMD 0\n Oops: Oops: 0000 [#1] SMP NOPTI\n CPU: 1 UID: 0 PID: 1188 Comm: fsstress Not tainted 6.15.0-rc2-tester+ #47 PREEMPT(voluntary)  7ca2cef72d5e9c600f0c7718adb6462de8149622\n Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS rel-1.16.3-2-gc13ff2cd-prebuilt.qemu.org 04/01/2014\n RIP: 0010:trace_event_raw_event_btrfs__prelim_ref+0x72/0x130\n Code: e8 43 81 9f ff 48 85 c0 74 78 4d 85 e4 0f 84 8f 00 00 00 49 8b 94 24 c0 06 00 00 48 8b 0a 48 89 48 08 48 8b 52 08 48 89 50 10 <49> 8b 55 18 48 89 50 18 49 8b 55 20 48 89 50 20 41 0f b6 55 28 88\n RSP: 0018:ffffce44820077a0 EFLAGS: 00010286\n RAX: ffff8c6b403f9014 RBX: ffff8c6b55825730 RCX: 304994edf9cf506b\n RDX: d8b11eb7f0fdb699 RSI: ffff8c6b403f9010 RDI: ffff8c6b403f9010\n RBP: 0000000000000001 R08: 0000000000000001 R09: 0000000000000010\n R10: 00000000ffffffff R11: 0000000000000000 R12: ffff8c6b4e8fb000\n R13: 0000000000000000 R14: ffffce44820077a8 R15: ffff8c6b4abd1540\n FS:  00007f4dc6813740(0000) GS:ffff8c6c1d378000(0000) knlGS:0000000000000000\n CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n CR2: 0000000000000018 CR3: 000000010eb42000 CR4: 0000000000750ef0\n PKRU: 55555554\n Call Trace:\n  <TASK>\n  prelim_ref_insert+0x1c1/0x270\n  find_parent_nodes+0x12a6/0x1ee0\n  ? __entry_text_end+0x101f06/0x101f09\n  ? srso_alias_return_thunk+0x5/0xfbef5\n  ? srso_alias_return_thunk+0x5/0xfbef5\n  ? srso_alias_return_thunk+0x5/0xfbef5\n  ? srso_alias_return_thunk+0x5/0xfbef5\n  btrfs_is_data_extent_shared+0x167/0x640\n  ? fiemap_process_hole+0xd0/0x2c0\n  extent_fiemap+0xa5c/0xbc0\n  ? __entry_text_end+0x101f05/0x101f09\n  btrfs_fiemap+0x7e/0xd0\n  do_vfs_ioctl+0x425/0x9d0\n  __x64_sys_ioctl+0x75/0xc0",
  "datePublished": "Jun 18, 2025, 9:33:21 AM",
  "dateUpdated": "Jun 18, 2025, 9:33:21 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/5755b6731655e248c4f1d52a2e1b18795b4a2a3a",
    "https://git.kernel.org/stable/c/a641154cedf9d69730f8af5d0a901fe86e6486bd",
    "https://git.kernel.org/stable/c/a876703894a6dd6e8c04b0635d86e9f7a7c81b79",
    "https://git.kernel.org/stable/c/0528bba48dce7820d2da72e1a114e1c4552367eb",
    "https://git.kernel.org/stable/c/7a97f961a568a8f72472dc804af02a0f73152c5f",
    "https://git.kernel.org/stable/c/7f7c8c03feba5f2454792fab3bb8bd45bd6883f9",
    "https://git.kernel.org/stable/c/137bfa08c6441f324d00692d1e9d22cfd773329b",
    "https://git.kernel.org/stable/c/bc7e0975093567f51be8e1bdf4aa5900a3cf0b1e"
  ],
  "aliases": [
    "CVE-2025-38034"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "05a14343-6880-3b9c-9f10-c23446209ee3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <bc7e0975093567f51be8e1bdf4aa5900a3cf0b1e"
    },
    {
      "id": "08f67dea-2c32-3d48-aff9-8e91c583b1cf",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7f7c8c03feba5f2454792fab3bb8bd45bd6883f9"
    },
    {
      "id": "1838b6f0-6241-3afd-85ca-34baec0d33d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.9"
    },
    {
      "id": "2a3d5b80-8c3f-3eba-a00b-5961f634025d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.141"
    },
    {
      "id": "2c61bf16-ab23-3a3f-8451-388d031e37cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0528bba48dce7820d2da72e1a114e1c4552367eb"
    },
    {
      "id": "2e870923-5b75-3783-b1fe-8c6753a5a616",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7a97f961a568a8f72472dc804af02a0f73152c5f"
    },
    {
      "id": "5b045ebf-e1ea-3634-af18-50ae70c49b73",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.31"
    },
    {
      "id": "64d3018d-3ca1-3741-b954-41f9ee94c4a4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.185"
    },
    {
      "id": "66b4c389-4284-3f9d-a63b-11494939ed2d",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a641154cedf9d69730f8af5d0a901fe86e6486bd"
    },
    {
      "id": "7133ae3e-55e5-351f-96a8-7ac68b66af55",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.238"
    },
    {
      "id": "94d31422-edec-351a-904f-68dc1d00935f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5755b6731655e248c4f1d52a2e1b18795b4a2a3a"
    },
    {
      "id": "a5bb546c-92dc-3fab-aac4-25062461f7b7",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a876703894a6dd6e8c04b0635d86e9f7a7c81b79"
    },
    {
      "id": "a92b69e6-0949-3c96-90cd-d6dca60ac511",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.294"
    },
    {
      "id": "bd028957-f866-3d2b-9160-dc99b7c32486",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.93"
    },
    {
      "id": "be08f57c-d8b3-3321-bac7-66d0e469b4ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15"
    },
    {
      "id": "fb7b83d8-efff-3d68-b306-0509ad3fb777",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <137bfa08c6441f324d00692d1e9d22cfd773329b"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "22fbbc1d-6ae3-3949-a67c-2c4a109fe43b",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38034"
}
