{
  "id": "EUVD-2025-20042",
  "enisaUuid": "addac0f3-fb07-3927-a85b-6813a3f2b8d6",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfbdev: Fix fb_set_var to prevent null-ptr-deref in fb_videomode_to_var\n\nIf fb_add_videomode() in fb_set_var() fails to allocate memory for\nfb_videomode, later it may lead to a null-ptr dereference in\nfb_videomode_to_var(), as the fb_info is registered while not having the\nmode in modelist that is expected to be there, i.e. the one that is\ndescribed in fb_info->var.\n\n================================================================\ngeneral protection fault, probably for non-canonical address 0xdffffc0000000001: 0000 [#1] PREEMPT SMP KASAN NOPTI\nKASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]\nCPU: 1 PID: 30371 Comm: syz-executor.1 Not tainted 5.10.226-syzkaller #0\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.12.0-1 04/01/2014\nRIP: 0010:fb_videomode_to_var+0x24/0x610 drivers/video/fbdev/core/modedb.c:901\nCall Trace:\n display_to_var+0x3a/0x7c0 drivers/video/fbdev/core/fbcon.c:929\n fbcon_resize+0x3e2/0x8f0 drivers/video/fbdev/core/fbcon.c:2071\n resize_screen drivers/tty/vt/vt.c:1176 [inline]\n vc_do_resize+0x53a/0x1170 drivers/tty/vt/vt.c:1263\n fbcon_modechanged+0x3ac/0x6e0 drivers/video/fbdev/core/fbcon.c:2720\n fbcon_update_vcs+0x43/0x60 drivers/video/fbdev/core/fbcon.c:2776\n do_fb_ioctl+0x6d2/0x740 drivers/video/fbdev/core/fbmem.c:1128\n fb_ioctl+0xe7/0x150 drivers/video/fbdev/core/fbmem.c:1203\n vfs_ioctl fs/ioctl.c:48 [inline]\n __do_sys_ioctl fs/ioctl.c:753 [inline]\n __se_sys_ioctl fs/ioctl.c:739 [inline]\n __x64_sys_ioctl+0x19a/0x210 fs/ioctl.c:739\n do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46\n entry_SYSCALL_64_after_hwframe+0x67/0xd1\n================================================================\n\nThe reason is that fb_info->var is being modified in fb_set_var(), and\nthen fb_videomode_to_var() is called. If it fails to add the mode to\nfb_info->modelist, fb_set_var() returns error, but does not restore the\nold value of fb_info->var. Restore fb_info->var on failure the same way\nit is done earlier in the function.\n\nFound by Linux Verification Center (linuxtesting.org) with Syzkaller.",
  "datePublished": "Jul 4, 2025, 1:37:32 PM",
  "dateUpdated": "Jul 28, 2025, 4:15:21 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/ee20216f12d9482cd70e44dae5e7fabb38367c71",
    "https://git.kernel.org/stable/c/fab201d72fde38d081e2c5d4ad25595c535b7b22",
    "https://git.kernel.org/stable/c/1a10d91766eb6ddfd5414e4785611e33a4fe0f9b",
    "https://git.kernel.org/stable/c/ff0e037241173b574b385bff53d67567b9816db5",
    "https://git.kernel.org/stable/c/3ca78032a388a0795201792b36e6fc9b6e6e8eed",
    "https://git.kernel.org/stable/c/b3071bb463ea1e6c686d0dc9638fc940f2f5cf17",
    "https://git.kernel.org/stable/c/8a3a2887794b2c8e78b3e5d6e3de724527c9f41b",
    "https://git.kernel.org/stable/c/05f6e183879d9785a3cdf2f08a498bc31b7a20aa"
  ],
  "aliases": [
    "CVE-2025-38214"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "134b0a3c-f0f4-394e-87b8-c3eda281b8e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1a10d91766eb6ddfd5414e4785611e33a4fe0f9b"
    },
    {
      "id": "1eea8fff-3c95-38df-9fa1-f5ece859bc11",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8a3a2887794b2c8e78b3e5d6e3de724527c9f41b"
    },
    {
      "id": "239d63ce-4848-3824-8d19-05f7ebe23025",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.35"
    },
    {
      "id": "2eac4c46-b078-336e-b5a6-3ed403ba70d8",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3ca78032a388a0795201792b36e6fc9b6e6e8eed"
    },
    {
      "id": "402016b6-f6f9-333c-b1f7-06943a52a6ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b3071bb463ea1e6c686d0dc9638fc940f2f5cf17"
    },
    {
      "id": "63ca193c-ac81-36f0-8c2a-e4e3fa230176",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fab201d72fde38d081e2c5d4ad25595c535b7b22"
    },
    {
      "id": "668eafbd-e4f0-3d5c-84b5-fbe578b541bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.239"
    },
    {
      "id": "6941b9bc-1a80-35cc-9d45-cc34a755aba3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.295"
    },
    {
      "id": "8b6236fb-b1f1-38d5-971e-0528299f1ef9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.186"
    },
    {
      "id": "93c3963b-fc77-3db9-a129-ca817043ef4d",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.12"
    },
    {
      "id": "9d645b1b-7dcf-3822-a4be-88fbede2b93b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <05f6e183879d9785a3cdf2f08a498bc31b7a20aa"
    },
    {
      "id": "a404b3c8-788e-33b2-9477-6d0c8a0caf79",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ee20216f12d9482cd70e44dae5e7fabb38367c71"
    },
    {
      "id": "b1f89b3d-c7e5-3841-b90f-7f9a7588d7ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.4"
    },
    {
      "id": "b7e85c81-c0cc-3a90-a05b-156737800bc3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "b80b3b05-7b21-3a6b-a571-41079dc46acc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.95"
    },
    {
      "id": "b9587655-6009-3fc9-b24d-f2e611ea06dd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "e026d4af-2cf9-3cb7-8252-04ecbd2d6df4",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ff0e037241173b574b385bff53d67567b9816db5"
    },
    {
      "id": "e22fbc3b-751a-30aa-9cf6-b0d996ed054c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "f154beca-d916-3c5a-b55d-f10abb24bc5f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.142"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "41f2af1d-4647-3c77-825c-e1c7915961b4",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}