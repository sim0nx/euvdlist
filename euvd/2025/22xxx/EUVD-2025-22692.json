{
  "id": "EUVD-2025-22692",
  "enisaUuid": "6a9628f9-7499-3697-a5af-df9ba9c0dfce",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/gem: Acquire references on GEM handles for framebuffers\n\nA GEM handle can be released while the GEM buffer object is attached\nto a DRM framebuffer. This leads to the release of the dma-buf backing\nthe buffer object, if any. [1] Trying to use the framebuffer in further\nmode-setting operations leads to a segmentation fault. Most easily\nhappens with driver that use shadow planes for vmap-ing the dma-buf\nduring a page flip. An example is shown below.\n\n[  156.791968] ------------[ cut here ]------------\n[  156.796830] WARNING: CPU: 2 PID: 2255 at drivers/dma-buf/dma-buf.c:1527 dma_buf_vmap+0x224/0x430\n[...]\n[  156.942028] RIP: 0010:dma_buf_vmap+0x224/0x430\n[  157.043420] Call Trace:\n[  157.045898]  <TASK>\n[  157.048030]  ? show_trace_log_lvl+0x1af/0x2c0\n[  157.052436]  ? show_trace_log_lvl+0x1af/0x2c0\n[  157.056836]  ? show_trace_log_lvl+0x1af/0x2c0\n[  157.061253]  ? drm_gem_shmem_vmap+0x74/0x710\n[  157.065567]  ? dma_buf_vmap+0x224/0x430\n[  157.069446]  ? __warn.cold+0x58/0xe4\n[  157.073061]  ? dma_buf_vmap+0x224/0x430\n[  157.077111]  ? report_bug+0x1dd/0x390\n[  157.080842]  ? handle_bug+0x5e/0xa0\n[  157.084389]  ? exc_invalid_op+0x14/0x50\n[  157.088291]  ? asm_exc_invalid_op+0x16/0x20\n[  157.092548]  ? dma_buf_vmap+0x224/0x430\n[  157.096663]  ? dma_resv_get_singleton+0x6d/0x230\n[  157.101341]  ? __pfx_dma_buf_vmap+0x10/0x10\n[  157.105588]  ? __pfx_dma_resv_get_singleton+0x10/0x10\n[  157.110697]  drm_gem_shmem_vmap+0x74/0x710\n[  157.114866]  drm_gem_vmap+0xa9/0x1b0\n[  157.118763]  drm_gem_vmap_unlocked+0x46/0xa0\n[  157.123086]  drm_gem_fb_vmap+0xab/0x300\n[  157.126979]  drm_atomic_helper_prepare_planes.part.0+0x487/0xb10\n[  157.133032]  ? lockdep_init_map_type+0x19d/0x880\n[  157.137701]  drm_atomic_helper_commit+0x13d/0x2e0\n[  157.142671]  ? drm_atomic_nonblocking_commit+0xa0/0x180\n[  157.147988]  drm_mode_atomic_ioctl+0x766/0xe40\n[...]\n[  157.346424] ---[ end trace 0000000000000000 ]---\n\nAcquiring GEM handles for the framebuffer's GEM buffer objects prevents\nthis from happening. The framebuffer's cleanup later puts the handle\nreferences.\n\nCommit 1a148af06000 (\"drm/gem-shmem: Use dma_buf from GEM object\ninstance\") triggers the segmentation fault easily by using the dma-buf\nfield more widely. The underlying issue with reference counting has\nbeen present before.\n\nv2:\n- acquire the handle instead of the BO (Christian)\n- fix comment style (Christian)\n- drop the Fixes tag (Christian)\n- rename err_ gotos\n- add missing Link tag",
  "datePublished": "Jul 25, 2025, 3:27:30 PM",
  "dateUpdated": "Jul 28, 2025, 4:22:34 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/cb4c956a15f8b7f870649454771fc3761f504b5f",
    "https://git.kernel.org/stable/c/08480e285c6a82ce689008d643e4a51db0aaef8b",
    "https://git.kernel.org/stable/c/3cf520d9860d4ec9f7f32068825da31f18dd3f25",
    "https://git.kernel.org/stable/c/5307dce878d4126e1b375587318955bd019c3741"
  ],
  "aliases": [
    "CVE-2025-38449"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "4befde8a-6a89-3ab5-a42d-5a29f2feaf95",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc5"
    },
    {
      "id": "57985146-a7ee-3d9f-844c-c04aaa24cb13",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3cf520d9860d4ec9f7f32068825da31f18dd3f25"
    },
    {
      "id": "6bb9043b-981f-347d-9b86-48aec521b059",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.7"
    },
    {
      "id": "77bb8eb3-eb39-3792-ba47-c265b687c6f0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5307dce878d4126e1b375587318955bd019c3741"
    },
    {
      "id": "85c1973f-d08a-3e01-9570-bed3148b6195",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <08480e285c6a82ce689008d643e4a51db0aaef8b"
    },
    {
      "id": "8ebee9e1-1180-3b66-9c55-91927f6037a2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "9139c7ff-e69a-39ea-8f92-8a5289ad7730",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.99"
    },
    {
      "id": "9c6daaad-8ba3-3b2a-8b2a-b79955a1eb3d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.39"
    },
    {
      "id": "e58ea987-74b8-3b39-9a5f-fc0db97d4d0a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <cb4c956a15f8b7f870649454771fc3761f504b5f"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "84f38616-9aab-347b-9371-e7a777700255",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}