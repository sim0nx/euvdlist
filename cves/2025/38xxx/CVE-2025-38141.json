{
  "id": "EUVD-2025-19802",
  "enisaUuid": "8ff6363f-7274-3427-885e-01d9b85f2419",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm: fix dm_blk_report_zones\n\nIf dm_get_live_table() returned NULL, dm_put_live_table() was never\ncalled. Also, it is possible that md->zone_revalidate_map will change\nwhile calling this function. Only read it once, so that we are always\nusing the same value. Otherwise we might miss a call to\ndm_put_live_table().\n\nFinally, while md->zone_revalidate_map is set and a process is calling\nblk_revalidate_disk_zones() to set up the zone append emulation\nresources, it is possible that another process, perhaps triggered by\nblkdev_report_zones_ioctl(), will call dm_blk_report_zones(). If\nblk_revalidate_disk_zones() fails, these resources can be freed while\nthe other process is still using them, causing a use-after-free error.\n\nblk_revalidate_disk_zones() will only ever be called when initially\nsetting up the zone append emulation resources, such as when setting up\na zoned dm-crypt table for the first time. Further table swaps will not\nset md->zone_revalidate_map or call blk_revalidate_disk_zones().\nHowever it must be called using the new table (referenced by\nmd->zone_revalidate_map) and the new queue limits while the DM device is\nsuspended. dm_blk_report_zones() needs some way to distinguish between a\ncall from blk_revalidate_disk_zones(), which must be allowed to use\nmd->zone_revalidate_map to access this not yet activated table, and all\nother calls to dm_blk_report_zones(), which should not be allowed while\nthe device is suspended and cannot use md->zone_revalidate_map, since\nthe zone resources might be freed by the process currently calling\nblk_revalidate_disk_zones().\n\nSolve this by tracking the process that sets md->zone_revalidate_map in\ndm_revalidate_zones() and only allowing that process to make use of it\nin dm_blk_report_zones().",
  "datePublished": "Jul 3, 2025, 8:35:42 AM",
  "dateUpdated": "Jul 28, 2025, 4:13:20 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/f9c1bdf24615303d48a2d0fd629c88f3189563aa",
    "https://git.kernel.org/stable/c/d19bc1b4dd5f322980b1f05f79b2ea4f0db10920",
    "https://git.kernel.org/stable/c/37f53a2c60d03743e0eacf7a0c01c279776fef4e"
  ],
  "aliases": [
    "CVE-2025-38141"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "0ddc78b9-b814-32e8-a558-b94ddb8f989b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.10"
    },
    {
      "id": "1c8f133c-4764-3fc2-92a6-8337ed428c31",
      "product": {
        "name": "Linux"
      },
      "product_version": "f211268ed1f9bdf48f06a3ead5f5d88437450579 <d19bc1b4dd5f322980b1f05f79b2ea4f0db10920"
    },
    {
      "id": "256be1fa-74d6-38fb-8072-123f2ab7c6f4",
      "product": {
        "name": "Linux"
      },
      "product_version": "f211268ed1f9bdf48f06a3ead5f5d88437450579 <37f53a2c60d03743e0eacf7a0c01c279776fef4e"
    },
    {
      "id": "28f2f290-95f4-34d5-aa01-26f355f80a1a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.3"
    },
    {
      "id": "3b722a8a-eb13-3319-98ad-325f1a159100",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.34"
    },
    {
      "id": "496767f0-419f-35e1-a4a7-1c35ec6805e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "f211268ed1f9bdf48f06a3ead5f5d88437450579 <f9c1bdf24615303d48a2d0fd629c88f3189563aa"
    },
    {
      "id": "672b95e7-3315-38af-a42f-176e528884db",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "cc8e2c49-2f4d-368c-a9cb-eda6278fda09",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "fc217b1d-40f7-3f74-a5c4-7aeb123670cb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8aec98e6-eef5-343f-bb53-549c138b38c9",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38141"
}