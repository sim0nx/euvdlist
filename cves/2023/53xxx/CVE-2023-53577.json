{
  "id": "EUVD-2025-32313",
  "enisaUuid": "d22b8d14-a518-3218-bfc4-fe483291e9c1",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, cpumap: Make sure kthread is running before map update returns\n\nThe following warning was reported when running stress-mode enabled\nxdp_redirect_cpu with some RT threads:\n\n  ------------[ cut here ]------------\n  WARNING: CPU: 4 PID: 65 at kernel/bpf/cpumap.c:135\n  CPU: 4 PID: 65 Comm: kworker/4:1 Not tainted 6.5.0-rc2+ #1\n  Hardware name: QEMU Standard PC (i440FX + PIIX, 1996)\n  Workqueue: events cpu_map_kthread_stop\n  RIP: 0010:put_cpu_map_entry+0xda/0x220\n  ......\n  Call Trace:\n   <TASK>\n   ? show_regs+0x65/0x70\n   ? __warn+0xa5/0x240\n   ......\n   ? put_cpu_map_entry+0xda/0x220\n   cpu_map_kthread_stop+0x41/0x60\n   process_one_work+0x6b0/0xb80\n   worker_thread+0x96/0x720\n   kthread+0x1a5/0x1f0\n   ret_from_fork+0x3a/0x70\n   ret_from_fork_asm+0x1b/0x30\n   </TASK>\n\nThe root cause is the same as commit 436901649731 (\"bpf: cpumap: Fix memory\nleak in cpu_map_update_elem\"). The kthread is stopped prematurely by\nkthread_stop() in cpu_map_kthread_stop(), and kthread() doesn't call\ncpu_map_kthread_run() at all but XDP program has already queued some\nframes or skbs into ptr_ring. So when __cpu_map_ring_cleanup() checks\nthe ptr_ring, it will find it was not emptied and report a warning.\n\nAn alternative fix is to use __cpu_map_ring_cleanup() to drop these\npending frames or skbs when kthread_stop() returns -EINTR, but it may\nconfuse the user, because these frames or skbs have been handled\ncorrectly by XDP program. So instead of dropping these frames or skbs,\njust make sure the per-cpu kthread is running before\n__cpu_map_entry_alloc() returns.\n\nAfter apply the fix, the error handle for kthread_stop() will be\nunnecessary because it will always return 0, so just remove it.",
  "datePublished": "Oct 4, 2025, 3:17:16 PM",
  "dateUpdated": "Oct 4, 2025, 3:17:16 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53577",
    "https://git.kernel.org/stable/c/640a604585aa30f93e39b17d4d6ba69fcb1e66c9",
    "https://git.kernel.org/stable/c/7a1178a3671b40746830d355836b72e47ceb2490",
    "https://git.kernel.org/stable/c/b44d28b98f185d2f2348aa3c3636838c316f889e",
    "https://git.kernel.org/stable/c/ecb45b852af5e88257020b88bea5ff0798d72aca"
  ],
  "aliases": [
    "CVE-2023-53577",
    "GHSA-7977-f593-wgc3"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "00dc91e3-637b-31ea-96af-5004ada1595b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "1b4308c7-754d-3bd2-ace6-e883809ba427",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.126"
    },
    {
      "id": "2e85462e-d92f-32ea-8a6b-e843cca9602a",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.15"
    },
    {
      "id": "4d89e9a1-0025-3cdb-a1a7-f96cf8c82a56",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.5"
    },
    {
      "id": "7c2c37bf-a142-3649-afa1-06231a9ed3bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <ecb45b852af5e88257020b88bea5ff0798d72aca"
    },
    {
      "id": "9d940902-fbe6-3bca-a835-30987d9f8cfc",
      "product": {
        "name": "Linux"
      },
      "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <b44d28b98f185d2f2348aa3c3636838c316f889e"
    },
    {
      "id": "b0b30e47-6904-3485-a84b-f13b7a8d0a72",
      "product": {
        "name": "Linux"
      },
      "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <7a1178a3671b40746830d355836b72e47ceb2490"
    },
    {
      "id": "b8183bb1-b21f-36c8-93a5-986708018f6f",
      "product": {
        "name": "Linux"
      },
      "product_version": "6710e1126934d8b4372b4d2f9ae1646cd3f151bf <640a604585aa30f93e39b17d4d6ba69fcb1e66c9"
    },
    {
      "id": "bd19cd44-e657-30c9-97d3-6c0dbb079962",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.45"
    },
    {
      "id": "d77b0212-5026-3e20-9460-4e3ca5d774ed",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.4.10"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "e68682dc-7310-30fe-92a2-6c8bd82ddd17",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2023-53577"
}