{
  "id": "EUVD-2025-19834",
  "enisaUuid": "ea56298d-87c8-377a-a30b-180af5a65681",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet/mlx5: Fix ECVF vports unload on shutdown flow\n\nFix shutdown flow UAF when a virtual function is created on the embedded\nchip (ECVF) of a BlueField device. In such case the vport acl ingress\ntable is not properly destroyed.\n\nECVF functionality is independent of ecpf_vport_exists capability and\nthus functions mlx5_eswitch_(enable|disable)_pf_vf_vports() should not\ntest it when enabling/disabling ECVF vports.\n\nkernel log:\n[] refcount_t: underflow; use-after-free.\n[] WARNING: CPU: 3 PID: 1 at lib/refcount.c:28\n   refcount_warn_saturate+0x124/0x220\n----------------\n[] Call trace:\n[] refcount_warn_saturate+0x124/0x220\n[] tree_put_node+0x164/0x1e0 [mlx5_core]\n[] mlx5_destroy_flow_table+0x98/0x2c0 [mlx5_core]\n[] esw_acl_ingress_table_destroy+0x28/0x40 [mlx5_core]\n[] esw_acl_ingress_lgcy_cleanup+0x80/0xf4 [mlx5_core]\n[] esw_legacy_vport_acl_cleanup+0x44/0x60 [mlx5_core]\n[] esw_vport_cleanup+0x64/0x90 [mlx5_core]\n[] mlx5_esw_vport_disable+0xc0/0x1d0 [mlx5_core]\n[] mlx5_eswitch_unload_ec_vf_vports+0xcc/0x150 [mlx5_core]\n[] mlx5_eswitch_disable_sriov+0x198/0x2a0 [mlx5_core]\n[] mlx5_device_disable_sriov+0xb8/0x1e0 [mlx5_core]\n[] mlx5_sriov_detach+0x40/0x50 [mlx5_core]\n[] mlx5_unload+0x40/0xc4 [mlx5_core]\n[] mlx5_unload_one_devl_locked+0x6c/0xe4 [mlx5_core]\n[] mlx5_unload_one+0x3c/0x60 [mlx5_core]\n[] shutdown+0x7c/0xa4 [mlx5_core]\n[] pci_device_shutdown+0x3c/0xa0\n[] device_shutdown+0x170/0x340\n[] __do_sys_reboot+0x1f4/0x2a0\n[] __arm64_sys_reboot+0x2c/0x40\n[] invoke_syscall+0x78/0x100\n[] el0_svc_common.constprop.0+0x54/0x184\n[] do_el0_svc+0x30/0xac\n[] el0_svc+0x48/0x160\n[] el0t_64_sync_handler+0xa4/0x12c\n[] el0t_64_sync+0x1a4/0x1a8\n[] --[ end trace 9c4601d68c70030e ]---",
  "datePublished": "Jul 3, 2025, 8:35:19 AM",
  "dateUpdated": "Jul 28, 2025, 4:12:25 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/5953ae44dfe5dbad374318875be834c3b7b71ee6",
    "https://git.kernel.org/stable/c/da15ca0553325acf68039015f2f4db750c8e2b96",
    "https://git.kernel.org/stable/c/24db585d369f949f698e03d7d8017e5ae19d0497",
    "https://git.kernel.org/stable/c/687560d8a9a2d654829ad0da1ec24242f1de711d"
  ],
  "aliases": [
    "CVE-2025-38109"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "3642f1af-52db-33c8-9f22-ce3f2abcd459",
      "product": {
        "name": "Linux"
      },
      "product_version": "a7719b29a82199b90ebbf355d3332e0fbfbf6045 <da15ca0553325acf68039015f2f4db750c8e2b96"
    },
    {
      "id": "44af9b47-bd0a-3214-8cb4-8448d261f4b2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.3"
    },
    {
      "id": "453896ce-e028-3572-9156-53ff7a346262",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc2"
    },
    {
      "id": "6cd90657-7579-3195-a6b7-1636938580bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "a7719b29a82199b90ebbf355d3332e0fbfbf6045 <24db585d369f949f698e03d7d8017e5ae19d0497"
    },
    {
      "id": "7a47d31d-f6ef-3900-975d-1cbc726df519",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.94"
    },
    {
      "id": "7a893ebd-7a6b-3f01-9f5c-02707372752c",
      "product": {
        "name": "Linux"
      },
      "product_version": "a7719b29a82199b90ebbf355d3332e0fbfbf6045 <5953ae44dfe5dbad374318875be834c3b7b71ee6"
    },
    {
      "id": "83926401-d1cb-3634-8ee3-138be645424a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.34"
    },
    {
      "id": "a1db2b3a-0ee6-3baa-8926-f335ccdd8dcc",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.5"
    },
    {
      "id": "d0dfd7b5-3cc7-36f1-bde7-405337ec8add",
      "product": {
        "name": "Linux"
      },
      "product_version": "a7719b29a82199b90ebbf355d3332e0fbfbf6045 <687560d8a9a2d654829ad0da1ec24242f1de711d"
    },
    {
      "id": "d2dc5e14-7c41-3da5-be44-1d080a084e22",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "e67bfe58-b08f-31d4-b120-1cf02af70a60",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "3b16a3da-fe6f-3aed-b50b-57b2e153f4d5",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38109"
}