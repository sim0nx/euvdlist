{
  "id": "EUVD-2025-5200",
  "enisaUuid": "ef694da7-fa03-391a-b1e6-b190e024439b",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: MGMT: Fix slab-use-after-free Read in mgmt_remove_adv_monitor_sync\n\nThis fixes the following crash:\n\n==================================================================\nBUG: KASAN: slab-use-after-free in mgmt_remove_adv_monitor_sync+0x3a/0xd0 net/bluetooth/mgmt.c:5543\nRead of size 8 at addr ffff88814128f898 by task kworker/u9:4/5961\n\nCPU: 1 UID: 0 PID: 5961 Comm: kworker/u9:4 Not tainted 6.12.0-syzkaller-10684-gf1cd565ce577 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\nWorkqueue: hci0 hci_cmd_sync_work\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:94 [inline]\n dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\n print_address_description mm/kasan/report.c:378 [inline]\n print_report+0x169/0x550 mm/kasan/report.c:489\n kasan_report+0x143/0x180 mm/kasan/report.c:602\n mgmt_remove_adv_monitor_sync+0x3a/0xd0 net/bluetooth/mgmt.c:5543\n hci_cmd_sync_work+0x22b/0x400 net/bluetooth/hci_sync.c:332\n process_one_work kernel/workqueue.c:3229 [inline]\n process_scheduled_works+0xa63/0x1850 kernel/workqueue.c:3310\n worker_thread+0x870/0xd30 kernel/workqueue.c:3391\n kthread+0x2f0/0x390 kernel/kthread.c:389\n ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147\n ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244\n </TASK>\n\nAllocated by task 16026:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3f/0x80 mm/kasan/common.c:68\n poison_kmalloc_redzone mm/kasan/common.c:377 [inline]\n __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c:394\n kasan_kmalloc include/linux/kasan.h:260 [inline]\n __kmalloc_cache_noprof+0x243/0x390 mm/slub.c:4314\n kmalloc_noprof include/linux/slab.h:901 [inline]\n kzalloc_noprof include/linux/slab.h:1037 [inline]\n mgmt_pending_new+0x65/0x250 net/bluetooth/mgmt_util.c:269\n mgmt_pending_add+0x36/0x120 net/bluetooth/mgmt_util.c:296\n remove_adv_monitor+0x102/0x1b0 net/bluetooth/mgmt.c:5568\n hci_mgmt_cmd+0xc47/0x11d0 net/bluetooth/hci_sock.c:1712\n hci_sock_sendmsg+0x7b8/0x11c0 net/bluetooth/hci_sock.c:1832\n sock_sendmsg_nosec net/socket.c:711 [inline]\n __sock_sendmsg+0x221/0x270 net/socket.c:726\n sock_write_iter+0x2d7/0x3f0 net/socket.c:1147\n new_sync_write fs/read_write.c:586 [inline]\n vfs_write+0xaeb/0xd30 fs/read_write.c:679\n ksys_write+0x18f/0x2b0 fs/read_write.c:731\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nFreed by task 16022:\n kasan_save_stack mm/kasan/common.c:47 [inline]\n kasan_save_track+0x3f/0x80 mm/kasan/common.c:68\n kasan_save_free_info+0x40/0x50 mm/kasan/generic.c:582\n poison_slab_object mm/kasan/common.c:247 [inline]\n __kasan_slab_free+0x59/0x70 mm/kasan/common.c:264\n kasan_slab_free include/linux/kasan.h:233 [inline]\n slab_free_hook mm/slub.c:2338 [inline]\n slab_free mm/slub.c:4598 [inline]\n kfree+0x196/0x420 mm/slub.c:4746\n mgmt_pending_foreach+0xd1/0x130 net/bluetooth/mgmt_util.c:259\n __mgmt_power_off+0x183/0x430 net/bluetooth/mgmt.c:9550\n hci_dev_close_sync+0x6c4/0x11c0 net/bluetooth/hci_sync.c:5208\n hci_dev_do_close net/bluetooth/hci_core.c:483 [inline]\n hci_dev_close+0x112/0x210 net/bluetooth/hci_core.c:508\n sock_do_ioctl+0x158/0x460 net/socket.c:1209\n sock_ioctl+0x626/0x8e0 net/socket.c:1328\n vfs_ioctl fs/ioctl.c:51 [inline]\n __do_sys_ioctl fs/ioctl.c:906 [inline]\n __se_sys_ioctl+0xf5/0x170 fs/ioctl.c:892\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f",
  "datePublished": "Feb 27, 2025, 2:12:06 AM",
  "dateUpdated": "Jun 19, 2025, 12:56:43 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2024-58013",
    "https://git.kernel.org/stable/c/0f3d05aacbfcf3584bbd9caaee34cb02508dab68",
    "https://git.kernel.org/stable/c/26fbd3494a7dd26269cb0817c289267dbcfdec06",
    "https://git.kernel.org/stable/c/4ebbcb9bc794e5be647ee28fdf14eb1ae0659405",
    "https://git.kernel.org/stable/c/75e65b983c5e2ee51962bfada98a79d805f28827",
    "https://git.kernel.org/stable/c/ebb90f23f0ac21044aacf4c61cc5d7841fe99987"
  ],
  "aliases": [
    "CVE-2024-58013",
    "GHSA-qg99-hc5r-rhvg"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "036c4462-752b-39d1-a6db-4abb302c92dd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.78"
    },
    {
      "id": "104ca583-2945-32aa-8809-bad01a179a08",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cf5c2978f23fdbb2dd7b4e8b07e362ae2d8211c <ebb90f23f0ac21044aacf4c61cc5d7841fe99987"
    },
    {
      "id": "32d112cc-5f57-3b90-8118-de3fd05565ad",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "35e196a3-bc72-3103-880f-57cda1fed4fb",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0f3d05aacbfcf3584bbd9caaee34cb02508dab68"
    },
    {
      "id": "3a350a88-9e2c-32cb-a1eb-274a54dc4132",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cf5c2978f23fdbb2dd7b4e8b07e362ae2d8211c <4ebbcb9bc794e5be647ee28fdf14eb1ae0659405"
    },
    {
      "id": "70baeda2-9f2b-33a1-960b-97d24bda7d8b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <75e65b983c5e2ee51962bfada98a79d805f28827"
    },
    {
      "id": "8870d11e-c299-3b80-9f10-84d09c451047",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <26fbd3494a7dd26269cb0817c289267dbcfdec06"
    },
    {
      "id": "90762a22-ca38-3d1d-8860-1f62e0633e04",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "915e539a-5e58-37c3-921f-f1dd81d3e507",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4ebbcb9bc794e5be647ee28fdf14eb1ae0659405"
    },
    {
      "id": "9cdeb202-324e-3bcb-971f-0ae05d037a52",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cf5c2978f23fdbb2dd7b4e8b07e362ae2d8211c <0f3d05aacbfcf3584bbd9caaee34cb02508dab68"
    },
    {
      "id": "9f7c6884-16dd-3f29-b9f7-f7eeccdee0a4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.129"
    },
    {
      "id": "a50925d0-845b-3399-88b1-83ecd0f54c4b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ebb90f23f0ac21044aacf4c61cc5d7841fe99987"
    },
    {
      "id": "b2cda6d8-e22b-3755-809b-c82e22096cfa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.3"
    },
    {
      "id": "b41d248f-f55b-393a-ac23-d051588525af",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cf5c2978f23fdbb2dd7b4e8b07e362ae2d8211c <26fbd3494a7dd26269cb0817c289267dbcfdec06"
    },
    {
      "id": "d36cb043-120a-3b73-bf6b-d71fcb97a026",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.0"
    },
    {
      "id": "d434f05c-12cd-33b1-b108-402d22f0d604",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.14"
    },
    {
      "id": "fb9e1b6c-dc99-31e9-8611-9af32651014d",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cf5c2978f23fdbb2dd7b4e8b07e362ae2d8211c <75e65b983c5e2ee51962bfada98a79d805f28827"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "193844dc-16ad-355b-96dd-268ef13af6c8",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}