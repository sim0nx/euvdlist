{
  "id": "EUVD-2022-54956",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndm: fix use-after-free in dm_cleanup_zoned_dev()\n\ndm_cleanup_zoned_dev() uses queue, so it must be called\nbefore blk_cleanup_disk() starts its killing:\n\nblk_cleanup_disk->blk_cleanup_queue()->kobject_put()->blk_release_queue()->\n->...RCU...->blk_free_queue_rcu()->kmem_cache_free()\n\nOtherwise, RCU callback may be executed first and\ndm_cleanup_zoned_dev() will touch free'd memory:\n\n BUG: KASAN: use-after-free in dm_cleanup_zoned_dev+0x33/0xd0\n Read of size 8 at addr ffff88805ac6e430 by task dmsetup/681\n\n CPU: 4 PID: 681 Comm: dmsetup Not tainted 5.17.0-rc2+ #6\n Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-2 04/01/2014\n Call Trace:\n  <TASK>\n  dump_stack_lvl+0x57/0x7d\n  print_address_description.constprop.0+0x1f/0x150\n  ? dm_cleanup_zoned_dev+0x33/0xd0\n  kasan_report.cold+0x7f/0x11b\n  ? dm_cleanup_zoned_dev+0x33/0xd0\n  dm_cleanup_zoned_dev+0x33/0xd0\n  __dm_destroy+0x26a/0x400\n  ? dm_blk_ioctl+0x230/0x230\n  ? up_write+0xd8/0x270\n  dev_remove+0x156/0x1d0\n  ctl_ioctl+0x269/0x530\n  ? table_clear+0x140/0x140\n  ? lock_release+0xb2/0x750\n  ? remove_all+0x40/0x40\n  ? rcu_read_lock_sched_held+0x12/0x70\n  ? lock_downgrade+0x3c0/0x3c0\n  ? rcu_read_lock_sched_held+0x12/0x70\n  dm_ctl_ioctl+0xa/0x10\n  __x64_sys_ioctl+0xb9/0xf0\n  do_syscall_64+0x3b/0x90\n  entry_SYSCALL_64_after_hwframe+0x44/0xae\n RIP: 0033:0x7fb6dfa95c27",
  "datePublished": "Feb 27, 2025, 9:32:13 PM",
  "dateUpdated": "Feb 27, 2025, 9:32:13 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0987f00a76a17aa7213da492c00ed9e5a6210c73",
    "https://git.kernel.org/stable/c/fdfe414ca28ddfd562c233fb27385cf820de03e8",
    "https://git.kernel.org/stable/c/43a043aed964659bc69ef81f266912b73c80d837",
    "https://git.kernel.org/stable/c/588b7f5df0cb64f281290c7672470c006abe7160",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49270"
  ],
  "aliases": [
    "CVE-2022-49270"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "0049fd8d-654f-3b9f-a57a-20d1f6d06d0e",
      "product": {
        "name": "Linux"
      },
      "product_version": "bb37d77239af25cde59693dbe3fac04dd17d7b29 <0987f00a76a17aa7213da492c00ed9e5a6210c73"
    },
    {
      "id": "17303883-2198-3dba-8209-9fc5fbcb2699",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    },
    {
      "id": "25d1e469-8747-38e8-a52e-3bd1f0853a45",
      "product": {
        "name": "Linux"
      },
      "product_version": "bb37d77239af25cde59693dbe3fac04dd17d7b29 <588b7f5df0cb64f281290c7672470c006abe7160"
    },
    {
      "id": "2c7ce99e-3f08-34ae-9ef7-d4a2f953fd40",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.14"
    },
    {
      "id": "3135595b-7b5e-33f9-9ab7-52ff83bb3161",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.2"
    },
    {
      "id": "5e685c28-85db-3a4c-becf-3deb396b0ad4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.19"
    },
    {
      "id": "71000ee1-21c1-3578-8b42-9f11e065f15a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "ca4824d0-d62e-3522-9d8b-97388888c34d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.33"
    },
    {
      "id": "d33d45f5-b379-3562-8188-c416fcc5aaae",
      "product": {
        "name": "Linux"
      },
      "product_version": "bb37d77239af25cde59693dbe3fac04dd17d7b29 <fdfe414ca28ddfd562c233fb27385cf820de03e8"
    },
    {
      "id": "fa7cfff8-7ad0-3e75-9d33-0fe42955899f",
      "product": {
        "name": "Linux"
      },
      "product_version": "bb37d77239af25cde59693dbe3fac04dd17d7b29 <43a043aed964659bc69ef81f266912b73c80d837"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7233bf9d-545d-3091-8ad7-4e4a64ce7c31",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49270"
}
