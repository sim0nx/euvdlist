{
  "id": "EUVD-2022-54876",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix warning in ext4_handle_inode_extension\n\nWe got issue as follows:\nEXT4-fs error (device loop0) in ext4_reserve_inode_write:5741: Out of memory\nEXT4-fs error (device loop0): ext4_setattr:5462: inode #13: comm syz-executor.0: mark_inode_dirty error\nEXT4-fs error (device loop0) in ext4_setattr:5519: Out of memory\nEXT4-fs error (device loop0): ext4_ind_map_blocks:595: inode #13: comm syz-executor.0: Can't allocate blocks for non-extent mapped inodes with bigalloc\n------------[ cut here ]------------\nWARNING: CPU: 1 PID: 4361 at fs/ext4/file.c:301 ext4_file_write_iter+0x11c9/0x1220\nModules linked in:\nCPU: 1 PID: 4361 Comm: syz-executor.0 Not tainted 5.10.0+ #1\nRIP: 0010:ext4_file_write_iter+0x11c9/0x1220\nRSP: 0018:ffff924d80b27c00 EFLAGS: 00010282\nRAX: ffffffff815a3379 RBX: 0000000000000000 RCX: 000000003b000000\nRDX: ffff924d81601000 RSI: 00000000000009cc RDI: 00000000000009cd\nRBP: 000000000000000d R08: ffffffffbc5a2c6b R09: 0000902e0e52a96f\nR10: ffff902e2b7c1b40 R11: ffff902e2b7c1b40 R12: 000000000000000a\nR13: 0000000000000001 R14: ffff902e0e52aa10 R15: ffffffffffffff8b\nFS:  00007f81a7f65700(0000) GS:ffff902e3bc80000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: ffffffffff600400 CR3: 000000012db88001 CR4: 00000000003706e0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n do_iter_readv_writev+0x2e5/0x360\n do_iter_write+0x112/0x4c0\n do_pwritev+0x1e5/0x390\n __x64_sys_pwritev2+0x7e/0xa0\n do_syscall_64+0x37/0x50\n entry_SYSCALL_64_after_hwframe+0x44/0xa9\n\nAbove issue may happen as follows:\nAssume\ninode.i_size=4096\nEXT4_I(inode)->i_disksize=4096\n\nstep 1: set inode->i_isize = 8192\next4_setattr\n  if (attr->ia_size != inode->i_size)\n    EXT4_I(inode)->i_disksize = attr->ia_size;\n    rc = ext4_mark_inode_dirty\n       ext4_reserve_inode_write\n          ext4_get_inode_loc\n            __ext4_get_inode_loc\n              sb_getblk --> return -ENOMEM\n   ...\n   if (!error)  ->will not update i_size\n     i_size_write(inode, attr->ia_size);\nNow:\ninode.i_size=4096\nEXT4_I(inode)->i_disksize=8192\n\nstep 2: Direct write 4096 bytes\next4_file_write_iter\n ext4_dio_write_iter\n   iomap_dio_rw ->return error\n if (extend)\n   ext4_handle_inode_extension\n     WARN_ON_ONCE(i_size_read(inode) < EXT4_I(inode)->i_disksize);\n->Then trigger warning.\n\nTo solve above issue, if mark inode dirty failed in ext4_setattr just\nset 'EXT4_I(inode)->i_disksize' with old value.",
  "datePublished": "Feb 26, 2025, 2:11:04 AM",
  "dateUpdated": "Jun 19, 2025, 12:56:19 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0ab308d72af7548f21e4499d025c25887da0c26a",
    "https://git.kernel.org/stable/c/adf490083ca52ebfb0b2fe64ff1ead00c0452dd7",
    "https://git.kernel.org/stable/c/b81d2ff6885e38fc745eeaf9565775055778fc0b",
    "https://git.kernel.org/stable/c/e383c2aa5f02ab571530dc5c5696479672478c25",
    "https://git.kernel.org/stable/c/1bcce88da60eccc946c0f4ed942b0f08cd565778",
    "https://git.kernel.org/stable/c/f4534c9fc94d22383f187b9409abb3f9df2e3db3"
  ],
  "aliases": [
    "CVE-2022-49352"
  ],
  "assigner": "Linux",
  "epss": 0.13,
  "enisaIdProduct": [
    {
      "id": "05f0c90a-955f-3f1e-952d-6528f5583ec2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f4534c9fc94d22383f187b9409abb3f9df2e3db3"
    },
    {
      "id": "15bd9644-d91b-39e5-8875-c73cbfcd5afe",
      "product": {
        "name": "Linux"
      },
      "product_version": "b1b4705d54abedfd69dcdf42779c521aa1e0fbd3 <f4534c9fc94d22383f187b9409abb3f9df2e3db3"
    },
    {
      "id": "3b367613-9a13-3d4a-8b89-d0318f848271",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <b81d2ff6885e38fc745eeaf9565775055778fc0b"
    },
    {
      "id": "45f767b4-4d65-33a6-92d3-da5a2620edd1",
      "product": {
        "name": "Linux"
      },
      "product_version": "b1b4705d54abedfd69dcdf42779c521aa1e0fbd3 <adf490083ca52ebfb0b2fe64ff1ead00c0452dd7"
    },
    {
      "id": "4b043175-9fd4-3f5f-9a86-d33403175e93",
      "product": {
        "name": "Linux"
      },
      "product_version": "b1b4705d54abedfd69dcdf42779c521aa1e0fbd3 <e383c2aa5f02ab571530dc5c5696479672478c25"
    },
    {
      "id": "77386a12-9d01-3eba-a59c-0271aae8e597",
      "product": {
        "name": "Linux"
      },
      "product_version": "b1b4705d54abedfd69dcdf42779c521aa1e0fbd3 <b81d2ff6885e38fc745eeaf9565775055778fc0b"
    },
    {
      "id": "7a6948f3-63ec-3d19-9059-10912a6048b8",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1bcce88da60eccc946c0f4ed942b0f08cd565778"
    },
    {
      "id": "8298db7b-9eee-3e36-856c-8a702ee6cd3f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0ab308d72af7548f21e4499d025c25887da0c26a"
    },
    {
      "id": "9547338e-cb55-3ee2-a092-89020b6a52e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.198"
    },
    {
      "id": "96f71680-d530-3ceb-81eb-3df6bca13950",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.5"
    },
    {
      "id": "ae7f339d-7e0b-3086-b4ea-128813b2a011",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "af88b330-231a-398a-bfcd-52c0a5e07e9c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <adf490083ca52ebfb0b2fe64ff1ead00c0452dd7"
    },
    {
      "id": "e0468897-7be0-3610-890d-c6df59100de3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.3"
    },
    {
      "id": "e0a8fc8c-6d90-31f3-b60b-35e6eec119f3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.14"
    },
    {
      "id": "e0ec4811-ebef-348d-94da-ce1f344bb1f4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.46"
    },
    {
      "id": "e5f03329-7e6d-3143-a6a5-da843229707e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "efd8967a-0dad-3da1-9ee2-4e88dfdc2f97",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.121"
    },
    {
      "id": "f5a224e6-fb12-3537-9f56-0975c1db6bd2",
      "product": {
        "name": "Linux"
      },
      "product_version": "b1b4705d54abedfd69dcdf42779c521aa1e0fbd3 <1bcce88da60eccc946c0f4ed942b0f08cd565778"
    },
    {
      "id": "fab458bb-e077-3fc8-a180-c678860439a1",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e383c2aa5f02ab571530dc5c5696479672478c25"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "6287f786-4cfd-3ed6-a244-ca307818324d",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49352"
}
