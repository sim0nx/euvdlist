{
  "id": "EUVD-2025-13073",
  "enisaUuid": "045479ad-3eaa-3bfc-8ef5-12d1d3af3e04",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to avoid out-of-bounds access in f2fs_truncate_inode_blocks()\n\nsyzbot reports an UBSAN issue as below:\n\n------------[ cut here ]------------\nUBSAN: array-index-out-of-bounds in fs/f2fs/node.h:381:10\nindex 18446744073709550692 is out of range for type '__le32[5]' (aka 'unsigned int[5]')\nCPU: 0 UID: 0 PID: 5318 Comm: syz.0.0 Not tainted 6.14.0-rc3-syzkaller-00060-g6537cfb395f3 #0\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:94 [inline]\n dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\n ubsan_epilogue lib/ubsan.c:231 [inline]\n __ubsan_handle_out_of_bounds+0x121/0x150 lib/ubsan.c:429\n get_nid fs/f2fs/node.h:381 [inline]\n f2fs_truncate_inode_blocks+0xa5e/0xf60 fs/f2fs/node.c:1181\n f2fs_do_truncate_blocks+0x782/0x1030 fs/f2fs/file.c:808\n f2fs_truncate_blocks+0x10d/0x300 fs/f2fs/file.c:836\n f2fs_truncate+0x417/0x720 fs/f2fs/file.c:886\n f2fs_file_write_iter+0x1bdb/0x2550 fs/f2fs/file.c:5093\n aio_write+0x56b/0x7c0 fs/aio.c:1633\n io_submit_one+0x8a7/0x18a0 fs/aio.c:2052\n __do_sys_io_submit fs/aio.c:2111 [inline]\n __se_sys_io_submit+0x171/0x2e0 fs/aio.c:2081\n do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\nRIP: 0033:0x7f238798cde9\n\nindex 18446744073709550692 (decimal, unsigned long long)\n= 0xfffffffffffffc64 (hexadecimal, unsigned long long)\n= -924 (decimal, long long)\n\nIn f2fs_truncate_inode_blocks(), UBSAN detects that get_nid() tries to\naccess .i_nid[-924], it means both offset[0] and level should zero.\n\nThe possible case should be in f2fs_do_truncate_blocks(), we try to\ntruncate inode size to zero, however, dn.ofs_in_node is zero and\ndn.node_page is not an inode page, so it fails to truncate inode page,\nand then pass zeroed free_from to f2fs_truncate_inode_blocks(), result\nin this issue.\n\n\tif (dn.ofs_in_node || IS_INODE(dn.node_page)) {\n\t\tf2fs_truncate_data_blocks_range(&dn, count);\n\t\tfree_from += count;\n\t}\n\nI guess the reason why dn.node_page is not an inode page could be: there\nare multiple nat entries share the same node block address, once the node\nblock address was reused, f2fs_get_node_page() may load a non-inode block.\n\nLet's add a sanity check for such condition to avoid out-of-bounds access\nissue.",
  "datePublished": "May 1, 2025, 12:55:48 PM",
  "dateUpdated": "Jul 11, 2025, 5:21:40 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-37739",
    "https://git.kernel.org/stable/c/6ba8b41d0aa4b82f90f0c416cb53fcef9696525d",
    "https://git.kernel.org/stable/c/8b5e5aac44fee122947a269f9034c048e4c295de",
    "https://git.kernel.org/stable/c/98dbf2af63de0b551082c9bc48333910e009b09f",
    "https://git.kernel.org/stable/c/d7242fd7946d4cba0411effb6b5048ca55125747",
    "https://git.kernel.org/stable/c/e6494977bd4a83862118a05f57a8df40256951c0",
    "https://git.kernel.org/stable/c/ecc461331604b07cdbdb7360dbdf78471653264c",
    "https://git.kernel.org/stable/c/a67e1bf03c609a751d1740a1789af25e599966fa",
    "https://git.kernel.org/stable/c/67e16ccba74dd8de0a7b10062f1e02d77432f573"
  ],
  "aliases": [
    "CVE-2025-37739",
    "GHSA-qc3f-4c25-g23q"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "00b5e3af-1d08-339a-96a0-2bc9895b0602",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.8"
    },
    {
      "id": "0776c5a4-3738-314f-943a-b31c6c2a2162",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <67e16ccba74dd8de0a7b10062f1e02d77432f573"
    },
    {
      "id": "2ccc266a-6738-3b93-a3aa-1c9d20341154",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.24"
    },
    {
      "id": "35bdfa44-5c46-3fba-b38c-ca0d3ec6fbd6",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <e6494977bd4a83862118a05f57a8df40256951c0"
    },
    {
      "id": "3736518f-0e41-376b-bc26-0a6ee4e71a8f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.237"
    },
    {
      "id": "3ab801a0-b559-32ef-b429-55542db41eed",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <6ba8b41d0aa4b82f90f0c416cb53fcef9696525d"
    },
    {
      "id": "3bb5462f-bbc5-30d5-91ad-c79237c279a0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <d7242fd7946d4cba0411effb6b5048ca55125747"
    },
    {
      "id": "3c4087bf-87f3-3ad8-83e2-160e3b310d45",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6ba8b41d0aa4b82f90f0c416cb53fcef9696525d"
    },
    {
      "id": "41ddc5b6-4fcf-3258-b270-a34304c55e15",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <98dbf2af63de0b551082c9bc48333910e009b09f"
    },
    {
      "id": "5a5737a3-422a-36ec-9eb4-b8d13fd15611",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <67e16ccba74dd8de0a7b10062f1e02d77432f573"
    },
    {
      "id": "60e6886f-fb65-3719-80a1-611101223cc3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "6cc82d79-8723-38f4-a1d0-33a42a855ac1",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <8b5e5aac44fee122947a269f9034c048e4c295de"
    },
    {
      "id": "7f58a946-a561-35d6-a2a7-c14f5ae2cabb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15-rc1"
    },
    {
      "id": "8f317066-e8c6-39ab-928c-283cac38bd76",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8b5e5aac44fee122947a269f9034c048e4c295de"
    },
    {
      "id": "96deea5f-c138-318c-bced-2e9209d2d250",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <ecc461331604b07cdbdb7360dbdf78471653264c"
    },
    {
      "id": "a4b7107a-e3db-3765-9951-5537ca4aaf8f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e6494977bd4a83862118a05f57a8df40256951c0"
    },
    {
      "id": "ae1cb67f-b30b-3c93-8035-b2b6c6cf8fbb",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14.3"
    },
    {
      "id": "afb9a961-8b58-3ef4-94ed-6119a2928213",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <98dbf2af63de0b551082c9bc48333910e009b09f"
    },
    {
      "id": "bb3a0593-e490-37a8-8532-0da4d8370af6",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <a67e1bf03c609a751d1740a1789af25e599966fa"
    },
    {
      "id": "bd8e32fe-67e5-311d-96a8-da852eca21bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.12"
    },
    {
      "id": "cad0c461-d2c8-388d-a747-fe751afbf109",
      "product": {
        "name": "Linux"
      },
      "product_version": "98e4da8ca301e062d79ae168c67e56f3c3de3ce4 <d7242fd7946d4cba0411effb6b5048ca55125747"
    },
    {
      "id": "ceccd521-5a92-3ab7-9c37-e5406f5b38b3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ecc461331604b07cdbdb7360dbdf78471653264c"
    },
    {
      "id": "d3f7663a-f62f-3017-af6a-518630f34b43",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.181"
    },
    {
      "id": "d7c735f0-04c8-33e4-89aa-4bb2b0d6665b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.88"
    },
    {
      "id": "e5d01206-76ed-3885-afad-e7e1749f8e42",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15"
    },
    {
      "id": "e96f134c-b518-3ab3-af40-e5445cd62876",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.135"
    },
    {
      "id": "f99daac1-6832-3144-ad33-347154f0f595",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a67e1bf03c609a751d1740a1789af25e599966fa"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "e604df81-c669-3753-a087-0456c7f1ca7d",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}