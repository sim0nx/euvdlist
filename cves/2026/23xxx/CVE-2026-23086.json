{
  "id": "EUVD-2026-5456",
  "enisaUuid": "03b83943-0186-3d24-b9eb-30d438beb885",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nvsock/virtio: cap TX credit to local buffer size\n\nThe virtio transports derives its TX credit directly from peer_buf_alloc,\nwhich is set from the remote endpoint's SO_VM_SOCKETS_BUFFER_SIZE value.\n\nOn the host side this means that the amount of data we are willing to\nqueue for a connection is scaled by a guest-chosen buffer size, rather\nthan the host's own vsock configuration. A malicious guest can advertise\na large buffer and read slowly, causing the host to allocate a\ncorrespondingly large amount of sk_buff memory.\nThe same thing would happen in the guest with a malicious host, since\nvirtio transports share the same code base.\n\nIntroduce a small helper, virtio_transport_tx_buf_size(), that\nreturns min(peer_buf_alloc, buf_alloc), and use it wherever we consume\npeer_buf_alloc.\n\nThis ensures the effective TX window is bounded by both the peer's\nadvertised buffer and our own buf_alloc (already clamped to\nbuffer_max_size via SO_VM_SOCKETS_BUFFER_MAX_SIZE), so a remote peer\ncannot force the other to queue more data than allowed by its own\nvsock settings.\n\nOn an unpatched Ubuntu 22.04 host (~64 GiB RAM), running a PoC with\n32 guest vsock connections advertising 2 GiB each and reading slowly\ndrove Slab/SUnreclaim from ~0.5 GiB to ~57 GiB; the system only\nrecovered after killing the QEMU process. That said, if QEMU memory is\nlimited with cgroups, the maximum memory used will be limited.\n\nWith this patch applied:\n\n  Before:\n    MemFree:        ~61.6 GiB\n    Slab:           ~142 MiB\n    SUnreclaim:     ~117 MiB\n\n  After 32 high-credit connections:\n    MemFree:        ~61.5 GiB\n    Slab:           ~178 MiB\n    SUnreclaim:     ~152 MiB\n\nOnly ~35 MiB increase in Slab/SUnreclaim, no host OOM, and the guest\nremains responsive.\n\nCompatibility with non-virtio transports:\n\n  - VMCI uses the AF_VSOCK buffer knobs to size its queue pairs per\n    socket based on the local vsk->buffer_* values; the remote side\n    cannot enlarge those queues beyond what the local endpoint\n    configured.\n\n  - Hyper-V's vsock transport uses fixed-size VMBus ring buffers and\n    an MTU bound; there is no peer-controlled credit field comparable\n    to peer_buf_alloc, and the remote endpoint cannot drive in-flight\n    kernel memory above those ring sizes.\n\n  - The loopback path reuses virtio_transport_common.c, so it\n    naturally follows the same semantics as the virtio transport.\n\nThis change is limited to virtio_transport_common.c and thus affects\nvirtio-vsock, vhost-vsock, and loopback, bringing them in line with the\n\"remote window intersected with local policy\" behaviour that VMCI and\nHyper-V already effectively have.\n\n[Stefano: small adjustments after changing the previous patch]\n[Stefano: tweak the commit message]",
  "datePublished": "Feb 4, 2026, 4:08:10 PM",
  "dateUpdated": "Feb 4, 2026, 4:08:10 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/d9d5f222558b42f6277eafaaa6080966faf37676",
    "https://git.kernel.org/stable/c/c0e42fb0e054c2b2ec4ee80f48ccd256ae0227ce",
    "https://git.kernel.org/stable/c/84ef86aa7120449828d1e0ce438c499014839711",
    "https://git.kernel.org/stable/c/8ee784fdf006cbe8739cfa093f54d326cbf54037"
  ],
  "aliases": [
    "CVE-2026-23086"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "11013fac-b445-3ba1-90c9-7e40c2777bed",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.19-rc7"
    },
    {
      "id": "2fa8d968-bba3-3bc2-a92c-75dec6bfdb0f",
      "product": {
        "name": "Linux"
      },
      "product_version": "06a8fc78367d070720af960dcecec917d3ae5f3b <8ee784fdf006cbe8739cfa093f54d326cbf54037"
    },
    {
      "id": "36c8dd14-93f0-3306-b46a-17b15ded9957",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "437aa219-c367-3a61-a223-60e0b17e570b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.122"
    },
    {
      "id": "8495b4dd-7c5f-393c-8e13-374eb7741656",
      "product": {
        "name": "Linux"
      },
      "product_version": "06a8fc78367d070720af960dcecec917d3ae5f3b <d9d5f222558b42f6277eafaaa6080966faf37676"
    },
    {
      "id": "8d0fe31a-d784-3e16-bfc3-f02f6a1a4360",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18.8"
    },
    {
      "id": "a117c85e-a0a3-3d29-a2d3-633431bf3f8a",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.8"
    },
    {
      "id": "bd023190-6002-3e9f-9d83-a335ca8a7e9e",
      "product": {
        "name": "Linux"
      },
      "product_version": "06a8fc78367d070720af960dcecec917d3ae5f3b <84ef86aa7120449828d1e0ce438c499014839711"
    },
    {
      "id": "d0a99f49-17c8-36a2-8718-5ff067eb0bcc",
      "product": {
        "name": "Linux"
      },
      "product_version": "06a8fc78367d070720af960dcecec917d3ae5f3b <c0e42fb0e054c2b2ec4ee80f48ccd256ae0227ce"
    },
    {
      "id": "dd35e833-9b0c-3386-b981-b3b0c36a211e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.68"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "1568b644-9f65-3ecb-b97f-c63ebf4690bf",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2026-23086"
}