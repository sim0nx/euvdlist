{
  "id": "EUVD-2025-34578",
  "enisaUuid": "af09de38-0bd2-37f6-a3f8-0d8996dc5ec6",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmedia: i2c: tc358743: Fix use-after-free bugs caused by orphan timer in probe\n\nThe state->timer is a cyclic timer that schedules work_i2c_poll and\ndelayed_work_enable_hotplug, while rearming itself. Using timer_delete()\nfails to guarantee the timer isn't still running when destroyed, similarly\ncancel_delayed_work() cannot ensure delayed_work_enable_hotplug has\nterminated if already executing. During probe failure after timer\ninitialization, these may continue running as orphans and reference the\nalready-freed tc358743_state object through tc358743_irq_poll_timer.\n\nThe following is the trace captured by KASAN.\n\nBUG: KASAN: slab-use-after-free in __run_timer_base.part.0+0x7d7/0x8c0\nWrite of size 8 at addr ffff88800ded83c8 by task swapper/1/0\n...\nCall Trace:\n <IRQ>\n dump_stack_lvl+0x55/0x70\n print_report+0xcf/0x610\n ? __pfx_sched_balance_find_src_group+0x10/0x10\n ? __run_timer_base.part.0+0x7d7/0x8c0\n kasan_report+0xb8/0xf0\n ? __run_timer_base.part.0+0x7d7/0x8c0\n __run_timer_base.part.0+0x7d7/0x8c0\n ? rcu_sched_clock_irq+0xb06/0x27d0\n ? __pfx___run_timer_base.part.0+0x10/0x10\n ? try_to_wake_up+0xb15/0x1960\n ? tmigr_update_events+0x280/0x740\n ? _raw_spin_lock_irq+0x80/0xe0\n ? __pfx__raw_spin_lock_irq+0x10/0x10\n tmigr_handle_remote_up+0x603/0x7e0\n ? __pfx_tmigr_handle_remote_up+0x10/0x10\n ? sched_balance_trigger+0x98/0x9f0\n ? sched_tick+0x221/0x5a0\n ? _raw_spin_lock_irq+0x80/0xe0\n ? __pfx__raw_spin_lock_irq+0x10/0x10\n ? tick_nohz_handler+0x339/0x440\n ? __pfx_tmigr_handle_remote_up+0x10/0x10\n __walk_groups.isra.0+0x42/0x150\n tmigr_handle_remote+0x1f4/0x2e0\n ? __pfx_tmigr_handle_remote+0x10/0x10\n ? ktime_get+0x60/0x140\n ? lapic_next_event+0x11/0x20\n ? clockevents_program_event+0x1d4/0x2a0\n ? hrtimer_interrupt+0x322/0x780\n handle_softirqs+0x16a/0x550\n irq_exit_rcu+0xaf/0xe0\n sysvec_apic_timer_interrupt+0x70/0x80\n </IRQ>\n...\n\nAllocated by task 141:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n __kasan_kmalloc+0x7f/0x90\n __kmalloc_node_track_caller_noprof+0x198/0x430\n devm_kmalloc+0x7b/0x1e0\n tc358743_probe+0xb7/0x610  i2c_device_probe+0x51d/0x880\n really_probe+0x1ca/0x5c0\n __driver_probe_device+0x248/0x310\n driver_probe_device+0x44/0x120\n __device_attach_driver+0x174/0x220\n bus_for_each_drv+0x100/0x190\n __device_attach+0x206/0x370\n bus_probe_device+0x123/0x170\n device_add+0xd25/0x1470\n i2c_new_client_device+0x7a0/0xcd0\n do_one_initcall+0x89/0x300\n do_init_module+0x29d/0x7f0\n load_module+0x4f48/0x69e0\n init_module_from_file+0xe4/0x150\n idempotent_init_module+0x320/0x670\n __x64_sys_finit_module+0xbd/0x120\n do_syscall_64+0xac/0x280\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nFreed by task 141:\n kasan_save_stack+0x24/0x50\n kasan_save_track+0x14/0x30\n kasan_save_free_info+0x3a/0x60\n __kasan_slab_free+0x3f/0x50\n kfree+0x137/0x370\n release_nodes+0xa4/0x100\n devres_release_group+0x1b2/0x380\n i2c_device_probe+0x694/0x880\n really_probe+0x1ca/0x5c0\n __driver_probe_device+0x248/0x310\n driver_probe_device+0x44/0x120\n __device_attach_driver+0x174/0x220\n bus_for_each_drv+0x100/0x190\n __device_attach+0x206/0x370\n bus_probe_device+0x123/0x170\n device_add+0xd25/0x1470\n i2c_new_client_device+0x7a0/0xcd0\n do_one_initcall+0x89/0x300\n do_init_module+0x29d/0x7f0\n load_module+0x4f48/0x69e0\n init_module_from_file+0xe4/0x150\n idempotent_init_module+0x320/0x670\n __x64_sys_finit_module+0xbd/0x120\n do_syscall_64+0xac/0x280\n entry_SYSCALL_64_after_hwframe+0x77/0x7f\n...\n\nReplace timer_delete() with timer_delete_sync() and cancel_delayed_work()\nwith cancel_delayed_work_sync() to ensure proper termination of timer and\nwork items before resource cleanup.\n\nThis bug was initially identified through static analysis. For reproduction\nand testing, I created a functional emulation of the tc358743 device via a\nkernel module and introduced faults through the debugfs interface.",
  "datePublished": "Oct 15, 2025, 7:58:20 AM",
  "dateUpdated": "Oct 19, 2025, 2:48:56 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/228d06c4cbfc750f1216a3fd91b4693b0766d2f6",
    "https://git.kernel.org/stable/c/f92181c0e13cad9671d07b15be695a97fc2534a3",
    "https://git.kernel.org/stable/c/f3f3f00bcabbd2ce0a77a2ac7a6797b8646bfd8b",
    "https://git.kernel.org/stable/c/2610617effb4454d2f1c434c011ccb5cc7140711",
    "https://git.kernel.org/stable/c/79d10f4f21a92e459b2276a77be62c59c1502c9d",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39995",
    "https://git.kernel.org/stable/c/3d17701c156579969470e58b3a906511f8bc018d",
    "https://git.kernel.org/stable/c/663faf1179db9663a3793c75e9bc869358bad910"
  ],
  "aliases": [
    "CVE-2025-39995"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "19f59a7e-b142-385c-befa-e294f9915331",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.111"
    },
    {
      "id": "1ca2672b-252a-3277-aabb-02daa9c197a6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.195"
    },
    {
      "id": "26e3dac7-17d8-3564-ae10-22fded4b0aea",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17.1"
    },
    {
      "id": "47672f7f-5b8f-3637-a0cc-56eb04d6cc29",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <2610617effb4454d2f1c434c011ccb5cc7140711"
    },
    {
      "id": "4e242e81-7c43-3bb7-a50b-824500dd95c0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18-rc1"
    },
    {
      "id": "5d67b5e7-d06d-363b-bec1-166448c99471",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <f92181c0e13cad9671d07b15be695a97fc2534a3"
    },
    {
      "id": "6ca9a236-6a9a-3347-86d6-c4c1b1bd02d0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.11"
    },
    {
      "id": "7a12d8d8-1f75-34ee-a46e-333980e7252f",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <79d10f4f21a92e459b2276a77be62c59c1502c9d"
    },
    {
      "id": "a2236b5b-41d2-3328-9f90-11fef68088f9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "ae5ebd10-0080-31ad-bca1-d4382f2cc1da",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.3"
    },
    {
      "id": "b8d90cfd-67c5-3bf7-8bae-853c6e307b6b",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <3d17701c156579969470e58b3a906511f8bc018d"
    },
    {
      "id": "b900820f-5a5c-333b-a4f5-0aa2fd788595",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.156"
    },
    {
      "id": "c065cf32-fd2c-3be6-a185-64efc55c805c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.52"
    },
    {
      "id": "d2adb7a3-9bfb-383c-8b8c-9790d6b36f8d",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <663faf1179db9663a3793c75e9bc869358bad910"
    },
    {
      "id": "d52fac4a-d3e8-3fa2-aa25-c34c989c1316",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <f3f3f00bcabbd2ce0a77a2ac7a6797b8646bfd8b"
    },
    {
      "id": "e95cbdfa-513a-3c7f-a43b-15126c0949ba",
      "product": {
        "name": "Linux"
      },
      "product_version": "d32d98642de66048f9534a05f3641558e811bbc9 <228d06c4cbfc750f1216a3fd91b4693b0766d2f6"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7c2a50fb-55f7-3341-9e7f-0679653b1f01",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39995"
}