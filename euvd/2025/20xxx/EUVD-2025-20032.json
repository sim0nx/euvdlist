{
  "id": "EUVD-2025-20032",
  "enisaUuid": "8436669b-17b4-394a-a65c-93d3e4caf513",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: kvaser_pciefd: refine error prone echo_skb_max handling logic\n\necho_skb_max should define the supported upper limit of echo_skb[]\nallocated inside the netdevice's priv. The corresponding size value\nprovided by this driver to alloc_candev() is KVASER_PCIEFD_CAN_TX_MAX_COUNT\nwhich is 17.\n\nBut later echo_skb_max is rounded up to the nearest power of two (for the\nmax case, that would be 32) and the tx/ack indices calculated further\nduring tx/rx may exceed the upper array boundary. Kasan reported this for\nthe ack case inside kvaser_pciefd_handle_ack_packet(), though the xmit\nfunction has actually caught the same thing earlier.\n\n BUG: KASAN: slab-out-of-bounds in kvaser_pciefd_handle_ack_packet+0x2d7/0x92a drivers/net/can/kvaser_pciefd.c:1528\n Read of size 8 at addr ffff888105e4f078 by task swapper/4/0\n\n CPU: 4 UID: 0 PID: 0 Comm: swapper/4 Not tainted 6.15.0 #12 PREEMPT(voluntary)\n Call Trace:\n  <IRQ>\n dump_stack_lvl lib/dump_stack.c:122\n print_report mm/kasan/report.c:521\n kasan_report mm/kasan/report.c:634\n kvaser_pciefd_handle_ack_packet drivers/net/can/kvaser_pciefd.c:1528\n kvaser_pciefd_read_packet drivers/net/can/kvaser_pciefd.c:1605\n kvaser_pciefd_read_buffer drivers/net/can/kvaser_pciefd.c:1656\n kvaser_pciefd_receive_irq drivers/net/can/kvaser_pciefd.c:1684\n kvaser_pciefd_irq_handler drivers/net/can/kvaser_pciefd.c:1733\n __handle_irq_event_percpu kernel/irq/handle.c:158\n handle_irq_event kernel/irq/handle.c:210\n handle_edge_irq kernel/irq/chip.c:833\n __common_interrupt arch/x86/kernel/irq.c:296\n common_interrupt arch/x86/kernel/irq.c:286\n  </IRQ>\n\nTx max count definitely matters for kvaser_pciefd_tx_avail(), but for seq\nnumbers' generation that's not the case - we're free to calculate them as\nwould be more convenient, not taking tx max count into account. The only\ndownside is that the size of echo_skb[] should correspond to the max seq\nnumber (not tx max count), so in some situations a bit more memory would\nbe consumed than could be.\n\nThus make the size of the underlying echo_skb[] sufficient for the rounded\nmax tx value.\n\nFound by Linux Verification Center (linuxtesting.org) with Syzkaller.",
  "datePublished": "Jul 4, 2025, 1:37:39 PM",
  "dateUpdated": "Jul 28, 2025, 4:15:36 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/d8a054b6e6824a8b52c3977ebd38c9583a63efac",
    "https://git.kernel.org/stable/c/a6550c9aa11e2f57f9cdaa6249cdd44d446be874",
    "https://git.kernel.org/stable/c/54ec8b08216f3be2cc98b33633d3c8ea79749895"
  ],
  "aliases": [
    "CVE-2025-38224"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "2abf6d5e-9ff6-38e4-bc69-32f5680397f8",
      "product": {
        "name": "Linux"
      },
      "product_version": "f14512f3ee09cda986191c8dd7f54972afa2c763"
    },
    {
      "id": "3306d496-5aa6-31be-82da-66d66b9ce8e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "3a900f9f-c025-3807-ad56-b3e81a72127c",
      "product": {
        "name": "Linux"
      },
      "product_version": "352fbde14177d608a54120b6ff559ce5b3cf6238 <d8a054b6e6824a8b52c3977ebd38c9583a63efac"
    },
    {
      "id": "a04d07f9-7684-3de2-a70f-d3f1e3186b1b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.15"
    },
    {
      "id": "a54313cf-c61e-3fb2-85c2-533e54348ba8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "b5af6946-6fe3-377c-afa5-5db186999312",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.4"
    },
    {
      "id": "d41c0617-a010-3f7e-8a94-18b98c25bbbe",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.35"
    },
    {
      "id": "d6a0e293-466f-3177-85dc-d72e65363e32",
      "product": {
        "name": "Linux"
      },
      "product_version": "8256e0ca601051933e9395746817f3801fa9a6bf <54ec8b08216f3be2cc98b33633d3c8ea79749895"
    },
    {
      "id": "e7cd5f11-52a8-38ac-a38c-35194a581d93",
      "product": {
        "name": "Linux"
      },
      "product_version": "8256e0ca601051933e9395746817f3801fa9a6bf <a6550c9aa11e2f57f9cdaa6249cdd44d446be874"
    },
    {
      "id": "fc8e32bb-0ac6-3f82-9f4e-77b848f764e6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "6ef6f939-fa55-3a44-929b-ba0b69d7b9fc",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}