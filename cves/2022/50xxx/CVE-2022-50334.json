{
  "id": "EUVD-2022-55521",
  "enisaUuid": "7dbb5f66-fbb3-3db0-8e72-0e19ad9cf0dd",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nhugetlbfs: fix null-ptr-deref in hugetlbfs_parse_param()\n\nSyzkaller reports a null-ptr-deref bug as follows:\n======================================================\nKASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]\nRIP: 0010:hugetlbfs_parse_param+0x1dd/0x8e0 fs/hugetlbfs/inode.c:1380\n[...]\nCall Trace:\n <TASK>\n vfs_parse_fs_param fs/fs_context.c:148 [inline]\n vfs_parse_fs_param+0x1f9/0x3c0 fs/fs_context.c:129\n vfs_parse_fs_string+0xdb/0x170 fs/fs_context.c:191\n generic_parse_monolithic+0x16f/0x1f0 fs/fs_context.c:231\n do_new_mount fs/namespace.c:3036 [inline]\n path_mount+0x12de/0x1e20 fs/namespace.c:3370\n do_mount fs/namespace.c:3383 [inline]\n __do_sys_mount fs/namespace.c:3591 [inline]\n __se_sys_mount fs/namespace.c:3568 [inline]\n __x64_sys_mount+0x27f/0x300 fs/namespace.c:3568\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n [...]\n </TASK>\n======================================================\n\nAccording to commit \"vfs: parse: deal with zero length string value\",\nkernel will set the param->string to null pointer in vfs_parse_fs_string()\nif fs string has zero length.\n\nYet the problem is that, hugetlbfs_parse_param() will dereference the\nparam->string, without checking whether it is a null pointer.  To be more\nspecific, if hugetlbfs_parse_param() parses an illegal mount parameter,\nsuch as \"size=,\", kernel will constructs struct fs_parameter with null\npointer in vfs_parse_fs_string(), then passes this struct fs_parameter to\nhugetlbfs_parse_param(), which triggers the above null-ptr-deref bug.\n\nThis patch solves it by adding sanity check on param->string\nin hugetlbfs_parse_param().",
  "datePublished": "Sep 15, 2025, 3:31:27 PM",
  "dateUpdated": "Sep 15, 2025, 3:31:28 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/fa71639873518e3587632ae58e25e4a96b57fa90",
    "https://git.kernel.org/stable/c/dcd28191be9bbf307ba51a5b485773a55b0037c4",
    "https://git.kernel.org/stable/c/9a8862820cbf1f18dca4f3b4c289d88561b3a384",
    "https://git.kernel.org/stable/c/965e8f8ae0f642b5528f5a82b7bcaf15a659d5bd",
    "https://git.kernel.org/stable/c/f2207145693ae5697a7b59e2add4b92f9e5b0e3c",
    "https://git.kernel.org/stable/c/26215b7ee923b9251f7bb12c4e5f09dc465d35f2",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50334"
  ],
  "aliases": [
    "CVE-2022-50334"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "10dd3ffa-2d87-37ca-bdba-18ee8fc266b8",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <9a8862820cbf1f18dca4f3b4c289d88561b3a384"
    },
    {
      "id": "34e3c245-cfae-34a8-b201-04b78146a116",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.2"
    },
    {
      "id": "64829d39-cd94-3abe-b76d-786bea171f62",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.16"
    },
    {
      "id": "a310acb8-1941-31e3-9435-e2ac55223c1a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.163"
    },
    {
      "id": "a67b1219-94c7-3453-a1d2-e6a77a740f14",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <26215b7ee923b9251f7bb12c4e5f09dc465d35f2"
    },
    {
      "id": "b0ad4c35-fde4-3721-ab3b-808dca61c7e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <965e8f8ae0f642b5528f5a82b7bcaf15a659d5bd"
    },
    {
      "id": "bd93f03b-544c-3c2e-8174-3729997ed156",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2"
    },
    {
      "id": "d0a32917-7d7a-3eae-99d2-05f63b87c35b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.229"
    },
    {
      "id": "d6683511-6f83-38c9-abe5-d73114edc8dd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.86"
    },
    {
      "id": "d7df181b-e20a-391c-9eea-c5d0dee8c88c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <fa71639873518e3587632ae58e25e4a96b57fa90"
    },
    {
      "id": "eac6057d-796d-35ec-a97d-35a2f36989c0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <dcd28191be9bbf307ba51a5b485773a55b0037c4"
    },
    {
      "id": "f2b1a11d-8167-3982-a77a-8a785f537599",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <f2207145693ae5697a7b59e2add4b92f9e5b0e3c"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "43ed89d6-c0ec-39c5-8ca8-45d804edd140",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50334"
}