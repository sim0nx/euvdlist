{
  "id": "EUVD-2025-20898",
  "enisaUuid": "2a45be64-6ceb-3d83-a3b6-a0933e8382f2",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nwifi: p54: prevent buffer-overflow in p54_rx_eeprom_readback()\n\nRobert Morris reported:\n\n|If a malicious USB device pretends to be an Intersil p54 wifi\n|interface and generates an eeprom_readback message with a large\n|eeprom->v1.len, p54_rx_eeprom_readback() will copy data from the\n|message beyond the end of priv->eeprom.\n|\n|static void p54_rx_eeprom_readback(struct p54_common *priv,\n|                                   struct sk_buff *skb)\n|{\n|        struct p54_hdr *hdr = (struct p54_hdr *) skb->data;\n|        struct p54_eeprom_lm86 *eeprom = (struct p54_eeprom_lm86 *) hdr->data;\n|\n|        if (priv->fw_var >= 0x509) {\n|                memcpy(priv->eeprom, eeprom->v2.data,\n|                       le16_to_cpu(eeprom->v2.len));\n|        } else {\n|                memcpy(priv->eeprom, eeprom->v1.data,\n|                       le16_to_cpu(eeprom->v1.len));\n|        }\n| [...]\n\nThe eeprom->v{1,2}.len is set by the driver in p54_download_eeprom().\nThe device is supposed to provide the same length back to the driver.\nBut yes, it's possible (like shown in the report) to alter the value\nto something that causes a crash/panic due to overrun.\n\nThis patch addresses the issue by adding the size to the common device\ncontext, so p54_rx_eeprom_readback no longer relies on possibly tampered\nvalues... That said, it also checks if the \"firmware\" altered the value\nand no longer copies them.\n\nThe one, small saving grace is: Before the driver tries to read the eeprom,\nit needs to upload >a< firmware. the vendor firmware has a proprietary\nlicense and as a reason, it is not present on most distributions by\ndefault.",
  "datePublished": "Jul 10, 2025, 8:15:15 AM",
  "dateUpdated": "Jul 28, 2025, 4:19:35 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/12134f79e53eb56b0b0b7447fa0c512acf6a8422",
    "https://git.kernel.org/stable/c/9701f842031b825e2fd5f22d064166f8f13f6e4d",
    "https://git.kernel.org/stable/c/1f7f8168abe8cbe845ab8bb557228d44784a6b57",
    "https://git.kernel.org/stable/c/f39b2f8c1549a539846e083790fad396ef6cd802",
    "https://git.kernel.org/stable/c/0e4dc150423b829c35cbcf399481ca11594fc036",
    "https://git.kernel.org/stable/c/6d05390d20f110de37d051a3e063ef0a542d01fb",
    "https://git.kernel.org/stable/c/714afb4c38edd19a057d519c1f9c5d164b43de94",
    "https://git.kernel.org/stable/c/da1b9a55ff116cb040528ef664c70a4eec03ae99"
  ],
  "aliases": [
    "CVE-2025-38348"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "1ab98656-3bc4-37ab-aa34-6397440dd261",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.4"
    },
    {
      "id": "1bd0ca73-eef9-3354-a783-5285398f8939",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <6d05390d20f110de37d051a3e063ef0a542d01fb"
    },
    {
      "id": "1bfb4689-d243-3c11-a20e-aef725bcaa46",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.295"
    },
    {
      "id": "35088e8d-efed-3db5-9b13-094f24f4ff93",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "503b2503-57b0-3d5c-b24c-1ba4b3a6196b",
      "product": {
        "name": "Linux"
      },
      "product_version": "2.6.28"
    },
    {
      "id": "53643c17-0622-3fdd-b631-337656d87457",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.186"
    },
    {
      "id": "7a076af3-d966-3bf2-9903-44883758842a",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <da1b9a55ff116cb040528ef664c70a4eec03ae99"
    },
    {
      "id": "7b7ee429-19d9-37a2-af0b-4fb270f7c9ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.239"
    },
    {
      "id": "7ba73cc5-a15f-312c-b8df-d870a82f4c7d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "7d815d73-a1f2-3ad8-aad7-adf3c6bf3771",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <12134f79e53eb56b0b0b7447fa0c512acf6a8422"
    },
    {
      "id": "939c8c9d-3a89-3a47-8b59-dfc9c9647396",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.35"
    },
    {
      "id": "9df8a71e-6cda-36e2-8cc1-a499536e8244",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <f39b2f8c1549a539846e083790fad396ef6cd802"
    },
    {
      "id": "a176f05e-3bf7-391c-9ec7-e07cea9e5d51",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "abd4f5a7-943b-3371-97c1-c0622d88b66d",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <714afb4c38edd19a057d519c1f9c5d164b43de94"
    },
    {
      "id": "b469cb27-3383-341e-a392-e440a286d117",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.95"
    },
    {
      "id": "ca7cd920-525f-3bad-b349-3e2c844a349e",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <0e4dc150423b829c35cbcf399481ca11594fc036"
    },
    {
      "id": "ee8261da-4cb6-3378-a9ec-d2ca1fb96d21",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.142"
    },
    {
      "id": "f69da23b-c7ec-3b09-b9b6-673a1db41dbe",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <1f7f8168abe8cbe845ab8bb557228d44784a6b57"
    },
    {
      "id": "f8b9c800-d37b-34c7-8dbb-0130e98b1da4",
      "product": {
        "name": "Linux"
      },
      "product_version": "7cb770729ba895f73253dfcd46c3fcba45d896f9 <9701f842031b825e2fd5f22d064166f8f13f6e4d"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "030f7b15-7597-3e85-bd89-a55432481904",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}