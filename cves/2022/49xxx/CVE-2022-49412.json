{
  "id": "EUVD-2022-54817",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbfq: Avoid merging queues with different parents\n\nIt can happen that the parent of a bfqq changes between the moment we\ndecide two queues are worth to merge (and set bic->stable_merge_bfqq)\nand the moment bfq_setup_merge() is called. This can happen e.g. because\nthe process submitted IO for a different cgroup and thus bfqq got\nreparented. It can even happen that the bfqq we are merging with has\nparent cgroup that is already offline and going to be destroyed in which\ncase the merge can lead to use-after-free issues such as:\n\nBUG: KASAN: use-after-free in __bfq_deactivate_entity+0x9cb/0xa50\nRead of size 8 at addr ffff88800693c0c0 by task runc:[2:INIT]/10544\n\nCPU: 0 PID: 10544 Comm: runc:[2:INIT] Tainted: G            E     5.15.2-0.g5fb85fd-default #1 openSUSE Tumbleweed (unreleased) f1f3b891c72369aebecd2e43e4641a6358867c70\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a-rebuilt.opensuse.org 04/01/2014\nCall Trace:\n <IRQ>\n dump_stack_lvl+0x46/0x5a\n print_address_description.constprop.0+0x1f/0x140\n ? __bfq_deactivate_entity+0x9cb/0xa50\n kasan_report.cold+0x7f/0x11b\n ? __bfq_deactivate_entity+0x9cb/0xa50\n __bfq_deactivate_entity+0x9cb/0xa50\n ? update_curr+0x32f/0x5d0\n bfq_deactivate_entity+0xa0/0x1d0\n bfq_del_bfqq_busy+0x28a/0x420\n ? resched_curr+0x116/0x1d0\n ? bfq_requeue_bfqq+0x70/0x70\n ? check_preempt_wakeup+0x52b/0xbc0\n __bfq_bfqq_expire+0x1a2/0x270\n bfq_bfqq_expire+0xd16/0x2160\n ? try_to_wake_up+0x4ee/0x1260\n ? bfq_end_wr_async_queues+0xe0/0xe0\n ? _raw_write_unlock_bh+0x60/0x60\n ? _raw_spin_lock_irq+0x81/0xe0\n bfq_idle_slice_timer+0x109/0x280\n ? bfq_dispatch_request+0x4870/0x4870\n __hrtimer_run_queues+0x37d/0x700\n ? enqueue_hrtimer+0x1b0/0x1b0\n ? kvm_clock_get_cycles+0xd/0x10\n ? ktime_get_update_offsets_now+0x6f/0x280\n hrtimer_interrupt+0x2c8/0x740\n\nFix the problem by checking that the parent of the two bfqqs we are\nmerging in bfq_setup_merge() is the same.",
  "datePublished": "Feb 26, 2025, 2:12:34 AM",
  "dateUpdated": "Jun 19, 2025, 12:39:08 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://git.kernel.org/stable/c/97be7d13fbd4001eeab49b1be6399f23a8c66160",
    "https://git.kernel.org/stable/c/7d172b9dc913e161d8ff88770eea01701ff553de",
    "https://git.kernel.org/stable/c/5ee21edaed09e6b25f2c007b3f326752bc89bacf",
    "https://git.kernel.org/stable/c/a16c65cca7d2c7ff965fdd3adc8df2156529caf1",
    "https://git.kernel.org/stable/c/8abc8763b11c35e03cc91d59fd0cd28d39f88ca9",
    "https://git.kernel.org/stable/c/c1cee4ab36acef271be9101590756ed0c0c374d9",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49412"
  ],
  "aliases": [
    "CVE-2022-49412"
  ],
  "assigner": "Linux",
  "epss": 0.1,
  "enisaIdProduct": [
    {
      "id": "10ff41fc-0f36-3248-9517-745d9e8c54ab",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <8abc8763b11c35e03cc91d59fd0cd28d39f88ca9"
    },
    {
      "id": "113b503c-b263-392e-af8c-5d7eb82ae2ec",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <a16c65cca7d2c7ff965fdd3adc8df2156529caf1"
    },
    {
      "id": "1dd4c329-9a10-34fc-95a8-95965ff15128",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.46"
    },
    {
      "id": "3f5a6a2e-dfb7-384f-a54e-3f9511ecaee7",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <7d172b9dc913e161d8ff88770eea01701ff553de"
    },
    {
      "id": "47c99ca0-be98-335b-a4ca-6692777e904e",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <5ee21edaed09e6b25f2c007b3f326752bc89bacf"
    },
    {
      "id": "4d5fa435-05c1-36af-a13d-0e9a9dfd991c",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <97be7d13fbd4001eeab49b1be6399f23a8c66160"
    },
    {
      "id": "5c27c0f8-bc0b-3325-8b19-b916393c5970",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.14"
    },
    {
      "id": "6e885d64-5ec2-3df0-85a5-aede259a88e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.13"
    },
    {
      "id": "815d720c-4f94-3375-85cc-27c6793c931a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.3"
    },
    {
      "id": "ac75c29f-cd4c-39e0-86fe-582f794e1608",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.121"
    },
    {
      "id": "d1cee729-53a7-353c-a7ad-5baed86c9e38",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.198"
    },
    {
      "id": "d8108c54-0a05-30c4-918f-1ff13787ac8e",
      "product": {
        "name": "Linux"
      },
      "product_version": "430a67f9d6169a7b3e328bceb2ef9542e4153c7c <c1cee4ab36acef271be9101590756ed0c0c374d9"
    },
    {
      "id": "fa3e10ba-eb80-3a5e-b930-124d321bcf6d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "fdb8848d-1c93-30a1-bd44-0025557857ab",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "29275468-35d4-3fa5-b208-cc046580e4b2",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49412"
}
