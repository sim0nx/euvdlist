{
  "id": "EUVD-2024-51892",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: fix to account dirty data in __get_secs_required()\n\nIt will trigger system panic w/ testcase in [1]:\n\n------------[ cut here ]------------\nkernel BUG at fs/f2fs/segment.c:2752!\nRIP: 0010:new_curseg+0xc81/0x2110\nCall Trace:\n f2fs_allocate_data_block+0x1c91/0x4540\n do_write_page+0x163/0xdf0\n f2fs_outplace_write_data+0x1aa/0x340\n f2fs_do_write_data_page+0x797/0x2280\n f2fs_write_single_data_page+0x16cd/0x2190\n f2fs_write_cache_pages+0x994/0x1c80\n f2fs_write_data_pages+0x9cc/0xea0\n do_writepages+0x194/0x7a0\n filemap_fdatawrite_wbc+0x12b/0x1a0\n __filemap_fdatawrite_range+0xbb/0xf0\n file_write_and_wait_range+0xa1/0x110\n f2fs_do_sync_file+0x26f/0x1c50\n f2fs_sync_file+0x12b/0x1d0\n vfs_fsync_range+0xfa/0x230\n do_fsync+0x3d/0x80\n __x64_sys_fsync+0x37/0x50\n x64_sys_call+0x1e88/0x20d0\n do_syscall_64+0x4b/0x110\n entry_SYSCALL_64_after_hwframe+0x76/0x7e\n\nThe root cause is if checkpoint_disabling and lfs_mode are both on,\nit will trigger OPU for all overwritten data, it may cost more free\nsegment than expected, so f2fs must account those data correctly to\ncalculate cosumed free segments later, and return ENOSPC earlier to\navoid run out of free segment during block allocation.\n\n[1] https://lore.kernel.org/fstests/20241015025106.3203676-1-chao@kernel.org/",
  "datePublished": "Dec 27, 2024, 1:50:05 PM",
  "dateUpdated": "Jan 20, 2025, 6:21:30 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/6e58b2987960efcd917bc42da781cee256213618",
    "https://git.kernel.org/stable/c/f1b8bfe8d2f2fdf905d37c174d5bc1cd2b6910c5",
    "https://git.kernel.org/stable/c/9313b85ddc120e2d2f0efaf86d0204d4c98d60b1",
    "https://git.kernel.org/stable/c/e812871c068cc0f91ff9f5cee87d00df1c44aae4",
    "https://git.kernel.org/stable/c/1acd73edbbfef2c3c5b43cba4006a7797eca7050"
  ],
  "aliases": [
    "CVE-2024-53220"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "363c00a5-bda6-3ff1-9059-0727bf15a64e",
      "product": {
        "name": "Linux"
      },
      "product_version": "4354994f097d068a894aa1a0860da54571df3582 <f1b8bfe8d2f2fdf905d37c174d5bc1cd2b6910c5"
    },
    {
      "id": "5a91d9ba-865c-3b62-bf91-bc1bfdf762ac",
      "product": {
        "name": "Linux"
      },
      "product_version": "4354994f097d068a894aa1a0860da54571df3582 <6e58b2987960efcd917bc42da781cee256213618"
    },
    {
      "id": "63afc956-00df-3109-aba4-dc08e50fde2c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "64c6c17a-913e-3c20-a741-e482874baffa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.64"
    },
    {
      "id": "6797c853-3c10-3a27-bba0-1148135a48f1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.2"
    },
    {
      "id": "90c49ac8-6773-3e37-9b47-7341eb65d766",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "b9c86b48-0e27-3da0-b6cb-18ec1ef87b32",
      "product": {
        "name": "Linux"
      },
      "product_version": "4354994f097d068a894aa1a0860da54571df3582 <1acd73edbbfef2c3c5b43cba4006a7797eca7050"
    },
    {
      "id": "cce9eff2-f490-39fd-a0ac-e2589eec754f",
      "product": {
        "name": "Linux"
      },
      "product_version": "4354994f097d068a894aa1a0860da54571df3582 <9313b85ddc120e2d2f0efaf86d0204d4c98d60b1"
    },
    {
      "id": "cd62e7aa-7527-3441-9671-5176ec07a4e7",
      "product": {
        "name": "Linux"
      },
      "product_version": "4354994f097d068a894aa1a0860da54571df3582 <e812871c068cc0f91ff9f5cee87d00df1c44aae4"
    },
    {
      "id": "d1a522de-db83-384b-a852-6b3b7f0e9597",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.11"
    },
    {
      "id": "d8342f79-3cb9-37ae-8a4d-bbcc168261b1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.120"
    },
    {
      "id": "efc99ae0-3a58-3c3c-a501-b7188dd67d78",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.20"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "33cf9a7b-1808-3e54-9506-9e81590a2536",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2024-53220"
}
