{
  "id": "EUVD-2022-54610",
  "enisaUuid": "4f310216-b87e-366a-9991-888de4a31a12",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: avoid skb access on nf_stolen\n\nWhen verdict is NF_STOLEN, the skb might have been freed.\n\nWhen tracing is enabled, this can result in a use-after-free:\n1. access to skb->nf_trace\n2. access to skb->mark\n3. computation of trace id\n4. dump of packet payload\n\nTo avoid 1, keep a cached copy of skb->nf_trace in the\ntrace state struct.\nRefresh this copy whenever verdict is != STOLEN.\n\nAvoid 2 by skipping skb->mark access if verdict is STOLEN.\n\n3 is avoided by precomputing the trace id.\n\nOnly dump the packet when verdict is not \"STOLEN\".",
  "datePublished": "Feb 27, 2025, 9:32:14 PM",
  "dateUpdated": "Feb 27, 2025, 9:32:14 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/0016d5d46d7440729a3132f61a8da3bf7f84e2ba",
    "https://git.kernel.org/stable/c/e34b9ed96ce3b06c79bf884009b16961ca478f87",
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49622"
  ],
  "aliases": [
    "CVE-2022-49622"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "0c1ed07e-e0ab-36fb-b869-1383dfa19b6a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.13"
    },
    {
      "id": "cafaed0a-bc95-33f9-a542-eb68b0b36016",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0016d5d46d7440729a3132f61a8da3bf7f84e2ba"
    },
    {
      "id": "ea7e6711-0a4f-34ae-b956-162e6ad952fa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "fcbf7949-8c60-3066-9d2e-66c39157b89f",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <e34b9ed96ce3b06c79bf884009b16961ca478f87"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "9957d162-ce63-3868-8a87-592b580f5cee",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}