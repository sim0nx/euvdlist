{
  "id": "EUVD-2025-12880",
  "enisaUuid": "4d04235d-2456-3948-833e-a2373f3d3ab0",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ncapabilities: fix potential memleak on error path from vfs_getxattr_alloc()\n\nIn cap_inode_getsecurity(), we will use vfs_getxattr_alloc() to\ncomplete the memory allocation of tmpbuf, if we have completed\nthe memory allocation of tmpbuf, but failed to call handler->get(...),\nthere will be a memleak in below logic:\n\n  |-- ret = (int)vfs_getxattr_alloc(mnt_userns, ...)\n    |           /* ^^^ alloc for tmpbuf */\n    |-- value = krealloc(*xattr_value, error + 1, flags)\n    |           /* ^^^ alloc memory */\n    |-- error = handler->get(handler, ...)\n    |           /* error! */\n    |-- *xattr_value = value\n    |           /* xattr_value is &tmpbuf (memory leak!) */\n\nSo we will try to free(tmpbuf) after vfs_getxattr_alloc() fails to fix it.\n\n[PM: subject line and backtrace tweaks]",
  "datePublished": "May 1, 2025, 2:10:34 PM",
  "dateUpdated": "Oct 1, 2025, 4:08:36 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49890",
    "https://git.kernel.org/stable/c/0c3e6288da650d1ec911a259c77bc2d88e498603",
    "https://git.kernel.org/stable/c/2de8eec8afb75792440b8900a01d52b8f6742fd1",
    "https://git.kernel.org/stable/c/6bb00eb21c0fbf18e5d3538c9ff0cf63fd0ace85",
    "https://git.kernel.org/stable/c/7480aeff0093d8c54377553ec6b31110bea37b4d",
    "https://git.kernel.org/stable/c/8cf0a1bc12870d148ae830a4ba88cfdf0e879cee",
    "https://git.kernel.org/stable/c/90577bcc01c4188416a47269f8433f70502abe98",
    "https://git.kernel.org/stable/c/cdf01c807e974048c43c7fd3ca574f6086a57906"
  ],
  "aliases": [
    "CVE-2022-49890",
    "GHSA-wxgf-7f8j-hr6j"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "0f3b57ea-d4fb-351d-bd38-59b77f1172c3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "111e5618-968b-3f6f-9b12-5280cae625d1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "200ef787-44d4-3375-8da3-6f24b38d340d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.8"
    },
    {
      "id": "43174ed3-0592-3e26-9521-adc5f4c914f5",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <8cf0a1bc12870d148ae830a4ba88cfdf0e879cee"
    },
    {
      "id": "55c26d12-1f4f-3544-97dd-44853225a520",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.78"
    },
    {
      "id": "60b1b091-d596-3491-9566-77c3fb548889",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <7480aeff0093d8c54377553ec6b31110bea37b4d"
    },
    {
      "id": "63d9e6cb-276d-3a23-b46f-8f33b20ff075",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.14"
    },
    {
      "id": "6a23bdb7-324a-3e81-b99f-678e1eeb78f3",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <90577bcc01c4188416a47269f8433f70502abe98"
    },
    {
      "id": "7de9cba1-b779-3839-a6b3-bf2e30f667f6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.224"
    },
    {
      "id": "8976a84e-0496-33c9-958b-9c9dc336613d",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <6bb00eb21c0fbf18e5d3538c9ff0cf63fd0ace85"
    },
    {
      "id": "c3cef257-98e9-3700-9973-6c15b7d97d81",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <2de8eec8afb75792440b8900a01d52b8f6742fd1"
    },
    {
      "id": "c88d90c7-638b-3100-a29e-1260754c8691",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <0c3e6288da650d1ec911a259c77bc2d88e498603"
    },
    {
      "id": "d6dea076-253c-3fe4-8dd8-4892441fab45",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.265"
    },
    {
      "id": "dbb13b9b-1ef6-35d9-893b-bb32ea724713",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.154"
    },
    {
      "id": "e2e78755-1f3c-3133-b190-c7f54864327b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.299"
    },
    {
      "id": "f942a7eb-592f-326a-bf49-a7eb7f89de6f",
      "product": {
        "name": "Linux"
      },
      "product_version": "8db6c34f1dbc8e06aa016a9b829b06902c3e1340 <cdf01c807e974048c43c7fd3ca574f6086a57906"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "cffef398-5bbf-326e-8a2a-03ca77444326",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}