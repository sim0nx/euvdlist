{
  "id": "EUVD-2025-2621",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nafs: Fix merge preference rule failure condition\n\nsyzbot reported a lock held when returning to userspace[1].  This is\nbecause if argc is less than 0 and the function returns directly, the held\ninode lock is not released.\n\nFix this by store the error in ret and jump to done to clean up instead of\nreturning directly.\n\n[dh: Modified Lizhi Xu's original patch to make it honour the error code\nfrom afs_split_string()]\n\n[1]\nWARNING: lock held when returning to user space!\n6.13.0-rc3-syzkaller-00209-g499551201b5f #0 Not tainted\n------------------------------------------------\nsyz-executor133/5823 is leaving the kernel with locks still held!\n1 lock held by syz-executor133/5823:\n #0: ffff888071cffc00 (&sb->s_type->i_mutex_key#9){++++}-{4:4}, at: inode_lock include/linux/fs.h:818 [inline]\n #0: ffff888071cffc00 (&sb->s_type->i_mutex_key#9){++++}-{4:4}, at: afs_proc_addr_prefs_write+0x2bb/0x14e0 fs/afs/addr_prefs.c:388",
  "datePublished": "Jan 31, 2025, 11:25:35 AM",
  "dateUpdated": "Apr 5, 2025, 10:39:37 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/22be1d90a6211c88dd093b25d1f3aa974d0d9f9d",
    "https://git.kernel.org/stable/c/17a4fde81d3a7478d97d15304a6d61094a10c2e3"
  ],
  "aliases": [
    "CVE-2025-21672"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "258481ff-c3f9-39a2-ac58-28ffd87f78d7",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <22be1d90a6211c88dd093b25d1f3aa974d0d9f9d"
    },
    {
      "id": "29bdf354-69b0-3727-85d1-ca057baceb65",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.8"
    },
    {
      "id": "2eecc8c4-302e-3bea-aef3-adcc7d1b969a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "342b0964-8e68-3efb-9a7f-79e75d9f3363",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.11"
    },
    {
      "id": "3f4eebe6-2fc0-3ab7-bb0e-cfd8cc31585c",
      "product": {
        "name": "Linux"
      },
      "product_version": "f94f70d39cc2d54079ebae934862198516315db2 <22be1d90a6211c88dd093b25d1f3aa974d0d9f9d"
    },
    {
      "id": "4cd25f79-626a-3b6d-9aae-3117cca76cd5",
      "product": {
        "name": "Linux"
      },
      "product_version": "f94f70d39cc2d54079ebae934862198516315db2 <17a4fde81d3a7478d97d15304a6d61094a10c2e3"
    },
    {
      "id": "744849f9-ec12-325f-9ac7-59a4f561fa36",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <17a4fde81d3a7478d97d15304a6d61094a10c2e3"
    },
    {
      "id": "bc1ca18f-1b13-3e36-b95a-928287197ebd",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "5587c2b6-7f08-3525-a320-7bb044cdbedb",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-21672"
}
