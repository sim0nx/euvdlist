{
  "id": "EUVD-2025-25574",
  "enisaUuid": "3a4f2c32-d951-33a7-9a3a-0634c8b7e2ef",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nf2fs: compress: fix UAF of f2fs_inode_info in f2fs_free_dic\n\nThe decompress_io_ctx may be released asynchronously after\nI/O completion. If this file is deleted immediately after read,\nand the kworker of processing post_read_wq has not been executed yet\ndue to high workloads, It is possible that the inode(f2fs_inode_info)\nis evicted and freed before it is used f2fs_free_dic.\n\n    The UAF case as below:\n    Thread A                                      Thread B\n    - f2fs_decompress_end_io\n     - f2fs_put_dic\n      - queue_work\n        add free_dic work to post_read_wq\n                                                   - do_unlink\n                                                    - iput\n                                                     - evict\n                                                      - call_rcu\n    This file is deleted after read.\n\n    Thread C                                 kworker to process post_read_wq\n    - rcu_do_batch\n     - f2fs_free_inode\n      - kmem_cache_free\n     inode is freed by rcu\n                                             - process_scheduled_works\n                                              - f2fs_late_free_dic\n                                               - f2fs_free_dic\n                                                - f2fs_release_decomp_mem\n                                      read (dic->inode)->i_compress_algorithm\n\nThis patch store compress_algorithm and sbi in dic to avoid inode UAF.\n\nIn addition, the previous solution is deprecated in [1] may cause system hang.\n[1] https://lore.kernel.org/all/c36ab955-c8db-4a8b-a9d0-f07b5f426c3f@kernel.org",
  "datePublished": "Aug 22, 2025, 4:00:35 PM",
  "dateUpdated": "Sep 29, 2025, 5:55:05 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/8fae5b6addd5f6895e03797b56e3c7b9f9cd15c9",
    "https://git.kernel.org/stable/c/39868685c2a94a70762bc6d77dc81d781d05bff5"
  ],
  "aliases": [
    "CVE-2025-38627"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1add68b1-3092-36c4-96ac-a34ecca04537",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.1"
    },
    {
      "id": "54937b35-b37c-31ec-9048-306623e612d5",
      "product": {
        "name": "Linux"
      },
      "product_version": "bff139b49d9f70c1ac5384aac94554846aa834de <39868685c2a94a70762bc6d77dc81d781d05bff5"
    },
    {
      "id": "66734c73-310c-3c7d-a765-dfa88acf49f5",
      "product": {
        "name": "Linux"
      },
      "product_version": "bff139b49d9f70c1ac5384aac94554846aa834de <8fae5b6addd5f6895e03797b56e3c7b9f9cd15c9"
    },
    {
      "id": "8c58d6d2-f53e-31a4-b928-3646f2b62ec5",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.0"
    },
    {
      "id": "a3864abc-eaf8-3ea2-964a-f65191b8684c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "be7fb91a-ed25-3f39-868e-a779fa674e67",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc1"
    },
    {
      "id": "e34ee1ee-678e-3947-834f-be580fe606e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "3e402442-15ef-3cee-8f22-7cc591e4d80a",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}