{
  "id": "EUVD-2024-44653",
  "enisaUuid": "35113141-3d01-357d-9651-65d96dadd259",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsmb: client: fix OOBs when building SMB2_IOCTL request\n\nWhen using encryption, either enforced by the server or when using\n'seal' mount option, the client will squash all compound request buffers\ndown for encryption into a single iov in smb2_set_next_command().\n\nSMB2_ioctl_init() allocates a small buffer (448 bytes) to hold the\nSMB2_IOCTL request in the first iov, and if the user passes an input\nbuffer that is greater than 328 bytes, smb2_set_next_command() will\nend up writing off the end of @rqst->iov[0].iov_base as shown below:\n\n  mount.cifs //srv/share /mnt -o ...,seal\n  ln -s $(perl -e \"print('a')for 1..1024\") /mnt/link\n\n  BUG: KASAN: slab-out-of-bounds in\n  smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n  Write of size 4116 at addr ffff8881148fcab8 by task ln/859\n\n  CPU: 1 UID: 0 PID: 859 Comm: ln Not tainted 6.12.0-rc3 #1\n  Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS\n  1.16.3-2.fc40 04/01/2014\n  Call Trace:\n   <TASK>\n   dump_stack_lvl+0x5d/0x80\n   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n   print_report+0x156/0x4d9\n   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n   ? __virt_addr_valid+0x145/0x310\n   ? __phys_addr+0x46/0x90\n   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n   kasan_report+0xda/0x110\n   ? smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n   kasan_check_range+0x10f/0x1f0\n   __asan_memcpy+0x3c/0x60\n   smb2_set_next_command.cold+0x1d6/0x24c [cifs]\n   smb2_compound_op+0x238c/0x3840 [cifs]\n   ? kasan_save_track+0x14/0x30\n   ? kasan_save_free_info+0x3b/0x70\n   ? vfs_symlink+0x1a1/0x2c0\n   ? do_symlinkat+0x108/0x1c0\n   ? __pfx_smb2_compound_op+0x10/0x10 [cifs]\n   ? kmem_cache_free+0x118/0x3e0\n   ? cifs_get_writable_path+0xeb/0x1a0 [cifs]\n   smb2_get_reparse_inode+0x423/0x540 [cifs]\n   ? __pfx_smb2_get_reparse_inode+0x10/0x10 [cifs]\n   ? rcu_is_watching+0x20/0x50\n   ? __kmalloc_noprof+0x37c/0x480\n   ? smb2_create_reparse_symlink+0x257/0x490 [cifs]\n   ? smb2_create_reparse_symlink+0x38f/0x490 [cifs]\n   smb2_create_reparse_symlink+0x38f/0x490 [cifs]\n   ? __pfx_smb2_create_reparse_symlink+0x10/0x10 [cifs]\n   ? find_held_lock+0x8a/0xa0\n   ? hlock_class+0x32/0xb0\n   ? __build_path_from_dentry_optional_prefix+0x19d/0x2e0 [cifs]\n   cifs_symlink+0x24f/0x960 [cifs]\n   ? __pfx_make_vfsuid+0x10/0x10\n   ? __pfx_cifs_symlink+0x10/0x10 [cifs]\n   ? make_vfsgid+0x6b/0xc0\n   ? generic_permission+0x96/0x2d0\n   vfs_symlink+0x1a1/0x2c0\n   do_symlinkat+0x108/0x1c0\n   ? __pfx_do_symlinkat+0x10/0x10\n   ? strncpy_from_user+0xaa/0x160\n   __x64_sys_symlinkat+0xb9/0xf0\n   do_syscall_64+0xbb/0x1d0\n   entry_SYSCALL_64_after_hwframe+0x77/0x7f\n  RIP: 0033:0x7f08d75c13bb",
  "datePublished": "Nov 7, 2024, 9:31:27 AM",
  "dateUpdated": "Oct 1, 2025, 8:27:13 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://git.kernel.org/stable/c/6f0516ef1290da24b85461ed08a0938af7415e49",
    "https://git.kernel.org/stable/c/ed31aba8ce93472d9e16f5cff844ae7c94e9601d",
    "https://git.kernel.org/stable/c/e07d05b7f5ad9a503d9cab0afde2ab867bb65470",
    "https://git.kernel.org/stable/c/2ef632bfb888d1a14f81c1703817951e0bec5531",
    "https://git.kernel.org/stable/c/b209c3a0bc3ac172265c7fa8309e5d00654f2510",
    "https://git.kernel.org/stable/c/fe92ddc1c32d4474e605e3a31a4afcd0e7d765ec",
    "https://git.kernel.org/stable/c/1ab60323c5201bef25f2a3dc0ccc404d9aca77f1"
  ],
  "aliases": [
    "CVE-2024-50151"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1b104e69-81fc-32e2-9726-7289e27828e0",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.170"
    },
    {
      "id": "2703a68e-fbe7-3b47-88c4-37ae1f18cbaf",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.0"
    },
    {
      "id": "3a1b56a1-28eb-3840-85d1-97c5af2de7ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.59"
    },
    {
      "id": "69492240-4a9f-3a74-ba28-3d9a09634c9f",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <b209c3a0bc3ac172265c7fa8309e5d00654f2510"
    },
    {
      "id": "72530eb0-7608-3aa7-978d-05aaeeb38a02",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.115"
    },
    {
      "id": "91629b4c-be95-3bd6-93e2-fcff4b6d6b23",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12"
    },
    {
      "id": "97887861-2c35-3b6a-8137-0274e09abdda",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.6"
    },
    {
      "id": "9d3d3c64-a172-3371-a26b-7d6dcdc2d30f",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <1ab60323c5201bef25f2a3dc0ccc404d9aca77f1"
    },
    {
      "id": "9f26303b-a9a0-3b37-b4ed-cb172fd3cc84",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "bc640539-1960-3ab3-9a76-5527e3e91594",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <ed31aba8ce93472d9e16f5cff844ae7c94e9601d"
    },
    {
      "id": "c25b8b61-1db7-30af-b4b6-059880ecaed1",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <fe92ddc1c32d4474e605e3a31a4afcd0e7d765ec"
    },
    {
      "id": "ca9cc942-6422-3083-8f84-3e77596e6d6a",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <6f0516ef1290da24b85461ed08a0938af7415e49"
    },
    {
      "id": "cc0effc9-fe46-3d82-890e-baadd7535739",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.229"
    },
    {
      "id": "dc488e63-e727-39f1-8f1e-64617f58526d",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <e07d05b7f5ad9a503d9cab0afde2ab867bb65470"
    },
    {
      "id": "e02c0f4b-7236-30b9-ba74-ebcd30ddd915",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.285"
    },
    {
      "id": "eb8de4f4-49eb-3814-bcf3-fbb58c83c6f6",
      "product": {
        "name": "Linux"
      },
      "product_version": "e77fe73c7e38c36145825d84cfe385d400aba4fd <2ef632bfb888d1a14f81c1703817951e0bec5531"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "5bac8717-6814-3cb7-a00e-d4f9ef6f27ee",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}