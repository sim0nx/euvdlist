{
  "id": "EUVD-2025-12887",
  "enisaUuid": "2b9c6e1e-51ad-3658-947d-66a73bc60e0d",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, sockmap: Fix the sk->sk_forward_alloc warning of sk_stream_kill_queues\n\nWhen running `test_sockmap` selftests, the following warning appears:\n\n  WARNING: CPU: 2 PID: 197 at net/core/stream.c:205 sk_stream_kill_queues+0xd3/0xf0\n  Call Trace:\n  <TASK>\n  inet_csk_destroy_sock+0x55/0x110\n  tcp_rcv_state_process+0xd28/0x1380\n  ? tcp_v4_do_rcv+0x77/0x2c0\n  tcp_v4_do_rcv+0x77/0x2c0\n  __release_sock+0x106/0x130\n  __tcp_close+0x1a7/0x4e0\n  tcp_close+0x20/0x70\n  inet_release+0x3c/0x80\n  __sock_release+0x3a/0xb0\n  sock_close+0x14/0x20\n  __fput+0xa3/0x260\n  task_work_run+0x59/0xb0\n  exit_to_user_mode_prepare+0x1b3/0x1c0\n  syscall_exit_to_user_mode+0x19/0x50\n  do_syscall_64+0x48/0x90\n  entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nThe root case is in commit 84472b436e76 (\"bpf, sockmap: Fix more uncharged\nwhile msg has more_data\"), where I used msg->sg.size to replace the tosend,\ncausing breakage:\n\n  if (msg->apply_bytes && msg->apply_bytes < tosend)\n    tosend = psock->apply_bytes;",
  "datePublished": "May 1, 2025, 2:10:25 PM",
  "dateUpdated": "May 4, 2025, 12:45:20 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49877",
    "https://git.kernel.org/stable/c/14e8bc3bf7bd6af64d7538a0684c8238d96cdfd7",
    "https://git.kernel.org/stable/c/8ec95b94716a1e4d126edc3fb2bc426a717e2dba",
    "https://git.kernel.org/stable/c/95adbd2ac8de82e43fd6b347e7e1b47f74dc1abb",
    "https://git.kernel.org/stable/c/cc21dc48a78cc9e5af9a4d039cd456446a6e73ff",
    "https://git.kernel.org/stable/c/d975bec1eaeb52341acc9273db79ddb078220399"
  ],
  "aliases": [
    "CVE-2022-49877",
    "GHSA-h8g4-6mrj-mfm8"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "073b6e05-bf7c-3152-8f3a-47fef55de9b7",
      "product": {
        "name": "Linux"
      },
      "product_version": "244ce90c8d0bd10ebf957da02c6f3fcd5d920bdf <d975bec1eaeb52341acc9273db79ddb078220399"
    },
    {
      "id": "156465e3-ffc6-3661-a7b9-d4844e2aade5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "2855a748-d473-3e10-ae21-4ff0683a129b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.225"
    },
    {
      "id": "35a082cf-ffbf-37c3-85af-7e67db87c466",
      "product": {
        "name": "Linux"
      },
      "product_version": "168ff181f5b6e7fce684c98a30d35da1dbf8f82a <95adbd2ac8de82e43fd6b347e7e1b47f74dc1abb"
    },
    {
      "id": "4b8b2d0c-fdb7-30d0-baf1-6af764c53c9e",
      "product": {
        "name": "Linux"
      },
      "product_version": "87d532d41ef937e16f61b3d2094f3a2ac49be365"
    },
    {
      "id": "8a58557b-dc06-3b96-9211-0c4a7595c275",
      "product": {
        "name": "Linux"
      },
      "product_version": "abb4caa477a5450817d2aa1198edce66450aecf8"
    },
    {
      "id": "9025e999-2975-3812-8a8f-0fe19e10833f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.155"
    },
    {
      "id": "b02f5c9c-0974-3638-8adc-ef940ebad400",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.79"
    },
    {
      "id": "bc7f6f56-c526-35d9-878f-86437ed8d795",
      "product": {
        "name": "Linux"
      },
      "product_version": "84472b436e760ba439e1969a9e3c5ae7c86de39d <14e8bc3bf7bd6af64d7538a0684c8238d96cdfd7"
    },
    {
      "id": "bd9e123c-5277-37cd-b9e3-f1e154ea9e06",
      "product": {
        "name": "Linux"
      },
      "product_version": "7b812a369e6416ab06d83cdd39d8e3f752781dd0 <cc21dc48a78cc9e5af9a4d039cd456446a6e73ff"
    },
    {
      "id": "c434e6e6-e26a-3f30-a698-fcedfa3b050d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "c5aa1490-d656-36c2-b1fc-f31086add9b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.18"
    },
    {
      "id": "e26c277c-7c50-31b5-b1b9-1988778bdc10",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.9"
    },
    {
      "id": "fc368367-6bc4-340e-9a7c-bf1cddd9e086",
      "product": {
        "name": "Linux"
      },
      "product_version": "84472b436e760ba439e1969a9e3c5ae7c86de39d <8ec95b94716a1e4d126edc3fb2bc426a717e2dba"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "9d930f53-a804-3670-83a6-8529406773a1",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}