{
  "id": "EUVD-2025-12895",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix warning in 'ext4_da_release_space'\n\nSyzkaller report issue as follows:\nEXT4-fs (loop0): Free/Dirty block details\nEXT4-fs (loop0): free_blocks=0\nEXT4-fs (loop0): dirty_blocks=0\nEXT4-fs (loop0): Block reservation details\nEXT4-fs (loop0): i_reserved_data_blocks=0\nEXT4-fs warning (device loop0): ext4_da_release_space:1527: ext4_da_release_space: ino 18, to_free 1 with only 0 reserved data blocks\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 92 at fs/ext4/inode.c:1528 ext4_da_release_space+0x25e/0x370 fs/ext4/inode.c:1524\nModules linked in:\nCPU: 0 PID: 92 Comm: kworker/u4:4 Not tainted 6.0.0-syzkaller-09423-g493ffd6605b2 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/22/2022\nWorkqueue: writeback wb_workfn (flush-7:0)\nRIP: 0010:ext4_da_release_space+0x25e/0x370 fs/ext4/inode.c:1528\nRSP: 0018:ffffc900015f6c90 EFLAGS: 00010296\nRAX: 42215896cd52ea00 RBX: 0000000000000000 RCX: 42215896cd52ea00\nRDX: 0000000000000000 RSI: 0000000080000001 RDI: 0000000000000000\nRBP: 1ffff1100e907d96 R08: ffffffff816aa79d R09: fffff520002bece5\nR10: fffff520002bece5 R11: 1ffff920002bece4 R12: ffff888021fd2000\nR13: ffff88807483ecb0 R14: 0000000000000001 R15: ffff88807483e740\nFS:  0000000000000000(0000) GS:ffff8880b9a00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00005555569ba628 CR3: 000000000c88e000 CR4: 00000000003506f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n ext4_es_remove_extent+0x1ab/0x260 fs/ext4/extents_status.c:1461\n mpage_release_unused_pages+0x24d/0xef0 fs/ext4/inode.c:1589\n ext4_writepages+0x12eb/0x3be0 fs/ext4/inode.c:2852\n do_writepages+0x3c3/0x680 mm/page-writeback.c:2469\n __writeback_single_inode+0xd1/0x670 fs/fs-writeback.c:1587\n writeback_sb_inodes+0xb3b/0x18f0 fs/fs-writeback.c:1870\n wb_writeback+0x41f/0x7b0 fs/fs-writeback.c:2044\n wb_do_writeback fs/fs-writeback.c:2187 [inline]\n wb_workfn+0x3cb/0xef0 fs/fs-writeback.c:2227\n process_one_work+0x877/0xdb0 kernel/workqueue.c:2289\n worker_thread+0xb14/0x1330 kernel/workqueue.c:2436\n kthread+0x266/0x300 kernel/kthread.c:376\n ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:306\n </TASK>\n\nAbove issue may happens as follows:\next4_da_write_begin\n  ext4_create_inline_data\n    ext4_clear_inode_flag(inode, EXT4_INODE_EXTENTS);\n    ext4_set_inode_flag(inode, EXT4_INODE_INLINE_DATA);\n__ext4_ioctl\n  ext4_ext_migrate -> will lead to eh->eh_entries not zero, and set extent flag\next4_da_write_begin\n  ext4_da_convert_inline_data_to_extent\n    ext4_da_write_inline_data_begin\n      ext4_da_map_blocks\n        ext4_insert_delayed_block\n\t  if (!ext4_es_scan_clu(inode, &ext4_es_is_delonly, lblk))\n\t    if (!ext4_es_scan_clu(inode, &ext4_es_is_mapped, lblk))\n\t      ext4_clu_mapped(inode, EXT4_B2C(sbi, lblk)); -> will return 1\n\t       allocated = true;\n          ext4_es_insert_delayed_block(inode, lblk, allocated);\next4_writepages\n  mpage_map_and_submit_extent(handle, &mpd, &give_up_on_write); -> return -ENOSPC\n  mpage_release_unused_pages(&mpd, give_up_on_write); -> give_up_on_write == 1\n    ext4_es_remove_extent\n      ext4_da_release_space(inode, reserved);\n        if (unlikely(to_free > ei->i_reserved_data_blocks))\n\t  -> to_free == 1  but ei->i_reserved_data_blocks == 0\n\t  -> then trigger warning as above\n\nTo solve above issue, forbid inode do migrate which has inline data.",
  "datePublished": "May 1, 2025, 2:10:27 PM",
  "dateUpdated": "May 4, 2025, 8:47:40 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49880",
    "https://git.kernel.org/stable/c/0a43c015e98121c91a76154edf42280ce1a8a883",
    "https://git.kernel.org/stable/c/0de5ee103747fd3a24f1c010c79caabe35e8f0bb",
    "https://git.kernel.org/stable/c/1b8f787ef547230a3249bcf897221ef0cc78481b",
    "https://git.kernel.org/stable/c/5370b965b7a945bb8f48b9ee23d83a76a947902e",
    "https://git.kernel.org/stable/c/72743d5598b9096950bbfd6a9b7f173d156eea97",
    "https://git.kernel.org/stable/c/890d738f569fa9412b70ba09f15407f17a52da20",
    "https://git.kernel.org/stable/c/89bee03d2fb8c54119b38ac6c24e7d60fae036b6",
    "https://git.kernel.org/stable/c/c3bf1e95cfa7d950dc3c064d0c2e3d06b427bc63"
  ],
  "aliases": [
    "CVE-2022-49880",
    "GHSA-6qgr-97mx-84hr"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "0654681c-1c95-3ebb-99b8-33b4336efef4",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <89bee03d2fb8c54119b38ac6c24e7d60fae036b6"
    },
    {
      "id": "1ebe8e0a-87c9-31f1-8017-3720a99d7f28",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.299"
    },
    {
      "id": "4d643a11-8d2a-3bf1-84a3-d74c6f709bb4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.78"
    },
    {
      "id": "54255c4b-3c03-3bb0-a5c6-4d2d6f047f39",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <5370b965b7a945bb8f48b9ee23d83a76a947902e"
    },
    {
      "id": "5c2a55c1-42df-3860-91f5-4e348f5dd3aa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.9.333"
    },
    {
      "id": "61702368-9494-3d3e-a7ba-9d97063b3093",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.224"
    },
    {
      "id": "65c9b714-f14e-383b-b311-94870c02f070",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1b8f787ef547230a3249bcf897221ef0cc78481b"
    },
    {
      "id": "6d7d6010-649f-38e0-9593-04cc6f924b5b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <72743d5598b9096950bbfd6a9b7f173d156eea97"
    },
    {
      "id": "79009e84-f48d-394a-9bae-fb247156b8b2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0a43c015e98121c91a76154edf42280ce1a8a883"
    },
    {
      "id": "9881b85b-4a70-3960-8d90-cd07ea11a3ef",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c3bf1e95cfa7d950dc3c064d0c2e3d06b427bc63"
    },
    {
      "id": "9f3fef14-686d-32ea-b66e-411e605f9783",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "b1004363-dd45-32e3-b2a0-50de8d0f7369",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <890d738f569fa9412b70ba09f15407f17a52da20"
    },
    {
      "id": "d86922b3-babf-3d56-b522-a0bdff34126d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.154"
    },
    {
      "id": "e6f988bc-6910-35cb-9d43-ecf3c1ec6ba7",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0de5ee103747fd3a24f1c010c79caabe35e8f0bb"
    },
    {
      "id": "ec3fa6b0-86eb-3826-adf7-61e7f0ee0a70",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.8"
    },
    {
      "id": "fb9b6df8-70c3-3130-badb-8da2ab5d0eab",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.265"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "b10c163b-ac22-36ff-a808-3fcb3b99a04a",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49880"
}
