{
  "id": "EUVD-2025-13162",
  "enisaUuid": "d62bd4ae-39da-3927-a97b-3351c302b8eb",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\next4: fix WARNING in ext4_update_inline_data\n\nSyzbot found the following issue:\nEXT4-fs (loop0): mounted filesystem 00000000-0000-0000-0000-000000000000 without journal. Quota mode: none.\nfscrypt: AES-256-CTS-CBC using implementation \"cts-cbc-aes-aesni\"\nfscrypt: AES-256-XTS using implementation \"xts-aes-aesni\"\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 5071 at mm/page_alloc.c:5525 __alloc_pages+0x30a/0x560 mm/page_alloc.c:5525\nModules linked in:\nCPU: 1 PID: 5071 Comm: syz-executor263 Not tainted 6.2.0-rc1-syzkaller #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/26/2022\nRIP: 0010:__alloc_pages+0x30a/0x560 mm/page_alloc.c:5525\nRSP: 0018:ffffc90003c2f1c0 EFLAGS: 00010246\nRAX: ffffc90003c2f220 RBX: 0000000000000014 RCX: 0000000000000000\nRDX: 0000000000000028 RSI: 0000000000000000 RDI: ffffc90003c2f248\nRBP: ffffc90003c2f2d8 R08: dffffc0000000000 R09: ffffc90003c2f220\nR10: fffff52000785e49 R11: 1ffff92000785e44 R12: 0000000000040d40\nR13: 1ffff92000785e40 R14: dffffc0000000000 R15: 1ffff92000785e3c\nFS:  0000555556c0d300(0000) GS:ffff8880b9800000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f95d5e04138 CR3: 00000000793aa000 CR4: 00000000003506f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n __alloc_pages_node include/linux/gfp.h:237 [inline]\n alloc_pages_node include/linux/gfp.h:260 [inline]\n __kmalloc_large_node+0x95/0x1e0 mm/slab_common.c:1113\n __do_kmalloc_node mm/slab_common.c:956 [inline]\n __kmalloc+0xfe/0x190 mm/slab_common.c:981\n kmalloc include/linux/slab.h:584 [inline]\n kzalloc include/linux/slab.h:720 [inline]\n ext4_update_inline_data+0x236/0x6b0 fs/ext4/inline.c:346\n ext4_update_inline_dir fs/ext4/inline.c:1115 [inline]\n ext4_try_add_inline_entry+0x328/0x990 fs/ext4/inline.c:1307\n ext4_add_entry+0x5a4/0xeb0 fs/ext4/namei.c:2385\n ext4_add_nondir+0x96/0x260 fs/ext4/namei.c:2772\n ext4_create+0x36c/0x560 fs/ext4/namei.c:2817\n lookup_open fs/namei.c:3413 [inline]\n open_last_lookups fs/namei.c:3481 [inline]\n path_openat+0x12ac/0x2dd0 fs/namei.c:3711\n do_filp_open+0x264/0x4f0 fs/namei.c:3741\n do_sys_openat2+0x124/0x4e0 fs/open.c:1310\n do_sys_open fs/open.c:1326 [inline]\n __do_sys_openat fs/open.c:1342 [inline]\n __se_sys_openat fs/open.c:1337 [inline]\n __x64_sys_openat+0x243/0x290 fs/open.c:1337\n do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n do_syscall_64+0x3d/0xb0 arch/x86/entry/common.c:80\n entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nAbove issue happens as follows:\next4_iget\n   ext4_find_inline_data_nolock ->i_inline_off=164 i_inline_size=60\next4_try_add_inline_entry\n   __ext4_mark_inode_dirty\n      ext4_expand_extra_isize_ea ->i_extra_isize=32 s_want_extra_isize=44\n         ext4_xattr_shift_entries\n\t ->after shift i_inline_off is incorrect, actually is change to 176\next4_try_add_inline_entry\n  ext4_update_inline_dir\n    get_max_inline_xattr_value_size\n      if (EXT4_I(inode)->i_inline_off)\n\tentry = (struct ext4_xattr_entry *)((void *)raw_inode +\n\t\t\tEXT4_I(inode)->i_inline_off);\n        free += EXT4_XATTR_SIZE(le32_to_cpu(entry->e_value_size));\n\t->As entry is incorrect, then 'free' may be negative\n   ext4_update_inline_data\n      value = kzalloc(len, GFP_NOFS);\n      -> len is unsigned int, maybe very large, then trigger warning when\n         'kzalloc()'\n\nTo resolve the above issue we need to update 'i_inline_off' after\n'ext4_xattr_shift_entries()'.  We do not need to set\nEXT4_STATE_MAY_INLINE_DATA flag here, since ext4_mark_inode_dirty()\nalready sets this flag if needed.  Setting EXT4_STATE_MAY_INLINE_DATA\nwhen it is needed may trigger a BUG_ON in ext4_writepages().",
  "datePublished": "May 2, 2025, 3:55:43 PM",
  "dateUpdated": "May 2, 2025, 3:55:43 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53100",
    "https://git.kernel.org/stable/c/2b96b4a5d9443ca4cad58b0040be455803c05a42",
    "https://git.kernel.org/stable/c/35161cec76772f74526f5886ad4082ec48511d5c",
    "https://git.kernel.org/stable/c/39c5df2ca544368b44b59d0f6d80131e90763371",
    "https://git.kernel.org/stable/c/74d775083e9f3d9dadf9e3b5f3e0028d1ad0bd5c",
    "https://git.kernel.org/stable/c/92eee6a82a9a6f9f83559e17a2b6b935e1a5cd25",
    "https://git.kernel.org/stable/c/a9bd94f67b27739bbe8583c52256502bd4cc7e83",
    "https://git.kernel.org/stable/c/c5aa102b433b1890e1ccaa40c06826c77dda1665",
    "https://git.kernel.org/stable/c/ca500cf2eceb5a8e93bf71ab97b5f7a18ecabce2"
  ],
  "aliases": [
    "CVE-2023-53100",
    "GHSA-mvqv-rc3q-g8hm"
  ],
  "assigner": "Linux",
  "epss": 0.08,
  "enisaIdProduct": [
    {
      "id": "02991918-19a3-361f-b226-5af22a7c8c1a",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <92eee6a82a9a6f9f83559e17a2b6b935e1a5cd25"
    },
    {
      "id": "17e8a889-18a0-37e9-9ad4-69a8f9cb5583",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.103"
    },
    {
      "id": "1953c2ed-e919-3fe5-916c-2bb02f4e2832",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <39c5df2ca544368b44b59d0f6d80131e90763371"
    },
    {
      "id": "3056409a-87dc-3183-a4fa-52730843eeb2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c5aa102b433b1890e1ccaa40c06826c77dda1665"
    },
    {
      "id": "35ffebf2-e67b-3508-bb6f-1e2f035fc0b1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.20"
    },
    {
      "id": "377aa219-28be-3c6b-b2f5-a9534de0024c",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <35161cec76772f74526f5886ad4082ec48511d5c"
    },
    {
      "id": "50cb4baf-396b-3a88-9a76-3ebdea391aa9",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <ca500cf2eceb5a8e93bf71ab97b5f7a18ecabce2"
    },
    {
      "id": "8f596b04-bfe6-326a-8dab-1d0fd4942ad9",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <a9bd94f67b27739bbe8583c52256502bd4cc7e83"
    },
    {
      "id": "926f3c37-f9f5-3bbf-979a-3e471035c734",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.237"
    },
    {
      "id": "943ad09e-b58c-30b1-a6af-f971bcc5432e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <2b96b4a5d9443ca4cad58b0040be455803c05a42"
    },
    {
      "id": "946b7e7e-3863-3d04-a925-4e8108c097de",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <74d775083e9f3d9dadf9e3b5f3e0028d1ad0bd5c"
    },
    {
      "id": "9b4837e9-215f-3a26-8c56-cee19a1a167f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2.7"
    },
    {
      "id": "a0cb9bd8-2884-3340-9eb9-e0b907f04580",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.14.310"
    },
    {
      "id": "d051bad6-4008-300f-bf59-5e9628f47a49",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.175"
    },
    {
      "id": "e651f8d4-a4c4-3800-9cf6-2c1082a13862",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.278"
    },
    {
      "id": "f20bac42-acb8-3441-8c5a-a96b09e9bc78",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.3"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "a775d32a-0a08-3a7c-bb92-8e07baea58c6",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}