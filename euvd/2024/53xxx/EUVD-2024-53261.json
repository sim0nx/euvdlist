{
  "id": "EUVD-2024-53261",
  "enisaUuid": "2255eea1-65b0-39ce-a5dd-d390a31fefc3",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nsched/numa: fix memory leak due to the overwritten vma->numab_state\n\n[Problem Description]\nWhen running the hackbench program of LTP, the following memory leak is\nreported by kmemleak.\n\n  # /opt/ltp/testcases/bin/hackbench 20 thread 1000\n  Running with 20*40 (== 800) tasks.\n\n  # dmesg | grep kmemleak\n  ...\n  kmemleak: 480 new suspected memory leaks (see /sys/kernel/debug/kmemleak)\n  kmemleak: 665 new suspected memory leaks (see /sys/kernel/debug/kmemleak)\n\n  # cat /sys/kernel/debug/kmemleak\n  unreferenced object 0xffff888cd8ca2c40 (size 64):\n    comm \"hackbench\", pid 17142, jiffies 4299780315\n    hex dump (first 32 bytes):\n      ac 74 49 00 01 00 00 00 4c 84 49 00 01 00 00 00  .tI.....L.I.....\n      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    backtrace (crc bff18fd4):\n      [<ffffffff81419a89>] __kmalloc_cache_noprof+0x2f9/0x3f0\n      [<ffffffff8113f715>] task_numa_work+0x725/0xa00\n      [<ffffffff8110f878>] task_work_run+0x58/0x90\n      [<ffffffff81ddd9f8>] syscall_exit_to_user_mode+0x1c8/0x1e0\n      [<ffffffff81dd78d5>] do_syscall_64+0x85/0x150\n      [<ffffffff81e0012b>] entry_SYSCALL_64_after_hwframe+0x76/0x7e\n  ...\n\nThis issue can be consistently reproduced on three different servers:\n  * a 448-core server\n  * a 256-core server\n  * a 192-core server\n\n[Root Cause]\nSince multiple threads are created by the hackbench program (along with\nthe command argument 'thread'), a shared vma might be accessed by two or\nmore cores simultaneously. When two or more cores observe that\nvma->numab_state is NULL at the same time, vma->numab_state will be\noverwritten.\n\nAlthough current code ensures that only one thread scans the VMAs in a\nsingle 'numa_scan_period', there might be a chance for another thread\nto enter in the next 'numa_scan_period' while we have not gotten till\nnumab_state allocation [1].\n\nNote that the command `/opt/ltp/testcases/bin/hackbench 50 process 1000`\ncannot the reproduce the issue. It is verified with 200+ test runs.\n\n[Solution]\nUse the cmpxchg atomic operation to ensure that only one thread executes\nthe vma->numab_state assignment.\n\n[1] https://lore.kernel.org/lkml/1794be3c-358c-4cdc-a43d-a1f841d91ef7@amd.com/",
  "datePublished": "Dec 27, 2024, 2:51:18 PM",
  "dateUpdated": "Oct 1, 2025, 8:07:13 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/8f149bcc4d91ac92b32ff4949b291e6ed883dc42",
    "https://git.kernel.org/stable/c/a71ddd5b87cda687efa28e049e85e923689bcef9",
    "https://git.kernel.org/stable/c/5f1b64e9a9b7ee9cfd32c6b2fab796e29bfed075"
  ],
  "aliases": [
    "CVE-2024-56613"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1506c734-d3c4-3d78-80ad-ce8f7ba55f86",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "32b435a5-45a5-311f-b6ce-4f49c62c8e18",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "35b9826f-021d-3850-b1c9-e92ba2a095a6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.5"
    },
    {
      "id": "6bf15445-add2-371b-b908-6dade3fb2f30",
      "product": {
        "name": "Linux"
      },
      "product_version": "ef6a22b70f6d90449a5c797b8968a682824e2011 <5f1b64e9a9b7ee9cfd32c6b2fab796e29bfed075"
    },
    {
      "id": "81605975-5a30-3c57-b94e-1fc1491e669e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.66"
    },
    {
      "id": "9a1b941c-4b64-3003-b251-06576da079f5",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.4"
    },
    {
      "id": "9da3c69b-52c0-360d-943b-9557fc65d6d0",
      "product": {
        "name": "Linux"
      },
      "product_version": "ef6a22b70f6d90449a5c797b8968a682824e2011 <a71ddd5b87cda687efa28e049e85e923689bcef9"
    },
    {
      "id": "b6ab81be-75e3-38b8-a73e-83d3657af7a2",
      "product": {
        "name": "Linux"
      },
      "product_version": "ef6a22b70f6d90449a5c797b8968a682824e2011 <8f149bcc4d91ac92b32ff4949b291e6ed883dc42"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "7d136968-5cce-3cab-90e3-6db8d80130b2",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}