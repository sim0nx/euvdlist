{
  "id": "EUVD-2025-8469",
  "enisaUuid": "5629e28c-92a5-3bfb-ae86-aeaf20a98471",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\novl: fix UAF in ovl_dentry_update_reval by moving dput() in ovl_link_up\n\nThe issue was caused by dput(upper) being called before\novl_dentry_update_reval(), while upper->d_flags was still\naccessed in ovl_dentry_remote().\n\nMove dput(upper) after its last use to prevent use-after-free.\n\nBUG: KASAN: slab-use-after-free in ovl_dentry_remote fs/overlayfs/util.c:162 [inline]\nBUG: KASAN: slab-use-after-free in ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167\n\nCall Trace:\n <TASK>\n __dump_stack lib/dump_stack.c:88 [inline]\n dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c:114\n print_address_description mm/kasan/report.c:377 [inline]\n print_report+0xc3/0x620 mm/kasan/report.c:488\n kasan_report+0xd9/0x110 mm/kasan/report.c:601\n ovl_dentry_remote fs/overlayfs/util.c:162 [inline]\n ovl_dentry_update_reval+0xd2/0xf0 fs/overlayfs/util.c:167\n ovl_link_up fs/overlayfs/copy_up.c:610 [inline]\n ovl_copy_up_one+0x2105/0x3490 fs/overlayfs/copy_up.c:1170\n ovl_copy_up_flags+0x18d/0x200 fs/overlayfs/copy_up.c:1223\n ovl_rename+0x39e/0x18c0 fs/overlayfs/dir.c:1136\n vfs_rename+0xf84/0x20a0 fs/namei.c:4893\n...\n </TASK>",
  "datePublished": "Mar 27, 2025, 2:57:14 PM",
  "dateUpdated": "May 4, 2025, 1:06:40 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-21887",
    "https://git.kernel.org/stable/c/3594aad97e7be2557ca9fa9c931b206b604028c8",
    "https://git.kernel.org/stable/c/4b49d939b5a79117f939b77cc67efae2694d9799",
    "https://git.kernel.org/stable/c/60b4b5c1277fc491da9e1e7abab307bfa39c2db7",
    "https://git.kernel.org/stable/c/64455c8051c3aedc71abb7ec8d47c80301f99f00",
    "https://git.kernel.org/stable/c/a7c41830ffcd17b2177a95a9b99b270302090c35",
    "https://git.kernel.org/stable/c/c84e125fff2615b4d9c259e762596134eddd2f27"
  ],
  "aliases": [
    "CVE-2025-21887",
    "GHSA-vjwm-w9rc-f4cc"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "0ac366d2-b44f-313c-9115-5f737b7aa2c9",
      "product": {
        "name": "Linux"
      },
      "product_version": "62f29ca45f832e281fc14966ac25f6ff3bd121ca <4b49d939b5a79117f939b77cc67efae2694d9799"
    },
    {
      "id": "17c7bdb0-a501-39c1-a97c-a505d5f3accf",
      "product": {
        "name": "Linux"
      },
      "product_version": "e4f2a1feebb3f209a0fca82aa53507a5b8be4d53 <a7c41830ffcd17b2177a95a9b99b270302090c35"
    },
    {
      "id": "2f7a1bd4-82bd-388d-8e01-81b2ecbdc8df",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.6"
    },
    {
      "id": "5f564f05-db93-332b-acad-f890379c61c2",
      "product": {
        "name": "Linux"
      },
      "product_version": "b07d5cc93e1b28df47a72c519d09d0a836043613 <c84e125fff2615b4d9c259e762596134eddd2f27"
    },
    {
      "id": "7436865a-d178-3e4e-92db-6ef5d955ceef",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "7cd954e6-c22c-3ebf-852f-89081db87255",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "8cd4ba15-a699-3297-913a-585ec751d167",
      "product": {
        "name": "Linux"
      },
      "product_version": "714ba10a6dd19752a349e59aa875f3288ccb59b9"
    },
    {
      "id": "97a52d0f-0343-3211-8257-a2158f50ca75",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.130"
    },
    {
      "id": "ae8a1bc1-7b43-3702-8c14-5b24cb442f11",
      "product": {
        "name": "Linux"
      },
      "product_version": "b07d5cc93e1b28df47a72c519d09d0a836043613 <3594aad97e7be2557ca9fa9c931b206b604028c8"
    },
    {
      "id": "b4e5e799-d106-3d54-a5f0-0fc36c7c18da",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.5"
    },
    {
      "id": "b54cebe2-9526-3b1f-b1df-31c083094015",
      "product": {
        "name": "Linux"
      },
      "product_version": "b07d5cc93e1b28df47a72c519d09d0a836043613 <60b4b5c1277fc491da9e1e7abab307bfa39c2db7"
    },
    {
      "id": "b81d9a0b-7717-3dc9-9547-8cb945b06153",
      "product": {
        "name": "Linux"
      },
      "product_version": "1ecdc55e5cd9f70f8d7513802971d4cffb9f77af"
    },
    {
      "id": "c0f01644-a6b9-3bd1-98b5-ecfa44653732",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.18"
    },
    {
      "id": "ca54dced-dcf9-3f35-ace8-52c7a9405a96",
      "product": {
        "name": "Linux"
      },
      "product_version": "b07d5cc93e1b28df47a72c519d09d0a836043613 <64455c8051c3aedc71abb7ec8d47c80301f99f00"
    },
    {
      "id": "cdd1577a-3fa7-3d28-ae09-cbbffa777090",
      "product": {
        "name": "Linux"
      },
      "product_version": "33ab4dd6202f359558a0a2678b94d1b9994c17e5"
    },
    {
      "id": "d34ed8f3-49a7-32b9-99b9-9e7972de7f94",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.179"
    },
    {
      "id": "fe35d477-3ac2-3843-b58e-201b533d2629",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.81"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "da42b243-a965-32bb-8cd0-42ef9be10e88",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}