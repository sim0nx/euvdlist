{
  "id": "EUVD-2022-55216",
  "enisaUuid": "56c2d6f6-3ff8-3fec-942e-05a45d754a3f",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: do not queue data on closed subflows\n\nDipanjan reported a syzbot splat at close time:\n\nWARNING: CPU: 1 PID: 10818 at net/ipv4/af_inet.c:153\ninet_sock_destruct+0x6d0/0x8e0 net/ipv4/af_inet.c:153\nModules linked in: uio_ivshmem(OE) uio(E)\nCPU: 1 PID: 10818 Comm: kworker/1:16 Tainted: G           OE\n5.19.0-rc6-g2eae0556bb9d #2\nHardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS\n1.13.0-1ubuntu1.1 04/01/2014\nWorkqueue: events mptcp_worker\nRIP: 0010:inet_sock_destruct+0x6d0/0x8e0 net/ipv4/af_inet.c:153\nCode: 21 02 00 00 41 8b 9c 24 28 02 00 00 e9 07 ff ff ff e8 34 4d 91\nf9 89 ee 4c 89 e7 e8 4a 47 60 ff e9 a6 fc ff ff e8 20 4d 91 f9 <0f> 0b\ne9 84 fe ff ff e8 14 4d 91 f9 0f 0b e9 d4 fd ff ff e8 08 4d\nRSP: 0018:ffffc9001b35fa78 EFLAGS: 00010246\nRAX: 0000000000000000 RBX: 00000000002879d0 RCX: ffff8881326f3b00\nRDX: 0000000000000000 RSI: ffff8881326f3b00 RDI: 0000000000000002\nRBP: ffff888179662674 R08: ffffffff87e983a0 R09: 0000000000000000\nR10: 0000000000000005 R11: 00000000000004ea R12: ffff888179662400\nR13: ffff888179662428 R14: 0000000000000001 R15: ffff88817e38e258\nFS:  0000000000000000(0000) GS:ffff8881f5f00000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000000020007bc0 CR3: 0000000179592000 CR4: 0000000000150ee0\nCall Trace:\n <TASK>\n __sk_destruct+0x4f/0x8e0 net/core/sock.c:2067\n sk_destruct+0xbd/0xe0 net/core/sock.c:2112\n __sk_free+0xef/0x3d0 net/core/sock.c:2123\n sk_free+0x78/0xa0 net/core/sock.c:2134\n sock_put include/net/sock.h:1927 [inline]\n __mptcp_close_ssk+0x50f/0x780 net/mptcp/protocol.c:2351\n __mptcp_destroy_sock+0x332/0x760 net/mptcp/protocol.c:2828\n mptcp_worker+0x5d2/0xc90 net/mptcp/protocol.c:2586\n process_one_work+0x9cc/0x1650 kernel/workqueue.c:2289\n worker_thread+0x623/0x1070 kernel/workqueue.c:2436\n kthread+0x2e9/0x3a0 kernel/kthread.c:376\n ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:302\n </TASK>\n\nThe root cause of the problem is that an mptcp-level (re)transmit can\nrace with mptcp_close() and the packet scheduler checks the subflow\nstate before acquiring the socket lock: we can try to (re)transmit on\nan already closed ssk.\n\nFix the issue checking again the subflow socket status under the\nsubflow socket lock protection. Additionally add the missing check\nfor the fallback-to-tcp case.",
  "datePublished": "Jun 18, 2025, 11:02:15 AM",
  "dateUpdated": "Aug 28, 2025, 2:42:38 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/fb9c73ef2ac2ec816efdc8b9267bc04e1369c20b",
    "https://git.kernel.org/stable/c/8caf5c15b5288d52d9c89374d6c10fa32ee84ec5",
    "https://git.kernel.org/stable/c/c886d70286bf3ad411eb3d689328a67f7102c6ae"
  ],
  "aliases": [
    "CVE-2022-50070"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "31cc0d41-2a6f-38a0-9071-acbf00dce843",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.4"
    },
    {
      "id": "59853f6a-2bce-360a-8ee5-8c8b2f285c73",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.190"
    },
    {
      "id": "92ca7191-91fb-36f6-bfd3-bd8d6d6ef365",
      "product": {
        "name": "Linux"
      },
      "product_version": "d5f49190def61c47b2faff170ba8fbc48bac4371 <fb9c73ef2ac2ec816efdc8b9267bc04e1369c20b"
    },
    {
      "id": "98faafbe-234c-3e81-acaf-b541c3ace11e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "d72467aa-48b4-36e4-bd58-9e0ffccac981",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.10"
    },
    {
      "id": "df769f65-91a1-3b67-8c57-d4b494f795db",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    },
    {
      "id": "f169cb77-9966-30d6-b7ff-911fbd87ab2e",
      "product": {
        "name": "Linux"
      },
      "product_version": "d5f49190def61c47b2faff170ba8fbc48bac4371 <8caf5c15b5288d52d9c89374d6c10fa32ee84ec5"
    },
    {
      "id": "fda9f9e5-8eac-3995-8ef6-17e1456cc654",
      "product": {
        "name": "Linux"
      },
      "product_version": "d5f49190def61c47b2faff170ba8fbc48bac4371 <c886d70286bf3ad411eb3d689328a67f7102c6ae"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "36d2a2a4-18eb-3c61-b365-a52fe0686ab7",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50070"
}