{
  "id": "EUVD-2022-55046",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nblock, bfq: don't move oom_bfqq\n\nOur test report a UAF:\n\n[ 2073.019181] ==================================================================\n[ 2073.019188] BUG: KASAN: use-after-free in __bfq_put_async_bfqq+0xa0/0x168\n[ 2073.019191] Write of size 8 at addr ffff8000ccf64128 by task rmmod/72584\n[ 2073.019192]\n[ 2073.019196] CPU: 0 PID: 72584 Comm: rmmod Kdump: loaded Not tainted 4.19.90-yk #5\n[ 2073.019198] Hardware name: QEMU KVM Virtual Machine, BIOS 0.0.0 02/06/2015\n[ 2073.019200] Call trace:\n[ 2073.019203]  dump_backtrace+0x0/0x310\n[ 2073.019206]  show_stack+0x28/0x38\n[ 2073.019210]  dump_stack+0xec/0x15c\n[ 2073.019216]  print_address_description+0x68/0x2d0\n[ 2073.019220]  kasan_report+0x238/0x2f0\n[ 2073.019224]  __asan_store8+0x88/0xb0\n[ 2073.019229]  __bfq_put_async_bfqq+0xa0/0x168\n[ 2073.019233]  bfq_put_async_queues+0xbc/0x208\n[ 2073.019236]  bfq_pd_offline+0x178/0x238\n[ 2073.019240]  blkcg_deactivate_policy+0x1f0/0x420\n[ 2073.019244]  bfq_exit_queue+0x128/0x178\n[ 2073.019249]  blk_mq_exit_sched+0x12c/0x160\n[ 2073.019252]  elevator_exit+0xc8/0xd0\n[ 2073.019256]  blk_exit_queue+0x50/0x88\n[ 2073.019259]  blk_cleanup_queue+0x228/0x3d8\n[ 2073.019267]  null_del_dev+0xfc/0x1e0 [null_blk]\n[ 2073.019274]  null_exit+0x90/0x114 [null_blk]\n[ 2073.019278]  __arm64_sys_delete_module+0x358/0x5a0\n[ 2073.019282]  el0_svc_common+0xc8/0x320\n[ 2073.019287]  el0_svc_handler+0xf8/0x160\n[ 2073.019290]  el0_svc+0x10/0x218\n[ 2073.019291]\n[ 2073.019294] Allocated by task 14163:\n[ 2073.019301]  kasan_kmalloc+0xe0/0x190\n[ 2073.019305]  kmem_cache_alloc_node_trace+0x1cc/0x418\n[ 2073.019308]  bfq_pd_alloc+0x54/0x118\n[ 2073.019313]  blkcg_activate_policy+0x250/0x460\n[ 2073.019317]  bfq_create_group_hierarchy+0x38/0x110\n[ 2073.019321]  bfq_init_queue+0x6d0/0x948\n[ 2073.019325]  blk_mq_init_sched+0x1d8/0x390\n[ 2073.019330]  elevator_switch_mq+0x88/0x170\n[ 2073.019334]  elevator_switch+0x140/0x270\n[ 2073.019338]  elv_iosched_store+0x1a4/0x2a0\n[ 2073.019342]  queue_attr_store+0x90/0xe0\n[ 2073.019348]  sysfs_kf_write+0xa8/0xe8\n[ 2073.019351]  kernfs_fop_write+0x1f8/0x378\n[ 2073.019359]  __vfs_write+0xe0/0x360\n[ 2073.019363]  vfs_write+0xf0/0x270\n[ 2073.019367]  ksys_write+0xdc/0x1b8\n[ 2073.019371]  __arm64_sys_write+0x50/0x60\n[ 2073.019375]  el0_svc_common+0xc8/0x320\n[ 2073.019380]  el0_svc_handler+0xf8/0x160\n[ 2073.019383]  el0_svc+0x10/0x218\n[ 2073.019385]\n[ 2073.019387] Freed by task 72584:\n[ 2073.019391]  __kasan_slab_free+0x120/0x228\n[ 2073.019394]  kasan_slab_free+0x10/0x18\n[ 2073.019397]  kfree+0x94/0x368\n[ 2073.019400]  bfqg_put+0x64/0xb0\n[ 2073.019404]  bfqg_and_blkg_put+0x90/0xb0\n[ 2073.019408]  bfq_put_queue+0x220/0x228\n[ 2073.019413]  __bfq_put_async_bfqq+0x98/0x168\n[ 2073.019416]  bfq_put_async_queues+0xbc/0x208\n[ 2073.019420]  bfq_pd_offline+0x178/0x238\n[ 2073.019424]  blkcg_deactivate_policy+0x1f0/0x420\n[ 2073.019429]  bfq_exit_queue+0x128/0x178\n[ 2073.019433]  blk_mq_exit_sched+0x12c/0x160\n[ 2073.019437]  elevator_exit+0xc8/0xd0\n[ 2073.019440]  blk_exit_queue+0x50/0x88\n[ 2073.019443]  blk_cleanup_queue+0x228/0x3d8\n[ 2073.019451]  null_del_dev+0xfc/0x1e0 [null_blk]\n[ 2073.019459]  null_exit+0x90/0x114 [null_blk]\n[ 2073.019462]  __arm64_sys_delete_module+0x358/0x5a0\n[ 2073.019467]  el0_svc_common+0xc8/0x320\n[ 2073.019471]  el0_svc_handler+0xf8/0x160\n[ 2073.019474]  el0_svc+0x10/0x218\n[ 2073.019475]\n[ 2073.019479] The buggy address belongs to the object at ffff8000ccf63f00\n which belongs to the cache kmalloc-1024 of size 1024\n[ 2073.019484] The buggy address is located 552 bytes inside of\n 1024-byte region [ffff8000ccf63f00, ffff8000ccf64300)\n[ 2073.019486] The buggy address belongs to the page:\n[ 2073.019492] page:ffff7e000333d800 count:1 mapcount:0 mapping:ffff8000c0003a00 index:0x0 compound_mapcount: 0\n[ 2073.020123] flags: 0x7ffff0000008100(slab|head)\n[ 2073.020403] raw: 07ffff0000008100 ffff7e0003334c08 ffff7e00001f5a08 ffff8000c0003a00\n[ 2073.020409] ra\n---truncated---",
  "datePublished": "Feb 26, 2025, 1:55:32 AM",
  "dateUpdated": "Mar 26, 2025, 5:44:58 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://git.kernel.org/stable/c/c4f5a678add58a8a0e7ee5e038496b376ea6d205",
    "https://git.kernel.org/stable/c/7507ead1e9d42957c2340f2c4a0e9d00034e3366",
    "https://git.kernel.org/stable/c/8f34dea99cd7761156a146a5258a67d045d862f7",
    "https://git.kernel.org/stable/c/87fdfe8589d43e471dffb4c60f75eeb6f37afc4c",
    "https://git.kernel.org/stable/c/c01fced8d38fbccc82787065229578006f28e020",
    "https://git.kernel.org/stable/c/8410f70977734f21b8ed45c37e925d311dfda2e7"
  ],
  "aliases": [
    "CVE-2022-49179"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "055c821d-831d-349c-a4b9-fe7e16c997e9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.110"
    },
    {
      "id": "05ae130a-15b6-3547-9c53-d52734dac659",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8410f70977734f21b8ed45c37e925d311dfda2e7"
    },
    {
      "id": "09e89223-a9f9-316c-a64e-206b6f9234aa",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.2"
    },
    {
      "id": "0b23b3e4-a6f3-3c1d-b49c-4aac23e6e168",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "10310c17-d465-3680-bcf7-cd2c6deba16e",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <c01fced8d38fbccc82787065229578006f28e020"
    },
    {
      "id": "11b05df8-663f-3afb-857e-993fa4db7d18",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <8f34dea99cd7761156a146a5258a67d045d862f7"
    },
    {
      "id": "1662c498-c415-3fca-9537-22b39e64433e",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c4f5a678add58a8a0e7ee5e038496b376ea6d205"
    },
    {
      "id": "1e1f317e-5438-3833-9dab-c634caf35eea",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c01fced8d38fbccc82787065229578006f28e020"
    },
    {
      "id": "35188752-28d4-334b-be0e-38b88356699f",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <87fdfe8589d43e471dffb4c60f75eeb6f37afc4c"
    },
    {
      "id": "460ef0fb-d65a-36ba-a0c8-1f330ef36058",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <c4f5a678add58a8a0e7ee5e038496b376ea6d205"
    },
    {
      "id": "6d0f74c7-3da0-3a25-ac8e-e8a00140da20",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.189"
    },
    {
      "id": "6f38b45c-54da-36c4-a70a-e1a2325961cc",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.12"
    },
    {
      "id": "9c94d6da-c2be-342c-909b-f6465ea02083",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.19"
    },
    {
      "id": "a4f58e5f-775d-366c-92c7-3157f0165270",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <7507ead1e9d42957c2340f2c4a0e9d00034e3366"
    },
    {
      "id": "a8e303ad-123a-327a-9cbe-5e67592a4af9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    },
    {
      "id": "a8efbdc4-ffb0-35de-9155-d22a1e669ee4",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <8410f70977734f21b8ed45c37e925d311dfda2e7"
    },
    {
      "id": "acdcc9c3-08e3-37ab-acbd-e110be3fa15c",
      "product": {
        "name": "Linux"
      },
      "product_version": "aee69d78dec0ffdf82e35d57c626e80dddc314d5 <7507ead1e9d42957c2340f2c4a0e9d00034e3366"
    },
    {
      "id": "b8cd3f7d-5907-3a63-8118-867ed0d1e391",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <8f34dea99cd7761156a146a5258a67d045d862f7"
    },
    {
      "id": "d9f1252e-673e-33bb-a71d-6392e467ae4b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.33"
    },
    {
      "id": "eda17296-a54d-3c00-a337-49059f619ac3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <87fdfe8589d43e471dffb4c60f75eeb6f37afc4c"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "c1915a43-fbcf-3783-b1ad-9f16318b70b6",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49179"
}
