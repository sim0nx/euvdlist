{
  "id": "EUVD-2025-20963",
  "enisaUuid": "2abae0ef-47a6-3883-bdfc-fcd7b3b9d869",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Fix WARN() in get_bpf_raw_tp_regs\n\nsyzkaller reported an issue:\n\nWARNING: CPU: 3 PID: 5971 at kernel/trace/bpf_trace.c:1861 get_bpf_raw_tp_regs+0xa4/0x100 kernel/trace/bpf_trace.c:1861\nModules linked in:\nCPU: 3 UID: 0 PID: 5971 Comm: syz-executor205 Not tainted 6.15.0-rc5-syzkaller-00038-g707df3375124 #0 PREEMPT(full)\nHardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014\nRIP: 0010:get_bpf_raw_tp_regs+0xa4/0x100 kernel/trace/bpf_trace.c:1861\nRSP: 0018:ffffc90003636fa8 EFLAGS: 00010293\nRAX: 0000000000000000 RBX: 0000000000000003 RCX: ffffffff81c6bc4c\nRDX: ffff888032efc880 RSI: ffffffff81c6bc83 RDI: 0000000000000005\nRBP: ffff88806a730860 R08: 0000000000000005 R09: 0000000000000003\nR10: 0000000000000004 R11: 0000000000000000 R12: 0000000000000004\nR13: 0000000000000001 R14: ffffc90003637008 R15: 0000000000000900\nFS:  0000000000000000(0000) GS:ffff8880d6cdf000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007f7baee09130 CR3: 0000000029f5a000 CR4: 0000000000352ef0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n ____bpf_get_stack_raw_tp kernel/trace/bpf_trace.c:1934 [inline]\n bpf_get_stack_raw_tp+0x24/0x160 kernel/trace/bpf_trace.c:1931\n bpf_prog_ec3b2eefa702d8d3+0x43/0x47\n bpf_dispatcher_nop_func include/linux/bpf.h:1316 [inline]\n __bpf_prog_run include/linux/filter.h:718 [inline]\n bpf_prog_run include/linux/filter.h:725 [inline]\n __bpf_trace_run kernel/trace/bpf_trace.c:2363 [inline]\n bpf_trace_run3+0x23f/0x5a0 kernel/trace/bpf_trace.c:2405\n __bpf_trace_mmap_lock_acquire_returned+0xfc/0x140 include/trace/events/mmap_lock.h:47\n __traceiter_mmap_lock_acquire_returned+0x79/0xc0 include/trace/events/mmap_lock.h:47\n __do_trace_mmap_lock_acquire_returned include/trace/events/mmap_lock.h:47 [inline]\n trace_mmap_lock_acquire_returned include/trace/events/mmap_lock.h:47 [inline]\n __mmap_lock_do_trace_acquire_returned+0x138/0x1f0 mm/mmap_lock.c:35\n __mmap_lock_trace_acquire_returned include/linux/mmap_lock.h:36 [inline]\n mmap_read_trylock include/linux/mmap_lock.h:204 [inline]\n stack_map_get_build_id_offset+0x535/0x6f0 kernel/bpf/stackmap.c:157\n __bpf_get_stack+0x307/0xa10 kernel/bpf/stackmap.c:483\n ____bpf_get_stack kernel/bpf/stackmap.c:499 [inline]\n bpf_get_stack+0x32/0x40 kernel/bpf/stackmap.c:496\n ____bpf_get_stack_raw_tp kernel/trace/bpf_trace.c:1941 [inline]\n bpf_get_stack_raw_tp+0x124/0x160 kernel/trace/bpf_trace.c:1931\n bpf_prog_ec3b2eefa702d8d3+0x43/0x47\n\nTracepoint like trace_mmap_lock_acquire_returned may cause nested call\nas the corner case show above, which will be resolved with more general\nmethod in the future. As a result, WARN_ON_ONCE will be triggered. As\nAlexei suggested, remove the WARN_ON_ONCE first.",
  "datePublished": "Jul 10, 2025, 7:42:02 AM",
  "dateUpdated": "Jul 28, 2025, 4:17:23 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/44ebe361abb322d2afd77930fa767a99f271c4d1",
    "https://git.kernel.org/stable/c/147ea936fc6fa8fe0c93f0df918803a5375ca535",
    "https://git.kernel.org/stable/c/ee90be48edb3dac612e0b7f5332482a9e8be2696",
    "https://git.kernel.org/stable/c/e167414beabb1e941fe563a96becc98627d5bdf6",
    "https://git.kernel.org/stable/c/6d8f39875a10a194051c3eaefebc7ac06a34aaf3",
    "https://git.kernel.org/stable/c/c98cdf6795a36bca163ebb40411fef1687b9eb13",
    "https://git.kernel.org/stable/c/18e8cbbae79cb35bdce8a01c889827b9799c762e",
    "https://git.kernel.org/stable/c/3880cdbed1c4607e378f58fa924c5d6df900d1d3"
  ],
  "aliases": [
    "CVE-2025-38285"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "025351b9-dd6b-3d95-a8b5-5bbc7ecf6a8f",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <c98cdf6795a36bca163ebb40411fef1687b9eb13"
    },
    {
      "id": "0da022fe-1299-309b-ad68-286397e3bb70",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "208cb954-e140-303c-b081-ba9682dab175",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.295"
    },
    {
      "id": "2d1102b2-8bdb-3e76-ae2c-19866b39567c",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <ee90be48edb3dac612e0b7f5332482a9e8be2696"
    },
    {
      "id": "406d2233-3485-3d42-80f3-2cd0fd8532ac",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <44ebe361abb322d2afd77930fa767a99f271c4d1"
    },
    {
      "id": "45b78552-d267-3d35-8888-88d3b4cb1779",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <18e8cbbae79cb35bdce8a01c889827b9799c762e"
    },
    {
      "id": "491461be-7af0-3dd7-a335-ef47035c90b9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.94"
    },
    {
      "id": "4beab75b-9769-3b45-b523-af707c6b5300",
      "product": {
        "name": "Linux"
      },
      "product_version": "2a9fedc1ef4be2acb4fd4674f405c21c811e1505"
    },
    {
      "id": "4cd73694-dbac-3526-a667-9fbbf966629c",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <6d8f39875a10a194051c3eaefebc7ac06a34aaf3"
    },
    {
      "id": "57ab0083-ee34-317f-80f0-157cd9cae79e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.239"
    },
    {
      "id": "5a507d2f-2370-3a84-9784-2b06d9b06e3d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "5c786f64-0f32-3fe5-9d3f-3ec19b859bad",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <3880cdbed1c4607e378f58fa924c5d6df900d1d3"
    },
    {
      "id": "6d8a38be-ff83-3034-a7c2-9e032e35c94e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.186"
    },
    {
      "id": "88cf7108-8265-3bc9-914c-034921e1c704",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "89d473ea-0381-3081-ba0a-414c955fa7e9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.3"
    },
    {
      "id": "9850ac39-93c3-3448-a830-3e15eff273e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.142"
    },
    {
      "id": "c2d9acb3-0e3a-39c4-85a4-335ab018dc9e",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <147ea936fc6fa8fe0c93f0df918803a5375ca535"
    },
    {
      "id": "c2f44cf5-8091-36b0-9993-4f103eb85cd1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.34"
    },
    {
      "id": "c7668908-3dfb-3a74-aed2-fbb0f706ee19",
      "product": {
        "name": "Linux"
      },
      "product_version": "9594dc3c7e71b9f52bee1d7852eb3d4e3aea9e99 <e167414beabb1e941fe563a96becc98627d5bdf6"
    },
    {
      "id": "c8e2242e-7831-3fc2-989c-3041d010a0ec",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.2"
    },
    {
      "id": "e5de1ae1-2024-3fb9-b82b-4ddeda3426ea",
      "product": {
        "name": "Linux"
      },
      "product_version": "a7177b94aff4febe657fe31bb7e5ecdef72079f4"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "033d14f2-39b7-35cf-8246-59d1cf481f1e",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}