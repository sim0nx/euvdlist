{
  "id": "EUVD-2025-5980",
  "enisaUuid": "05169acc-cde5-3205-a1ae-6a3a7f879248",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nax25: rcu protect dev->ax25_ptr\n\nsyzbot found a lockdep issue [1].\n\nWe should remove ax25 RTNL dependency in ax25_setsockopt()\n\nThis should also fix a variety of possible UAF in ax25.\n\n[1]\n\nWARNING: possible circular locking dependency detected\n6.13.0-rc3-syzkaller-00762-g9268abe611b0 #0 Not tainted\n------------------------------------------------------\nsyz.5.1818/12806 is trying to acquire lock:\n ffffffff8fcb3988 (rtnl_mutex){+.+.}-{4:4}, at: ax25_setsockopt+0xa55/0xe90 net/ax25/af_ax25.c:680\n\nbut task is already holding lock:\n ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{0:0}, at: lock_sock include/net/sock.h:1618 [inline]\n ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{0:0}, at: ax25_setsockopt+0x209/0xe90 net/ax25/af_ax25.c:574\n\nwhich lock already depends on the new lock.\n\nthe existing dependency chain (in reverse order) is:\n\n-> #1 (sk_lock-AF_AX25){+.+.}-{0:0}:\n        lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c:5849\n        lock_sock_nested+0x48/0x100 net/core/sock.c:3642\n        lock_sock include/net/sock.h:1618 [inline]\n        ax25_kill_by_device net/ax25/af_ax25.c:101 [inline]\n        ax25_device_event+0x24d/0x580 net/ax25/af_ax25.c:146\n        notifier_call_chain+0x1a5/0x3f0 kernel/notifier.c:85\n       __dev_notify_flags+0x207/0x400\n        dev_change_flags+0xf0/0x1a0 net/core/dev.c:9026\n        dev_ifsioc+0x7c8/0xe70 net/core/dev_ioctl.c:563\n        dev_ioctl+0x719/0x1340 net/core/dev_ioctl.c:820\n        sock_do_ioctl+0x240/0x460 net/socket.c:1234\n        sock_ioctl+0x626/0x8e0 net/socket.c:1339\n        vfs_ioctl fs/ioctl.c:51 [inline]\n        __do_sys_ioctl fs/ioctl.c:906 [inline]\n        __se_sys_ioctl+0xf5/0x170 fs/ioctl.c:892\n        do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n        do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n       entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\n-> #0 (rtnl_mutex){+.+.}-{4:4}:\n        check_prev_add kernel/locking/lockdep.c:3161 [inline]\n        check_prevs_add kernel/locking/lockdep.c:3280 [inline]\n        validate_chain+0x18ef/0x5920 kernel/locking/lockdep.c:3904\n        __lock_acquire+0x1397/0x2100 kernel/locking/lockdep.c:5226\n        lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c:5849\n        __mutex_lock_common kernel/locking/mutex.c:585 [inline]\n        __mutex_lock+0x1ac/0xee0 kernel/locking/mutex.c:735\n        ax25_setsockopt+0xa55/0xe90 net/ax25/af_ax25.c:680\n        do_sock_setsockopt+0x3af/0x720 net/socket.c:2324\n        __sys_setsockopt net/socket.c:2349 [inline]\n        __do_sys_setsockopt net/socket.c:2355 [inline]\n        __se_sys_setsockopt net/socket.c:2352 [inline]\n        __x64_sys_setsockopt+0x1ee/0x280 net/socket.c:2352\n        do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n        do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n       entry_SYSCALL_64_after_hwframe+0x77/0x7f\n\nother info that might help us debug this:\n\n Possible unsafe locking scenario:\n\n       CPU0                    CPU1\n       ----                    ----\n  lock(sk_lock-AF_AX25);\n                               lock(rtnl_mutex);\n                               lock(sk_lock-AF_AX25);\n  lock(rtnl_mutex);\n\n *** DEADLOCK ***\n\n1 lock held by syz.5.1818/12806:\n  #0: ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{0:0}, at: lock_sock include/net/sock.h:1618 [inline]\n  #0: ffff8880617ac258 (sk_lock-AF_AX25){+.+.}-{0:0}, at: ax25_setsockopt+0x209/0xe90 net/ax25/af_ax25.c:574\n\nstack backtrace:\nCPU: 1 UID: 0 PID: 12806 Comm: syz.5.1818 Not tainted 6.13.0-rc3-syzkaller-00762-g9268abe611b0 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\nCall Trace:\n <TASK>\n  __dump_stack lib/dump_stack.c:94 [inline]\n  dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120\n  print_circular_bug+0x13a/0x1b0 kernel/locking/lockdep.c:2074\n  check_noncircular+0x36a/0x4a0 kernel/locking/lockdep.c:2206\n  check_prev_add kernel/locking/lockdep.c:3161 [inline]\n  check_prevs_add kernel/lockin\n---truncated---",
  "datePublished": "Feb 27, 2025, 8:01:02 PM",
  "dateUpdated": "May 4, 2025, 1:06:36 PM",
  "baseScore": 7.8,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-21812",
    "https://git.kernel.org/stable/c/2802ed4ced27ebd474828fc67ffd7d66f11e3605",
    "https://git.kernel.org/stable/c/7705d8a7f2c26c80973c81093db07c6022b2b30e",
    "https://git.kernel.org/stable/c/8937f5e38a218531dce2a89fae60e3adcc2311e1",
    "https://git.kernel.org/stable/c/95fc45d1dea8e1253f8ec58abc5befb71553d666",
    "https://git.kernel.org/stable/c/c2531db6de3c95551be58878f859c6a053b7eb2e"
  ],
  "aliases": [
    "CVE-2025-21812",
    "GHSA-5qmp-w6rv-24wf"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "1bc24a09-838b-3787-9680-afcd4a2d2c9e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "40d91c47-8259-3a2f-8d45-f2bfac0f0600",
      "product": {
        "name": "Linux"
      },
      "product_version": "c433570458e49bccea5c551df628d058b3526289 <8937f5e38a218531dce2a89fae60e3adcc2311e1"
    },
    {
      "id": "4fafa1cd-ab3e-3045-9623-db2614ea75af",
      "product": {
        "name": "Linux"
      },
      "product_version": "c433570458e49bccea5c551df628d058b3526289 <c2531db6de3c95551be58878f859c6a053b7eb2e"
    },
    {
      "id": "553624c8-1417-3bdd-a7a4-2e55e800171b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "5ae0fa39-256a-3435-b9d4-ad00c35d31fe",
      "product": {
        "name": "Linux"
      },
      "product_version": "c433570458e49bccea5c551df628d058b3526289 <2802ed4ced27ebd474828fc67ffd7d66f11e3605"
    },
    {
      "id": "5da3e37c-7ba9-3cc9-ac68-02f533334778",
      "product": {
        "name": "Linux"
      },
      "product_version": "c433570458e49bccea5c551df628d058b3526289 <7705d8a7f2c26c80973c81093db07c6022b2b30e"
    },
    {
      "id": "6c3093ef-e92b-3e29-bc33-c6c679e8a93c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.2"
    },
    {
      "id": "6e8ff897-f665-371c-b1e8-0abae88f7b18",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.129"
    },
    {
      "id": "6f2142be-6deb-3250-b2aa-97fe9f8b6561",
      "product": {
        "name": "Linux"
      },
      "product_version": "c39b8fd4997bf99503b8e48d8cb0eedb1d9a54f0"
    },
    {
      "id": "95a4e9f4-15f9-36ea-9237-56a6080dc48e",
      "product": {
        "name": "Linux"
      },
      "product_version": "c433570458e49bccea5c551df628d058b3526289 <95fc45d1dea8e1253f8ec58abc5befb71553d666"
    },
    {
      "id": "97b13ec8-8634-3a37-a991-3432d643296b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.76"
    },
    {
      "id": "ac300bf9-09d4-36a8-8122-63dc525729d5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.13"
    },
    {
      "id": "b2bd9b1f-014a-3cf5-869c-abfaa3bbe8e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "c0e93a6d36135d5082cb3af8352f5b69c9f58d6e"
    },
    {
      "id": "b3ac87cd-75fe-32d5-8b1a-afa3995c46df",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.0"
    },
    {
      "id": "b6cdabbf-1286-38c9-aa68-f281f120f201",
      "product": {
        "name": "Linux"
      },
      "product_version": "7f93d703e276311dd289c9a520ce9e8c8fa2858c"
    },
    {
      "id": "d7e2e9f2-a379-3fb7-ab27-48e0d53b2833",
      "product": {
        "name": "Linux"
      },
      "product_version": "26a5adc8eb26d170058645c3cccd4d19165bec16"
    },
    {
      "id": "f4fa6426-6607-3bed-ae81-7a463750c2eb",
      "product": {
        "name": "Linux"
      },
      "product_version": "77768c96dcf860c43b970b87b2a09229f84ea560"
    },
    {
      "id": "ffcc088c-412e-3446-8e62-3e84aab7e4e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "3e881d8764ed9b04ae3e5c3e5d132acb75ef91ba"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "5b2e4957-828e-3663-9a79-8f8603f4d8eb",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}