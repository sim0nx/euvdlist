{
  "id": "EUVD-2025-20798",
  "enisaUuid": "a2cb4a7e-83b5-3ff4-a09b-e3a7615ec507",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbcache: fix NULL pointer in cache_set_flush()\n\n1. LINE#1794 - LINE#1887 is some codes about function of\n   bch_cache_set_alloc().\n2. LINE#2078 - LINE#2142 is some codes about function of\n   register_cache_set().\n3. register_cache_set() will call bch_cache_set_alloc() in LINE#2098.\n\n 1794 struct cache_set *bch_cache_set_alloc(struct cache_sb *sb)\n 1795 {\n ...\n 1860         if (!(c->devices = kcalloc(c->nr_uuids, sizeof(void *), GFP_KERNEL)) ||\n 1861             mempool_init_slab_pool(&c->search, 32, bch_search_cache) ||\n 1862             mempool_init_kmalloc_pool(&c->bio_meta, 2,\n 1863                                 sizeof(struct bbio) + sizeof(struct bio_vec) *\n 1864                                 bucket_pages(c)) ||\n 1865             mempool_init_kmalloc_pool(&c->fill_iter, 1, iter_size) ||\n 1866             bioset_init(&c->bio_split, 4, offsetof(struct bbio, bio),\n 1867                         BIOSET_NEED_BVECS|BIOSET_NEED_RESCUER) ||\n 1868             !(c->uuids = alloc_bucket_pages(GFP_KERNEL, c)) ||\n 1869             !(c->moving_gc_wq = alloc_workqueue(\"bcache_gc\",\n 1870                                                 WQ_MEM_RECLAIM, 0)) ||\n 1871             bch_journal_alloc(c) ||\n 1872             bch_btree_cache_alloc(c) ||\n 1873             bch_open_buckets_alloc(c) ||\n 1874             bch_bset_sort_state_init(&c->sort, ilog2(c->btree_pages)))\n 1875                 goto err;\n                      ^^^^^^^^\n 1876\n ...\n 1883         return c;\n 1884 err:\n 1885         bch_cache_set_unregister(c);\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n 1886         return NULL;\n 1887 }\n ...\n 2078 static const char *register_cache_set(struct cache *ca)\n 2079 {\n ...\n 2098         c = bch_cache_set_alloc(&ca->sb);\n 2099         if (!c)\n 2100                 return err;\n                      ^^^^^^^^^^\n ...\n 2128         ca->set = c;\n 2129         ca->set->cache[ca->sb.nr_this_dev] = ca;\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n ...\n 2138         return NULL;\n 2139 err:\n 2140         bch_cache_set_unregister(c);\n 2141         return err;\n 2142 }\n\n(1) If LINE#1860 - LINE#1874 is true, then do 'goto err'(LINE#1875) and\n    call bch_cache_set_unregister()(LINE#1885).\n(2) As (1) return NULL(LINE#1886), LINE#2098 - LINE#2100 would return.\n(3) As (2) has returned, LINE#2128 - LINE#2129 would do *not* give the\n    value to c->cache[], it means that c->cache[] is NULL.\n\nLINE#1624 - LINE#1665 is some codes about function of cache_set_flush().\nAs (1), in LINE#1885 call\nbch_cache_set_unregister()\n---> bch_cache_set_stop()\n     ---> closure_queue()\n          -.-> cache_set_flush() (as below LINE#1624)\n\n 1624 static void cache_set_flush(struct closure *cl)\n 1625 {\n ...\n 1654         for_each_cache(ca, c, i)\n 1655                 if (ca->alloc_thread)\n                          ^^\n 1656                         kthread_stop(ca->alloc_thread);\n ...\n 1665 }\n\n(4) In LINE#1655 ca is NULL(see (3)) in cache_set_flush() then the\n    kernel crash occurred as below:\n[  846.712887] bcache: register_cache() error drbd6: cannot allocate memory\n[  846.713242] bcache: register_bcache() error : failed to register device\n[  846.713336] bcache: cache_set_free() Cache set 2f84bdc1-498a-4f2f-98a7-01946bf54287 unregistered\n[  846.713768] BUG: unable to handle kernel NULL pointer dereference at 00000000000009f8\n[  846.714790] PGD 0 P4D 0\n[  846.715129] Oops: 0000 [#1] SMP PTI\n[  846.715472] CPU: 19 PID: 5057 Comm: kworker/19:16 Kdump: loaded Tainted: G           OE    --------- -  - 4.18.0-147.5.1.el8_1.5es.3.x86_64 #1\n[  846.716082] Hardware name: ESPAN GI-25212/X11DPL-i, BIOS 2.1 06/15/2018\n[  846.716451] Workqueue: events cache_set_flush [bcache]\n[  846.716808] RIP: 0010:cache_set_flush+0xc9/0x1b0 [bcache]\n[  846.717155] Code: 00 4c 89 a5 b0 03 00 00 48 8b 85 68 f6 ff ff a8 08 0f 84 88 00 00 00 31 db 66 83 bd 3c f7 ff ff 00 48 8b 85 48 ff ff ff 74 28 <48> 8b b8 f8 09 00 0\n---truncated---",
  "datePublished": "Jul 9, 2025, 10:42:37 AM",
  "dateUpdated": "Jul 28, 2025, 4:16:36 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/c4f5e7e417034b05f5d2f5fa9a872db897da69bd",
    "https://git.kernel.org/stable/c/553f560e0a74a7008ad9dba05c3fd05da296befb",
    "https://git.kernel.org/stable/c/667c3f52373ff5354cb3543e27237eb7df7b2333",
    "https://git.kernel.org/stable/c/3f9e128186c99a117e304f1dce6d0b9e50c63cd8",
    "https://git.kernel.org/stable/c/1e46ed947ec658f89f1a910d880cd05e42d3763e",
    "https://git.kernel.org/stable/c/1f25f2d3fa29325320c19a30abf787e0bd5fc91b",
    "https://git.kernel.org/stable/c/d54681938b777488e5dfb781b566d16adad991de"
  ],
  "aliases": [
    "CVE-2025-38263"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "0485201e-3380-3c0f-8229-4aa9fa170b5b",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <3f9e128186c99a117e304f1dce6d0b9e50c63cd8"
    },
    {
      "id": "13bbc82e-81bc-37b6-a6fd-8753fbe102f1",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <1f25f2d3fa29325320c19a30abf787e0bd5fc91b"
    },
    {
      "id": "153ec876-4945-3540-8f2d-602640df9472",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1f25f2d3fa29325320c19a30abf787e0bd5fc91b"
    },
    {
      "id": "1d09a956-d496-3a08-85b9-3cc1e33879c8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.96"
    },
    {
      "id": "27028793-fa0b-3427-9112-21ad54978f00",
      "product": {
        "name": "Linux"
      },
      "product_version": "3.10"
    },
    {
      "id": "32a07fef-011a-314a-a01e-548efac843a6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.143"
    },
    {
      "id": "343d9cc1-c6aa-38ce-a2ec-70a08d3f8f2a",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <d54681938b777488e5dfb781b566d16adad991de"
    },
    {
      "id": "3b4de32a-3a7d-3057-bdfb-58a0a06c800b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.187"
    },
    {
      "id": "48999a59-42e0-3976-82fb-3ea7d015a62b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc1"
    },
    {
      "id": "4e342873-26bd-3bd5-8e1f-d7885d3faf4c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.5"
    },
    {
      "id": "5792185b-f219-39df-9d3a-78dc62acc7e3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.240"
    },
    {
      "id": "57c7ca10-4299-3463-a525-9251fb3d1af4",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <667c3f52373ff5354cb3543e27237eb7df7b2333"
    },
    {
      "id": "6c25a4df-844c-310c-8fd8-ecc8d1ee08af",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <c4f5e7e417034b05f5d2f5fa9a872db897da69bd"
    },
    {
      "id": "8de5360f-ceef-36c7-bb46-21f567873ee5",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <667c3f52373ff5354cb3543e27237eb7df7b2333"
    },
    {
      "id": "98e794c0-3884-3d31-9007-a897be899389",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <553f560e0a74a7008ad9dba05c3fd05da296befb"
    },
    {
      "id": "b910d7c9-959e-3de3-ae8e-95ab6fa27200",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <553f560e0a74a7008ad9dba05c3fd05da296befb"
    },
    {
      "id": "c7a71de0-8a19-3de6-9f81-dc75eddb9801",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c4f5e7e417034b05f5d2f5fa9a872db897da69bd"
    },
    {
      "id": "ceb9d990-2c87-3940-ae2d-d7608d3dfd01",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <1e46ed947ec658f89f1a910d880cd05e42d3763e"
    },
    {
      "id": "e2bdf86b-7f08-362e-99cf-9a3801fb1e50",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "eb4141da-9104-3f32-a2fd-ea99432d4549",
      "product": {
        "name": "Linux"
      },
      "product_version": "cafe563591446cf80bfbc2fe3bc72a2e36cf1060 <3f9e128186c99a117e304f1dce6d0b9e50c63cd8"
    },
    {
      "id": "ec01809b-9a70-3e33-89f6-45b91ba5dbd7",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <1e46ed947ec658f89f1a910d880cd05e42d3763e"
    },
    {
      "id": "fa8ff6cc-8a91-36d0-af13-c719b92dfe19",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "fb909b37-11a2-3684-baa9-4ed1c880ebb9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.36"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "bb9b441c-4b40-3a6d-93a9-75f7a375de0e",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}