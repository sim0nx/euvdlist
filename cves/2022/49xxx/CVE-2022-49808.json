{
  "id": "EUVD-2025-12955",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: dsa: don't leak tagger-owned storage on switch driver unbind\n\nIn the initial commit dc452a471dba (\"net: dsa: introduce tagger-owned\nstorage for private and shared data\"), we had a call to\ntag_ops->disconnect(dst) issued from dsa_tree_free(), which is called at\ntree teardown time.\n\nThere were problems with connecting to a switch tree as a whole, so this\ngot reworked to connecting to individual switches within the tree. In\nthis process, tag_ops->disconnect(ds) was made to be called only from\nswitch.c (cross-chip notifiers emitted as a result of dynamic tag proto\nchanges), but the normal driver teardown code path wasn't replaced with\nanything.\n\nSolve this problem by adding a function that does the opposite of\ndsa_switch_setup_tag_protocol(), which is called from the equivalent\nspot in dsa_switch_teardown(). The positioning here also ensures that we\nwon't have any use-after-free in tagging protocol (*rcv) ops, since the\nteardown sequence is as follows:\n\ndsa_tree_teardown\n-> dsa_tree_teardown_master\n   -> dsa_master_teardown\n      -> unsets master->dsa_ptr, making no further packets match the\n         ETH_P_XDSA packet type handler\n-> dsa_tree_teardown_ports\n   -> dsa_port_teardown\n      -> dsa_slave_destroy\n         -> unregisters DSA net devices, there is even a synchronize_net()\n            in unregister_netdevice_many()\n-> dsa_tree_teardown_switches\n   -> dsa_switch_teardown\n      -> dsa_switch_teardown_tag_protocol\n         -> finally frees the tagger-owned storage",
  "datePublished": "May 1, 2025, 2:09:34 PM",
  "dateUpdated": "May 4, 2025, 8:45:47 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-49808",
    "https://git.kernel.org/stable/c/4e0c19fcb8b5323716140fa82b79aa9f60e60407",
    "https://git.kernel.org/stable/c/5809fb03942dbac25144db5bebea84fa003ecaca"
  ],
  "aliases": [
    "CVE-2022-49808",
    "GHSA-m9hv-2rww-w638"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "036bb540-94c9-3729-bcad-5bd1db178263",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.10"
    },
    {
      "id": "27e6677c-ec94-371d-b66f-8e831dc95414",
      "product": {
        "name": "Linux"
      },
      "product_version": "7f2973149c22e7a6fee4c0c9fa6b8e4108e9c208 <4e0c19fcb8b5323716140fa82b79aa9f60e60407"
    },
    {
      "id": "2d6cc74d-bd40-32d3-8464-8f32d07ad899",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "83f9bd33-d1f5-3e13-9c59-bef4a5446cc1",
      "product": {
        "name": "Linux"
      },
      "product_version": "7f2973149c22e7a6fee4c0c9fa6b8e4108e9c208 <5809fb03942dbac25144db5bebea84fa003ecaca"
    },
    {
      "id": "b235533a-85c0-3d1b-aec6-10ff15a6659f",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    },
    {
      "id": "ba60ef9f-ae48-3258-a4d7-877dfe9dd153",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "0734a313-b487-340d-a314-c13628aa6c7a",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49808"
}
