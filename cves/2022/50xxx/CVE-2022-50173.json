{
  "id": "EUVD-2022-55438",
  "enisaUuid": "7a34670d-7c33-3fb0-9859-bfffbbb1910d",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/msm/mdp5: Fix global state lock backoff\n\nWe need to grab the lock after the early return for !hwpipe case.\nOtherwise, we could have hit contention yet still returned 0.\n\nFixes an issue that the new CONFIG_DRM_DEBUG_MODESET_LOCK stuff flagged\nin CI:\n\n   WARNING: CPU: 0 PID: 282 at drivers/gpu/drm/drm_modeset_lock.c:296 drm_modeset_lock+0xf8/0x154\n   Modules linked in:\n   CPU: 0 PID: 282 Comm: kms_cursor_lega Tainted: G        W         5.19.0-rc2-15930-g875cc8bc536a #1\n   Hardware name: Qualcomm Technologies, Inc. DB820c (DT)\n   pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n   pc : drm_modeset_lock+0xf8/0x154\n   lr : drm_atomic_get_private_obj_state+0x84/0x170\n   sp : ffff80000cfab6a0\n   x29: ffff80000cfab6a0 x28: 0000000000000000 x27: ffff000083bc4d00\n   x26: 0000000000000038 x25: 0000000000000000 x24: ffff80000957ca58\n   x23: 0000000000000000 x22: ffff000081ace080 x21: 0000000000000001\n   x20: ffff000081acec18 x19: ffff80000cfabb80 x18: 0000000000000038\n   x17: 0000000000000000 x16: 0000000000000000 x15: fffffffffffea0d0\n   x14: 0000000000000000 x13: 284e4f5f4e524157 x12: 5f534b434f4c5f47\n   x11: ffff80000a386aa8 x10: 0000000000000029 x9 : ffff80000cfab610\n   x8 : 0000000000000029 x7 : 0000000000000014 x6 : 0000000000000000\n   x5 : 0000000000000001 x4 : ffff8000081ad904 x3 : 0000000000000029\n   x2 : ffff0000801db4c0 x1 : ffff80000cfabb80 x0 : ffff000081aceb58\n   Call trace:\n    drm_modeset_lock+0xf8/0x154\n    drm_atomic_get_private_obj_state+0x84/0x170\n    mdp5_get_global_state+0x54/0x6c\n    mdp5_pipe_release+0x2c/0xd4\n    mdp5_plane_atomic_check+0x2ec/0x414\n    drm_atomic_helper_check_planes+0xd8/0x210\n    drm_atomic_helper_check+0x54/0xb0\n    ...\n   ---[ end trace 0000000000000000 ]---\n   drm_modeset_lock attempting to lock a contended lock without backoff:\n      drm_modeset_lock+0x148/0x154\n      mdp5_get_global_state+0x30/0x6c\n      mdp5_pipe_release+0x2c/0xd4\n      mdp5_plane_atomic_check+0x290/0x414\n      drm_atomic_helper_check_planes+0xd8/0x210\n      drm_atomic_helper_check+0x54/0xb0\n      drm_atomic_check_only+0x4b0/0x8f4\n      drm_atomic_commit+0x68/0xe0\n\nPatchwork: https://patchwork.freedesktop.org/patch/492701/",
  "datePublished": "Jun 18, 2025, 11:03:25 AM",
  "dateUpdated": "Jun 18, 2025, 11:03:25 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/247f2934324f9a18d18df24ea4bfcc7d4631d0ef",
    "https://git.kernel.org/stable/c/2e34d6c8180a398de6448a93df25068bf3062042",
    "https://git.kernel.org/stable/c/bf386c955f35a0a01bef482b6035d40ff2f6cc75",
    "https://git.kernel.org/stable/c/f4e3a8c7e890049e7ba2b49ad0315dae841dfa55",
    "https://git.kernel.org/stable/c/2fdf5a54ef9376ff69149a48c5616f1141008c9f",
    "https://git.kernel.org/stable/c/0b07f28c23ff50a7fa5dbc3f6b3b6bd53ac9fc70",
    "https://git.kernel.org/stable/c/92ef86ab513593c6329d04146e61f9a670e72fc5"
  ],
  "aliases": [
    "CVE-2022-50173"
  ],
  "assigner": "Linux",
  "epss": 0.05,
  "enisaIdProduct": [
    {
      "id": "0e892804-c7a9-3bee-a6fa-3b75f5aece37",
      "product": {
        "name": "Linux"
      },
      "product_version": "33dc5aac46e0fad8f5eb193e5906ed0eb6b66ceb <2fdf5a54ef9376ff69149a48c5616f1141008c9f"
    },
    {
      "id": "11ba19b6-9c34-3899-95a0-d782549c8af4",
      "product": {
        "name": "Linux"
      },
      "product_version": "d59be579fa932c46b908f37509f319cbd4ca9a68 <0b07f28c23ff50a7fa5dbc3f6b3b6bd53ac9fc70"
    },
    {
      "id": "16173414-9a09-3412-89a6-d86dd11ba300",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.61"
    },
    {
      "id": "349ff5af-de04-3333-9845-108de4cde963",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.19"
    },
    {
      "id": "3b5be94c-32c7-3f92-8ab1-a217d91e7d4f",
      "product": {
        "name": "Linux"
      },
      "product_version": "776f5c58bfe16cf322d71eeed3c5dda1eeac7e6b <247f2934324f9a18d18df24ea4bfcc7d4631d0ef"
    },
    {
      "id": "5dd3a347-b1c4-30e7-8e5f-1346546bf103",
      "product": {
        "name": "Linux"
      },
      "product_version": "b2aa2c4efe93e2580d6a8774b04fe2b99756a322 <2e34d6c8180a398de6448a93df25068bf3062042"
    },
    {
      "id": "68b83973-70d8-3763-92a3-3e5392083680",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.256"
    },
    {
      "id": "784bf275-d193-3c0f-882c-f769b956bb1a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.2"
    },
    {
      "id": "82f12c4d-6152-34b6-864a-2ff048a7d013",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.211"
    },
    {
      "id": "84f5e054-d553-38c6-b446-4d8b3d201108",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.18"
    },
    {
      "id": "9e6d590f-49fc-3b2a-959d-d67a93b9fb7a",
      "product": {
        "name": "Linux"
      },
      "product_version": "d59be579fa932c46b908f37509f319cbd4ca9a68 <92ef86ab513593c6329d04146e61f9a670e72fc5"
    },
    {
      "id": "a29e671e-ba51-3b17-812e-857b65deb2d2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "a6fa00a1-b31b-34c2-b513-88c3975f85d1",
      "product": {
        "name": "Linux"
      },
      "product_version": "19964dfb39bda4d7716a71009488f0668ecbcf52"
    },
    {
      "id": "bbda5b1f-2292-3ad1-ad60-41a619ff5961",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.137"
    },
    {
      "id": "d62f2b71-e134-3e69-97f8-8536572bbcb0",
      "product": {
        "name": "Linux"
      },
      "product_version": "04bef5f1ba8ea6d7c1c8f5f65e0395c62db59cb8 <f4e3a8c7e890049e7ba2b49ad0315dae841dfa55"
    },
    {
      "id": "ed4bb234-9baf-37c2-89d1-57ae677d68a5",
      "product": {
        "name": "Linux"
      },
      "product_version": "49dc28b4b2e28ef7564e355c91487996c1cbebd7 <bf386c955f35a0a01bef482b6035d40ff2f6cc75"
    },
    {
      "id": "fa0c1833-e294-3a4e-9fd1-4b49deecc30b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "eaa0b75f-a35b-3800-84f5-0d5df9e7239f",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50173"
}