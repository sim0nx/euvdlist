{
  "id": "EUVD-2025-27920",
  "enisaUuid": "b112ee91-be50-3c57-9812-d4bb142a5097",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf: Reject narrower access to pointer ctx fields\n\nThe following BPF program, simplified from a syzkaller repro, causes a\nkernel warning:\n\n    r0 = *(u8 *)(r1 + 169);\n    exit;\n\nWith pointer field sk being at offset 168 in __sk_buff. This access is\ndetected as a narrower read in bpf_skb_is_valid_access because it\ndoesn't match offsetof(struct __sk_buff, sk). It is therefore allowed\nand later proceeds to bpf_convert_ctx_access. Note that for the\n\"is_narrower_load\" case in the convert_ctx_accesses(), the insn->off\nis aligned, so the cnt may not be 0 because it matches the\noffsetof(struct __sk_buff, sk) in the bpf_convert_ctx_access. However,\nthe target_size stays 0 and the verifier errors with a kernel warning:\n\n    verifier bug: error during ctx access conversion(1)\n\nThis patch fixes that to return a proper \"invalid bpf_context access\noff=X size=Y\" error on the load instruction.\n\nThe same issue affects multiple other fields in context structures that\nallow narrow access. Some other non-affected fields (for sk_msg,\nsk_lookup, and sockopt) were also changed to use bpf_ctx_range_ptr for\nconsistency.\n\nNote this syzkaller crash was reported in the \"Closes\" link below, which\nused to be about a different bug, fixed in\ncommit fce7bd8e385a (\"bpf/verifier: Handle BPF_LOAD_ACQ instructions\nin insn_def_regno()\"). Because syzbot somehow confused the two bugs,\nthe new crash and repro didn't get reported to the mailing list.",
  "datePublished": "Aug 19, 2025, 5:03:12 PM",
  "dateUpdated": "Sep 29, 2025, 5:54:24 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/202900ceeef67458c964c2af6e1427c8e533ea7c",
    "https://git.kernel.org/stable/c/e09299225d5ba3916c91ef70565f7d2187e4cca0"
  ],
  "aliases": [
    "CVE-2025-38591"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "2d1beacd-42fd-32a7-898f-b48ec699284f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc1"
    },
    {
      "id": "3bee20fa-dcb9-3a70-bdf6-93cd977f6107",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.13"
    },
    {
      "id": "6c9eef80-68a5-3925-8247-838a02441d0c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "715ea676-5ed1-3d8f-9724-e2e0851d1b61",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "98f968ce-60de-37ed-a00a-ace226bcf771",
      "product": {
        "name": "Linux"
      },
      "product_version": "f96da09473b52c09125cc9bf7d7d4576ae8229e0 <e09299225d5ba3916c91ef70565f7d2187e4cca0"
    },
    {
      "id": "c50aee19-ca59-3d4c-bb8d-098916ab6f2b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.1"
    },
    {
      "id": "f0dcb1bd-a70d-3136-915e-0d6b3b115601",
      "product": {
        "name": "Linux"
      },
      "product_version": "f96da09473b52c09125cc9bf7d7d4576ae8229e0 <202900ceeef67458c964c2af6e1427c8e533ea7c"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "3aab61bb-8d4d-3be6-b33d-967ab17a0458",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}