{
  "id": "EUVD-2024-54043",
  "enisaUuid": "e8afa41d-347b-3649-96f5-867ed3d7a7bc",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nremoteproc: core: Fix ida_free call while not allocated\n\nIn the rproc_alloc() function, on error, put_device(&rproc->dev) is\ncalled, leading to the call of the rproc_type_release() function.\nAn error can occurs before ida_alloc is called.\n\nIn such case in rproc_type_release(), the condition (rproc->index >= 0) is\ntrue as rproc->index has been  initialized to 0.\nida_free() is called reporting a warning:\n[    4.181906] WARNING: CPU: 1 PID: 24 at lib/idr.c:525 ida_free+0x100/0x164\n[    4.186378] stm32-display-dsi 5a000000.dsi: Fixed dependency cycle(s) with /soc/dsi@5a000000/panel@0\n[    4.188854] ida_free called for id=0 which is not allocated.\n[    4.198256] mipi-dsi 5a000000.dsi.0: Fixed dependency cycle(s) with /soc/dsi@5a000000\n[    4.203556] Modules linked in: panel_orisetech_otm8009a dw_mipi_dsi_stm(+) gpu_sched dw_mipi_dsi stm32_rproc stm32_crc32 stm32_ipcc(+) optee(+)\n[    4.224307] CPU: 1 UID: 0 PID: 24 Comm: kworker/u10:0 Not tainted 6.12.0 #442\n[    4.231481] Hardware name: STM32 (Device Tree Support)\n[    4.236627] Workqueue: events_unbound deferred_probe_work_func\n[    4.242504] Call trace:\n[    4.242522]  unwind_backtrace from show_stack+0x10/0x14\n[    4.250218]  show_stack from dump_stack_lvl+0x50/0x64\n[    4.255274]  dump_stack_lvl from __warn+0x80/0x12c\n[    4.260134]  __warn from warn_slowpath_fmt+0x114/0x188\n[    4.265199]  warn_slowpath_fmt from ida_free+0x100/0x164\n[    4.270565]  ida_free from rproc_type_release+0x38/0x60\n[    4.275832]  rproc_type_release from device_release+0x30/0xa0\n[    4.281601]  device_release from kobject_put+0xc4/0x294\n[    4.286762]  kobject_put from rproc_alloc.part.0+0x208/0x28c\n[    4.292430]  rproc_alloc.part.0 from devm_rproc_alloc+0x80/0xc4\n[    4.298393]  devm_rproc_alloc from stm32_rproc_probe+0xd0/0x844 [stm32_rproc]\n[    4.305575]  stm32_rproc_probe [stm32_rproc] from platform_probe+0x5c/0xbc\n\nCalling ida_alloc earlier in rproc_alloc ensures that the rproc->index is\nproperly set.",
  "datePublished": "Mar 6, 2025, 3:53:59 PM",
  "dateUpdated": "Mar 24, 2025, 3:38:14 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/2cf54928e7e32362215c69b68a6a53d110323bf3",
    "https://git.kernel.org/stable/c/b32d60a852bb3952886625d0c3b1c9a88c3ceb7c",
    "https://git.kernel.org/stable/c/f2013d19b7704cd723ab42664b8d9408ea8cc77c",
    "https://git.kernel.org/stable/c/e9efd9fa4679803fe23188d7b47119cf7bc2de6f",
    "https://git.kernel.org/stable/c/7378aeb664e5ebc396950b36a1f2dedf5aabec20"
  ],
  "aliases": [
    "CVE-2024-58056"
  ],
  "assigner": "Linux",
  "epss": 0.07,
  "enisaIdProduct": [
    {
      "id": "0616b3a4-5a55-34c0-8ad5-34e767d766de",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.76"
    },
    {
      "id": "072c311b-0318-3660-8faf-0eff8468ce17",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "1adc14dd-7dec-3944-bba2-fa9a667efcd9",
      "product": {
        "name": "Linux"
      },
      "product_version": "08333b911f01862e71e51b7065fb4baca3cd2e67 <f2013d19b7704cd723ab42664b8d9408ea8cc77c"
    },
    {
      "id": "29ede842-b253-3703-8873-1361cabe119e",
      "product": {
        "name": "Linux"
      },
      "product_version": "08333b911f01862e71e51b7065fb4baca3cd2e67 <7378aeb664e5ebc396950b36a1f2dedf5aabec20"
    },
    {
      "id": "399a6f53-1231-34af-8fac-b772d2365901",
      "product": {
        "name": "Linux"
      },
      "product_version": "08333b911f01862e71e51b7065fb4baca3cd2e67 <2cf54928e7e32362215c69b68a6a53d110323bf3"
    },
    {
      "id": "5bde2ed5-2ee2-3963-bca2-3e9d36509e85",
      "product": {
        "name": "Linux"
      },
      "product_version": "08333b911f01862e71e51b7065fb4baca3cd2e67 <b32d60a852bb3952886625d0c3b1c9a88c3ceb7c"
    },
    {
      "id": "67b8980f-f5c7-3e47-afc0-b7ce72f82453",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.14"
    },
    {
      "id": "717951d6-03a7-3ed7-82cf-e6b6229982e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.13"
    },
    {
      "id": "8858f991-c33c-3ddd-b5bc-099b0ded6695",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13.2"
    },
    {
      "id": "ccc6b8ca-663c-3ef4-b96d-d366b4cf8a4b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.129"
    },
    {
      "id": "ec833700-6b38-32cb-b5f1-b4105570833b",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.0"
    },
    {
      "id": "ffb645c2-7edc-30f4-bd61-3d4d35c82cce",
      "product": {
        "name": "Linux"
      },
      "product_version": "08333b911f01862e71e51b7065fb4baca3cd2e67 <e9efd9fa4679803fe23188d7b47119cf7bc2de6f"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8f82cb8d-b154-3620-a4ff-505dfcf36490",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}