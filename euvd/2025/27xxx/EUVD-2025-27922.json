{
  "id": "EUVD-2025-27922",
  "enisaUuid": "66a18a27-7d1b-3822-8c27-a6fbaf56f84f",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: hci_sync: fix double free in 'hci_discovery_filter_clear()'\n\nFunction 'hci_discovery_filter_clear()' frees 'uuids' array and then\nsets it to NULL. There is a tiny chance of the following race:\n\n'hci_cmd_sync_work()'\n\n 'update_passive_scan_sync()'\n\n   'hci_update_passive_scan_sync()'\n\n     'hci_discovery_filter_clear()'\n       kfree(uuids);\n\n       <-------------------------preempted-------------------------------->\n                                           'start_service_discovery()'\n\n                                             'hci_discovery_filter_clear()'\n                                               kfree(uuids); // DOUBLE FREE\n\n       <-------------------------preempted-------------------------------->\n\n      uuids = NULL;\n\nTo fix it let's add locking around 'kfree()' call and NULL pointer\nassignment. Otherwise the following backtrace fires:\n\n[ ] ------------[ cut here ]------------\n[ ] kernel BUG at mm/slub.c:547!\n[ ] Internal error: Oops - BUG: 00000000f2000800 [#1] PREEMPT SMP\n[ ] CPU: 3 UID: 0 PID: 246 Comm: bluetoothd Tainted: G O 6.12.19-kernel #1\n[ ] Tainted: [O]=OOT_MODULE\n[ ] pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[ ] pc : __slab_free+0xf8/0x348\n[ ] lr : __slab_free+0x48/0x348\n...\n[ ] Call trace:\n[ ]  __slab_free+0xf8/0x348\n[ ]  kfree+0x164/0x27c\n[ ]  start_service_discovery+0x1d0/0x2c0\n[ ]  hci_sock_sendmsg+0x518/0x924\n[ ]  __sock_sendmsg+0x54/0x60\n[ ]  sock_write_iter+0x98/0xf8\n[ ]  do_iter_readv_writev+0xe4/0x1c8\n[ ]  vfs_writev+0x128/0x2b0\n[ ]  do_writev+0xfc/0x118\n[ ]  __arm64_sys_writev+0x20/0x2c\n[ ]  invoke_syscall+0x68/0xf0\n[ ]  el0_svc_common.constprop.0+0x40/0xe0\n[ ]  do_el0_svc+0x1c/0x28\n[ ]  el0_svc+0x30/0xd0\n[ ]  el0t_64_sync_handler+0x100/0x12c\n[ ]  el0t_64_sync+0x194/0x198\n[ ] Code: 8b0002e6 eb17031f 54fffbe1 d503201f (d4210000)\n[ ] ---[ end trace 0000000000000000 ]---",
  "datePublished": "Aug 19, 2025, 5:03:18 PM",
  "dateUpdated": "Sep 29, 2025, 5:54:26 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/16852eccbdfaf41a666705e3f8be55cf2864c5ca",
    "https://git.kernel.org/stable/c/a351ff6b8ecca4229afaa0d98042bead8de64799",
    "https://git.kernel.org/stable/c/f8069f34c4c976786ded97498012225af87435d7",
    "https://git.kernel.org/stable/c/2935e556850e9c94d7a00adf14d3cd7fe406ac03"
  ],
  "aliases": [
    "CVE-2025-38593"
  ],
  "assigner": "Linux",
  "epss": 0.0,
  "enisaIdProduct": [
    {
      "id": "174946f3-7529-318d-af1e-bbe1f767bb13",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    },
    {
      "id": "1ee23232-4de2-3341-8ee3-6dfe452fcee4",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad383c2c65a5baf16e334cd40a013cc302176891 <16852eccbdfaf41a666705e3f8be55cf2864c5ca"
    },
    {
      "id": "36d91e2a-87b9-342e-bb96-c6f868c08b2e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "40028262-cd29-33f1-bb54-ae9035c25b48",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.10"
    },
    {
      "id": "46db64c0-3b30-3d5d-a3e0-eb379a9e4159",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.42"
    },
    {
      "id": "4aa6f949-7019-3d4a-881f-d78fea80d78a",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad383c2c65a5baf16e334cd40a013cc302176891 <2935e556850e9c94d7a00adf14d3cd7fe406ac03"
    },
    {
      "id": "88a4a620-8168-3178-bf11-44066e2daab8",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.1"
    },
    {
      "id": "b88d9b5f-72ab-3a7a-a195-04beea2df3ff",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc1"
    },
    {
      "id": "bcf8153e-c46c-30c2-9ccc-21a3d424f511",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad383c2c65a5baf16e334cd40a013cc302176891 <a351ff6b8ecca4229afaa0d98042bead8de64799"
    },
    {
      "id": "c6560477-8010-3ab8-b999-42df7251ff5a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "f6289491-35ac-3685-a3f2-0cf8c3d6e9d4",
      "product": {
        "name": "Linux"
      },
      "product_version": "ad383c2c65a5baf16e334cd40a013cc302176891 <f8069f34c4c976786ded97498012225af87435d7"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "bb70053c-6736-339d-a83a-bd8b6fb7ae03",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}