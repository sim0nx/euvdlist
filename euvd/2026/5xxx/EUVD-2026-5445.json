{
  "id": "EUVD-2026-5445",
  "enisaUuid": "514e64ac-7c10-395b-b4fe-39a89496f426",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmigrate: correct lock ordering for hugetlb file folios\n\nSyzbot has found a deadlock (analyzed by Lance Yang):\n\n1) Task (5749): Holds folio_lock, then tries to acquire i_mmap_rwsem(read lock).\n2) Task (5754): Holds i_mmap_rwsem(write lock), then tries to acquire\nfolio_lock.\n\nmigrate_pages()\n  -> migrate_hugetlbs()\n    -> unmap_and_move_huge_page()     <- Takes folio_lock!\n      -> remove_migration_ptes()\n        -> __rmap_walk_file()\n          -> i_mmap_lock_read()       <- Waits for i_mmap_rwsem(read lock)!\n\nhugetlbfs_fallocate()\n  -> hugetlbfs_punch_hole()           <- Takes i_mmap_rwsem(write lock)!\n    -> hugetlbfs_zero_partial_page()\n     -> filemap_lock_hugetlb_folio()\n      -> filemap_lock_folio()\n        -> __filemap_get_folio        <- Waits for folio_lock!\n\nThe migration path is the one taking locks in the wrong order according to\nthe documentation at the top of mm/rmap.c.  So expand the scope of the\nexisting i_mmap_lock to cover the calls to remove_migration_ptes() too.\n\nThis is (mostly) how it used to be after commit c0d0381ade79.  That was\nremoved by 336bf30eb765 for both file & anon hugetlb pages when it should\nonly have been removed for anon hugetlb pages.",
  "datePublished": "Feb 4, 2026, 4:08:19 PM",
  "dateUpdated": "Feb 4, 2026, 4:08:19 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/526394af4e8ade89cacd1a9ce2b97712712fcc34",
    "https://git.kernel.org/stable/c/b75070823b89009f5123fd0e05a8e0c3d39937c1",
    "https://git.kernel.org/stable/c/1b68efce6dd483d22f50d0d3800c4cfda14b1305",
    "https://git.kernel.org/stable/c/b7880cb166ab62c2409046b2347261abf701530e"
  ],
  "aliases": [
    "CVE-2026-23097"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "119d8414-c03b-346a-ba8b-86504607b7e5",
      "product": {
        "name": "Linux"
      },
      "product_version": "336bf30eb76580b579dc711ded5d599d905c0217 <b75070823b89009f5123fd0e05a8e0c3d39937c1"
    },
    {
      "id": "1b29e383-3698-34d4-8329-aa3d888797b4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "231aa547-a1ed-3d6d-923c-c86019b352ce",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.68"
    },
    {
      "id": "62f14e2a-bbf2-3d78-aeac-26f013ab9748",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.10"
    },
    {
      "id": "81d830a7-9497-3688-889b-9a7ee9309052",
      "product": {
        "name": "Linux"
      },
      "product_version": "ef792d6ce0db6a56e56743b1de1716a982c3b851"
    },
    {
      "id": "b96f53a6-28fc-30a4-8ad4-c0a9eb8d4772",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.19-rc7"
    },
    {
      "id": "ca890efd-345e-3e77-80fa-3c2c7cfb9a80",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.18.8"
    },
    {
      "id": "e0fc414f-2572-3ecd-b580-20b68cd6cdac",
      "product": {
        "name": "Linux"
      },
      "product_version": "336bf30eb76580b579dc711ded5d599d905c0217 <b7880cb166ab62c2409046b2347261abf701530e"
    },
    {
      "id": "f2cb55f9-a858-327f-9b28-34cd108d0b9a",
      "product": {
        "name": "Linux"
      },
      "product_version": "336bf30eb76580b579dc711ded5d599d905c0217 <526394af4e8ade89cacd1a9ce2b97712712fcc34"
    },
    {
      "id": "fb955515-29ed-3fc9-ba1e-58b4046b4772",
      "product": {
        "name": "Linux"
      },
      "product_version": "336bf30eb76580b579dc711ded5d599d905c0217 <1b68efce6dd483d22f50d0d3800c4cfda14b1305"
    },
    {
      "id": "fc523fa4-3603-3218-a50a-e1ef63f5a688",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.122"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "f5c0f3c4-7ea1-3925-bd6f-dbd73318be35",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}