{
  "id": "EUVD-2022-54773",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbonding: fix missed rcu protection\n\nWhen removing the rcu_read_lock in bond_ethtool_get_ts_info() as\ndiscussed [1], I didn't notice it could be called via setsockopt,\nwhich doesn't hold rcu lock, as syzbot pointed:\n\n  stack backtrace:\n  CPU: 0 PID: 3599 Comm: syz-executor317 Not tainted 5.18.0-rc5-syzkaller-01392-g01f4685797a5 #0\n  Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 01/01/2011\n  Call Trace:\n   <TASK>\n   __dump_stack lib/dump_stack.c:88 [inline]\n   dump_stack_lvl+0xcd/0x134 lib/dump_stack.c:106\n   bond_option_active_slave_get_rcu include/net/bonding.h:353 [inline]\n   bond_ethtool_get_ts_info+0x32c/0x3a0 drivers/net/bonding/bond_main.c:5595\n   __ethtool_get_ts_info+0x173/0x240 net/ethtool/common.c:554\n   ethtool_get_phc_vclocks+0x99/0x110 net/ethtool/common.c:568\n   sock_timestamping_bind_phc net/core/sock.c:869 [inline]\n   sock_set_timestamping+0x3a3/0x7e0 net/core/sock.c:916\n   sock_setsockopt+0x543/0x2ec0 net/core/sock.c:1221\n   __sys_setsockopt+0x55e/0x6a0 net/socket.c:2223\n   __do_sys_setsockopt net/socket.c:2238 [inline]\n   __se_sys_setsockopt net/socket.c:2235 [inline]\n   __x64_sys_setsockopt+0xba/0x150 net/socket.c:2235\n   do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n   do_syscall_64+0x35/0xb0 arch/x86/entry/common.c:80\n   entry_SYSCALL_64_after_hwframe+0x44/0xae\n  RIP: 0033:0x7f8902c8eb39\n\nFix it by adding rcu_read_lock and take a ref on the real_dev.\nSince dev_hold() and dev_put() can take NULL these days, we can\nskip checking if real_dev exist.\n\n[1] https://lore.kernel.org/netdev/27565.1642742439@famine/",
  "datePublished": "Feb 26, 2025, 2:13:04 AM",
  "dateUpdated": "Feb 26, 2025, 2:13:04 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/1b66a533c47d29b38af8e05fbb53b609a5ba3a4e",
    "https://git.kernel.org/stable/c/85eed460681da71b359ed906bce4d800081db854",
    "https://git.kernel.org/stable/c/9b80ccda233fa6c59de411bf889cc4d0e028f2c7"
  ],
  "aliases": [
    "CVE-2022-49456"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "01853e15-0382-3793-a3ca-8069f15f0c29",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.14"
    },
    {
      "id": "1b8c371a-c36b-380e-8962-f36834e456bd",
      "product": {
        "name": "Linux"
      },
      "product_version": "aa6034678e873db8bd5c5a4b73f8b88c469374d6 <85eed460681da71b359ed906bce4d800081db854"
    },
    {
      "id": "33a9ae9c-cebf-365e-bb3c-f5b6ac323488",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.17"
    },
    {
      "id": "507ab1d4-2a21-3388-9d3c-91328946a7da",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18.3"
    },
    {
      "id": "644a7f48-2b40-3eb2-b627-5fd28e8f9f4e",
      "product": {
        "name": "Linux"
      },
      "product_version": "aa6034678e873db8bd5c5a4b73f8b88c469374d6 <9b80ccda233fa6c59de411bf889cc4d0e028f2c7"
    },
    {
      "id": "68d6801f-a943-3932-889e-f7413f4fe990",
      "product": {
        "name": "Linux"
      },
      "product_version": "aa6034678e873db8bd5c5a4b73f8b88c469374d6 <1b66a533c47d29b38af8e05fbb53b609a5ba3a4e"
    },
    {
      "id": "86fa3161-4490-37f4-8f00-97439e653678",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19"
    },
    {
      "id": "c1855029-eab7-3e06-94d3-3c26cf441180",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8431e690-a956-32a4-a2e2-d6bfece434d5",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49456"
}
