{
  "id": "EUVD-2025-2631",
  "enisaUuid": "c337cb86-10d2-3b44-bcdf-d66fb973becc",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\neth: bnxt: always recalculate features after XDP clearing, fix null-deref\n\nRecalculate features when XDP is detached.\n\nBefore:\n  # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp\n  # ip li set dev eth0 xdp off\n  # ethtool -k eth0 | grep gro\n  rx-gro-hw: off [requested on]\n\nAfter:\n  # ip li set dev eth0 xdp obj xdp_dummy.bpf.o sec xdp\n  # ip li set dev eth0 xdp off\n  # ethtool -k eth0 | grep gro\n  rx-gro-hw: on\n\nThe fact that HW-GRO doesn't get re-enabled automatically is just\na minor annoyance. The real issue is that the features will randomly\ncome back during another reconfiguration which just happens to invoke\nnetdev_update_features(). The driver doesn't handle reconfiguring\ntwo things at a time very robustly.\n\nStarting with commit 98ba1d931f61 (\"bnxt_en: Fix RSS logic in\n__bnxt_reserve_rings()\") we only reconfigure the RSS hash table\nif the \"effective\" number of Rx rings has changed. If HW-GRO is\nenabled \"effective\" number of rings is 2x what user sees.\nSo if we are in the bad state, with HW-GRO re-enablement \"pending\"\nafter XDP off, and we lower the rings by / 2 - the HW-GRO rings\ndoing 2x and the ethtool -L doing / 2 may cancel each other out,\nand the:\n\n  if (old_rx_rings != bp->hw_resc.resv_rx_rings &&\n\ncondition in __bnxt_reserve_rings() will be false.\nThe RSS map won't get updated, and we'll crash with:\n\n  BUG: kernel NULL pointer dereference, address: 0000000000000168\n  RIP: 0010:__bnxt_hwrm_vnic_set_rss+0x13a/0x1a0\n    bnxt_hwrm_vnic_rss_cfg_p5+0x47/0x180\n    __bnxt_setup_vnic_p5+0x58/0x110\n    bnxt_init_nic+0xb72/0xf50\n    __bnxt_open_nic+0x40d/0xab0\n    bnxt_open_nic+0x2b/0x60\n    ethtool_set_channels+0x18c/0x1d0\n\nAs we try to access a freed ring.\n\nThe issue is present since XDP support was added, really, but\nprior to commit 98ba1d931f61 (\"bnxt_en: Fix RSS logic in\n__bnxt_reserve_rings()\") it wasn't causing major issues.",
  "datePublished": "Jan 31, 2025, 11:25:42 AM",
  "dateUpdated": "Oct 1, 2025, 7:57:11 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/08831a894d18abfaabb5bbde7c2069a7fb41dd93",
    "https://git.kernel.org/stable/c/f0aa6a37a3dbb40b272df5fc6db93c114688adcd"
  ],
  "aliases": [
    "CVE-2025-21682"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "464fa2fc-cffd-33b8-b66f-3325508999e1",
      "product": {
        "name": "Linux"
      },
      "product_version": "4.16"
    },
    {
      "id": "8c692f3d-0ee3-364e-98dd-1d266b22a1d0",
      "product": {
        "name": "Linux"
      },
      "product_version": "1054aee82321483dceabbb9b9e5d6512e8fe684b <08831a894d18abfaabb5bbde7c2069a7fb41dd93"
    },
    {
      "id": "90286397-92b4-36f4-8699-cc81b3515521",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.11"
    },
    {
      "id": "9b7c3f48-b238-3485-b80f-c0d5a74b9f36",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "ab3946fc-7d74-39c1-aa85-bf5a05b2b05e",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "d01fca35-895e-3609-971b-ecc155d73745",
      "product": {
        "name": "Linux"
      },
      "product_version": "1054aee82321483dceabbb9b9e5d6512e8fe684b <f0aa6a37a3dbb40b272df5fc6db93c114688adcd"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "6d27956b-ff7f-314f-bc40-cdf7902312df",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}