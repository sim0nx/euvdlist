{
  "id": "EUVD-2024-53394",
  "enisaUuid": "8c7b81de-ede1-3281-91db-51d2caf905d3",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nipv6: release nexthop on device removal\n\nThe CI is hitting some aperiodic hangup at device removal time in the\npmtu.sh self-test:\n\nunregister_netdevice: waiting for veth_A-R1 to become free. Usage count = 6\nref_tracker: veth_A-R1@ffff888013df15d8 has 1/5 users at\n\tdst_init+0x84/0x4a0\n\tdst_alloc+0x97/0x150\n\tip6_dst_alloc+0x23/0x90\n\tip6_rt_pcpu_alloc+0x1e6/0x520\n\tip6_pol_route+0x56f/0x840\n\tfib6_rule_lookup+0x334/0x630\n\tip6_route_output_flags+0x259/0x480\n\tip6_dst_lookup_tail.constprop.0+0x5c2/0x940\n\tip6_dst_lookup_flow+0x88/0x190\n\tudp_tunnel6_dst_lookup+0x2a7/0x4c0\n\tvxlan_xmit_one+0xbde/0x4a50 [vxlan]\n\tvxlan_xmit+0x9ad/0xf20 [vxlan]\n\tdev_hard_start_xmit+0x10e/0x360\n\t__dev_queue_xmit+0xf95/0x18c0\n\tarp_solicit+0x4a2/0xe00\n\tneigh_probe+0xaa/0xf0\n\nWhile the first suspect is the dst_cache, explicitly tracking the dst\nowing the last device reference via probes proved such dst is held by\nthe nexthop in the originating fib6_info.\n\nSimilar to commit f5b51fe804ec (\"ipv6: route: purge exception on\nremoval\"), we need to explicitly release the originating fib info when\ndisconnecting a to-be-removed device from a live ipv6 dst: move the\nfib6_info cleanup into ip6_dst_ifdown().\n\nTested running:\n\n./pmtu.sh cleanup_ipv6_exception\n\nin a tight loop for more than 400 iterations with no spat, running an\nunpatched kernel  I observed a splat every ~10 iterations.",
  "datePublished": "Dec 29, 2024, 11:30:16 AM",
  "dateUpdated": "May 2, 2025, 6:15:30 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/b2f26a27ea3f72f75d18330f76f5d1007c791848",
    "https://git.kernel.org/stable/c/43e25adc80269f917d2a195f0d59f74cdd182955",
    "https://git.kernel.org/stable/c/a3c3f8a4d025acc8c857246ec2b812c59102487a",
    "https://git.kernel.org/stable/c/0e4c6faaef8a24b762a24ffb767280e263ef8e10",
    "https://git.kernel.org/stable/c/eb02688c5c45c3e7af7e71f036a7144f5639cbfe",
    "https://git.kernel.org/stable/c/77aa9855a878fb43f547ddfbda3127a1e88ad31a"
  ],
  "aliases": [
    "CVE-2024-56751"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "00fd4ec7-433a-31ac-926f-9c6529a5e752",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.11.11"
    },
    {
      "id": "051db18a-9346-3bdf-b11c-b3153c6e16c6",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.120"
    },
    {
      "id": "0fb25138-9386-3429-a748-bc4431e220b1",
      "product": {
        "name": "Linux"
      },
      "product_version": "f88d8ea67fbdbac7a64bfa6ed9a2ba27bb822f74 <b2f26a27ea3f72f75d18330f76f5d1007c791848"
    },
    {
      "id": "15b23d85-b22b-3f91-966d-08c01b292164",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "2e055ece-124d-3100-98a2-1d1a9d20d801",
      "product": {
        "name": "Linux"
      },
      "product_version": "f88d8ea67fbdbac7a64bfa6ed9a2ba27bb822f74 <0e4c6faaef8a24b762a24ffb767280e263ef8e10"
    },
    {
      "id": "54e085a8-4745-3b4b-b257-8c1244606df5",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "6a1acbbf-050d-3302-877f-dad56865faa4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.64"
    },
    {
      "id": "a3826c6e-b3c8-3537-8800-c27edc2c628c",
      "product": {
        "name": "Linux"
      },
      "product_version": "f88d8ea67fbdbac7a64bfa6ed9a2ba27bb822f74 <eb02688c5c45c3e7af7e71f036a7144f5639cbfe"
    },
    {
      "id": "b505bfc0-88f8-3235-9b24-e519becd7277",
      "product": {
        "name": "Linux"
      },
      "product_version": "f88d8ea67fbdbac7a64bfa6ed9a2ba27bb822f74 <43e25adc80269f917d2a195f0d59f74cdd182955"
    },
    {
      "id": "c2076bae-a6ef-3aa3-a7d8-bcd98fe2a1a5",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.3"
    },
    {
      "id": "d8613013-6747-3cba-99c6-47e5d5c2574d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.2"
    },
    {
      "id": "dc41551f-db50-30f0-a9a3-bf5842c7ff92",
      "product": {
        "name": "Linux"
      },
      "product_version": "f88d8ea67fbdbac7a64bfa6ed9a2ba27bb822f74 <a3c3f8a4d025acc8c857246ec2b812c59102487a"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "71bd85df-f3c9-3521-a72f-35b2bcc23dfb",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}