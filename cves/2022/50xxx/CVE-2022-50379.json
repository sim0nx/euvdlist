{
  "id": "EUVD-2025-29988",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix race between quota enable and quota rescan ioctl\n\nWhen enabling quotas, at btrfs_quota_enable(), after committing the\ntransaction, we change fs_info->quota_root to point to the quota root we\ncreated and set BTRFS_FS_QUOTA_ENABLED at fs_info->flags. Then we try\nto start the qgroup rescan worker, first by initializing it with a call\nto qgroup_rescan_init() - however if that fails we end up freeing the\nquota root but we leave fs_info->quota_root still pointing to it, this\ncan later result in a use-after-free somewhere else.\n\nWe have previously set the flags BTRFS_FS_QUOTA_ENABLED and\nBTRFS_QGROUP_STATUS_FLAG_ON, so we can only fail with -EINPROGRESS at\nbtrfs_quota_enable(), which is possible if someone already called the\nquota rescan ioctl, and therefore started the rescan worker.\n\nSo fix this by ignoring an -EINPROGRESS and asserting we can't get any\nother error.",
  "datePublished": "Sep 18, 2025, 1:33:01 PM",
  "dateUpdated": "Sep 18, 2025, 1:33:01 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2022-50379",
    "https://git.kernel.org/stable/c/0efd9dfc00d677a1d0929319a6103cb2dfc41c22",
    "https://git.kernel.org/stable/c/26b7c0ac49a3eea15559c9d84863736a6d1164b4",
    "https://git.kernel.org/stable/c/331cd9461412e103d07595a10289de90004ac890",
    "https://git.kernel.org/stable/c/47b5ffe86332af95f0f52be0a63d4da7c2b37b55",
    "https://git.kernel.org/stable/c/4b996a3014ef014af8f97b60c35f5289210a4720",
    "https://git.kernel.org/stable/c/6c22f86dd221eba0c7af645b1af73dcbc04ee27b",
    "https://git.kernel.org/stable/c/c97f6d528c3f1c83a6b792a8a7928c236c80b8fe"
  ],
  "aliases": [
    "CVE-2022-50379",
    "GHSA-ffg2-pg2r-fw6w"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "0e2ecb7b-d355-3f8d-a4b6-0003e1fa3298",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <c97f6d528c3f1c83a6b792a8a7928c236c80b8fe"
    },
    {
      "id": "1fc94fb2-7662-3fa7-9a2d-dc2b3f6816bc",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.75"
    },
    {
      "id": "32e4aafa-1fbb-3e52-8adc-c1596f1a3632",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <6c22f86dd221eba0c7af645b1af73dcbc04ee27b"
    },
    {
      "id": "5995335c-f7ad-3e8d-94b3-0b08a06be9b3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.150"
    },
    {
      "id": "65af9d06-1feb-3e9a-abcd-ee562b36ef88",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 4.19.262"
    },
    {
      "id": "7fd53318-4008-3306-b145-0b0ad6769cc3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.220"
    },
    {
      "id": "81de0335-7792-34f5-bb7d-29d1833e43f3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <4b996a3014ef014af8f97b60c35f5289210a4720"
    },
    {
      "id": "8fadeb5c-8c4c-3902-be08-de147892a9e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <26b7c0ac49a3eea15559c9d84863736a6d1164b4"
    },
    {
      "id": "90006a6f-60e2-3a04-9a55-db69795d9fa3",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <0efd9dfc00d677a1d0929319a6103cb2dfc41c22"
    },
    {
      "id": "a1b0dd69-24af-3a76-975f-fac1d543111a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.0.3"
    },
    {
      "id": "bb60e048-100e-358d-8977-27d7ef45fa54",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1"
    },
    {
      "id": "dc67e67b-201d-3800-b1c4-7dec0b4f05e4",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <331cd9461412e103d07595a10289de90004ac890"
    },
    {
      "id": "e7ecca2c-c96d-3f1b-9011-24dcce606994",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.19.17"
    },
    {
      "id": "fc64a1f5-3f22-36d5-b768-bcae9636b2e2",
      "product": {
        "name": "Linux"
      },
      "product_version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 <47b5ffe86332af95f0f52be0a63d4da7c2b37b55"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "cc70b2ba-960d-3c1a-9283-2bca6f770a3d",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-50379"
}