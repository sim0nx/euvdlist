{
  "id": "EUVD-2025-30856",
  "enisaUuid": "21c8ead5-e44f-3276-a1cb-8967aa2f5536",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nmacsec: sync features on RTM_NEWLINK\n\nSyzkaller managed to lock the lower device via ETHTOOL_SFEATURES:\n\n netdev_lock include/linux/netdevice.h:2761 [inline]\n netdev_lock_ops include/net/netdev_lock.h:42 [inline]\n netdev_sync_lower_features net/core/dev.c:10649 [inline]\n __netdev_update_features+0xcb1/0x1be0 net/core/dev.c:10819\n netdev_update_features+0x6d/0xe0 net/core/dev.c:10876\n macsec_notify+0x2f5/0x660 drivers/net/macsec.c:4533\n notifier_call_chain+0x1b3/0x3e0 kernel/notifier.c:85\n call_netdevice_notifiers_extack net/core/dev.c:2267 [inline]\n call_netdevice_notifiers net/core/dev.c:2281 [inline]\n netdev_features_change+0x85/0xc0 net/core/dev.c:1570\n __dev_ethtool net/ethtool/ioctl.c:3469 [inline]\n dev_ethtool+0x1536/0x19b0 net/ethtool/ioctl.c:3502\n dev_ioctl+0x392/0x1150 net/core/dev_ioctl.c:759\n\nIt happens because lower features are out of sync with the upper:\n\n  __dev_ethtool (real_dev)\n    netdev_lock_ops(real_dev)\n    ETHTOOL_SFEATURES\n      __netdev_features_change\n        netdev_sync_upper_features\n          disable LRO on the lower\n    if (old_features != dev->features)\n      netdev_features_change\n        fires NETDEV_FEAT_CHANGE\n\tmacsec_notify\n\t  NETDEV_FEAT_CHANGE\n\t    netdev_update_features (for each macsec dev)\n\t      netdev_sync_lower_features\n\t        if (upper_features != lower_features)\n\t          netdev_lock_ops(lower) # lower == real_dev\n\t\t  stuck\n\t\t  ...\n\n    netdev_unlock_ops(real_dev)\n\nPer commit af5f54b0ef9e (\"net: Lock lower level devices when updating\nfeatures\"), we elide the lock/unlock when the upper and lower features\nare synced. Makes sure the lower (real_dev) has proper features after\nthe macsec link has been created. This makes sure we never hit the\nsituation where we need to sync upper flags to the lower.",
  "datePublished": "Sep 23, 2025, 6:00:46 AM",
  "dateUpdated": "Sep 29, 2025, 6:01:31 AM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39874",
    "https://git.kernel.org/stable/c/0f82c3ba66c6b2e3cde0f255156a753b108ee9dc",
    "https://git.kernel.org/stable/c/d7624629ccf47135c65fef0701fa0d9a115b87f3"
  ],
  "aliases": [
    "CVE-2025-39874",
    "GHSA-rmcq-9vcc-9423"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "41ef0d54-0469-3951-911c-7241a8ef8d11",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.8"
    },
    {
      "id": "4da8a2f9-9f48-3500-b80d-bbd7142cb280",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc6"
    },
    {
      "id": "56f1af4f-5eee-305e-93af-ea990948b6e5",
      "product": {
        "name": "Linux"
      },
      "product_version": "7e4d784f5810bba76c4593791028e13cce4af547 <d7624629ccf47135c65fef0701fa0d9a115b87f3"
    },
    {
      "id": "940d3e61-73d0-309b-bb1a-d5379192b475",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "b809472b-65de-39f1-b442-45efcb22795d",
      "product": {
        "name": "Linux"
      },
      "product_version": "7e4d784f5810bba76c4593791028e13cce4af547 <0f82c3ba66c6b2e3cde0f255156a753b108ee9dc"
    },
    {
      "id": "d6bb2ddb-6472-31c2-8394-9019e5c7ba3a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "fd14fcfe-41db-3e45-ae48-cbf3ef5b0072",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.15"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "33e5ea92-ebd8-359d-a41a-cfe0711da49c",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}