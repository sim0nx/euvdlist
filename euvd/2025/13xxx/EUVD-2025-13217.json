{
  "id": "EUVD-2025-13217",
  "enisaUuid": "f5e5f0c5-b782-3c81-8af5-ee9d01fc92b2",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: typec: tcpm: fix warning when handle discover_identity message\n\nSince both source and sink device can send discover_identity message in\nPD3, kernel may dump below warning:\n\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 169 at drivers/usb/typec/tcpm/tcpm.c:1446 tcpm_queue_vdm+0xe0/0xf0\nModules linked in:\nCPU: 0 PID: 169 Comm: 1-0050 Not tainted 6.1.1-00038-g6a3c36cf1da2-dirty #567\nHardware name: NXP i.MX8MPlus EVK board (DT)\npstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : tcpm_queue_vdm+0xe0/0xf0\nlr : tcpm_queue_vdm+0x2c/0xf0\nsp : ffff80000c19bcd0\nx29: ffff80000c19bcd0 x28: 0000000000000001 x27: ffff0000d11c8ab8\nx26: ffff0000d11cc000 x25: 0000000000000000 x24: 00000000ff008081\nx23: 0000000000000001 x22: 00000000ff00a081 x21: ffff80000c19bdbc\nx20: 0000000000000000 x19: ffff0000d11c8080 x18: ffffffffffffffff\nx17: 0000000000000000 x16: 0000000000000000 x15: ffff0000d716f580\nx14: 0000000000000001 x13: ffff0000d716f507 x12: 0000000000000001\nx11: 0000000000000000 x10: 0000000000000020 x9 : 00000000000ee098\nx8 : 00000000ffffffff x7 : 000000000000001c x6 : ffff0000d716f580\nx5 : 0000000000000000 x4 : 0000000000000000 x3 : 0000000000000000\nx2 : ffff80000c19bdbc x1 : 00000000ff00a081 x0 : 0000000000000004\nCall trace:\ntcpm_queue_vdm+0xe0/0xf0\ntcpm_pd_rx_handler+0x340/0x1ab0\nkthread_worker_fn+0xcc/0x18c\nkthread+0x10c/0x110\nret_from_fork+0x10/0x20\n---[ end trace 0000000000000000 ]---\n\nBelow sequences may trigger this warning:\n\ntcpm_send_discover_work(work)\n  tcpm_send_vdm(port, USB_SID_PD, CMD_DISCOVER_IDENT, NULL, 0);\n   tcpm_queue_vdm(port, header, data, count);\n    port->vdm_state = VDM_STATE_READY;\n\nvdm_state_machine_work(work);\n\t\t\t<-- received discover_identity from partner\n vdm_run_state_machine(port);\n  port->vdm_state = VDM_STATE_SEND_MESSAGE;\n   mod_vdm_delayed_work(port, x);\n\ntcpm_pd_rx_handler(work);\n tcpm_pd_data_request(port, msg);\n  tcpm_handle_vdm_request(port, msg->payload, cnt);\n   tcpm_queue_vdm(port, response[0], &response[1], rlen - 1);\n--> WARN_ON(port->vdm_state > VDM_STATE_DONE);\n\nFor this case, the state machine could still send out discover\nidentity message later if we skip current discover_identity message.\nSo we should handle the received message firstly and override the pending\ndiscover_identity message without warning in this case. Then, a delayed\nsend_discover work will send discover_identity message again.",
  "datePublished": "May 2, 2025, 3:55:04 PM",
  "dateUpdated": "May 2, 2025, 3:55:04 PM",
  "baseScore": 0.0,
  "references": [
    "https://nvd.nist.gov/vuln/detail/CVE-2023-53048",
    "https://git.kernel.org/stable/c/abfc4fa28f0160df61c7149567da4f6494dfb488",
    "https://git.kernel.org/stable/c/bb579b3f75c60bf488a7c36e092e8be583407d53",
    "https://git.kernel.org/stable/c/d55ca2d2ea1a7ec553213986993fba8c0257381c",
    "https://git.kernel.org/stable/c/e37d2c489d71e94ed4a39529bc9520a7fd983d42"
  ],
  "aliases": [
    "CVE-2023-53048",
    "GHSA-5v2q-9mrf-qmcj"
  ],
  "assigner": "Linux",
  "epss": 0.02,
  "enisaIdProduct": [
    {
      "id": "06dadf79-dd3a-3e01-9e2c-63b4e531777f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.2.9"
    },
    {
      "id": "090fa09a-f4af-3312-8e3c-7a1b32ed7759",
      "product": {
        "name": "Linux"
      },
      "product_version": "e00943e916782ae17ca05d654779a84f09481ab8 <bb579b3f75c60bf488a7c36e092e8be583407d53"
    },
    {
      "id": "5f0ec6ff-e999-3600-b471-5c3f70787246",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.13"
    },
    {
      "id": "6075eb26-683b-3be1-a8e8-cb42315229d1",
      "product": {
        "name": "Linux"
      },
      "product_version": "e00943e916782ae17ca05d654779a84f09481ab8 <d55ca2d2ea1a7ec553213986993fba8c0257381c"
    },
    {
      "id": "62d2eeff-f36f-3103-a69b-416a007bcbce",
      "product": {
        "name": "Linux"
      },
      "product_version": "e00943e916782ae17ca05d654779a84f09481ab8 <e37d2c489d71e94ed4a39529bc9520a7fd983d42"
    },
    {
      "id": "9c74e7a4-b7c1-3672-ab25-b1a87b3da7f2",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.3"
    },
    {
      "id": "ce5b2d68-a459-306c-ad84-d3751a13dc58",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.105"
    },
    {
      "id": "ce9a23bb-c2ac-3b8a-99b9-b01dbab6ff4a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "d5eeba19-b7a4-318e-b910-60132d60ab3f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.22"
    },
    {
      "id": "dde073cd-d76f-3f39-b6bf-60fdde3ada5b",
      "product": {
        "name": "Linux"
      },
      "product_version": "e00943e916782ae17ca05d654779a84f09481ab8 <abfc4fa28f0160df61c7149567da4f6494dfb488"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "672e5a4a-b7d3-3a8e-8200-c2f8dd5cac11",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}