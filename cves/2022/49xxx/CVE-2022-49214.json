{
  "id": "EUVD-2022-55012",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/64s: Don't use DSISR for SLB faults\n\nSince commit 46ddcb3950a2 (\"powerpc/mm: Show if a bad page fault on data\nis read or write.\") we use page_fault_is_write(regs->dsisr) in\n__bad_page_fault() to determine if the fault is for a read or write, and\nchange the message printed accordingly.\n\nBut SLB faults, aka Data Segment Interrupts, don't set DSISR (Data\nStorage Interrupt Status Register) to a useful value. All ISA versions\nfrom v2.03 through v3.1 specify that the Data Segment Interrupt sets\nDSISR \"to an undefined value\". As far as I can see there's no mention of\nSLB faults setting DSISR in any BookIV content either.\n\nThis manifests as accesses that should be a read being incorrectly\nreported as writes, for example, using the xmon \"dump\" command:\n\n  0:mon> d 0x5deadbeef0000000\n  5deadbeef0000000\n  [359526.415354][    C6] BUG: Unable to handle kernel data access on write at 0x5deadbeef0000000\n  [359526.415611][    C6] Faulting instruction address: 0xc00000000010a300\n  cpu 0x6: Vector: 380 (Data SLB Access) at [c00000000ffbf400]\n      pc: c00000000010a300: mread+0x90/0x190\n\nIf we disassemble the PC, we see a load instruction:\n\n  0:mon> di c00000000010a300\n  c00000000010a300 89490000      lbz     r10,0(r9)\n\nWe can also see in exceptions-64s.S that the data_access_slb block\ndoesn't set IDSISR=1, which means it doesn't load DSISR into pt_regs. So\nthe value we're using to determine if the fault is a read/write is some\nstale value in pt_regs from a previous page fault.\n\nRework the printing logic to separate the SLB fault case out, and only\nprint read/write in the cases where we can determine it.\n\nThe result looks like eg:\n\n  0:mon> d 0x5deadbeef0000000\n  5deadbeef0000000\n  [  721.779525][    C6] BUG: Unable to handle kernel data access at 0x5deadbeef0000000\n  [  721.779697][    C6] Faulting instruction address: 0xc00000000014cbe0\n  cpu 0x6: Vector: 380 (Data SLB Access) at [c00000000ffbf390]\n\n  0:mon> d 0\n  0000000000000000\n  [  742.793242][    C6] BUG: Kernel NULL pointer dereference at 0x00000000\n  [  742.793316][    C6] Faulting instruction address: 0xc00000000014cbe0\n  cpu 0x6: Vector: 380 (Data SLB Access) at [c00000000ffbf390]",
  "datePublished": "Feb 26, 2025, 1:55:49 AM",
  "dateUpdated": "Feb 26, 2025, 1:55:49 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/4a852ff9b7bea9c640540e2c1bc70bd3ba455d61",
    "https://git.kernel.org/stable/c/a3dae36d632b2cf6eb20314273e512a96cb43c9a",
    "https://git.kernel.org/stable/c/093449bb182db885dae816d62874cccab7a4c42a",
    "https://git.kernel.org/stable/c/d4679ac8ea2e5078704aa1c026db36580cc1bf9a"
  ],
  "aliases": [
    "CVE-2022-49214"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "06b0b5b2-de6a-38f3-92dd-97f6eb3c5fe3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.18"
    },
    {
      "id": "2a5eb38f-cc11-3775-8516-ddc966a797a1",
      "product": {
        "name": "Linux"
      },
      "product_version": "46ddcb3950a28c0df4815e8dbb8d4b91d5d9f22d <4a852ff9b7bea9c640540e2c1bc70bd3ba455d61"
    },
    {
      "id": "330a4563-27ec-34c8-80fe-20ca080d86d6",
      "product": {
        "name": "Linux"
      },
      "product_version": "46ddcb3950a28c0df4815e8dbb8d4b91d5d9f22d <a3dae36d632b2cf6eb20314273e512a96cb43c9a"
    },
    {
      "id": "526cdc59-f666-3f4f-9e88-bca265f2ae45",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.16.19"
    },
    {
      "id": "553e54ba-ecee-3bc4-870b-e6b2a9099103",
      "product": {
        "name": "Linux"
      },
      "product_version": "46ddcb3950a28c0df4815e8dbb8d4b91d5d9f22d <d4679ac8ea2e5078704aa1c026db36580cc1bf9a"
    },
    {
      "id": "9e98c17a-09ff-36b7-9034-806704e7da4d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.17.2"
    },
    {
      "id": "c97340ce-8f06-3dc2-8077-bd9e815c4efe",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.5"
    },
    {
      "id": "eddcf63b-6b9f-32bc-afdf-0aadb9cc5429",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.33"
    },
    {
      "id": "f6e77ea1-256a-3b42-a563-2636cb92d854",
      "product": {
        "name": "Linux"
      },
      "product_version": "46ddcb3950a28c0df4815e8dbb8d4b91d5d9f22d <093449bb182db885dae816d62874cccab7a4c42a"
    },
    {
      "id": "fc543ba1-58aa-3dda-ae2f-38bb299cd526",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "a2f3f8b0-342d-32d1-a1ad-1a961d8069ac",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2022-49214"
}
