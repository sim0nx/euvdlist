{
  "id": "EUVD-2024-53804",
  "enisaUuid": "7a0cf260-c3da-35f6-beca-6d8599429b94",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_packet: fix vlan_get_protocol_dgram() vs MSG_PEEK\n\nBlamed commit forgot MSG_PEEK case, allowing a crash [1] as found\nby syzbot.\n\nRework vlan_get_protocol_dgram() to not touch skb at all,\nso that it can be used from many cpus on the same skb.\n\nAdd a const qualifier to skb argument.\n\n[1]\nskbuff: skb_under_panic: text:ffffffff8a8ccd05 len:29 put:14 head:ffff88807fc8e400 data:ffff88807fc8e3f4 tail:0x11 end:0x140 dev:<NULL>\n------------[ cut here ]------------\n kernel BUG at net/core/skbuff.c:206 !\nOops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI\nCPU: 1 UID: 0 PID: 5892 Comm: syz-executor883 Not tainted 6.13.0-rc4-syzkaller-00054-gd6ef8b40d075 #0\nHardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024\n RIP: 0010:skb_panic net/core/skbuff.c:206 [inline]\n RIP: 0010:skb_under_panic+0x14b/0x150 net/core/skbuff.c:216\nCode: 0b 8d 48 c7 c6 86 d5 25 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 5a 69 79 f7 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3\nRSP: 0018:ffffc900038d7638 EFLAGS: 00010282\nRAX: 0000000000000087 RBX: dffffc0000000000 RCX: 609ffd18ea660600\nRDX: 0000000000000000 RSI: 0000000080000000 RDI: 0000000000000000\nRBP: ffff88802483c8d0 R08: ffffffff817f0a8c R09: 1ffff9200071ae60\nR10: dffffc0000000000 R11: fffff5200071ae61 R12: 0000000000000140\nR13: ffff88807fc8e400 R14: ffff88807fc8e3f4 R15: 0000000000000011\nFS:  00007fbac5e006c0(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 00007fbac5e00d58 CR3: 000000001238e000 CR4: 00000000003526f0\nDR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\nDR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\nCall Trace:\n <TASK>\n  skb_push+0xe5/0x100 net/core/skbuff.c:2636\n  vlan_get_protocol_dgram+0x165/0x290 net/packet/af_packet.c:585\n  packet_recvmsg+0x948/0x1ef0 net/packet/af_packet.c:3552\n  sock_recvmsg_nosec net/socket.c:1033 [inline]\n  sock_recvmsg+0x22f/0x280 net/socket.c:1055\n  ____sys_recvmsg+0x1c6/0x480 net/socket.c:2803\n  ___sys_recvmsg net/socket.c:2845 [inline]\n  do_recvmmsg+0x426/0xab0 net/socket.c:2940\n  __sys_recvmmsg net/socket.c:3014 [inline]\n  __do_sys_recvmmsg net/socket.c:3037 [inline]\n  __se_sys_recvmmsg net/socket.c:3030 [inline]\n  __x64_sys_recvmmsg+0x199/0x250 net/socket.c:3030\n  do_syscall_x64 arch/x86/entry/common.c:52 [inline]\n  do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83\n entry_SYSCALL_64_after_hwframe+0x77/0x7f",
  "datePublished": "Jan 15, 2025, 1:05:57 PM",
  "dateUpdated": "Oct 1, 2025, 7:57:19 PM",
  "baseScore": 5.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://git.kernel.org/stable/c/560cbdd26b510626f3f4f27d34c44dfd3dd3499d",
    "https://git.kernel.org/stable/c/0d3fa6c3c9ca7aa255696150f5b759ac4a4974e1",
    "https://git.kernel.org/stable/c/de4f8d477c67ec1d7c28f3486c3e47d147d90a01",
    "https://git.kernel.org/stable/c/5d336714db324bef84490c75dcc48b387ef0346e",
    "https://git.kernel.org/stable/c/a693b87692b4d7c50f4fc08a996678d60534a9da",
    "https://git.kernel.org/stable/c/cd8488fdc7116f6da277515647b167859d4f72b1",
    "https://git.kernel.org/stable/c/f91a5b8089389eb408501af2762f168c3aaa7b79",
    "https://nvd.nist.gov/vuln/detail/CVE-2024-57901"
  ],
  "aliases": [
    "CVE-2024-57901"
  ],
  "assigner": "Linux",
  "epss": 0.04,
  "enisaIdProduct": [
    {
      "id": "12cc7375-05f3-36de-96dd-4ff9b0f9f14d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.1.124"
    },
    {
      "id": "18648fd8-4ca6-3630-a9e0-2642e994b451",
      "product": {
        "name": "Linux"
      },
      "product_version": "66f23a7b5174b5d3e7111fd2d0d5a4f3faaa12e5"
    },
    {
      "id": "4356f125-02ad-3be5-8311-ab84692face4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.70"
    },
    {
      "id": "51a1b9b0-3ab4-3c60-a6d5-c33a3e59b55d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.15.176"
    },
    {
      "id": "5d69cb64-5b72-32cf-a59c-66f71be4af9d",
      "product": {
        "name": "Linux"
      },
      "product_version": "5a041d25b67042cbe06a0fb292ee22fd1147e65c <a693b87692b4d7c50f4fc08a996678d60534a9da"
    },
    {
      "id": "5fa16688-7eee-3517-b35c-d69f4963b1ba",
      "product": {
        "name": "Linux"
      },
      "product_version": "3dfd84aa72fa7329ed4a257c8f40e0c9aff4dc8f"
    },
    {
      "id": "61777e9d-7c36-3170-a620-3aac1ca29cea",
      "product": {
        "name": "Linux"
      },
      "product_version": "79eecf631c14e7f4057186570ac20e2cfac3802e <f91a5b8089389eb408501af2762f168c3aaa7b79"
    },
    {
      "id": "72340620-c801-3d4a-abdb-cf03fc5be124",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.13"
    },
    {
      "id": "767e56cc-ca81-3d50-8730-e6f3aa326b3b",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.9"
    },
    {
      "id": "83f494dc-7ebc-3ce6-9822-42ee992a851a",
      "product": {
        "name": "Linux"
      },
      "product_version": "d0a1f9aa70f0d8a05b6320e8a3f3b83adab8dac3 <de4f8d477c67ec1d7c28f3486c3e47d147d90a01"
    },
    {
      "id": "89fe60a2-8258-3eef-8395-9dddcbefebac",
      "product": {
        "name": "Linux"
      },
      "product_version": "83e2dfadcb6258fe3111c8a8ec9cf34465e55e64 <0d3fa6c3c9ca7aa255696150f5b759ac4a4974e1"
    },
    {
      "id": "b2ba96f0-9b63-3cf0-ab2f-53d14ab17055",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "dac96489-0424-3513-b5d5-7a2dbdf90ec4",
      "product": {
        "name": "Linux"
      },
      "product_version": "79eecf631c14e7f4057186570ac20e2cfac3802e <cd8488fdc7116f6da277515647b167859d4f72b1"
    },
    {
      "id": "dd609c9c-e160-3362-bf80-0fbdcd9ccd8c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.10.233"
    },
    {
      "id": "de2bfd4d-658b-39a3-84d7-8c6f87fb9de6",
      "product": {
        "name": "Linux"
      },
      "product_version": "5839f59ff1dd4e35b9e767927931a039484839e1 <5d336714db324bef84490c75dcc48b387ef0346e"
    },
    {
      "id": "e27ef318-b8ae-3eb0-967c-9aad8262e8d5",
      "product": {
        "name": "Linux"
      },
      "product_version": "c77064e76c768fb101ea5ff92dc771142fc9d8fd <560cbdd26b510626f3f4f27d34c44dfd3dd3499d"
    },
    {
      "id": "f54031fc-20e2-313d-b990-f47d7e62f89d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 5.4.289"
    },
    {
      "id": "f90d7fdd-97a7-3e1a-a39a-5ee931566338",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.11"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "79b4bd1e-4a8d-3d2c-9171-ac2d77778fbd",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}