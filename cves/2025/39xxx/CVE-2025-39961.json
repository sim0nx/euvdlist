{
  "id": "EUVD-2025-33337",
  "enisaUuid": "87912a63-2ed1-3f7c-a826-1a32c21fbc7a",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/amd/pgtbl: Fix possible race while increase page table level\n\nThe AMD IOMMU host page table implementation supports dynamic page table levels\n(up to 6 levels), starting with a 3-level configuration that expands based on\nIOVA address. The kernel maintains a root pointer and current page table level\nto enable proper page table walks in alloc_pte()/fetch_pte() operations.\n\nThe IOMMU IOVA allocator initially starts with 32-bit address and onces its\nexhuasted it switches to 64-bit address (max address is determined based\non IOMMU and device DMA capability). To support larger IOVA, AMD IOMMU\ndriver increases page table level.\n\nBut in unmap path (iommu_v1_unmap_pages()), fetch_pte() reads\npgtable->[root/mode] without lock. So its possible that in exteme corner case,\nwhen increase_address_space() is updating pgtable->[root/mode], fetch_pte()\nreads wrong page table level (pgtable->mode). It does compare the value with\nlevel encoded in page table and returns NULL. This will result is\niommu_unmap ops to fail and upper layer may retry/log WARN_ON.\n\nCPU 0                                         CPU 1\n------                                       ------\nmap pages                                    unmap pages\nalloc_pte() -> increase_address_space()      iommu_v1_unmap_pages() -> fetch_pte()\n  pgtable->root = pte (new root value)\n                                             READ pgtable->[mode/root]\n\t\t\t\t\t       Reads new root, old mode\n  Updates mode (pgtable->mode += 1)\n\nSince Page table level updates are infrequent and already synchronized with a\nspinlock, implement seqcount to enable lock-free read operations on the read path.",
  "datePublished": "Oct 9, 2025, 3:31:03 PM",
  "dateUpdated": "Oct 9, 2025, 3:31:03 PM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/075abf0b1a958acfbea2435003d228e738e90346",
    "https://git.kernel.org/stable/c/cd92c8ab336c3a633d46e6f35ebcd3509ae7db3b",
    "https://git.kernel.org/stable/c/7d462bdecb7d9c32934dab44aaeb7ea7d73a27a2",
    "https://git.kernel.org/stable/c/1e56310b40fd2e7e0b9493da9ff488af145bdd0c",
    "https://nvd.nist.gov/vuln/detail/CVE-2025-39961"
  ],
  "aliases": [
    "CVE-2025-39961"
  ],
  "assigner": "Linux",
  "epss": 0.0,
  "enisaIdProduct": [
    {
      "id": "09ef5767-82b3-3be5-8bec-6bea270cbced",
      "product": {
        "name": "Linux"
      },
      "product_version": "754265bcab78a9014f0f99cd35e0d610fcd7dfa7 <cd92c8ab336c3a633d46e6f35ebcd3509ae7db3b"
    },
    {
      "id": "12a61b1d-3916-3a5f-9c5c-38cfd175e7d7",
      "product": {
        "name": "Linux"
      },
      "product_version": "5.3"
    },
    {
      "id": "25355714-7522-3265-bdfd-7a827acb326f",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "25ed46d2-5d85-3422-9723-0a9432307df4",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.6.108"
    },
    {
      "id": "4e6ab6cf-a7c0-317a-aa66-d90a944713c5",
      "product": {
        "name": "Linux"
      },
      "product_version": "754265bcab78a9014f0f99cd35e0d610fcd7dfa7 <1e56310b40fd2e7e0b9493da9ff488af145bdd0c"
    },
    {
      "id": "7e707ac9-1c48-3a62-9f43-34ff9a9135a1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.12.49"
    },
    {
      "id": "813eb48c-8bfb-3ad8-984e-a4578af743f7",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "99901057-429a-37fd-b2b3-b08a55fbf024",
      "product": {
        "name": "Linux"
      },
      "product_version": "b15bf74405faa1a65025eb8a6eb337e140e5250a"
    },
    {
      "id": "9d6ab61a-cb59-3299-8a08-5083546ebe44",
      "product": {
        "name": "Linux"
      },
      "product_version": "785ca708a908b9c596ede852470ba28b8dc3e40b"
    },
    {
      "id": "9ea46acf-4770-3a7b-acca-167c109d76eb",
      "product": {
        "name": "Linux"
      },
      "product_version": "0d50f7b1e8c80a8c20db5049e269468c059b0378"
    },
    {
      "id": "a08e9746-15db-3c4a-82b4-8dfcbf63d83c",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.9"
    },
    {
      "id": "a4981978-1815-38cc-b73f-94e923f4bff7",
      "product": {
        "name": "Linux"
      },
      "product_version": "754265bcab78a9014f0f99cd35e0d610fcd7dfa7 <7d462bdecb7d9c32934dab44aaeb7ea7d73a27a2"
    },
    {
      "id": "debb411e-2725-3738-af1f-617c02b75938",
      "product": {
        "name": "Linux"
      },
      "product_version": "6fb92f18555a7b8e085267d513612dc0ff9a5360"
    },
    {
      "id": "eee75ad2-9a16-3f3e-83a5-59a97af1de61",
      "product": {
        "name": "Linux"
      },
      "product_version": "754265bcab78a9014f0f99cd35e0d610fcd7dfa7 <075abf0b1a958acfbea2435003d228e738e90346"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "5f8882b3-d030-320c-b91e-17f4663ff57b",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39961"
}