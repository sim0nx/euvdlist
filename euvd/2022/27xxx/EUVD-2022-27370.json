{
  "id": "EUVD-2022-27370",
  "enisaUuid": "ddb0d42d-e3af-3e4f-8d92-e3310e675abf",
  "description": "On QFX10000 Series devices using Juniper Networks Junos OS when configured as transit IP/MPLS penultimate hop popping (PHP) nodes with link aggregation group (LAG) interfaces, an Improper Validation of Specified Index, Position, or Offset in Input weakness allows an attacker sending certain IP packets to cause multiple interfaces in the LAG to detach causing a Denial of Service (DoS) condition. Continued receipt and processing of these packets will sustain the Denial of Service. This issue affects IPv4 and IPv6 packets. Packets of either type can cause and sustain the DoS event. These packets can be destined to the device or be transit packets. On devices such as the QFX10008 with line cards, line cards can be restarted to restore service. On devices such as the QFX10002 you can restart the PFE service, or reboot device to restore service. This issue affects: Juniper Networks Junos OS on QFX10000 Series: All versions prior to 15.1R7-S11; 18.4 versions prior to 18.4R2-S10, 18.4R3-S10; 19.1 versions prior to 19.1R3-S8; 19.2 versions prior to 19.2R3-S4; 19.3 versions prior to 19.3R3-S5; 19.4 versions prior to 19.4R2-S6, 19.4R3-S7; 20.1 versions prior to 20.1R3-S3; 20.2 versions prior to 20.2R3-S3; 20.3 versions prior to 20.3R3-S2; 20.4 versions prior to 20.4R3-S4; 21.1 versions prior to 21.1R3; 21.2 versions prior to 21.2R3-S3; 21.3 versions prior to 21.3R3-S1. An indicator of compromise may be seen by issuing the command: request pfe execute target fpc0 command \"show jspec pechip[3] registers ps l2_node 10\" timeout 0 | refresh 1 | no-more and reviewing for backpressured output; for example: GOT: 0x220702a8 pe.ps.l2_node[10].pkt_cnt 00000076 GOT: 0x220702b4 pe.ps.l2_node[10].backpressured 00000002 <<<< STICKS HERE and requesting detail on the pepic wanio: request pfe execute target fpc0 command \"show pepic 0 wanio-info\" timeout 0 | no-more | match xe-0/0/0:2 GOT: 3 xe-0/0/0:2 10 6 3 0 1 10 189 10 0x6321b088 <<< LOOK HERE as well as looking for tail drops looking at the interface queue, for example: show interfaces queue xe-0/0/0:2 resulting in: Transmitted: Total-dropped packets: 1094137 0 pps << LOOK HERE",
  "datePublished": "Oct 18, 2022, 2:46:24 AM",
  "dateUpdated": "May 12, 2025, 2:43:06 PM",
  "baseScore": 6.5,
  "baseScoreVersion": "3.1",
  "baseScoreVector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "references": [
    "https://kb.juniper.net/JSA69873"
  ],
  "aliases": [
    "CVE-2022-22223",
    "GSD-2022-22223"
  ],
  "assigner": "juniper",
  "epss": 0.54,
  "enisaIdProduct": [
    {
      "id": "09651b7a-8658-3bee-a1aa-f0c0f45a5fbb",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "20.1 <20.1R3-S3"
    },
    {
      "id": "0b12943a-bd04-3202-90e7-3afe11814831",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "20.2 <20.2R3-S3"
    },
    {
      "id": "1e09368d-3baf-3d75-8372-44b14016c013",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "21.3 <21.3R3-S1"
    },
    {
      "id": "36fe34e4-d5df-37a6-aa68-af626effd9b3",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "19.3 <19.3R3-S5"
    },
    {
      "id": "3f1295ac-c787-3ec0-8eb0-3c9dabcdfb67",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "21.2 <21.2R3-S3"
    },
    {
      "id": "406645d2-79cd-39b8-accf-07ae0d51cf84",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "19.4 <19.4R2-S6, 19.4R3-S7"
    },
    {
      "id": "7bf9e4f5-7cb2-327a-a5f4-acd5cce11cde",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "20.3 <20.3R3-S2"
    },
    {
      "id": "a6200902-22ec-36a2-886c-52f26ad993a9",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "20.4 <20.4R3-S4"
    },
    {
      "id": "b3d4ac00-146c-3434-b861-c395dd6ee153",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "21.1 <21.1R3"
    },
    {
      "id": "b5229bc7-9722-3953-8be1-1d13bf5a90e4",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "19.2 <19.2R3-S4"
    },
    {
      "id": "ca4d3713-ca52-3c4e-8a01-70e839fff625",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "unspecified <15.1R7-S11"
    },
    {
      "id": "e6e73d86-e200-3957-a209-82ed91c06084",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "19.1 <19.1R3-S8"
    },
    {
      "id": "f934c5f9-433e-3823-94ba-f6ce9626c0da",
      "product": {
        "name": "Junos OS"
      },
      "product_version": "18.4 <18.4R2-S10, 18.4R3-S10"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "8fe6e631-dd4b-30f7-8b1d-5d907c0e2702",
      "vendor": {
        "name": "Juniper Networks"
      }
    }
  ]
}