{
  "id": "EUVD-2025-20919",
  "enisaUuid": "0e31ee53-0b81-324f-ba87-1ae608b811b0",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nfgraph: Do not enable function_graph tracer when setting funcgraph-args\n\nWhen setting the funcgraph-args option when function graph tracer is net\nenabled, it incorrectly enables it. Worse, it unregisters itself when it\nwas never registered. Then when it gets enabled again, it will register\nitself a second time causing a WARNing.\n\n ~# echo 1 > /sys/kernel/tracing/options/funcgraph-args\n ~# head -20 /sys/kernel/tracing/trace\n # tracer: nop\n #\n # entries-in-buffer/entries-written: 813/26317372   #P:8\n #\n #                                _-----=> irqs-off/BH-disabled\n #                               / _----=> need-resched\n #                              | / _---=> hardirq/softirq\n #                              || / _--=> preempt-depth\n #                              ||| / _-=> migrate-disable\n #                              |||| /     delay\n #           TASK-PID     CPU#  |||||  TIMESTAMP  FUNCTION\n #              | |         |   |||||     |         |\n           <idle>-0       [007] d..4.   358.966010:  7)   1.692 us    |          fetch_next_timer_interrupt(basej=4294981640, basem=357956000000, base_local=0xffff88823c3ae040, base_global=0xffff88823c3af300, tevt=0xffff888100e47cb8);\n           <idle>-0       [007] d..4.   358.966012:  7)               |          tmigr_cpu_deactivate(nextexp=357988000000) {\n           <idle>-0       [007] d..4.   358.966013:  7)               |            _raw_spin_lock(lock=0xffff88823c3b2320) {\n           <idle>-0       [007] d..4.   358.966014:  7)   0.981 us    |              preempt_count_add(val=1);\n           <idle>-0       [007] d..5.   358.966017:  7)   1.058 us    |              do_raw_spin_lock(lock=0xffff88823c3b2320);\n           <idle>-0       [007] d..4.   358.966019:  7)   5.824 us    |            }\n           <idle>-0       [007] d..5.   358.966021:  7)               |            tmigr_inactive_up(group=0xffff888100cb9000, child=0x0, data=0xffff888100e47bc0) {\n           <idle>-0       [007] d..5.   358.966022:  7)               |              tmigr_update_events(group=0xffff888100cb9000, child=0x0, data=0xffff888100e47bc0) {\n\nNotice the \"tracer: nop\" at the top there. The current tracer is the \"nop\"\ntracer, but the content is obviously the function graph tracer.\n\nEnabling function graph tracing will cause it to register again and\ntrigger a warning in the accounting:\n\n ~# echo function_graph > /sys/kernel/tracing/current_tracer\n -bash: echo: write error: Device or resource busy\n\nWith the dmesg of:\n\n ------------[ cut here ]------------\n WARNING: CPU: 7 PID: 1095 at kernel/trace/ftrace.c:3509 ftrace_startup_subops+0xc1e/0x1000\n Modules linked in: kvm_intel kvm irqbypass\n CPU: 7 UID: 0 PID: 1095 Comm: bash Not tainted 6.16.0-rc2-test-00006-gea03de4105d3 #24 PREEMPT\n Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2 04/01/2014\n RIP: 0010:ftrace_startup_subops+0xc1e/0x1000\n Code: 48 b8 22 01 00 00 00 00 ad de 49 89 84 24 88 01 00 00 8b 44 24 08 89 04 24 e9 c3 f7 ff ff c7 04 24 ed ff ff ff e9 b7 f7 ff ff <0f> 0b c7 04 24 f0 ff ff ff e9 a9 f7 ff ff c7 04 24 f4 ff ff ff e9\n RSP: 0018:ffff888133cff948 EFLAGS: 00010202\n RAX: 0000000000000001 RBX: 1ffff1102679ff31 RCX: 0000000000000000\n RDX: 1ffffffff0b27a60 RSI: ffffffff8593d2f0 RDI: ffffffff85941140\n RBP: 00000000000c2041 R08: ffffffffffffffff R09: ffffed1020240221\n R10: ffff88810120110f R11: ffffed1020240214 R12: ffffffff8593d2f0\n R13: ffffffff8593d300 R14: ffffffff85941140 R15: ffffffff85631100\n FS:  00007f7ec6f28740(0000) GS:ffff8882b5251000(0000) knlGS:0000000000000000\n CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n CR2: 00007f7ec6f181c0 CR3: 000000012f1d0005 CR4: 0000000000172ef0\n Call Trace:\n  <TASK>\n  ? __pfx_ftrace_startup_subops+0x10/0x10\n  ? find_held_lock+0x2b/0x80\n  ? ftrace_stub_direct_tramp+0x10/0x10\n  ? ftrace_stub_direct_tramp+0x10/0x10\n  ? trace_preempt_on+0xd0/0x110\n  ? __pfx_trace_graph_entry_args+0x10/\n---truncated---",
  "datePublished": "Jul 10, 2025, 8:15:01 AM",
  "dateUpdated": "Jul 28, 2025, 4:18:52 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/300dedd9fe182d4c7424550d81cee595994486d1",
    "https://git.kernel.org/stable/c/327e28664307d49ce3fa71ba30dcc0007c270974"
  ],
  "aliases": [
    "CVE-2025-38327"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "2cd6229f-7dec-3240-94ff-db33a6b6d2ae",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.15.4"
    },
    {
      "id": "312ad8ea-7294-3d43-8a10-547788bef9b1",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16"
    },
    {
      "id": "8099cfce-4f44-3339-b61c-fb65a03a1398",
      "product": {
        "name": "Linux"
      },
      "product_version": "c7a60a733c373eed0094774c141bf2934237e7ff <300dedd9fe182d4c7424550d81cee595994486d1"
    },
    {
      "id": "c0f61c20-d53e-31d4-9377-ba51320a972a",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.15"
    },
    {
      "id": "cbd10071-84d6-3959-b367-58974ccfe56a",
      "product": {
        "name": "Linux"
      },
      "product_version": "c7a60a733c373eed0094774c141bf2934237e7ff <327e28664307d49ce3fa71ba30dcc0007c270974"
    },
    {
      "id": "e800a43e-990b-39bf-9c63-fe484e4c94c3",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "f530560c-d436-34c0-8da6-2cba27d2e045",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16-rc3"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "59b9a2e0-86b1-3976-b268-828afcffeb23",
      "vendor": {
        "name": "Linux"
      }
    }
  ]
}