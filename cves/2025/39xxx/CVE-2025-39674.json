{
  "id": "EUVD-2025-31550",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ufs: ufs-qcom: Fix ESI null pointer dereference\n\nESI/MSI is a performance optimization feature that provides dedicated\ninterrupts per MCQ hardware queue. This is optional feature and UFS MCQ\nshould work with and without ESI feature.\n\nCommit e46a28cea29a (\"scsi: ufs: qcom: Remove the MSI descriptor abuse\")\nbrings a regression in ESI (Enhanced System Interrupt) configuration that\ncauses a null pointer dereference when Platform MSI allocation fails.\n\nThe issue occurs in when platform_device_msi_init_and_alloc_irqs() in\nufs_qcom_config_esi() fails (returns -EINVAL) but the current code uses\n__free() macro for automatic cleanup free MSI resources that were never\nsuccessfully allocated.\n\nUnable to handle kernel NULL pointer dereference at virtual\naddress 0000000000000008\n\n  Call trace:\n  mutex_lock+0xc/0x54 (P)\n  platform_device_msi_free_irqs_all+0x1c/0x40\n  ufs_qcom_config_esi+0x1d0/0x220 [ufs_qcom]\n  ufshcd_config_mcq+0x28/0x104\n  ufshcd_init+0xa3c/0xf40\n  ufshcd_pltfrm_init+0x504/0x7d4\n  ufs_qcom_probe+0x20/0x58 [ufs_qcom]\n\nFix by restructuring the ESI configuration to try MSI allocation first,\nbefore any other resource allocation and instead use explicit cleanup\ninstead of __free() macro to avoid cleanup of unallocated resources.\n\nTested on SM8750 platform with MCQ enabled, both with and without\nPlatform ESI support.",
  "datePublished": "Sep 5, 2025, 5:20:39 PM",
  "dateUpdated": "Sep 29, 2025, 5:57:09 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/aaf17a35a59572c8b29372883619c3dbb0ebb50a",
    "https://git.kernel.org/stable/c/6300d5c5438724c0876828da2f6e2c1a661871fc"
  ],
  "aliases": [
    "CVE-2025-39674"
  ],
  "assigner": "Linux",
  "epss": 0.0,
  "enisaIdProduct": [
    {
      "id": "1d952815-f8d1-3807-861a-071551998165",
      "product": {
        "name": "Linux"
      },
      "product_version": "e46a28cea29a0ca7d51c811acccf5d119b40c745 <aaf17a35a59572c8b29372883619c3dbb0ebb50a"
    },
    {
      "id": "2bd7eb8b-c924-3a70-8aed-1ea4781cd14d",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.4"
    },
    {
      "id": "3048421f-1eb7-35ff-883f-8f762cfa027c",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.16"
    },
    {
      "id": "58608631-f849-3381-a7c8-8aedaa910d8a",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "886b8765-511e-3e8b-9b79-2f83e1c467e9",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "d4068d7f-5cc5-331f-a312-85a260930001",
      "product": {
        "name": "Linux"
      },
      "product_version": "e46a28cea29a0ca7d51c811acccf5d119b40c745 <6300d5c5438724c0876828da2f6e2c1a661871fc"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "69b903fc-5100-307e-85ee-0ea5e1f9461f",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-39674"
}