{
  "id": "EUVD-2025-27923",
  "enisaUuid": "3dffb90c-f544-365d-b870-0f769ac178cf",
  "description": "In the Linux kernel, the following vulnerability has been resolved:\n\niommu/vt-d: Fix UAF on sva unbind with pending IOPFs\n\nCommit 17fce9d2336d (\"iommu/vt-d: Put iopf enablement in domain attach\npath\") disables IOPF on device by removing the device from its IOMMU's\nIOPF queue when the last IOPF-capable domain is detached from the device.\nUnfortunately, it did this in a wrong place where there are still pending\nIOPFs. As a result, a use-after-free error is potentially triggered and\neventually a kernel panic with a kernel trace similar to the following:\n\n refcount_t: underflow; use-after-free.\n WARNING: CPU: 3 PID: 313 at lib/refcount.c:28 refcount_warn_saturate+0xd8/0xe0\n Workqueue: iopf_queue/dmar0-iopfq iommu_sva_handle_iopf\n Call Trace:\n   <TASK>\n   iopf_free_group+0xe/0x20\n   process_one_work+0x197/0x3d0\n   worker_thread+0x23a/0x350\n   ? rescuer_thread+0x4a0/0x4a0\n   kthread+0xf8/0x230\n   ? finish_task_switch.isra.0+0x81/0x260\n   ? kthreads_online_cpu+0x110/0x110\n   ? kthreads_online_cpu+0x110/0x110\n   ret_from_fork+0x13b/0x170\n   ? kthreads_online_cpu+0x110/0x110\n   ret_from_fork_asm+0x11/0x20\n   </TASK>\n  ---[ end trace 0000000000000000 ]---\n\nThe intel_pasid_tear_down_entry() function is responsible for blocking\nhardware from generating new page faults and flushing all in-flight\nones. Therefore, moving iopf_for_domain_remove() after this function\nshould resolve this.",
  "datePublished": "Aug 19, 2025, 5:03:19 PM",
  "dateUpdated": "Sep 29, 2025, 5:54:27 AM",
  "baseScore": 0.0,
  "references": [
    "https://git.kernel.org/stable/c/c68332b7ee893292bba6e87d31ef2080c066c65d",
    "https://git.kernel.org/stable/c/f0b9d31c6edd50a6207489cd1bd4ddac814b9cd2"
  ],
  "aliases": [
    "CVE-2025-38594"
  ],
  "assigner": "Linux",
  "epss": 0.03,
  "enisaIdProduct": [
    {
      "id": "046e6dcf-d848-3d7a-b66d-9e1db7ef1305",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17"
    },
    {
      "id": "05d4e350-318c-3fd7-bd07-fd44d42f796a",
      "product": {
        "name": "Linux"
      },
      "product_version": "17fce9d2336d952b95474248303e5e7d9777f2e0 <f0b9d31c6edd50a6207489cd1bd4ddac814b9cd2"
    },
    {
      "id": "27cdcbda-1f64-39fd-a361-7221fa88caf2",
      "product": {
        "name": "Linux"
      },
      "product_version": "6.16"
    },
    {
      "id": "38e17349-9b69-3bff-8316-221267bc43be",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.17-rc1"
    },
    {
      "id": "eb5815d9-9ae9-323b-b345-cc8e9c9fffce",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 0"
    },
    {
      "id": "efd18ce0-db71-36cf-8bd2-34e9f3150cb7",
      "product": {
        "name": "Linux"
      },
      "product_version": "17fce9d2336d952b95474248303e5e7d9777f2e0 <c68332b7ee893292bba6e87d31ef2080c066c65d"
    },
    {
      "id": "fd222ba5-7335-3a0c-9087-0ee0c20f8935",
      "product": {
        "name": "Linux"
      },
      "product_version": "patch: 6.16.1"
    }
  ],
  "enisaIdVendor": [
    {
      "id": "f265d41d-753e-33f4-a159-4a1402e969ff",
      "vendor": {
        "name": "Linux"
      }
    }
  ],
  "cve": "CVE-2025-38594"
}